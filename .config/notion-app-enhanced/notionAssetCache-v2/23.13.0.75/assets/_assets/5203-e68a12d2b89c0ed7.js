"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[5203],{73657:(e,t,r)=>{r.d(t,{Z:()=>s});r(67294);var o=r(28992),i=r(85893);const s=function(e){return(0,i.jsx)(o.Z,{...e,style:{background:"none",borderBottom:"none",boxShadow:"",marginTop:2,marginBottom:6,paddingTop:4,paddingBottom:4,minHeight:"none",...e.style}})}},75203:(e,t,r)=>{r.r(t),r.d(t,{default:()=>_});r(67294);var o=r(83355),i=r(39068),s=r(56666),n=r(39132),p=r(61061),l=r(72126),a=r(82990),d=r(9291),h=r(50906),c=r(31869),y=r(96802),m=r(82530),u=r(87279),g=r(29376),v=r(4023),x=r(29798),b=r(73657),f=r(52275),P=r(31945),j=r(79131),S=r(73063),T=r(78140),C=r(32163),k=r(53437),Z=r(72495),w=r(26388),M=r(85893);class R extends o.Z{constructor(){super(...arguments),this.storeTypes={menuListStore:x.Z},this.renderRelationPropertyMenuPopup=e=>{const t=this.allRelatedTargetProperties.state;if(!t)return;const r=t.filter((e=>e.visible)),o=t.filter((e=>!e.visible));return(0,M.jsxs)(T.Z,{menuType:u.og.Popup,maxWidth:240,maxHeight:500,children:[0===t.length&&(0,M.jsx)(Z.Z,{children:(0,M.jsx)(b.Z,{caption:(0,M.jsx)(d.FormattedMessage,{defaultMessage:"No properties",id:"database.relationMenu.noProperties"})})}),t.length>0&&(0,M.jsx)(C.Z,{type:C.i.Vertical,store:this.stores.menuListStore,initialFocus:void 0,sections:l.oA([r.length>0&&{key:"visible_and_hidden_properties",render:e=>(0,M.jsx)(Z.Z,{...e,noTextOverflow:!0,isTitleUppercase:!1,title:(0,M.jsx)(d.FormattedMessage,{defaultMessage:"Shown in relation",id:"database.relationMenu.shownInRelationTitle"}),desktopTitleStyle:{height:18},children:this.renderPropertyDraggableList({visibleProperties:r,hiddenProperties:o,children:e.children})}),items:l.oA([...I({properties:r,visibility:!0},this.environment,this.theme,this.props.collectionStore,this.props.targetCollectionStore,this.props.property,this.props.disabled),o.length>0&&{key:"group-header-hidden-property",render:e=>(0,M.jsx)(F,{props:e,children:(0,M.jsx)(M.Fragment,{})}),action:()=>{}},...I({properties:o,visibility:!1},this.environment,this.theme,this.props.collectionStore,this.props.targetCollectionStore,this.props.property,this.props.disabled)])},0===r.length&&o.length>0&&{key:"hidden_properties",render:e=>(0,M.jsx)(F,{props:e,children:this.renderPropertyDraggableList({visibleProperties:r,hiddenProperties:o,children:e.children})}),items:I({properties:o,visibility:!1},this.environment,this.theme,this.props.collectionStore,this.props.targetCollectionStore,this.props.property,this.props.disabled)}])})]})},this.handlePropertyReorder=e=>{const{newPropertyKeys:t}=e,{collectionStore:r,property:o}=this.props,i=g.U1({collectionStore:r,property:o}),s=t.indexOf("group-header-hidden-property"),n=l.oA(t.filter((e=>!e.startsWith("group-header-"))).map(((e,t)=>{const r=i.find((t=>t.property===e));return r?s>0?"title"===e&&t>=s?r:{...r,visible:Boolean(t<s)}:r:{property:e,visible:!(s>0)||Boolean(t<s)}}))),p=i.filter((e=>!t.includes(e.property))),a={...g.ZI(r)};a[o]||(a[o]={}),a[o].related_properties=[...n,...p],m.createAndCommit({userAction:"RelationPropertyCustomizeLayoutMenu.handlePropertyReorder",environment:this.environment,perform:e=>{y.FH({stores:[r],update:{collection_relation_options:a},transaction:e})}}),this.stores.menuListStore.reset()},this.allRelatedTargetProperties=this.createComputedStore((()=>{const{collectionStore:e,targetCollectionStore:t,property:r}=this.props,o=g.U1({collectionStore:e,property:r}),i=Object.keys(t.getSchema()).map((e=>o.find((t=>t.property===e))??{property:e,visible:!1})),s=o.map((e=>e.property)),n=e=>{const t=s.indexOf(e);return-1!==t?t:1/0};return i.sort(((e,t)=>n(e.property)-n(t.property))),i}),!0)}renderComponent(){const{device:e}=this.environment;if(!e.isPhone||"section"===this.props.rowType)return(0,M.jsx)(w.ZP,{renderTooltip:()=>(0,M.jsx)(d.FormattedMessage,{id:"database.RelationCustomizeLayoutMenu.tooltip.button.message",defaultMessage:"Customize shown properties"}),placement:"section"===this.props.rowType?v.u.Top:v.u.Right,render:e=>(0,M.jsx)(P.ZP,{popupType:k.kQ.Popup,alignmentToOrigin:v.v.Start,...e,renderOrigin:t=>(0,M.jsx)(S.Z,{icon:s.o,iconStyle:{width:16,color:this.theme.mediumIconColor,fill:this.theme.mediumIconColor},...t,...e}),onClick:()=>{h.gP(this.environment,{from:"section"===this.props.rowType?"relation_section":"configure_relation_modal"})},originGap:16,render:this.renderRelationPropertyMenuPopup})})}renderPropertyDraggableList(e){const{visibleProperties:t,hiddenProperties:r,children:o}=e,i=l.oA([...t.map((e=>e.property)),t.length>0&&r.length>0&&{key:"group-header-hidden-property",draggable:!1},...r.map((e=>e.property))]);return(0,M.jsx)(j.ZP,{direction:"vertical",keys:i,renderKey:(e,t)=>o[t],onDrop:e=>{this.handlePropertyReorder({newPropertyKeys:e})},disabled:this.props.disabled})}}R.displayName="RelationPropertyCustomizeLayoutMenu";const _=R;function F(e){const{props:t,children:r}=e;return(0,M.jsx)(Z.Z,{...t,noTextOverflow:!0,isTitleUppercase:!1,title:(0,M.jsx)(d.FormattedMessage,{defaultMessage:"Hidden in relation",id:"database.relationMenu.hiddenInRelationTitle"}),desktopTitleStyle:{height:19},children:r,disableDesktopPadding:!0})}function I(e,t,r,o,s,d,h){const{properties:y,visibility:m}=e;return l.oA(y.map((e=>function(e,t,r,o,s,l,d){const{propertyFormat:h,visibility:y}=e,m=!y,u=s.getSchema();if(!u)return;const g=u[h.property];return g?{key:h.property,render:e=>(0,M.jsx)(f.Z,{...e,showDragHandle:!d,title:(0,M.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,M.jsx)(i.ZP,{icon:g.icon,type:g.type,size:16,theme:r,style:{fill:r.regularIconColor}}),(0,M.jsx)("span",{style:{marginLeft:8,...a.Z.textOverflowStyle},children:g.name})]}),right:(0,M.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,M.jsx)(S.Z,{icon:m?p.B:n.c,iconStyle:{width:16,height:16},isDarkIconColor:!m,onClick:()=>{c.qK({propertyFormat:h,visibility:y,collectionStore:o,property:l,environment:t})},disabled:d||"title"===h.property})})}),action:()=>{}}:void 0}({propertyFormat:e,visibility:m},t,r,o,s,d,h))))}},39132:(e,t,r)=>{r.d(t,{c:()=>s});r(67294);var o=r(45238),i=r(85893);const s=(0,o.I)("eye",{viewBox:"0 0 32 32",svg:(0,i.jsx)("path",{d:"M16.006 25.812c8.863 0 14.994-7.17 14.994-9.406C31 14.16 24.858 7 16.006 7 7.252 7 1 14.16 1 16.406c0 2.236 6.252 9.406 15.006 9.406zm0-3.242a6.194 6.194 0 01-6.197-6.164c-.012-3.452 2.744-6.164 6.197-6.164 3.419 0 6.185 2.711 6.185 6.164 0 3.364-2.766 6.164-6.185 6.164zm0-3.94c1.228 0 2.246-1.007 2.246-2.224 0-1.228-1.018-2.235-2.246-2.235-1.24 0-2.258 1.007-2.258 2.235 0 1.217 1.018 2.224 2.258 2.224z"})})}}]);