"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[1290],{58188:(e,t,o)=>{o.d(t,{Lg:()=>u,N:()=>c,aG:()=>d});var n=o(13493),i=o(29369),s=o(82530),r=o(75330),a=(o(77907),o(30806)),l=o(80444);o(72711);function d(e){const{environment:t,currentSpaceViewStore:o,...n}=e,i=o.getModel();if(!i)return;const r=!i.showFeatureOnPersonalHome(e.feature);s.createAndCommit({userAction:"userHomeActions.toggleHomeFeature",environment:t,perform:t=>{s.applyOperation({store:o,operation:{pointer:o.pointer,path:["settings","personal_home","enabled_features"],command:"update",args:{[e.feature]:r}},transaction:t})}}),(0,a.cY)({environment:t,show:r,...n})}function c(e){let{environment:t,option:o,from:n,userAction:i}=e;const r=l.default.state.currentSpaceViewStore;if(!r)return!1;const d=r.getOnAppStartStore().getValue();return s.createAndCommit({userAction:i,environment:t,perform:e=>{s.applyOperation({store:r,operation:{pointer:r.pointer,path:["settings","on_app_start"],command:"set",args:o},transaction:e})}}),(0,a.BX)({environment:t,oldValue:d,newValue:o,from:n}),!0}function u(e){const{environment:t,selectedStore:o,currentSpaceViewStore:l,collectionContextStore:d}=e,c=d.collectionViewStore(),u=d.collectionStore(),p=d.collectionViewBlockStore();if(!(u&&c&&p&&l))return;const g=l.getTeamsStores(),h=o.table===i.e0?g.indexOf(o)+1:0,m=o.table===i.e0?o.id:void 0;s.createAndCommit({environment:t,userAction:"PersonalHomeTrendingPanel.setCollectionViewSourceTeamId",perform:e=>{s.applyOperation({store:c,operation:{pointer:{id:c.id,table:n.n},path:["format","collection_view_source","teamId"],command:"set",args:m},transaction:e}),r.mc({environment:t,collectionViewBlockStore:p,collectionViewStore:c,collectionStore:u,collectionContextStore:d,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1})}}),(0,a.Ay)({environment:t,teamId:m,index:h})}},79698:(e,t,o)=>{o.d(t,{j:()=>p});var n=o(9291),i=o(14542),s=o(96809),r=o(47307),a=o(96802),l=o(27153),d=o(82530),c=o(53471);const u=(0,n.defineMessages)({pageCover:{defaultMessage:"Page cover",id:"pageCover.title"},fileTypeCaption:{defaultMessage:"Images wider than {idealImageWidth} pixels work best.",id:"pageCover.fileType.caption"},uploadFailed:{defaultMessage:"Upload failed",id:"pageCover.errorDialogMessage.uploadFailed"},embedTitle:{defaultMessage:"Link",id:"pageCover.embedType.title"},embedPlaceholder:{defaultMessage:"Paste an image linkâ€¦",id:"pageCover.embedType.placeholder"},embedCaption:{defaultMessage:"Works with any image from the web.",id:"pageCover.embedType.caption"},embedSubmit:{defaultMessage:"Submit",id:"pageCover.embedType.buttonText"}});function p(e){let{environment:t,intl:o,store:n,rect:i}=e;l.$(t,{originGap:3,originRect:i,isSmallWidth:!1,popupWidth:540,maxHeight:485,title:o.formatMessage(u.pageCover),onDelete:()=>{!function(e){let{environment:t,store:o}=e;l.Z(),d.createAndCommit({userAction:"PageCover.handleDelete",environment:t,perform:e=>{a.MF({store:o,transaction:e})}})}({environment:t,store:n})},currentTab:"gallery",tabs:[{type:"gallery",onChange:e=>{let{url:o,position:i}=e;h({environment:t,store:n,url:o,position:i})}},{type:"file",fileUpload:!1,imageUpload:!0,videoUpload:!1,caption:o.formatMessage(u.fileTypeCaption,{idealImageWidth:1500}),onUpload:e=>{l.Z(),c.cT({environment:t,file:e,bucket:"secure",record:n.pointer,onStart:m,onProgress:b,onComplete:e=>{var o;o={environment:t,store:n,url:e},g({...o,position:.5})},onError:()=>{r.showErrorMessage(o.formatMessage(u.uploadFailed))}})}},{type:"embed",title:o.formatMessage(u.embedTitle),inputPlaceholder:o.formatMessage(u.embedPlaceholder),caption:o.formatMessage(u.embedCaption),buttonText:o.formatMessage(u.embedSubmit),onChange:e=>{var o;o={environment:t,store:n,url:e},g({...o,position:.5}),l.Z()}},{type:"unsplash",onChange:e=>{let{url:o,position:i}=e;h({environment:t,store:n,url:o,position:i})}}]})}async function g(e){const{environment:t,store:o,url:n,position:r}=e,{serverCommitResult:l}=d.createAndCommit({userAction:"PageCover.updatePageCover",environment:t,perform:e=>{a.fs({store:o,url:n,position:r||.5,transaction:e})}});await l,s.Z.state.loadingMode===i.NS&&s.Z.setState({loadingMode:i.EP,dataURL:s.Z.state.dataURL,uploadProgress:100})}function h(e){g(e),e.environment.device.isMobile&&l.Z()}function m(e){const{file:t,name:o,size:n}=e;if(l.Z(),s.Z.setState({loadingMode:i.SS,file:t,name:o,size:n}),t.type.indexOf("image")>=0){const e=new FileReader;e.onload=e=>{s.Z.state.loadingMode===i.SS&&s.Z.setState({...s.Z.state,uploadProgress:0,loadingMode:i.NS,dataURL:e.target.result})},e.readAsDataURL(t)}}function b(e){const{progressPercent:t}=e;s.Z.state.loadingMode===i.NS&&s.Z.setState({...s.Z.state,uploadProgress:t})}},55587:(e,t,o)=>{o.d(t,{j:()=>r});var n=o(89101),i=o(32441),s=o(69915);async function r(e){i.T3(e,{variant:"open_notion"}),i.eb(e,{target:"open_notion"}),await s.yF(e,{utmContent:"topbar_cta",nextRoute:n._j.root})}},28040:(e,t,o)=>{o.d(t,{i:()=>u});var n=o(26263),i=o(65958),s=o(21202),r=o(80444),a=o(77080),l=o(68373),d=o(35057),c=o(54642);async function u(e){const{environment:t,sudoModeStore:o,pageBlockId:u}=e,p=o.state.privatePageStore&&o.state.privatePageStore.id===u;if(t.device.isMobile||p||o.state.loading||o.state.error)return;if(!a.default.checkGate("enable_get_private_page_info_endpoint"))return;const{currentSpaceStore:g}=r.default.state,h=null==g?void 0:g.canAdmin();if(!(u&&h&&g&&(0,d.wP)()))return;o.setState({...o.state,loading:!0});const m=g.id,b=await c.getPrivatePageInfo(t,{id:u});if("failed"===b.type)return void o.setState({...o.state,loading:!1,error:b.error});const v=b.data,f=new n.Z({name:i.Gh});for(const n of v)switch(n.table){case"block":case"collection":f.setRecord({pointer:{spaceId:m,table:n.table,id:n.value.id},userId:t.currentUser.id},{role:"editor",value:n.value});break;case"team":f.setRecord({pointer:{spaceId:m,table:n.table,id:n.value.id},userId:t.currentUser.id},{role:"editor",value:n.value})}const S=new l.G(t,{table:s.iU,id:u},{inMemoryRecordCache:f});S.inMemoryRecordCache.addCacheFallback(t.defaultRecordCache.inMemoryRecordCache),o.setState({...o.state,privatePageStore:S,loading:!1,error:void 0})}},7476:(e,t,o)=>{o.d(t,{t:()=>r});var n=o(80444),i=o(56681),s=o(34047);function r(e){var t;let{discussionStore:o,commentStore:r}=e;if(!r.isDefined())return!1;const a=null===(t=n.default.state.currentUserStore)||void 0===t?void 0:t.id;const l=i.Z.state.lastInteractionTimes[o.id];if(r.getCreatedById()===a)return!1;const d=function(){if(!o.isDefined()||!a)return 0;const{pageVisitStore:e}=n.default.state,{lastViewTime:t,lastExitTime:i}=e.state;return i||t}();if(void 0===d)return!1;const c=(0,s.NI)(o).filter((e=>e.getCreatedById()===a)).reverse()[0],u=r.getCreatedTime();return!u||!(c&&u<c.getCreatedTime())&&(!(l&&u<l)&&u>d)}},39849:(e,t,o)=>{o.d(t,{N:()=>l,Z:()=>d});o(67294);var n=o(24405),i=o(8848),s=o(82990),r=o(85893);const a={display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:16,height:16,fontSize:10,textAlign:"center",fontWeight:s.Z.fontWeight.semibold,borderRadius:4,color:i.ZP.white,position:"static",marginLeft:6,WebkitFontSmoothing:"auto"};let l=function(e){return e[e.Red=0]="Red",e[e.Gray=1]="Gray",e}({});const d=function(e){let{count:t,color:o,style:i,numberStyle:s}=e;window.__c={n:"MentionsBadge"};const d=(0,n.Fg)(),u=o===l.Red;return!t||t<=0?null:(0,r.jsx)("div",{style:{...a,...i,...t>99&&{width:void 0,padding:2},background:u?d.redBadgeBackground:d.lightIconColor},children:(0,r.jsx)(c,{count:t,numberStyle:s})})};function c(e){let{count:t,numberStyle:o}=e;return t?1===t?(0,r.jsx)("span",{style:{marginLeft:-.5,...o},children:"1"}):t>99?(0,r.jsx)("span",{style:{letterSpacing:-.5,...o},children:"99+"}):t>9?(0,r.jsx)("span",{style:{letterSpacing:-.5,marginLeft:-.5,...o},children:t}):(0,r.jsx)("span",{style:{...o},children:t}):null}},22789:(e,t,o)=>{o.d(t,{Z:()=>k});o(67294);var n=o(83355),i=o(86628),s=o(24405),r=o(16184),a=o(47020),l=o(3123),d=o(58687),c=o(19889),u=o(7928),p=o(9291),g=o(50906),h=o(96802),m=o(82530),b=o(34700),v=o(92547),f=o(68373),S=o(64921),x=o(26388),y=o(85893);const w={width:16,marginRight:4};class M extends n.Z{constructor(){super(...arguments),this.storeTypes={lockStore:v.Z},this.handleLockClick=()=>{const{store:e}=this.props;m.createAndCommit({userAction:"PageLockTopbarIndicator.handleLockClick",environment:this.environment,perform:t=>{h.Wq({environment:this.environment,store:e,isLocked:!1,transaction:t})}}),this.stores.lockStore.setState({...this.stores.lockStore.state,justUnlocked:!0});const t=this.props.store.getType();if(t){var o;let n;e.isCollectionView()&&(n=e.getCollectionViewCollectionStore()),g.UJ(this.environment,{from:"topbar",block_type:t,locked:!1,collection_id:null===(o=n)||void 0===o?void 0:o.id})}},this.handleUnlockClick=()=>{const{store:e}=this.props;m.createAndCommit({userAction:"PageLockTopbarIndicator.handleUnlockClick",environment:this.environment,perform:t=>{h.Wq({environment:this.environment,store:e,isLocked:!0,transaction:t})}}),this.stores.lockStore.setState({...this.stores.lockStore.state,justUnlocked:!1});const t=this.props.store.getType();if(t){var o;let n;e.isCollectionView()&&(n=e.getCollectionViewCollectionStore()),g.UJ(this.environment,{from:"topbar",block_type:t,locked:!0,collection_id:null===(o=n)||void 0===o?void 0:o.id})}}}renderComponent(){return this.props.isMobile?this.renderMobile():this.renderDesktop()}renderDesktop(){return this.props.store.isLocked()?(0,y.jsx)(x.ZP,{renderTooltip:()=>(0,y.jsx)(C,{store:this.props.store}),disableTooltip:this.props.disableTooltip,render:e=>{return(0,y.jsxs)(S.Z,{style:(t=this.props.isMobile,o=this.environment,n=this.theme,i=this.props.isInlineCollection,s=this.props.buttonStyle,{...j(t,i,s),...(0,b.X)({noDrag:o.device.isElectronMac}),color:n.lightTextColor,fill:n.lightIconColor}),onClick:this.handleLockClick,...e,children:[(0,r.Q)(w),(0,y.jsx)("div",{style:{lineHeight:1},children:(0,y.jsx)(p.FormattedMessage,{defaultMessage:"Locked",id:"pageLockIndicator.lockedButton.label"})})]});var t,o,n,i,s}}):this.stores.lockStore.state.justUnlocked?(0,y.jsxs)(S.Z,{style:(e=this.props.isMobile,t=this.environment,o=this.theme,n=this.props.isInlineCollection,i=this.props.buttonStyle,{...j(e,n,i),...(0,b.X)({noDrag:t.device.isElectronMac}),paddingLeft:5,border:`1px solid ${o.blueColor}`,color:o.blueColor,fill:o.blueColor}),onClick:this.handleUnlockClick,hoveredStyle:{background:this.theme.outlineBlueButtonHoveredBackground},pressedStyle:{background:this.theme.outlineBlueButtonPressedBackground},children:[(0,d.H)(w),(0,y.jsx)("div",{style:{lineHeight:1},children:(0,y.jsx)(p.FormattedMessage,{defaultMessage:"Re-lock",id:"pageLockIndicator.relockButton.label"})})]}):void 0;var e,t,o,n,i}renderMobile(){const{WindowSizeStore:e}=this.environment;return this.props.store.isLocked()?(0,y.jsxs)(S.Z,{onClick:this.handleLockClick,mobileFeedback:!0,style:{display:"flex",alignItems:"center",height:"100%",paddingLeft:e.getSafePaddingLeftCSS(10),paddingRight:e.getSafePaddingRightCSS(14)},children:[(0,a.B)({width:20,marginRight:6}),(0,y.jsx)("div",{children:(0,y.jsx)(p.FormattedMessage,{defaultMessage:"Locked",id:"pageLockIndicator.mobileLockedButton.label"})})]}):this.stores.lockStore.state.justUnlocked?(0,y.jsxs)(S.Z,{onClick:this.handleUnlockClick,mobileFeedback:!0,style:{display:"flex",alignItems:"center",width:"100%",height:"100%",paddingLeft:e.getSafePaddingLeftCSS(10),paddingRight:e.getSafePaddingRightCSS(14),color:this.theme.blueColor,fill:this.theme.blueColor},children:[(0,l.j)({height:26,width:32,marginRight:6}),(0,y.jsx)("div",{children:(0,y.jsx)(p.FormattedMessage,{defaultMessage:"Re-lock",id:"pageLockIndicator.mobileRelockButton.label"})})]}):void 0}}M.displayName="PageLockTopbarIndicator";const k=M;function j(e,t,o){return{display:"flex",alignItems:"center",whiteSpace:"nowrap",fontSize:e?12:14,borderRadius:4,padding:"0 6px",marginRight:2,height:24,marginTop:e?1:0,marginLeft:e?0:-5,...t&&{marginLeft:e?8:12,marginRight:0},...o}}function C(e){let{store:t}=e;window.__c={n:"TooltipComponent"};const o=(0,s.Fg)(),n=(0,i.VK)((()=>t.getFormat().block_locked_by),[t]),r=(0,p.useIntl)(),a=(0,i.VK)((()=>n&&(0,u.Nz)(r,f.t1.createChildStore(t,{table:c.KJ,id:n}).getModel())),[n,r,t]);return n?(0,y.jsx)("div",{children:(0,y.jsx)(p.FormattedMessage,{defaultMessage:"Locked by {lockedByPerson}{br}to prevent accidental editing.{br}<prompttext>Click to unlock</prompttext>",id:"pageLockIndicator.lockedTooltip",values:{lockedByPerson:(0,y.jsx)("b",{children:a}),br:(0,y.jsx)("br",{}),prompttext:e=>(0,y.jsx)("span",{style:{color:o.mediumInvertedTextColor},children:e})}})}):null}},13612:(e,t,o)=>{o.d(t,{Z:()=>g});o(67294);var n=o(480),i=o(56666),s=o(90334),r=o(9291),a=o(50906),l=o(24677),d=o(77907),c=o(64921),u=o(31945),p=o(85893);const g=function(e){let{buttonPopupStore:t,useEllipsisIcon:o,store:i}=e;window.__c={n:"PublicTopbarMoreButton"};const s=(0,n.O7)(),{device:r}=s;return(0,p.jsx)(u.ZP,{popupType:r.isMobile?u.Z4.SlideUp:u.Z4.Popup,buttonPopupStore:t,renderOrigin:e=>(0,p.jsx)(m,{buttonPopupEvents:e,useEllipsisIcon:o}),onClick:()=>b(s),render:()=>(0,p.jsx)(d.LazyPublicTopbarMoreMenu,{block:i,onDismiss:()=>b(s)}),originGap:8})};function h(e){const{device:t}=e;return t.isMobile?{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",marginLeft:8,marginRight:8}:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:4}}function m(e){let{buttonPopupEvents:t,useEllipsisIcon:o}=e;window.__c={n:"OriginComponent"};const a=(0,r.useIntl)(),l=(0,n.O7)(),{device:d}=l;return(0,p.jsx)(c.Z,{ariaLabel:a.formatMessage({id:"publicTopbarMoreButton.ariaLabel",defaultMessage:"More actions"}),style:h(l),mobileFeedback:d.isMobile,...t,children:o?(0,s.O)({width:18,height:18}):(0,i.o)({width:18,height:18})})}function b(e){l.ZH(e),a.Fj(e)}},46457:(e,t,o)=>{o.d(t,{_:()=>g});var n=o(67294),i=o(480),s=o(86628),r=o(24405),a=o(9291),l=o(77907),d=o(34859),c=o(7184),u=o(53336),p=o(85893);function g(e){let{loginModalStore:t,loginStore:o,title:r,description:a,isSignup:d,disableLoginLink:u,redirectURL:g,className:v,onDismiss:f}=e;window.__c={n:"LoginModal"};const S=(0,i.O7)(),x=(0,s.VK)((()=>t.state.open),[t]),y=(0,n.useId)(),w=(0,n.useId)(),M={loginStore:o,title:r,description:a,isSignup:d,redirectURL:g,disableLoginLink:u,titleAriaId:y,descriptionAriaId:w};return(0,p.jsx)(c.c,{ariaLabelledBy:y,ariaDescribedBy:w,isOpen:x,onDismiss:()=>{b({loginModalStore:t,loginStore:o,onDismiss:f})},areaConstraint:{width:{min:480,max:480},height:{scroll:!0}},children:(0,p.jsx)(h,{children:(0,p.jsxs)("div",{className:v,children:[!S.device.isMobile&&(0,p.jsx)(m,{loginModalStore:t,loginStore:o,onDismiss:f}),(0,p.jsx)(l.LazyLoginModalContent,{...M})]})})})}function h(e){let{children:t}=e;window.__c={n:"MobileScroller"};return(0,i.O7)().device.isMobile?(0,p.jsx)(u.Z,{type:d.Z.Y,children:t}):t}function m(e){let{loginModalStore:t,loginStore:o,onDismiss:n}=e;window.__c={n:"CancelButton"};const i=(0,r.Fg)();return(0,p.jsx)("div",{style:{fontSize:14,color:i.mediumTextColor,position:"absolute",right:0,marginTop:16,marginRight:16,cursor:"pointer"},onClick:()=>{b({loginModalStore:t,loginStore:o,onDismiss:n})},children:(0,p.jsx)(a.FormattedMessage,{defaultMessage:"Cancel",id:"sidebarSwitcherMultiAccount.addAccountModal.cancelButton.label"})})}function b(e){const{loginModalStore:t,loginStore:o,onDismiss:n}=e;o.reset(),t.setState({open:!1}),n&&n()}},9045:(e,t,o)=>{o.d(t,{Z:()=>s});o(67294);var n=o(9291),i=o(85893);function s(){return(0,i.jsx)(n.FormattedMessage,{id:"signupPage.title",defaultMessage:"Sign up"})}},92955:(e,t,o)=>{o.d(t,{Z:()=>l});o(67294);var n=o(86628),i=o(97880),s=o(19034),r=o(39849),a=o(85893);function l(e){window.__c={n:"UnreadMentionsBadge"};const{type:t,...o}=e,l=(0,n.VK)((()=>{switch(t){case"currentSpace":return s.Z.getUnreadCountForCurrentSpace().mentions;case"otherSpaces":return s.Z.getUnreadMentionsCountForOtherSpaces();case"allSpaces":return s.Z.getTotalUnreadMentionsCount();default:(0,i.t1)(t)}}),[t]);return(0,a.jsx)(r.Z,{count:l,...o})}},10388:(e,t,o)=>{o.d(t,{C:()=>Ge,nk:()=>Ne,ZP:()=>He});var n=o(67294),i=o(73935),s=o(83355),r=o(15145),a=o(40654),l=o(88437),d=o(60651),c=o(25651),u=o(35840),p=o(45137),g=o(89101),h=o(21202),m=o(80503),b=o(9291),v=o(32441),f=o(47307),S=o(3297),x=o(99553),y=o(40277),w=o(69915),M=o(8055),k=o(87531),j=o(98104),C=o(3043),T=o(28020),P=o(43250),Z=o(34700),I=o(84210),B=o(12534),_=o(46654),F=o(17504),E=o(18514),R=o(77907),O=o(480),D=o(86628),L=o(24405),U=o(15560),V=o(32662),A=o(3553),N=o(61394),K=o(84920),H=o(42543),G=o(44332),W=o(51454),z=o(24646);function q(e){return{...(0,Z.X)({noDrag:e.device.isElectronMac}),height:"100%",flexGrow:0,marginRight:8,fontSize:14,minWidth:0}}function X(e){let{theme:t,isPhone:o,isFloatingPersonalHomeTopbar:n}=e;return{background:n&&!o?"transparent":t.contentBackground,maxWidth:"100vw",zIndex:W.lI,WebkitUserSelect:"none",userSelect:"none"}}function Y(e){let{environment:t,isShowingTabBar:o,shouldShowSidebar:n,isSidebarExpanded:i,isNotificationPanelOpen:s,isBrowserFullScreen:r,shouldRenderTemplateGalleryTopbar:l,isFloatingPersonalHomeTopbar:d,zoom:c}=e;const{device:u}=t,p=u.isElectronMac&&(!n||!i&&!s)&&!r&&!o;let g=m.R6(u.isElectronMac);return l?g=m.TT:d&&(g=m.Aj),{...(0,Z.X)({drag:u.isElectronMac&&!o}),display:"flex",justifyContent:"space-between",alignItems:"center",overflow:"hidden",height:g,paddingLeft:p?(0,a.XW)(c):u.isMobile?4:12,paddingRight:u.isMobile?4:10}}function $(e){let{environment:t,isBrowserFullScreen:o,zoom:n}=e;const i=(0,z.vF)(t);return{position:"absolute",top:0,width:`${m.Pv(t.device.isElectronMac,o,n)}px`,height:`${i}px`}}var Q=o(61436),J=o(24042),ee=o(45325),te=o(69150),oe=o(61931),ne=o(64719),ie=o(85893);const se=function(e){window.__c={n:"PersonalHomeTopbar"};const t=(0,O.O7)(),o=(0,D.VK)((()=>te.Z.state.isHovered),[]),n=(0,D.VK)((()=>J.Z.state.isShowingTabBar),[]),i=(0,D.VK)((()=>J.Z.state.zoomFactor),[]),s=(0,D.VK)((()=>ee.default.isOpen()),[]),r=(0,D.VK)((()=>Q.Z.state.isFullScreen),[]),l=(0,D.VK)((()=>(0,z.in)(t)),[t]),d=(0,D.VK)((()=>(0,T.h1)(t)),[t]),c=(0,D.VK)((()=>e.store.hasCover()),[e.store]),u=(0,L.yK)((e=>({container:{...Y({environment:t,isShowingTabBar:Boolean(n),shouldShowSidebar:d.shouldShowSidebar,isSidebarExpanded:l,isNotificationPanelOpen:s,isBrowserFullScreen:r,isFloatingPersonalHomeTopbar:c,zoom:i||a.lO}),...c?{display:"flex",alignItems:"flex-start",paddingTop:12,opacity:o?1:0,transition:"opacity 0.2s ease"}:{}},divider:{flexGrow:1,flexShrink:1},betaBadgeWithoutCover:{background:e.home.betaBadge.background,color:e.home.betaBadge.color},betaBadgeWithCover:{position:"absolute",top:8,right:8,background:e.home.betaBadge.background,color:e.home.betaBadge.color,opacity:o?0:1,transition:"opacity 0.2s ease"}})),[d.shouldShowSidebar,t,c,r,o,s,n,l,i]);return(0,ie.jsx)(A.Z,{store:e.store,disableRectangularSelection:!0,disableEditNearestBlock:!0,render:()=>(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsxs)("div",{style:u.container,onClick:e.handleClickTopbar,onMouseDown:e.handleMouseDown,onDoubleClick:H.wq,onMouseEnter:()=>te.Z.setState({isHovered:!0}),onMouseLeave:()=>te.Z.setState({isHovered:!1}),children:[(0,ie.jsx)(re,{store:e.store,showSidebarButton:Boolean(e.showSidebarButton)}),!e.isInvalidPage&&(0,ie.jsx)(K.Z,{}),(0,ie.jsx)("div",{style:u.divider}),(0,ie.jsx)(ae,{store:e.store,showSidebarButton:Boolean(e.showSidebarButton),isInvalidPage:e.isInvalidPage})]}),c&&(0,ie.jsx)("div",{onMouseEnter:()=>te.Z.setState({isHovered:!0}),style:{pointerEvents:"none"},children:(0,ie.jsx)(U.Z,{style:u.betaBadgeWithCover})})]})})};function re(e){window.__c={n:"LeftSideActionButtons"};const t=(0,O.O7)(),o=(0,O.Fy)(),n=(0,D.VK)((()=>e.store.hasCover()),[e.store]),i=(0,D.VK)((()=>J.Z.state.isShowingTabBar),[]),s=(0,D.VK)((()=>{const e=(0,z.in)(t);return i||e}),[t,i]),r=(0,L.yK)((e=>({noDragArea:{...(0,Z.X)({noDrag:o.isElectronMac}),width:150,height:"100%"},electronButtonWrapper:{...(0,oe.Er)({theme:e,isPhone:o.isPhone,buttonState:"base",hasCover:n}),width:"fit-content",paddingLeft:2,paddingRight:2}})),[o,n]);return n?o.isElectron?s?null:(0,ie.jsx)("div",{style:r.noDragArea,children:(0,ie.jsxs)("div",{style:r.electronButtonWrapper,children:[e.showSidebarButton&&(0,ie.jsx)(G.Z,{}),!i&&(0,ie.jsx)(N.Z,{})]})}):(0,ie.jsx)(ie.Fragment,{children:e.showSidebarButton&&(0,ie.jsx)(G.Z,{isFloatingButton:!0})}):(0,ie.jsxs)(ie.Fragment,{children:[e.showSidebarButton&&(0,ie.jsx)(G.Z,{}),o.isElectron&&!i&&(0,ie.jsx)(N.Z,{})]})}function ae(e){window.__c={n:"RightSideActionButtons"};const t=(0,O.Fy)(),o=(0,D.VK)((()=>e.store.hasCover()),[e.store]),n=(0,L.yK)((e=>({noDragArea:{...(0,Z.X)({noDrag:t.isElectronMac}),width:150,height:"100%",display:"flex",justifyContent:"flex-end"},betaBadgeWithoutCover:{background:e.home.betaBadge.background,color:e.home.betaBadge.color}})),[t.isElectronMac]);return o?t.isElectron?(0,ie.jsx)("div",{style:n.noDragArea,children:(0,ie.jsx)(ne.E,{store:e.store,isInvalidPage:e.isInvalidPage})}):(0,ie.jsx)(ne.E,{store:e.store,isInvalidPage:e.isInvalidPage}):(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(U.Z,{style:n.betaBadgeWithoutCover}),(0,ie.jsx)(V.Z,{size:4}),(0,ie.jsx)(ne.E,{store:e.store,isInvalidPage:e.isInvalidPage})]})}var le=o(94841),de=o(38676),ce=o(51),ue=o(80444),pe=o(96071),ge=o(85974),he=o(83212),me=o(68373),be=o(52258),ve=o(66708),fe=o(63296),Se=o(89728),xe=o(26388),ye=o(46457),we=o(9045),Me=o(22789),ke=o(13612),je=o(58178),Ce=o(25729),Te=o(55587),Pe=o(95477),Ze=o(93827),Ie=o(42922),Be=o(16354),_e=o(5002);function Fe(e){window.__c={n:"TemplateGalleryPublicPageTopbar"};const{blockStore:t,style:o,onDoubleClick:i,onClickDuplicate:s,templateBlockStore:r}=e,a=(0,O.O7)(),l=(0,D.VK)((()=>ce.Z.state.publicPageData),[]),c=(0,D.VK)((()=>(0,_.S4)(r)),[r]),[u,p]=(0,n.useState)(!1),g=(0,L.yK)((e=>({topbarContainer:{display:"flex",justifyContent:"space-between",alignItems:"center",overflow:"hidden",height:m.TT,paddingLeft:12,paddingRight:10},topbarContents:{display:"flex",alignItems:"center"},notionLogoStyle:{width:20,height:20},templatesIcon:{width:20,height:20,marginRight:4,marginTop:2},templateGalleryButton:{display:"flex",alignItems:"center",fontSize:15,fontWeight:600},centerText:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",overflow:"hidden",textWrap:"nowrap"},templateNameText:{fontSize:13.5,fontWeight:600},templateCreatorText:{fontSize:12,color:e.lightTextColor},templateCreatorLink:{fontSize:12,color:e.lightTextColor,cursor:"pointer"},publicTopbarMoreButton:{marginRight:8}})),[]),h=(0,D.VK)((()=>{const e=(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(Se.Z,{onClick:async()=>{await Te.j(a)},children:(0,d.h)(g.notionLogoStyle)}),(0,ie.jsx)(_e.Z,{})]});return(0,Ze.C)()?de.sidebarExpandedStore.state?null:(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(G.Z,{}),e]}):e}),[a,g.notionLogoStyle]);if(!l||!l.template)return(0,ie.jsx)(ie.Fragment,{});const f=(0,ie.jsx)("a",{href:`${Pe.default.domainBaseUrl}/@${l.template.creator.username}`,target:"_blank",style:g.templateCreatorLink,onClick:()=>{var e;v.eb(a,{target:"creator",slug:null===(e=l.template)||void 0===e?void 0:e.creator.username})},children:l.template.creator.name});return(0,ie.jsxs)("div",{style:o??g.topbarContainer,onDoubleClick:i,children:[(0,ie.jsxs)("div",{style:g.topbarContents,children:[h,(0,ie.jsx)(Be.Z,{href:(0,E.UY)("templateGallery"),external:!0,children:(0,ie.jsxs)(Se.Z,{style:g.templateGalleryButton,onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),onClick:()=>{v.eb(a,{target:"gallery"})},children:[u?(0,Ce.U)(g.templatesIcon):(0,je.s)(g.templatesIcon),(0,ie.jsx)(b.FormattedMessage,{defaultMessage:"Templates",id:"templateGalleryPublicPageTopbar.templatesButton.label"})]})})]}),(0,ie.jsxs)("div",{style:g.centerText,children:[(0,ie.jsx)(Be.Z,{href:`${(0,E.UY)("templateGallery")}/${l.template.slug}`,style:g.templateNameText,external:!0,onClick:()=>{var e;v.eb(a,{target:"template",slug:null===(e=l.template)||void 0===e?void 0:e.slug})},children:l.template.name}),(0,ie.jsx)("div",{style:g.templateCreatorText,children:(0,ie.jsx)(b.FormattedMessage,{defaultMessage:"Template by {templateCreatorNameWithLink}",id:"templateGalleryPublicPageTopbar.templateName.subtitle",values:{templateCreatorNameWithLink:f}})})]}),(0,ie.jsxs)("div",{style:g.topbarContents,children:[(0,ie.jsx)("div",{style:g.publicTopbarMoreButton,children:(0,ie.jsx)(ke.Z,{store:t,buttonPopupStore:be.Z})}),c&&(0,ie.jsx)(Ie.Z,{onClick:s,children:(0,ie.jsx)(b.FormattedMessage,{defaultMessage:"Start with this template",id:"templateGalleryPublicPageTopbar.duplicateButton.label"})})]})]})}var Ee=o(61881),Re=o(7715),Oe=o(54338);const De={width:18,height:18,marginRight:6},Le={width:14,height:14,marginRight:6},Ue={width:14,height:14},Ve={width:15,height:15},Ae={width:14,height:14,marginLeft:6},Ne=700;class Ke extends s.Z{constructor(){super(...arguments),this.startedInitialPublicPageEdit=!1,this.screenXAtLastMouseDown=0,this.screenYAtLastMouseDown=0,this.storeTypes={loginModalStore:pe.Z,loginStore:ge.Z},this.handleMouseDown=()=>{this.screenXAtLastMouseDown=window.screenX,this.screenYAtLastMouseDown=window.screenY},this.handleClickTopbar=e=>{const t=window.screenX,o=window.screenY;this.screenXAtLastMouseDown===t&&this.screenYAtLastMouseDown===o&&(e.target===e.currentTarget&&j.ZH(this.environment),(0,B.ZP)({event:e,context:B.Af.EditorClick,callback:()=>{x.E5(this.environment)}}))},this.maybeOpenOnBaseUrl=()=>{var e;const{RouterStore:t}=this.environment,o=t.state.route,n=null===(e=this.pageContext)||void 0===e?void 0:e.pageStore;if("page"===o.name&&o.requestedOnPublicDomain&&n){const e=(0,I.ZP)({store:n,preferPublicLink:!1,pageVisitSource:r.tY.EditPublicPage});return M.Li({environment:this.environment,url:e}),!0}return!1},this.handleStartPublicEdit=()=>{this.maybeOpenOnBaseUrl()||(this.environment.currentUser.isLoggedIn()?f.showDialog({showCancel:!0,keepFocus:!1,message:(0,ie.jsx)(b.FormattedMessage,{defaultMessage:"When you start editing, your name, email and photo may become visible to anyone who can view the page.",id:"topbar.startPublicEditDialog.message"}),items:[{label:(0,ie.jsx)(b.FormattedMessage,{defaultMessage:"Continue",id:"topbar.startPublicEditDialog.continueLabel"}),color:"blue",onAccept(){he.Z.setState({editing:!0,commenting:!0})}}]}):(y.Hr({currentUserId:this.environment.currentUser.id,blockId:this.props.store.id}),M.Li({environment:this.environment,url:g._j.login})))},this.handleAttemptPublicComment=()=>{y.Hr({currentUserId:this.environment.currentUser.id,blockId:this.props.store.id}),this.maybeOpenOnBaseUrl()||M.Li({environment:this.environment,url:g._j.login})},this.forkPageRef=null,this.handleForkPageRef=e=>{this.forkPageRef=e},this.handleOpenForkPage=()=>{S.S({environment:this.environment,store:this.props.store,originRect:this.getDuplicateClientRect()})},this.shouldRenderTemplateGalleryTopbar=this.createComputedStore((()=>{const{device:e}=this.environment;if(e.isMobile||!(0,E.Sr)())return!1;if(!H.cE(this.props.store,this.environment))return!1;const{publicPageData:t}=ce.Z.state;return!(null==t||!t.template)})),this.appRenderState=this.createComputedStore((()=>T.h1(this.environment))),this.isNotificationPanelOpen=this.createComputedStore((()=>ee.default.isOpen())),this.isBrowserFullScreen=this.createComputedStore((()=>Q.Z.state.isFullScreen)),this.isSidebarExpanded=this.createComputedStore((()=>(0,z.in)(this.environment))),this.isFloatingPersonalHomeTopbar=this.createComputedStore((()=>{const e=(0,le.WE)(this.props.store),t=this.props.store.hasCover();return e&&t}))}didUpdate(){const{store:e}=this.props,{RouterStore:t}=this.environment,o=t.state.route,{publicPageData:n}=ce.Z.state;H.DK(this.props.store,this.environment)&&e.canComment()&&!e.canEdit()&&"page"===o.name&&!o.requestedOnPublicDomain&&H.cE(this.props.store,this.environment)&&null!=n&&n.requireLogin?he.Z.setState({commenting:!0,editing:!1}):!H.DK(this.props.store,this.environment)||!e.canEdit()||"page"!==o.name||he.Z.state.editing||he.Z.state.commenting||o.shouldDuplicate||o.requestedOnPublicDomain||!H.cE(this.props.store,this.environment)||this.startedInitialPublicPageEdit||null==n||!n.requireLogin||(this.startedInitialPublicPageEdit=!0,this.handleStartPublicEdit())}renderComponent(){const e=this.pickSidebar(),t=de.sidebarElectronMousePeekStore.state,{isShowingTabBar:o,zoomFactor:n}=J.Z.state,i=t&&o&&this.appRenderState.state.shouldShowSidebar&&!this.isSidebarExpanded.state&&!this.isNotificationPanelOpen.state;return(0,F.Z)((t=>(0,ie.jsxs)("header",{style:X({theme:this.theme,isPhone:this.environment.device.isPhone,isFloatingPersonalHomeTopbar:this.isFloatingPersonalHomeTopbar.state}),...t,children:[(0,ie.jsx)("div",{style:this.getStyle(),className:P.lIT,onFocus:H.Iw,onBlur:H.u1,children:e}),(0,ie.jsx)(R.LazyBannersRenderer,{banners:this.props.banners,isMobile:!1,isInPeekRenderer:!1}),i&&(0,ie.jsx)(Oe.o,{style:$({environment:this.environment,isBrowserFullScreen:this.isBrowserFullScreen.state,zoom:n||a.lO})})]})))}pickSidebar(){const e=(0,le.WE)(this.props.store);return H.DK(this.props.store,this.environment)?H.cE(this.props.store,this.environment)?this.shouldRenderTemplateGalleryTopbar.state?this.renderTemplateGalleryPublicPageTopbar():this.renderPublicPageTopbar():e?(0,ie.jsx)(se,{store:this.props.store,isInvalidPage:this.props.isInvalidPage,showSidebarButton:this.props.showSidebarButton,handleClickTopbar:this.handleClickTopbar,handleMouseDown:this.handleMouseDown}):this.renderDefaultTopbar():null}renderPublicPageTopbar(){const{store:e,isInvalidPage:t,isElectron:o}=this.props,{isShowingTabBar:n,zoomFactor:i}=J.Z.state,s=Boolean(this.environment.currentUser.isLoggedIn()||this.environment.publicDomainUserId);return(0,ie.jsxs)("div",{style:Y({environment:this.environment,isShowingTabBar:Boolean(n),shouldShowSidebar:this.appRenderState.state.shouldShowSidebar,isSidebarExpanded:this.isSidebarExpanded.state,isNotificationPanelOpen:this.isNotificationPanelOpen.state,isBrowserFullScreen:this.isBrowserFullScreen.state,shouldRenderTemplateGalleryTopbar:this.shouldRenderTemplateGalleryTopbar.state,zoom:i||a.lO}),onDoubleClick:H.wq,children:[(0,ie.jsx)(ye._,{loginModalStore:this.stores.loginModalStore,loginStore:this.stores.loginStore,title:(0,ie.jsx)(we.Z,{}),isSignup:!0}),o&&!n&&(0,ie.jsx)(N.Z,{}),!t&&(0,ie.jsx)(C.l2,{store:e,style:q(this.environment),maxAncestorCount:2,ancestorMaxWidth:160,currentPageMaxWidth:240,showCurrentPageControls:!0,isMobile:!1}),(0,ie.jsx)("div",{style:{flexGrow:1,flexShrink:1}}),s?this.renderTopbarRightSectionDefault():this.renderTopbarRightSectionUnauth()]})}renderTopbarRightSectionDefault(){const{device:e,currentUser:t}=this.environment,{store:o,isInvalidPage:n}=this.props,i=Boolean(t.isLoggedIn()||this.environment.publicDomainUserId);return(0,ie.jsxs)(ie.Fragment,{children:[o.canEdit()&&!he.Z.state.editing&&(0,ie.jsxs)(fe.Z,{onClick:this.handleStartPublicEdit,style:{marginRight:8,padding:"0 8px"},children:[(0,c.R)(Le),(0,ie.jsx)(b.FormattedMessage,{id:"topbar.publicPage.edit",defaultMessage:"Edit"})]}),!this.environment.currentUser.isLoggedIn()&&o.canComment()&&!o.canEdit()&&(0,ie.jsxs)(fe.Z,{onClick:this.handleAttemptPublicComment,style:{marginRight:8,padding:"0 8px"},children:[(0,p.o)(Le),(0,ie.jsx)(b.FormattedMessage,{id:"topbar.publicPage.comment",defaultMessage:"Comment"})]}),(0,ie.jsxs)(Se.Z,{onClick:()=>We(this.environment),children:[(0,u.R)(Le),(0,ie.jsx)(b.FormattedMessage,{defaultMessage:"Search",id:"topbar.publicPage.searchButton.label"})]}),(0,_.S4)(this.props.store)&&(0,ie.jsx)(Se.Z,{onClick:this.handleOpenForkPage,ref:this.handleForkPageRef,children:(0,ie.jsx)(b.FormattedMessage,{defaultMessage:"Duplicate",id:"topbar.publicPage.duplicateButton.label"})}),!e.isMobile&&!n&&(0,ie.jsx)(ke.Z,{store:o,buttonPopupStore:be.Z}),(0,ie.jsx)("div",{style:(s=this.theme,{flex:"none",width:1,height:16,marginLeft:8,marginRight:8,background:s.darkDividerColor})}),i?(0,ie.jsxs)(Se.Z,{onClick:()=>async function(e){v.T3(e,{variant:"open_notion"}),await w.yF(e,{utmContent:"topbar_cta",nextRoute:g._j.root})}(this.environment),children:[(0,d.h)(De),(0,ie.jsx)(b.FormattedMessage,{defaultMessage:"Open Notion",id:"topbar.publicPage.cta.label.open"})]}):(0,ie.jsxs)(Se.Z,{onClick:()=>async function(e){v.T3(e,{variant:"try_notion"}),await w.yF(e,{utmContent:"topbar_cta",nextRoute:g._j.signup})}(this.environment),children:[(0,d.h)(De),(0,ie.jsx)(b.FormattedMessage,{defaultMessage:"Try Notion",id:"topbar.publicPage.cta.label.try"})]})]});var s}renderTopbarRightSectionUnauth(){const{device:e}=this.environment,{store:t,isInvalidPage:o}=this.props;return(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(Se.Z,{onClick:()=>We(this.environment),children:(0,u.R)(Ue)}),(0,_.S4)(t)&&this.renderPublicPageTopbarExpDuplicateIconButton(),!e.isMobile&&!o&&(0,ie.jsx)(ke.Z,{store:t,buttonPopupStore:be.Z,useEllipsisIcon:!0}),(0,ie.jsx)(Ge,{onClick:()=>async function(e){await H.i3({environment:e,route:g._j.signup})}(this.environment)})]})}renderTemplateGalleryPublicPageTopbar(){var e;const{store:t,isInvalidPage:o}=this.props,{isShowingTabBar:n,zoomFactor:i}=J.Z.state,{publicPageData:s}=ce.Z.state,r=null!=s&&null!==(e=s.template)&&void 0!==e&&e.blockId?new me.G(this.environment,{table:h.iU,id:null==s?void 0:s.template.blockId}):void 0;return r?(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(Fe,{blockStore:t,style:{...Y({environment:this.environment,isShowingTabBar:Boolean(n),shouldShowSidebar:this.appRenderState.state.shouldShowSidebar,isSidebarExpanded:this.isSidebarExpanded.state,isNotificationPanelOpen:this.isNotificationPanelOpen.state,isBrowserFullScreen:this.isBrowserFullScreen.state,shouldRenderTemplateGalleryTopbar:this.shouldRenderTemplateGalleryTopbar.state,zoom:i||a.lO}),borderBottom:`1px solid ${this.theme.lightDividerColor}`},onDoubleClick:H.wq,onClickDuplicate:()=>{S.S({environment:this.environment,store:r,originRect:this.getDuplicateClientRect()})},templateBlockStore:r}),(0,ie.jsxs)("div",{style:Y({environment:this.environment,isShowingTabBar:Boolean(n),shouldShowSidebar:this.appRenderState.state.shouldShowSidebar,isSidebarExpanded:this.isSidebarExpanded.state,isNotificationPanelOpen:this.isNotificationPanelOpen.state,isBrowserFullScreen:this.isBrowserFullScreen.state,shouldRenderTemplateGalleryTopbar:this.shouldRenderTemplateGalleryTopbar.state,zoom:i||a.lO}),onDoubleClick:H.wq,children:[!o&&(0,ie.jsx)(C.l2,{store:t,style:q(this.environment),maxAncestorCount:2,ancestorMaxWidth:160,currentPageMaxWidth:240,showCurrentPageControls:!0,isMobile:!1}),(0,ie.jsx)("div",{style:{flexGrow:1,flexShrink:1}}),(0,ie.jsxs)(Se.Z,{onClick:()=>We(this.environment),children:[(0,u.R)(Le),(0,ie.jsx)(b.FormattedMessage,{defaultMessage:"Search",id:"topbar.publicPage.searchButton.label"})]})]})]}):this.renderPublicPageTopbar()}renderDefaultTopbar(){const{store:e,isInvalidPage:t,isElectron:o,showSidebarButton:n,collectionViewStore:i,hideActionButtons:s}=this.props,{isMobile:r}=this.environment.device,{pageVisitStore:l,presenceStore:d,currentSpaceStore:c,currentSpaceViewStore:u}=ue.default.state,p=(0,_.IJ)(this.environment,this.props.store),{isShowingTabBar:g,zoomFactor:h}=J.Z.state;return(0,ie.jsx)(A.Z,{store:e,disableRectangularSelection:!0,disableEditNearestBlock:!0,render:()=>(0,ie.jsxs)("div",{style:Y({environment:this.environment,isShowingTabBar:Boolean(g),shouldShowSidebar:this.appRenderState.state.shouldShowSidebar,isSidebarExpanded:this.isSidebarExpanded.state,isNotificationPanelOpen:this.isNotificationPanelOpen.state,isBrowserFullScreen:this.isBrowserFullScreen.state,shouldRenderTemplateGalleryTopbar:this.shouldRenderTemplateGalleryTopbar.state,zoom:h||a.lO}),onClick:this.handleClickTopbar,onMouseDown:this.handleMouseDown,onDoubleClick:H.wq,children:[n&&(0,ie.jsx)(G.Z,{}),o&&!g&&(0,ie.jsx)(N.Z,{}),!t&&(0,ie.jsx)(C.l2,{store:e,style:q(this.environment),maxAncestorCount:2,ancestorMaxWidth:160,currentPageMaxWidth:240,showCurrentPageControls:!0,isMobile:!1}),e.canEditCollection()&&(0,ie.jsx)(Me.Z,{store:e,isMobile:!1},e.id),e.isRestricted()&&(0,ie.jsx)(Re.Z,{style:{...(0,Z.X)({noDrag:this.environment.device.isElectronMac}),marginRight:10},onClick:()=>{ve.Z.setState({open:!0})}}),!t&&(0,ie.jsx)(K.Z,{}),(0,ie.jsx)("div",{style:{flexGrow:1,flexShrink:1}}),!r&&!p&&!s&&(0,ie.jsx)(Ee.iY,{store:e,collectionViewStore:i,spaceStore:c,spaceViewStore:u,pageVisitStore:l,presenceStore:d,isInvalidPage:t})]})})}getDuplicateClientRect(){if(this.forkPageRef){const e=i.findDOMNode(this.forkPageRef);if(e instanceof Element)return e.getBoundingClientRect()}}getStyle(){let e=m.R6(this.environment.device.isElectronMac);return this.shouldRenderTemplateGalleryTopbar.state?e=2*m.TT:this.isFloatingPersonalHomeTopbar.state&&(e=m.Aj),{width:"100%",maxWidth:"100vw",height:e,opacity:T.tu.state?0:1,transition:`\n \t\t\t\topacity ${Ne}ms,\n \t\t\t\tcolor ${Ne}ms\n\t\t\t`,position:"relative"}}renderPublicPageTopbarExpDuplicateIconButton(){return(0,ie.jsx)(xe.ZP,{renderTooltip:()=>(0,ie.jsx)("div",{style:{display:"flex"},children:(0,ie.jsx)(b.FormattedMessage,{id:"topbar.publicPage.duplicateButton.tooltip",defaultMessage:"Duplicate"})}),placement:xe.ug.Bottom,alignment:xe.v2.Center,originGap:6,render:e=>(0,ie.jsx)(Se.Z,{onClick:this.handleOpenForkPage,ref:this.handleForkPageRef,...e,children:(0,l.a)(Ve)})})}}Ke.displayName="Topbar";const He=Ke;function Ge(e){return(0,ie.jsxs)(fe.Z,{style:{padding:"0 10px",marginLeft:8},onClick:e.onClick,children:[(0,ie.jsx)(b.FormattedMessage,{defaultMessage:"Built with",id:"topbar.publicPage.cta.label.builtWithNotion"}),(0,d.h)(Ae)]})}function We(e){k.UT({environment:e,analyticsFrom:"public-page-topbar",isPublicPageSearch:!0})}},61881:(e,t,o)=>{o.d(t,{iY:()=>W,UP:()=>z,W2:()=>q});var n=o(67294),i=o(480),s=o(86628),r=o(24405),a=o(7525),l=o(80503),d=o(51454),c=o(9291),u=o(92650),p=o(95477),g=o(28651),h=o(28020),m=o(43250),b=o(81170),v=o(74948),f=o(24646),S=o(36391),x=o(21273),y=o(77080),w=o(61766);const M=new w.Z,k=new w.Z;var j=o(52258),C=o(66708),T=o(77503),P=o(34700),Z=o(16402),I=o(16011),B=o(26388),_=o(85893);function F(e){window.__c={n:"PageFreshnessMetadata"};const{store:t,isExpanded:o,isWindowSmall:i,isElectronMac:a}=e,l=(0,r.Fg)(),d=(0,s.VK)((()=>t.getLastEditedTime()),[t]),[u,p]=(0,n.useState)("flex"),[g,h]=(0,n.useState)(1);(0,n.useEffect)((()=>{let e;return o||i?o?(h(0),p("none")):(h(0),e=setTimeout((()=>p("none")),150)):(p("flex"),e=setTimeout((()=>h(1)),150)),()=>clearTimeout(e)}),[o,i]);const m=d?(0,Z.IS)(d,{useLowercase:!0,useCompactFormat:!0,roundDownYears:!0}):"";return m?(0,_.jsx)(_.Fragment,{children:(0,_.jsx)("span",{style:{opacity:g,transition:"opacity 150ms linear",display:u,alignItems:"center",fontSize:14,color:l.lightTextColor,height:28,whiteSpace:"nowrap",lineHeight:1.2},children:(0,_.jsx)("div",{style:{display:"flex",flexFlow:"wrap"},children:(0,_.jsx)(B.ZP,{placement:B.ug.Bottom,alignment:B.v2.Start,renderTooltip:()=>(0,_.jsx)(I.Z,{store:t,compactFormat:!0}),render:e=>{return(0,_.jsx)(_.Fragment,{children:(0,_.jsx)("div",{...e,style:{...(0,P.X)({noDrag:a})},children:(t=m,(0,_.jsx)(c.FormattedMessage,{defaultMessage:"Edited {timestamp}",id:"pagePropertiesHeader.edited.label",values:{timestamp:t}}))})});var t}})})})}):null}var E=o(10388),R=o(11751),O=o(73063);function D(e){let{blockStore:t,spaceStore:o,buttonPopupStore:s}=e;window.__c={n:"TopbarAiContextButton"};const a=(0,i.O7)(),l=(0,n.useCallback)((()=>{(0,v.handleSidebarButtonClick)(a,t,S.gY.AiContext,"topbar")}),[a,t]),d=function(){const{isElectronMac:e}=(0,i.O7)().device;return(0,r.yK)((t=>({icon:{height:18,width:18,fill:t.regularIconColor},button:{...(0,P.X)({noDrag:e}),width:33,height:28,marginRight:2},buttonWrapper:{...(0,P.X)({noDrag:e}),position:"relative"}})),[e])}();return(0,_.jsx)(B.ZP,{placement:B.ug.Bottom,renderTooltip:()=>"AI Context [ai_team]",render:e=>(0,_.jsx)("div",{style:d.buttonWrapper,children:(0,_.jsx)(O.Z,{icon:R.t,iconStyle:d.icon,style:d.button,ariaLabel:"AI Context [ai_team]",onClick:l,...e})})})}var L=o(28311),U=o(24097),V=o(43377),A=o(72485),N=o(86467),K=o(82774),H=o(22165),G=o(94107);function W(e){window.__c={n:"TopbarActionButtons"};const t=(0,i.O7)(),{device:o}=t,p=(0,c.useIntl)(),{store:w,spaceStore:P,pageVisitStore:Z,presenceStore:I,collectionViewStore:B,spaceViewStore:R}=e,O=(0,s.VK)((()=>w.canEdit()),[w]),[W,X]=(0,s.AF)(void 0,g.Z),[Y,$]=(0,n.useState)(!1),[Q]=(0,s.AF)(S.ZP),J=(0,s.VK)((()=>h.qG(w.id)),[w]),ee=(0,s.VK)((()=>q({canEditPage:O,device:o})&&!J),[O,o,J]),te=(0,s.VK)((()=>Boolean(P&&!P.canEdit())),[P]),oe=(0,s.VK)((()=>(0,f.Sx)(t)),[t]),ne=(0,s.VK)((()=>(0,u.ui)(t,!1)<1150),[t]),ie=(0,s.VK)((()=>z({isSpaceGuest:te,canEditPage:O})&&!J),[O,J,te]);(0,n.useEffect)((()=>{$(!oe)}),[oe]);const{canShowUpdateSidebarUnexpander:se,shouldShowUpdateSidebarUnexpander:re}=(0,s.VK)((()=>{const e=!Y&&oe&&!(0,f._c)(t);return{canShowUpdateSidebarUnexpander:e,shouldShowUpdateSidebarUnexpander:e&&(Q.mouseEntered||W.mouseEntered)}}),[Y,oe,t,W,Q]),[ae]=(0,s.AF)(S.ZP),le=(0,s.Kw)(h.tu),de=(0,s.VK)((()=>!o.isMobile&&!J&&(!w.isCollectionView()||w.isCollectionViewPageWithContent())),[o.isMobile,J,w]),ce=(0,s.VK)((()=>x.Z.isContextEnabled()),[]),ue=(0,s.VK)((()=>!o.isMobile&&!J),[o.isMobile,J]),pe=(0,s.VK)((()=>y.default.checkGate("show_topbar_layout_info_button")),[]),ge=(0,r.yK)((()=>({actionButtonsWrapStyle:{flexGrow:0,flexShrink:0,display:"flex",alignItems:"center",paddingRight:o.isMobile?4:0,paddingLeft:o.isMobile?4:12,width:se?ae.width:void 0,justifyContent:"space-between",zIndex:d.A_,height:l.R6(t.device.isElectronMac),opacity:le?0:1,transition:`\n\t\t\t\t\topacity ${E.nk}ms,\n\t\t\t\t\tcolor ${E.nk}ms\n\t\t\t\t`},rightButtonsContainer:{display:"flex"}})),[se,o,ae,t,le]);if(e.isInvalidPage)return null;const he=o.isElectronMac&&le||!se||!o.isElectron&&!re||Q.isAnimating;return(0,_.jsxs)("div",{style:ge.actionButtonsWrapStyle,onMouseMove:()=>{X({...W,mouseEntered:!0})},onMouseLeave:()=>{X({...W,mouseEntered:!1})},className:m.A_D,children:[he?(0,_.jsx)("div",{}):(0,_.jsx)("div",{className:m.JiD,children:(0,_.jsx)(H.C,{shouldHide:he,icon:a.t,caption:p.formatMessage({defaultMessage:"Close sidebar",id:"updateSidebarUnexpandButton.closeSidebar.tooltip"}),onClick:()=>{$(!0),v.setUpdateExpand({environment:t,isExpanded:!1,from:"close_for_space"})},keyboardShortcutName:"toggleUpdateSidebar",isElectron:o.isElectron})}),(0,_.jsxs)("div",{style:ge.rightButtonsContainer,children:[!J&&(0,_.jsx)(F,{store:w,isExpanded:oe,isWindowSmall:ne,isElectronMac:o.isElectronMac}),O&&Z&&I&&(0,_.jsx)(N.Z,{rootStore:w,pageVisitStore:Z,presenceStore:I,maxUsers:Q.expanded?3:void 0}),ie&&(0,_.jsx)(K.Z,{store:w,buttonPopupStore:C.Z}),ce&&w&&P&&(0,_.jsx)(D,{blockStore:w,spaceStore:P,buttonPopupStore:M}),de&&(0,_.jsx)(L.Z,{blockStore:w,spaceStore:P,buttonPopupStore:k}),ee&&(0,_.jsx)(G.Z,{blockStore:w,spaceStore:P,buttonPopupStore:T.Z}),pe&&(0,_.jsx)(V.b,{blockStore:w}),(0,_.jsx)(U.Z,{store:w,spaceViewStore:R}),J&&(0,_.jsx)(b.Z,{}),ue&&(0,_.jsx)(A.Z,{store:w,collectionViewStore:B,buttonPopupStore:j.Z})]})]})}function z(e){const{canEditPage:t,isSpaceGuest:o}=e;return!!p.default.isAdminMode||(!o||t)}function q(e){const{canEditPage:t,device:o}=e;return!!p.default.isAdminMode||!!t&&!o.isPhone}},61394:(e,t,o)=>{o.d(t,{Z:()=>P});var n=o(67294),i=o(480),s=o(86628),r=o(1464),a=o(81270),l=o(10020),d=o(12392),c=o(13530),u=o(73361),p=o(9291),g=o(66324),h=o(47839),m=o(8055),b=o(24098),v=o(34700),f=o(18514),S=o(24042),x=o(88923),y=o(64921),w=o(73063),M=o(58261),k=o(53437),j=o(26388),C=o(85893);const T={position:"relative",display:"flex",alignItems:"center",justifyContent:"center",height:"100%",width:32};const P=function(e){let{supportsNativeHomeTabPhone:t}=e;return window.__c={n:"TopbarBrowserButtons"},(0,i.O7)().device.isMobile?(0,C.jsx)(D,{supportsNativeHomeTabPhone:t}):(0,C.jsx)(U,{supportsNativeHomeTabPhone:t})};function Z(){h.openInNewTab({url:"",makeTabActive:!0,position:"start"})}function I(){window.__c={n:"NewTabButtonComponent"};const e=(0,i.Fy)();return(0,s.VK)((()=>S.Z.state.isTabsFeatureEnabled),[])?(0,C.jsx)(j.ZP,{renderTooltip:()=>(0,C.jsxs)("div",{style:{display:"flex"},children:[(0,C.jsx)(p.FormattedMessage,{id:"topbarBrowserHistoryButton.newTabButton.label",defaultMessage:"New tab"}),(0,C.jsx)(M.Z,{name:"newTab",style:{opacity:.5,marginLeft:4}})]}),placement:j.ug.Bottom,alignment:j.v2.Center,originGap:6,render:t=>(0,C.jsx)(w.Z,{icon:e=>(0,u.K)({...e,width:"24px",height:"24px"}),isDarkIconColor:!0,className:"notion-new-tab-button",style:{position:"relative",...(0,v.X)({noDrag:e.isElectronMac})},onClick:Z,...t})}):null}function B(e){g.ME(e,{type:"forward"}),m.eH()}function _(e,t){const{mobileNative:o}=e;g.ME(e,{type:"back"}),f.__(e)?m.op(e):t&&!f.NW(e)?null==o||o.showNativeHomeTab():m.op(e)}function F(e){let{supportsNativeHomeTabPhone:t}=e;window.__c={n:"BackButtonComponent"};const o=(0,i.O7)(),r=(0,n.useCallback)((e=>(0,a.z)({...e,width:"24px",height:"24px"})),[]),l=(0,n.useCallback)((e=>(0,d.S)(e)),[]),c=(0,s.VK)((()=>!f.NW(o)),[o]),u=(0,s.VK)((()=>S.Z.state.isTabsFeatureEnabled?r:l),[l,r]);return(0,C.jsx)(j.ZP,{renderTooltip:()=>(0,C.jsxs)("div",{style:{display:"flex"},children:[(0,C.jsx)(p.FormattedMessage,{id:"topbarBrowserHistoryButtons.goBackButton.label",defaultMessage:"Go back"}),(0,C.jsx)(M.Z,{name:"goBack",style:{opacity:.5,marginLeft:4}})]}),placement:j.ug.Bottom,alignment:j.v2.Center,originGap:6,render:e=>(0,C.jsx)(w.Z,{icon:u,isDarkIconColor:!0,className:"notion-history-back-button",disabled:c,style:{position:"relative",...(0,v.X)({noDrag:o.device.isElectronMac})},onClick:()=>_(o,t),...e})})}function E(){window.__c={n:"ForwardButtonComponent"};const e=(0,i.O7)(),t=(0,n.useCallback)((e=>(0,l.C)({...e,width:"24px",height:"24px"})),[]),o=(0,n.useCallback)((e=>(0,c.s)(e)),[]),r=(0,s.VK)((()=>!f.vy(e)),[e]),a=(0,s.VK)((()=>S.Z.state.isTabsFeatureEnabled?t:o),[o,t]);return(0,C.jsx)(j.ZP,{renderTooltip:()=>(0,C.jsxs)("div",{style:{display:"flex"},children:[(0,C.jsx)(p.FormattedMessage,{id:"topbarBrowserHistoryButton.goForwardButton.label",defaultMessage:"Go forward"}),(0,C.jsx)(M.Z,{name:"goForward",style:{opacity:.5,marginLeft:4}})]}),placement:j.ug.Bottom,alignment:j.v2.Center,originGap:6,render:t=>(0,C.jsx)(w.Z,{icon:a,isDarkIconColor:!0,className:"notion-history-forward-button",disabled:r,style:{position:"relative",...(0,v.X)({noDrag:e.device.isElectronMac})},onClick:()=>B(e),...t})})}function R(e){let{supportsNativeHomeTabPhone:t}=e;window.__c={n:"MobileBackButtonComponent"};const o=(0,i.O7)(),{RouterStore:n}=o,a=(0,s.VK)((()=>!t&&!n.canGoBack()),[t,n]);return(0,C.jsx)(y.Z,{onClick:()=>_(o,t),className:"notion-history-back-button",disabled:a,disabledFeedback:!0,mobileFeedback:!0,style:T,children:t?(0,r.k)():(0,d.S)({width:16,height:16})})}function O(){window.__c={n:"MobileForwardButtonComponent"};const e=(0,i.O7)(),t=(0,s.VK)((()=>!f.vy(e)),[e]);return(0,C.jsx)(y.Z,{onClick:()=>B(e),className:"notion-history-forward-button",disabled:t,mobileFeedback:!0,disabledFeedback:!0,style:T,children:(0,c.s)({width:16,height:16})})}function D(e){let{supportsNativeHomeTabPhone:t}=e;window.__c={n:"MobileComponent"};const o=(0,i.O7)(),n=(0,s.VK)((()=>o.device.isTablet),[o]);return t||n?(0,C.jsx)(b.Z,{capture:!0,render:e=>(0,C.jsxs)("div",{style:{display:"flex",flexShrink:0,height:"100%",paddingLeft:4,paddingRight:t?0:4},...e,children:[(0,C.jsx)(R,{supportsNativeHomeTabPhone:t}),!t&&(0,C.jsx)(O,{})]})}):null}function L(e){let{supportsNativeHomeTabPhone:t}=e;return(0,C.jsx)(b.Z,{capture:!0,render:e=>(0,C.jsxs)("div",{style:{display:"flex",flexShrink:0},...e,children:[(0,C.jsx)(F,{supportsNativeHomeTabPhone:t}),(0,C.jsx)(E,{}),(0,C.jsx)(I,{})]})})}function U(e){let{supportsNativeHomeTabPhone:t}=e;window.__c={n:"DesktopComponent"};const o=(0,s.VK)((()=>x.default.isCenterPeekOpen()),[]);return(0,C.jsx)(k.ZP,{style:{background:"transparent",borderRadius:0,boxShadow:"none"},origin:(0,C.jsx)(L,{supportsNativeHomeTabPhone:t}),render:()=>(0,C.jsx)(L,{supportsNativeHomeTabPhone:t}),placementToOrigin:k.ZP.Placement.Center,alignmentToOrigin:k.ZP.Alignment.Center,open:o,disableMouseCapture:!0,preventCaptureEsc:!0,preventScaleTransition:!0,preventOpacityTransition:!0,popupType:k.ZP.PopupType.Popup})}},28311:(e,t,o)=>{o.d(t,{Z:()=>M});o(67294);var n=o(83355),i=o(24405),s=o(8848),r=o(47560),a=o(9291),l=o(7476),d=o(34047),c=o(43250),u=o(34700),p=o(33929),g=o(74948),h=o(24646),m=o(36391),b=o(88923),v=o(73063),f=o(26388),S=o(85893);const x=(0,a.defineMessages)({updates:{id:"topbar.commentsButton.title",defaultMessage:"Comments"}});class y extends n.Z{constructor(){super(...arguments),this.hasUnreadCommentsStore=this.createComputedStore((()=>(0,d.DF)({blockStore:this.props.blockStore,ignoreAfterTime:Date.now()}).some((e=>!e.getResolved()&&(0,d.NI)(e).some((t=>l.t({discussionStore:e,commentStore:t})))))),!1)}renderComponent(){const e=p.default.getIntl(),t=h.vK(this.environment)?(0,S.jsx)("div",{style:{textAlign:"center"},children:(0,S.jsx)(a.FormattedMessage,{defaultMessage:"Close all comments",id:"topbar.commentsButton.closeSidebartTooltip"})}):(0,S.jsx)("div",{style:{textAlign:"center"},children:(0,S.jsx)(a.FormattedMessage,{defaultMessage:"View all comments",id:"topbar.commentsButton.openSidebartTooltip"})});return(0,S.jsx)(f.ZP,{placement:f.ug.Bottom,renderTooltip:()=>t,render:t=>(0,S.jsxs)("div",{style:{...(0,u.X)({noDrag:this.environment.device.isElectronMac}),position:"relative"},children:[(0,S.jsx)(v.Z,{...t,icon:r.o,iconStyle:{height:20,width:20,fill:this.theme.regularIconColor},onClick:()=>{return e=this.props.blockStore,t=this.environment,void g.handleSidebarButtonClick(t,e,m.gY.Comments,"topbar");var e,t},style:{width:33,height:28,marginRight:2},ariaLabel:e.formatMessage(x.updates),hovered:h.vK(this.environment)&&!b.default.state.open,className:c.p0b}),this.hasUnreadCommentsStore.state&&(0,S.jsx)(w,{})]}),children:t})}}y.displayName="TopbarCommentsButton";const w=()=>{window.__c={n:"TopBarNotificationDot"};const{dot:e}=(0,i.yK)((e=>({dot:{position:"absolute",top:1.8,right:5.5,height:11,width:11,border:`2px solid ${e.whiteButtonBackground}`,borderRadius:12,background:s.ZP.red,pointerEvents:"none"}})),[]);return(0,S.jsx)("div",{style:e})},M=y},84920:(e,t,o)=>{o.d(t,{Z:()=>L});var n=o(67294),i=o(12183),s=o(480),r=o(86628),a=o(24405),l=o(27961),d=o(38737),c=o(9291),u=o(3022),p=o(47307),g=o(53323),h=o(34700),m=o(45023),b=o(87279),v=o(15517),f=o(88632),S=o(99757),x=o(38335),y=o(8848),w=o(80750),M=o(16402),k=o(85893);function j(e){window.__c={n:"ConnectionErrorIndicatorLabel"};const t=(0,x.f)(500);if(e.device.isMobile)return(0,w.l)({width:24,height:"100%"});if(void 0===e.error.approximateBackoffDelayEndTime)return(0,k.jsx)(c.FormattedMessage,{defaultMessage:"Something's not right.",id:"connectionErrorIndicator.label.shortMessage"});const o=Math.floor((e.error.approximateBackoffDelayEndTime-t)/1e3);return o>0?(0,k.jsx)(c.FormattedMessage,{defaultMessage:"Something's not right. Retrying in {numberOfSeconds}sâ€¦",values:{numberOfSeconds:o},id:"connectionErrorIndicator.label.retryingInSeconds"}):(0,k.jsx)(c.FormattedMessage,{defaultMessage:"Something's not right. Retryingâ€¦",id:"connectionErrorIndicator.label.retrying"})}function C(e){window.__c={n:"ConnectionErrorIndicatorDetails"},(0,x.f)(1e4);const{startTime:t}=e,o=(0,M.IS)(t),i=(0,s.O7)();return(0,n.useEffect)((()=>{u.ap(i,{errorSinceMs:Date.now()-t})}),[i,t]),(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(c.FormattedMessage,{defaultMessage:"{sinceSomeTimeAgo}, an error occurred saving your changes. We'll try again soon.",values:{sinceSomeTimeAgo:o},id:"connectionErrorIndicator.details.message"}),e.retryReason?(0,k.jsx)("div",{style:{marginTop:8,fontSize:12,color:y.ZP.whiteWithAlpha(.7),fontStyle:"italic"},children:(0,k.jsx)(c.FormattedMessage,{defaultMessage:"Debug info: {debugInfo}",values:{debugInfo:e.retryReason},id:"connectionErrorIndicator.details.debugInfo"})}):void 0]})}var T=o(31945),P=o(68785),Z=o(78140),I=o(89728),B=o(26388);const _=e=>(0,k.jsx)(c.FormattedMessage,{defaultMessage:"You can no longer make edits: {errorMessage} {usageInfoMessage}",id:"connectionState.errorIndicator.cannotMakeEdits.detailedMessage",values:{errorMessage:e.errorMessage,usageInfoMessage:e.usageInfoMessage}}),F=e=>{window.__c={n:"ErrorIndicator"};const t=(0,a.Fg)(),o=(0,s.O7)(),i=(0,l.z)({marginLeft:6,width:14,height:14,fill:e.errorStateStyle.color}),r="transactionQueue"===e.type?e.message:void 0,d="lowStorage"===e.type?e.estimate:void 0;return(0,n.useEffect)((()=>{"transactionQueue"===e.type?u.sI(o,{message:r}):"connection"===e.type?u.SL(o):"lowStorage"===e.type&&u.zQ(o,{estimate:d})}),[e.type,r,d,o]),(0,n.useEffect)((()=>{r&&p.showThrottledErrorMessage((0,k.jsx)(_,{errorMessage:r}))}),[r]),o.device.isMobile?(0,k.jsx)(T.ZP,{popupType:T.Z4.SlideUp,renderOrigin:t=>(0,k.jsx)(I.Z,{style:e.errorStateStyle,...t,children:e.indicatorText||i}),render:o=>{let{close:n}=o;return(0,k.jsx)(Z.Z,{menuType:b.og.ActionSheet,children:(0,k.jsx)("div",{style:{padding:15,background:t.errorText,color:"white"},onClick:n,children:e.detailsText})})}}):(0,k.jsx)(B.ZP,{renderTooltip:()=>(0,k.jsx)("div",{style:{width:320,whiteSpace:"normal"},children:e.detailsText}),render:t=>(0,k.jsxs)("div",{style:e.errorStateStyle,...t,children:[e.indicatorText,i]})})};function E(e){let{showLoadingSpinner:t}=e;window.__c={n:"MobileLoadingSpinner"};const o=(0,s.O7)(),n=(0,r.VK)((()=>{var e;return null===(e=o.mobileNative)||void 0===e?void 0:e.supportsNativeHomeOnPhone()}),[o]);return(0,k.jsx)("div",{style:{display:"flex",alignItems:"center",height:"100%",marginLeft:"auto",paddingLeft:!n||t?4:0,paddingRight:!n||t?8:0,visibility:t?"visible":"hidden"},children:(!n||t)&&(0,k.jsx)(P.Z,{style:{height:18,width:18}})})}function R(e){return{display:"flex",alignItems:"center",marginRight:e?0:18,fontSize:e?12:14}}function O(e){let{isOnline:t,showLoadingSpinner:o}=e;window.__c={n:"DesktopIndicators"};const n=(0,c.useIntl)(),i=(0,s.Fy)(),r=(0,a.yK)((e=>({offlineBadge:{...(0,h.X)({noDrag:i.isElectronMac}),display:"flex",alignItems:"center",padding:"0px 6px",height:i.isMobile?20:24,borderRadius:4,marginRight:i.isMobile?4:18,whiteSpace:"nowrap",fontSize:i.isMobile?12:14,color:e.mediumTextColor,border:`1px solid ${e.darkDividerColor}`},loadingState:{...(0,h.X)({noDrag:i.isElectronMac}),...R(i.isMobile),color:e.lightTextColor}})),[i]);return t?o?(0,k.jsx)(B.ZP,{renderTooltip:()=>(0,k.jsx)(c.FormattedMessage,{defaultMessage:"{percent} complete.",id:"connectionState.savePercentangeIndicator.tooltip",values:{percent:S.Z.percentComplete(n)}}),render:e=>(0,k.jsxs)("div",{style:r.loadingState,...e,children:[(0,k.jsx)(P.Z,{style:{margin:4,marginRight:8}}),(0,k.jsx)(c.FormattedMessage,{defaultMessage:"Savingâ€¦",id:"connectionState.saving.message"})]})}):null:(0,k.jsx)(B.ZP,{renderTooltip:()=>(0,k.jsx)("div",{style:{width:200},children:(0,k.jsx)(c.FormattedMessage,{defaultMessage:"{numberOfEdits, plural, one {You have {numberOfEdits} edit that will be synced next time you are online.} other {You have {numberOfEdits} edits that will be synced next time you are online.}}",id:"connectionState.offlineBadge.tooltip",values:{numberOfEdits:S.Z.state.totalPending}})}),textWrap:!0,render:e=>(0,k.jsx)("div",{style:r.offlineBadge,...e,children:(0,k.jsx)(c.FormattedMessage,{defaultMessage:"Offline",id:"connectionState.offlineBadge.label"})})})}function D(){window.__c={n:"ErrorMessages"};const e=(0,s.Fy)(),t=(0,r.VK)((()=>S.Z.state.transactionQueueError),[]),o=(0,r.VK)((()=>S.Z.state.storageUsageEstimate),[]),i=(0,c.useIntl)(),l=(0,a.yK)((t=>({errorState:{...(0,h.X)({noDrag:e.isElectronMac}),...R(e.isMobile),whiteSpace:"nowrap",color:t.errorText}})),[e]),u=(0,r.VK)((()=>(0,g.L)()),[]),p=()=>{if(o){const e=o.usage/o.quota;return(0,k.jsx)(c.FormattedMessage,{defaultMessage:"Notion is using {percentageOfStorageBytesUsed} of its available storage on your device ({usedNumberOfBytes} of {totalNumberOfBytes}).",id:"connectionState.errorIndicator.possibleLostEdits.detailedMessagePart1",values:{usedNumberOfBytes:(0,d.uf)(o.usage,"bytes",i),totalNumberOfBytes:(0,d.uf)(o.quota,"bytes",i),percentageOfStorageBytesUsed:i.formatNumber(e,{style:"percent",maximumFractionDigits:2})}})}};if(t){const e=(0,k.jsx)(c.FormattedMessage,{defaultMessage:"Cannot save changes",id:"connectionState.errorIndicator.cannotSaveChanges.message"}),o=(0,k.jsx)(_,{errorMessage:t.message,usageInfoMessage:p()});return(0,k.jsx)(F,{type:"transactionQueue",message:t.message,indicatorText:e,detailsText:o,errorStateStyle:l.errorState})}if(void 0!==o&&!(0,v.mn)(o)){const t=e.isBrowser?(0,k.jsx)(c.FormattedMessage,{defaultMessage:"Low browser storage",id:"connectionState.errorIndicator.lowStorageOnWebApp.message"}):e.isMobileNative?(0,k.jsx)(c.FormattedMessage,{defaultMessage:"Low app storage",id:"connectionState.errorIndicator.lowStorageOnMobileApp.message"}):(0,k.jsx)(c.FormattedMessage,{defaultMessage:"Low disk space",id:"connectionState.errorIndicator.lowStorageOnDesktopApp.message"});return(0,k.jsx)(F,{type:"lowStorage",estimate:o,indicatorText:t,detailsText:(0,k.jsxs)(n.Fragment,{children:[p()," ",(0,k.jsx)(c.FormattedMessage,{id:"connectionState.errorIndicator.possibleLostEdits.detailedMessagePart2",defaultMessage:"You may lose changes made while offline. Try closing and re-opening your app, and contact support if that doesnâ€™t fix the issue."})]}),errorStateStyle:l.errorState})}return u?(0,k.jsx)(F,{type:"connection",indicatorText:(0,k.jsx)(j,{error:u,device:e}),detailsText:(0,k.jsx)(C,{...u}),errorStateStyle:l.errorState}):null}const L=function(){window.__c={n:"TopbarConnectionIndicator"};const e=(0,r.VK)((()=>f.Z.state.online),[]),t=(0,r.VK)((()=>!S.n.state),[]),o=function(){const e=(0,n.useRef)(!1),[t,o]=(0,n.useState)(!1),s=(0,i.v)((()=>{f.Z.state.syncing&&!e.current&&(e.current=!0,o(!0))}),8e3),r=(0,i.v)((()=>{e.current&&!f.Z.state.syncing&&(e.current=!1,o(!1))}),200);return(0,n.useEffect)((()=>(f.Z.addListener(s),f.Z.addListener(r),()=>{f.Z.removeListener(s),f.Z.removeListener(r)})),[s,r]),e.current}(),a=function(e,t){const o=(0,s.O7)(),[i,r]=(0,n.useState)(!1),a=(0,n.useCallback)((n=>{(0,m.Z)(o,n,"command+s")&&(n.preventDefault(),e&&!i&&t&&(r(!0),setTimeout((()=>{r(!1)}),500)))}),[o,i,t,e]);return(0,n.useEffect)((()=>(window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)})),[a]),i}(e,t),l=(0,s.Fy)(),d=(0,r.VK)((()=>!(0,g.n)()),[]),c=(a||o)&&t&&d;return(0,k.jsxs)(k.Fragment,{children:[l.isMobile?(0,k.jsx)(E,{showLoadingSpinner:c}):(0,k.jsx)(O,{isOnline:e,showLoadingSpinner:c}),(0,k.jsx)(D,{})]})}},24097:(e,t,o)=>{o.d(t,{Z:()=>w});var n=o(67294),i=o(480),s=o(86628),r=o(24405),a=o(18387),l=o(52926),d=o(9291),c=o(24677),u=o(82530),p=o(97978),g=o(43250),h=o(34700),m=o(92783),b=o(74948),v=o(73063),f=o(58261),S=o(26388),x=o(85893);const y=(0,d.defineMessages)({isBookmarkedMessage:{defaultMessage:"Favorited",id:"topbar.favoriteButton.activeTitle"},isNotBookmarkedMessage:{defaultMessage:"Favorite",id:"topbar.favoriteButton.title"},isBookmarkedTooltip:{defaultMessage:"Remove from your favorites",id:"topbar.favoriteButton.activeTooltip1"},isNotBookmarkedTooltip:{defaultMessage:"Add to your favorites",id:"topbar.favoriteButton.tooltip1"}});const w=function(e){let{spaceViewStore:t,store:o}=e;window.__c={n:"TopbarFavoriteButton"};const f=(0,r.Fg)(),w=(0,i.O7)(),k=(0,d.useIntl)(),j=(0,s.VK)((()=>!!t&&(0,m.Z)({spaceViewStore:t,pageId:o.id})),[t,o]),C=j?l.b:a.A,T=(0,n.useMemo)((()=>j?()=>function(e,t,o){if(!o)return;c.ZH(t),p.j(t,"unbookmark",{from:"topbar"}),u.createAndCommit({userAction:"TopbarFavoriteButton.handleUnbookmarkClick",environment:t,perform:t=>{b.unbookmarkPage({spaceViewStore:o,store:e,transaction:t})}})}(o,w,t):()=>function(e,t,o){if(!o)return;c.ZH(t),p.j(t,"bookmark",{from:"topbar"}),u.createAndCommit({userAction:"TopbarFavoriteButton.handleBookmarkClick",environment:t,perform:t=>{b.bookmarkPage({spaceViewStore:o,store:e,transaction:t})}})}(o,w,t)),[j,o,w,t]);return(0,x.jsx)(S.ZP,{placement:S.ug.Bottom,renderTooltip:()=>(0,x.jsx)(M,{isBookmarked:j}),render:e=>(0,x.jsx)(v.Z,{...e,className:g.GbT,icon:C,style:{...(0,h.X)({noDrag:w.device.isElectronMac}),width:33,height:28,marginRight:2},iconStyle:{height:20,width:20,fill:j?f.topbarFavorite:f.regularIconColor},onClick:T,ariaLabel:k.formatMessage(j?y.isBookmarkedMessage:y.isNotBookmarkedMessage)})})};function M(e){let{isBookmarked:t}=e;window.__c={n:"TooltipMessageComponent"};const o=(0,r.Fg)();return(0,x.jsxs)("div",{style:{textAlign:"center"},children:[(0,x.jsx)("div",{children:(0,x.jsx)(d.FormattedMessage,{...t?y.isBookmarkedTooltip:y.isNotBookmarkedTooltip})}),(0,x.jsx)(f.Z,{style:{color:o.mediumInvertedTextColor},name:"toggleFavorite"})]})}},43377:(e,t,o)=>{o.d(t,{b:()=>p});o(67294);var n=o(480),i=o(24405),s=o(44495),r=o(9291),a=o(74948),l=o(36391),d=o(73063),c=o(26388),u=o(85893);function p(e){window.__c={n:"TopbarLayoutInfoButton"};const{blockStore:t}=e,o=(0,i.Fg)(),p=(0,n.O7)(),g=(0,r.useIntl)(),h=(0,u.jsx)("div",{style:{textAlign:"center"},children:(0,u.jsx)(r.FormattedMessage,{defaultMessage:"Show page info",id:"topbar.infoButton.tooltip"})});return(0,u.jsx)(c.ZP,{placement:c.ug.Bottom,renderTooltip:()=>h,render:e=>(0,u.jsx)(d.Z,{...e,style:{width:33,height:28},icon:s.D,iconStyle:{height:20,width:20,fill:o.regularIconColor},onClick:()=>a.handleSidebarButtonClick(p,t,l.gY.Info,"info"),ariaLabel:g.formatMessage({defaultMessage:"Info",id:"topbar.infoButton.text"})})})}},72485:(e,t,o)=>{o.d(t,{Z:()=>C});o(67294);var n=o(73935),i=o(83355),s=o(56666),r=o(30681),a=o(9291),l=o(50906),d=o(24677),c=o(43250),u=o(34700),p=o(98742),g=o(35328),h=o(77907),m=o(80444),b=o(21884),v=o(64921),f=o(31945),S=o(26388),x=o(28451),y=o(81415),w=o(71424),M=o(85893);function k(e){return(0,M.jsx)(x.P,{calloutId:"wiki_promo",children:(0,M.jsx)(y.U,{origin:()=>e.origin,placementToOrigin:"bottom",header:"Upgrade your existing wikis",content:"Look for the Turn into wiki action here",onCloseClick:()=>{b.E.reset()},pointerPosition:"98%",pointerLength:24,pointerOffset:-3,style:{width:w.G5}})})}class j extends i.Z{constructor(){super(...arguments),this.originEl=null,this.onClickOriginRect=void 0,this.renderOrigin=e=>{const{device:t}=this.environment;return(0,M.jsx)(S.ZP,{renderTooltip:()=>this.environment.currentUser.isLoggedIn()?(0,M.jsx)(a.FormattedMessage,{defaultMessage:"Style, export, and moreâ€¦",id:"topbarMoreButton.tooltip"}):(0,M.jsx)(a.FormattedMessage,{defaultMessage:"Moreâ€¦",id:"topbarMoreButton.loggedOut.tooltip"}),placement:S.ug.Bottom,delayThreshold:400,render:o=>(0,M.jsx)(v.Z,{ref:this.handleButtonMount,style:T(this.environment),mobileFeedback:t.isMobile,className:c.mSZ,...(0,p.Z)(e,o),children:t.isMobile?(0,r.I)({width:26}):(0,s.o)({width:18,height:18,fill:this.theme.regularIconColor})})})},this.handleButtonMount=e=>{e&&(this.originEl=n.findDOMNode(e))},this.handleClick=()=>{b.E.reset(),d.ZH(this.environment),this.originEl&&(this.onClickOriginRect=this.originEl.getBoundingClientRect()),l.kq(this.environment)}}renderComponent(){const{device:e}=this.environment,t=b.E.state.showConvertTooltip;return(0,M.jsxs)(M.Fragment,{children:[t?(0,M.jsx)(k,{origin:this.originEl}):null,(0,M.jsx)(f.ZP,{popupType:e.isMobile?f.Z4.SlideUp:f.Z4.Popup,buttonPopupStore:this.props.buttonPopupStore,renderOrigin:this.renderOrigin,onClick:this.handleClick,render:()=>(0,M.jsx)(h.LazyTopbarMoreMenu,{blockStore:this.props.store,onClickOriginRect:this.onClickOriginRect,handleAccept:e=>function(e,t,o){const{mainEditorCurrentBlockStore:n}=m.default.state;if(n){const t=n.getType();t&&l.dh(o,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"topbar_more_menu",block_id:n.id,block_type:t,is_toggleable:(0,g._A)(t,n.getFormat())})}e.closeParentMenu&&P(t)}(e,this.props.buttonPopupStore,this.environment),handleDismiss:()=>P(this.props.buttonPopupStore)}),originGap:8,trapFocus:!0,forceInitialInbound:!0,style:e.isMobile?{}:{width:240,maxHeight:"80vh"}})]})}}j.displayName="TopbarMoreButton";const C=j;function T(e){const{device:t}=e;return t.isMobile?{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",paddingLeft:8,paddingRight:8,marginRight:2}:{...(0,u.X)({noDrag:e.device.isElectronMac}),display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:4}}function P(e){e.setState({...e.state,open:!1})}},5002:(e,t,o)=>{o.d(t,{Z:()=>s});o(67294);var n=o(24405),i=o(85893);const s=function(){window.__c={n:"TopbarPeekControlsSeparator"};const e=(0,n.yK)((e=>({separator:{height:14,width:1,marginLeft:6,marginRight:6,background:e.darkDividerColor}})),[]);return(0,i.jsx)("div",{style:e.separator})}},86467:(e,t,o)=>{o.d(t,{Z:()=>B});o(57658);var n=o(67294),i=o(83355),s=o(13991),r=o(480),a=o(86628),l=o(24405),d=o(7057),c=o(72126),u=o(19889),p=o(7928),g=o(9291),h=o(61045),m=o(34700),b=o(20095),v=o(68373),f=o(64921),S=o(26388),x=o(64369),y=o(29302),w=o(45653),M=o(40107),k=o(44615),j=o(25320),C=o(2688),T=o(53730);function P(e){window.__c={n:"PageVisitListener"};const t=(0,r.O7)(),o=(0,n.useRef)(),i=(0,M.t)(),s=(0,n.useCallback)((async()=>{if(await T.transactionQueue.awaitRecordTransaction(e.block.pointer),!i())return;const n=(0,k.pb)(e.block.id);o.current=C.ZP.addListener(n,c.P2((()=>j.Ri(t,{block:e.block,pageVisitStore:e.pageVisitStore,incremental:!0,limit:e.limit})),1e3),void 0,t)}),[t,i,e.block,e.limit,e.pageVisitStore]),a=(0,n.useCallback)((()=>{o.current&&(C.ZP.removeListener(o.current,t),o.current=void 0)}),[t]);return(0,n.useEffect)((()=>(s(),a)),[s,a]),null}var Z=o(85893);class I extends i.Z{constructor(){super(...arguments),this.renderStateStore=this.createComputedStore((()=>{const{pageVisitStore:e,presenceStore:t}=this.props,o=(0,b.AQ)(e,t),n=this.environment.currentUser.id;if(!n)return;const i=E(n,this.props.rootStore),s=o.find((e=>e.userId===n));if(!s||!i.isDefined())return;let r=o.filter((e=>e.userId!==n&&(0,b.MR)(this.environment,e)));r=_(r).reverse();const a=_(c.e5(o,r,[s])).reverse(),l=[...r,...a],d=F(this.props.maxUsers)-1;return{visibleUsers:l.slice(0,d),hiddenUsers:l.slice(d)}}),!0)}renderComponent(){return(0,Z.jsxs)(Z.Fragment,{children:[this.renderPresence(),(0,Z.jsx)(P,{block:this.props.rootStore,pageVisitStore:this.props.pageVisitStore,limit:1+F(this.props.maxUsers)+25})]})}renderPresence(){const e=this.environment.currentUser.id;if(!e)return;const t=this.renderStateStore.state;if(!t)return;const{visibleUsers:o,hiddenUsers:n}=t;var i;if([e,...o.map((e=>e.userId)),...n.map((e=>e.userId))].map((e=>E(e,this.props.rootStore))).every((e=>e.isReady()))&&(o.length>0||n.length>0)){const t=[...o];return t.reverse(),(0,Z.jsxs)("div",{style:(i=this.environment,{...(0,m.X)({noDrag:i.device.isElectronMac}),display:"flex",alignItems:"center",position:"relative",flexDirection:"row-reverse",marginLeft:9,marginTop:-2,transform:"translateZ(0)"}),children:[n.length>0&&(0,Z.jsx)(L,{rootStore:this.props.rootStore,hiddenUsers:n}),t.map((e=>(0,Z.jsx)(U,{userData:e,rootStore:this.props.rootStore},e.userId))),(0,Z.jsx)(U,{rootStore:this.props.rootStore,userData:{userId:e,present:!0}})]})}}}I.displayName="TopbarPresence";const B=I;function _(e){return c.MR(e,(e=>e.activityTimestampNearestMinuteMs))}function F(e){return e??5}function E(e,t){return v.U6.createChildStore(t,{table:u.KJ,id:e})}function R(e){return{color:e.mediumInvertedTextColor,fontSize:10,textTransform:"uppercase",letterSpacing:"0.015em"}}function O(e){let{userData:t,isPresent:o,rootStore:n}=e;window.__c={n:"AvatarTooltipComponent"};const i=(0,l.Fg)(),c=(0,r.O7)(),u=(0,g.useIntl)(),h=c.currentUser.id,m=(0,a.VK)((()=>E(t.userId,n)),[t,n]),b=(0,a.VK)((()=>m.isDefined()),[m]),v=(0,a.VK)((()=>(0,p.Nz)(u,m.getModel())),[u,m]),f=(0,a.VK)((()=>m.getEmail()),[m]);if(!b)return null;let S;return o?h!==m.id&&(S=t.blockId?(0,Z.jsx)(g.FormattedMessage,{defaultMessage:"Viewing now. Click to see where they are.",id:"topbar.presenceIndicator.viewingNowWithLocation.tooltip"}):(0,Z.jsx)(g.FormattedMessage,{defaultMessage:"Viewing now",id:"topbar.presenceIndicator.viewingNow.tooltip"})):h!==m.id&&t.activityTimestampNearestMinuteMs&&(S=(0,Z.jsx)(g.FormattedMessage,{defaultMessage:"Last viewed {timeFromNow}",id:"topbar.presenceIndicator.lastViewedTime.tooltip",values:{timeFromNow:(0,d.tv)(Math.min(t.activityTimestampNearestMinuteMs,Date.now()),s.SP)}})),(0,Z.jsxs)("div",{children:[(0,Z.jsx)("div",{className:"notranslate",children:v}),(0,Z.jsx)("div",{style:{fontWeight:400},children:f}),S&&(0,Z.jsx)("div",{style:{color:i.mediumInvertedTextColor,minWidth:150,paddingTop:2,paddingBottom:2,lineHeight:1.3},children:S})]})}function D(e){let{userData:t,index:o,rootStore:n}=e;window.__c={n:"HiddenUsersTooltipItemComponent"};const i=(0,l.Fg)(),c=(0,r.O7)(),u=(0,b.MR)(c,t),p=(0,a.VK)((()=>E(t.userId,n)),[t,n]);if(!(0,a.VK)((()=>p.isDefined()),[p]))return null;let g;!u&&t.activityTimestampNearestMinuteMs&&(g=(0,d.tv)(t.activityTimestampNearestMinuteMs,s.SP));const m=(0,Z.jsxs)("div",{style:{display:"flex",alignContent:"flex-end",minWidth:140,width:"100%",marginTop:4},children:[(0,Z.jsx)(y.Z,{userStore:p,avatarSize:18,style:{flexGrow:1}}),(0,Z.jsx)("div",{style:{marginLeft:"auto",paddingLeft:12,textAlign:"right",flexShrink:1,color:i.mediumInvertedTextColor},children:g})]});if(u&&t.blockId){const e=t.blockId;return(0,Z.jsx)(f.Z,{onClick:()=>h.hl([e],!0),style:{display:"flex",alignItems:"center"},children:m})}return(0,Z.jsx)("div",{style:{display:"flex",alignItems:"center"},children:m})}function L(e){let{hiddenUsers:t,rootStore:o}=e;window.__c={n:"HiddenUsersComponent"};const n=(0,l.Fg)(),i=(0,r.O7)();return(0,Z.jsx)(S.ZP,{allowHover:!0,originGap:7,renderTooltip:e=>{const s=[],r=[];for(const o of t)(0,b.MR)(i,o)?s.push(o):r.push(o);const a=r.slice(0,25-s.length);return(0,Z.jsxs)("div",{...e,children:[s.length>0&&(0,Z.jsxs)("div",{style:{marginBottom:4},children:[(0,Z.jsx)(x.Z,{style:R(n),children:(0,Z.jsx)(g.FormattedMessage,{defaultMessage:"Viewing now",id:"topbar.presenceIndicator.hiddenUsers.viewingNow.tooltip"})}),s.map(((e,t)=>(0,Z.jsx)(D,{userData:e,index:t,rootStore:o},t)))]}),a.length>0&&(0,Z.jsxs)("div",{style:{marginBottom:4},children:[(0,Z.jsx)(x.Z,{style:{...R(n)},children:(0,Z.jsx)(g.FormattedMessage,{defaultMessage:"Last viewed by",id:"topbar.presenceIndicator.hiddenUsers.lastViewedBy.tooltip"})}),a.map(((e,t)=>(0,Z.jsx)(D,{userData:e,index:t,rootStore:o},t)))]}),r.length>a.length&&(0,Z.jsx)("div",{style:{marginLeft:2,marginTop:2,color:n.mediumInvertedTextColor},children:(0,Z.jsx)(g.FormattedMessage,{defaultMessage:"{notViewingMoreUsersCount} moreâ€¦",id:"topbarPresence.presenceIndicator.hiddenUsers.moreUsersNotViewing.tooltip",values:{notViewingMoreUsersCount:r.length-a.length}})})]})},render:e=>(0,Z.jsx)("div",{style:{color:n.mediumTextColor,fontSize:14,marginLeft:10,marginRight:-5,whiteSpace:"nowrap"},...e,children:(0,Z.jsx)(g.FormattedMessage,{defaultMessage:"{hiddenUsersCount, plural, one {+{hiddenUsersCount}} other {+{hiddenUsersCount}}}",id:"topbar.presenceIndicator.hiddenUsers.otherCount.message",values:{hiddenUsersCount:t.length}})})})}function U(e){let{userData:t,rootStore:o}=e;window.__c={n:"AvatarComponent"};const n=(0,r.O7)(),{userId:i}=t,s=(0,b.MR)(n,t),l=E(i,o);if(!(0,a.VK)((()=>l.isDefined()&&!l.getIsSuspended()),[l]))return null;const d={transition:"all 0.2s ease",transform:"scale(1)"},c={transform:"scale(1.15)",background:"none"},u={transform:"scale(0.9)",background:"none"},p={width:23,height:23,borderRadius:23,marginRight:-5,position:"relative"};return(0,Z.jsx)(S.ZP,{textWrap:!0,renderTooltip:()=>(0,Z.jsx)(O,{rootStore:o,userData:t,isPresent:s}),render:e=>{const o=(0,Z.jsx)(w.Z,{userStore:l,style:p,isOffline:!s,size:23,avatarShouldShowShadow:!0});if(s&&t.blockId){const n=t.blockId;return(0,Z.jsx)(f.Z,{...e,onClick:()=>h.hl([n],!0),style:d,hoveredStyle:c,pressedStyle:u,children:o})}return(0,Z.jsx)("div",{...e,children:o})}})}},7715:(e,t,o)=>{o.d(t,{Z:()=>u});o(67294);var n=o(480),i=o(24405),s=o(61061),r=o(9291),a=o(34700),l=o(89728),d=o(26388),c=o(85893);const u=function(e){window.__c={n:"TopbarRestrictedBadge"};const t=(0,i.Fg)(),o=(0,n.O7)(),{device:u}=o;return(0,c.jsx)(d.ZP,{placement:d.ug.Bottom,renderTooltip:()=>(0,c.jsxs)("div",{style:{...(0,a.X)({noDrag:o.device.isElectronMac}),textAlign:"center"},children:[(0,c.jsx)(r.FormattedMessage,{defaultMessage:"Access restricted from parent page",id:"blockAuthorInfo.restrictedBadge.infoText"}),(0,c.jsx)("br",{}),(0,c.jsx)("span",{style:{color:t.mediumInvertedTextColor},children:(0,c.jsx)(r.FormattedMessage,{defaultMessage:"Click to view access",id:"blockAuthorInfo.restrictedBadge.clickText"})})]}),render:o=>(0,c.jsxs)(l.Z,{onClick:e.onClick,style:{marginRight:u.isMobile?4:2,color:t.lightTextColor,fill:t.lightIconColor},...o,children:[(0,s.B)({width:20,marginRight:4,fill:t.lightIconColor}),(0,c.jsx)("div",{style:{color:t.lightTextColor,fontSize:u.isMobile?16:14,lineHeight:u.isAndroid?1.5:1,whiteSpace:"nowrap"},children:(0,c.jsx)(r.FormattedMessage,{id:"blockAuthorInfo.restrictedBadge",defaultMessage:"Restricted"})})]})})}},82774:(e,t,o)=>{o.d(t,{Z:()=>A});var n=o(67294),i=o(83355),s=o(15769),r=o(43876),a=o(63143),l=o(9291),d=o(24677),c=o(28040),u=o(37181),p=o(43250),g=o(34700),h=o(98742),m=o(45101),b=o(77907),v=o(57345),f=o(4023),S=o(80444),x=o(77080),y=o(55899),w=o(8675),M=o(52878),k=o(34583),j=o(88893),C=o(88280),T=o(31945),P=o(58261),Z=o(89728),I=o(53437),B=o(26388),_=o(24405),F=o(8848),E=o(13148),R=o(23063),O=o(73063),D=o(28451),L=o(85893);function U(e){window.__c={n:"ShareButtonIntroTooltip"};const{visible:t,onDismiss:o}=e,n=(0,_.yK)((e=>({overlayContainer:{position:"relative",width:240,height:140,paddingTop:0,paddingBottom:20,paddingLeft:20,paddingRight:20},container:{fontSize:12,color:F.ZP.white,position:"absolute",top:13,background:F.ZP.blue,borderRadius:6,padding:"8px 12px 12px 12px",width:200,boxShadow:e.largeLightBoxShadow,zIndex:9999},circle:{position:"absolute",top:-12,left:"calc(50% - 2.5px)",background:F.ZP.blue,width:5,height:5,borderRadius:5,boxShadow:`0 0 0 1.5px ${e.contentBackground}`},verticalLine:{position:"absolute",top:-12,left:"calc(50% - 1px)",background:F.ZP.blue,width:2,height:12},textContainer:{width:"90%",fontWeight:500},iconButton:{position:"absolute",top:4,right:4,opacity:.8},iconStyle:{width:12,fill:F.ZP.white}})),[]);return(0,L.jsx)("div",{style:n.overlayContainer,children:(0,L.jsx)(R.Z,{isVisible:t,animationStyle:{opacity:1},enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},render:function(){return(0,L.jsx)(D.P,{calloutId:"share_button_tooltip",children:(0,L.jsxs)("div",{style:n.container,children:[(0,L.jsx)("div",{style:n.circle}),(0,L.jsx)("div",{style:n.verticalLine}),(0,L.jsx)("div",{style:n.textContainer,children:(0,L.jsx)(l.FormattedMessage,{defaultMessage:"You can share your content with your teammates here",id:"shareButtonIntroTooltip.title"})}),(0,L.jsx)(O.Z,{icon:E.U,style:n.iconButton,iconStyle:n.iconStyle,onClick:()=>o()})]})})}})})}class V extends i.Z{constructor(){super(...arguments),this.storeTypes={universalMemberInviteStore:M.Z,sudoModeStore:w.Z,inviteTargetsStore:y.ZP},this.showShareButtonTooltip=this.createComputedStore((()=>function(e){const{currentUserSettingsStore:t,mainEditorCurrentBlockStore:o,inAppCalloutStore:n}=S.default.state;if(null!=o&&o.isTypedCollectionViewBlock())return!1;if(!t)return!1;if(t.id!==e.currentUser.id)return!1;const i=t.getKeyStore("settings").getKeyStore("seen_share_button_tooltip_at").getValue();if(Boolean(i))return!1;const s=t.getKeyStore("settings").getKeyStore("signup_time").getValue();if(!s)return!1;if(!n.canShow("share_button_tooltip"))return!1;const r=Date.now()-s;if(r<=30*a.A0){switch(x.default.getEligibleGroup({experimentId:"intro_share_tooltip_condition",defaultGroup:"control"})){case"b200":const t=C.subscriptionDataStoreInstance.state;if(t){return(0,j.Lz)(e,t)>=200}return!1;case"d3":return r>=3*a.A0;case"control":return r>=10*a.A0}}return!1}(this.environment))),this.buttonPopupStyle=this.createComputedStore((()=>{const{device:e}=this.environment;return e.isMobile?{width:460}:{width:500,overflow:"hidden"}})),this.shareButtonStyle=this.createComputedStore((()=>{const{device:e}=this.environment;return e.isMobile?{display:"flex",alignItems:"center",height:"100%",paddingLeft:8,paddingRight:8}:{...(0,g.X)({noDrag:e.isElectronMac}),marginRight:2,marginLeft:12}})),this.shareButtonRef=n.createRef(),this.renderShareButtonOrigin=e=>{const{device:t}=this.environment;return(0,L.jsx)(B.ZP,{disableTooltip:t.isMobile,renderTooltip:()=>(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("div",{children:(0,L.jsx)(l.FormattedMessage,{defaultMessage:"Share or publish to the web",id:"topbar.shareButton.tooltip"})}),(0,L.jsx)(P.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"openShareMenu"})]}),placement:f.u.Bottom,delayThreshold:400,render:t=>this.renderShareButton((0,h.Z)(e,t))})},this.renderShareButton=e=>{const{device:t}=this.environment,o=this.showShareButtonTooltip.state,n=t.isMobile?t.isAndroid?(0,s.Q)({width:16,height:16}):(0,r.s)({width:26}):(0,L.jsx)(l.FormattedMessage,{defaultMessage:"Share",id:"topbar.shareButton.title"}),i=(0,L.jsx)("div",{ref:this.shareButtonRef,children:(0,L.jsx)(Z.Z,{className:p.MD7,...(0,h.Z)(e,{onClick:o?()=>u.Qm(this.environment):()=>{}}),mobileFeedback:t.isMobile,style:this.shareButtonStyle.state,children:n})});return o?(0,L.jsx)(I.ZP,{popupType:I.kQ.Popup,open:!0,origin:i,placementToOrigin:f.u.Bottom,alignmentToOrigin:I.ZP.Alignment.Center,preventScaleTransition:!0,preventOpacityTransition:!0,viewportPadding:4,preventCaptureEsc:!0,preventPointerEvents:!1,disableMouseCapture:!0,render:()=>this.showShareButtonTooltip.state?(0,L.jsx)(U,{visible:this.showShareButtonTooltip.state,onDismiss:()=>u.Qm(this.environment)}):null,style:{boxShadow:"none",backgroundColor:"rgba(0, 0, 0, 0)"}}):i},this.getBlockStoreForPermissionsSettings=()=>this.stores.sudoModeStore.shouldUserHaveAccessToPrivatePageBlock()&&this.stores.sudoModeStore.state.changePermissionsEnabled&&this.stores.sudoModeStore.state.privatePageStore?this.stores.sudoModeStore.state.privatePageStore:this.props.store,this.handleClick=()=>{this.resetStores(),d.ZH(this.environment),v.lG(this.environment),k.bi(this.environment)},this.handleClose=async()=>{if(this.stores.inviteTargetsStore.state.inviteTargets.length>0){return void(await v.zd({environment:this.environment,inviteTargetsStore:this.stores.inviteTargetsStore})&&(v.a6(this.environment),this.resetStores()))}const{permissionsInviteStore:e}=this.stores.universalMemberInviteStore.state;"invitee"===e.state.inputFocus&&e.setState({...e.state,inputFocus:"none"});await(0,m.Aw)({environment:this.environment,permissionsInviteStoreState:e.state,from:"share_menu"})||(v.a6(this.environment),this.resetStores())},this.resetStores=()=>{this.props.buttonPopupStore.reset(),this.stores.universalMemberInviteStore.reset(),this.stores.inviteTargetsStore.reset()},this.hasInviteTargets=()=>{const{universalMemberInviteStore:e,inviteTargetsStore:t}=this.stores,{permissionsInviteStore:o}=e.state;return o.state.inviteTargets.length>0||t.state.inviteTargets.length>0}}didMountOrUpdate(){this.props.store.canAdmin()?this.stores.sudoModeStore.reset():c.i({environment:this.environment,sudoModeStore:this.stores.sudoModeStore,pageBlockId:this.props.store.id})}renderComponent(){const{device:e}=this.environment;return(0,L.jsx)(T.ZP,{popupType:e.isMobile?T.Z4.SlideUp:T.Z4.Popup,forceInitialInbound:!0,buttonPopupStore:this.props.buttonPopupStore,renderOrigin:this.renderShareButtonOrigin,originGap:e.isMobile?void 0:8,style:this.buttonPopupStyle.state,onClick:this.handleClick,render:()=>(0,L.jsx)(b.LazyShareMenuContainer,{buttonPopupStore:this.props.buttonPopupStore,sudoModeStore:this.stores.sudoModeStore,store:this.getBlockStoreForPermissionsSettings(),inviteTargetsStore:this.stores.inviteTargetsStore,onUpgradeButtonClick:()=>{this.props.buttonPopupStore.reset()},location:e.isMobile?"topbar_mobile":"topbar_share_button",onClose:this.handleClose}),persistOnClose:!e.isMobile&&this.hasInviteTargets(),onDismiss:this.handleClose,onClose:this.handleClose})}}V.displayName="TopbarShareButton";const A=V},44332:(e,t,o)=>{o.d(t,{Z:()=>M});o(67294);var n=o(480),i=o(86628),s=o(24405),r=o(7525),a=o(63261),l=o(9291),d=o(43250),c=o(34700),u=o(61931),p=o(74948),g=o(38676),h=o(23063),m=o(64921),b=o(73063),v=o(58261),f=o(26388),S=o(39849),x=o(92955),y=o(54338),w=o(85893);function M(e){window.__c={n:"TopbarSidebarButton"};const t=(0,n.O7)(),o=(0,n.Fy)(),M=(0,l.useIntl)(),k=(0,i.VK)((()=>g.sidebarOpenStore.state),[]),j=(0,s.yK)((t=>({root:{...(0,c.X)({noDrag:o.isElectronMac}),flexShrink:0,width:48,height:48,margin:-12,padding:12,marginRight:-6},hamburgerButton:{position:"absolute",top:0,left:0,willChange:"opacity",display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24,borderRadius:4,...e.isFloatingButton?{...(0,u.Er)({theme:t,isPhone:o.isPhone,buttonState:"base"}),width:28}:{}},sidebarButton:{position:"absolute",top:0,left:0,willChange:"opacity",...e.isFloatingButton?{...(0,u.Er)({theme:t,isPhone:o.isPhone,buttonState:"base"}),width:28}:{}},svg:{width:16,height:16,fill:t.regularIconColor,...e.isFloatingButton?{width:12,height:12}:{}},chevron:{...e.isFloatingButton?{width:14,height:14}:{width:16,height:16}},keyboardShortcut:{color:t.mediumInvertedTextColor},mentionBadge:{position:"absolute",top:-1,right:-4,...e.isFloatingButton?{top:-4}:{}}})),[o,e.isFloatingButton]),C=M.formatMessage({defaultMessage:"Lock sidebar open",id:"sidebarExpandButton.tooltip"});return(0,w.jsx)(y.o,{style:j.root,children:(0,w.jsxs)("div",{style:{position:"relative"},children:[(0,w.jsx)(h.Z,{isVisible:!0,animationStyle:{opacity:k?0:1},render:()=>(0,w.jsxs)(m.Z,{style:j.hamburgerButton,children:[(0,a._)(j.svg),(0,w.jsx)(x.Z,{type:"allSpaces",color:S.N.Red,style:j.mentionBadge})]})}),(0,w.jsx)(h.Z,{isVisible:!0,animationStyle:{opacity:k?1:0},render:()=>(0,w.jsx)(f.ZP,{renderTooltip:()=>(0,w.jsxs)("div",{children:[(0,w.jsx)("div",{children:C}),(0,w.jsx)(v.Z,{style:j.keyboardShortcut,name:"toggleSidebar"})]}),placement:f.ug.Right,alignment:f.v2.Start,delayThreshold:0,originGap:6,render:e=>(0,w.jsx)(b.Z,{ariaLabel:C,icon:r.t,style:j.sidebarButton,hoveredStyle:j.sidebarButton,iconStyle:j.chevron,isDarkIconColor:!0,onClick:()=>p.setExpand({environment:t,isExpanded:!0,from:"topbar_sidebar_button"}),className:d.exn,...e})})})]})})}},54338:(e,t,o)=>{o.d(t,{o:()=>a});o(67294);var n=o(12534),i=o(74948),s=o(38676),r=o(85893);function a(e){let{children:t,style:o}=e;const a=e=>{(0,n.ZP)({event:e,context:n.Af.SidebarMouseMove,callback:()=>{const t=e.currentTarget.getBoundingClientRect();s.sidebarMousePeekXStore.setState(t.right),i.open({fromElectron:!1})}})};return(0,r.jsx)("div",{onMouseEnter:a,onMouseMove:a,style:o,children:t})}},22165:(e,t,o)=>{o.d(t,{C:()=>y,V:()=>x});o(67294);var n=o(480),i=o(86628),s=o(24405),r=o(97439),a=o(9291),l=o(28020),d=o(43250),c=o(34700),u=o(74948),p=o(38676),g=o(24042),h=o(45325),m=o(23063),b=o(73063),v=o(58261),f=o(26388),S=o(85893);function x(e){let{}=e;window.__c={n:"TopbarSidebarUnexpandButton"};const t=(0,n.O7)(),o=(0,n.Fy)(),s=(0,a.useIntl)(),d=(0,i.VK)((()=>!p.sidebarMouseEnteredStore.state),[]),c=(0,i.VK)((()=>g.Z.state.isShowingTabBar||!1),[]),m=(0,i.VK)((()=>l.tu.state),[]),b=s.formatMessage({defaultMessage:"Close sidebar",id:"sidebarUnexpandButton.closeSidebar.tooltip"});return(0,S.jsx)(y,{shouldHide:o.isElectronMac&&m||c||d,icon:r.D,caption:b,onClick:()=>{u.setExpand({environment:t,isExpanded:!1,from:"topbar_sidebar_unexpand_button"}),h.default.isOpen()&&u.close()},keyboardShortcutName:"toggleSidebar",isElectron:o.isElectron})}function y(e){window.__c={n:"TopbarUnexpandButton"};const t=(0,n.Fy)(),o=(0,s.yK)((e=>({keyboardShortcut:{color:e.mediumInvertedTextColor}})),[]),i=e.isElectron&&!e.shouldHide?1:0,r=e.shouldHide?0:1,a=e.keyboardShortcutName;return(0,S.jsx)(f.ZP,{disableTooltip:e.shouldHide,renderTooltip:()=>(0,S.jsxs)("div",{children:[(0,S.jsx)("div",{children:e.caption}),a&&(0,S.jsx)(v.Z,{style:o.keyboardShortcut,name:a})]}),originGap:6,render:o=>(0,S.jsx)(m.Z,{isVisible:!0,animationStyle:{opacity:r},enterAnimationStyle:{opacity:i},render:()=>(0,S.jsx)(b.Z,{ariaLabel:e.caption,disabled:e.shouldHide,icon:e.icon,style:{...(0,c.X)({noDrag:t.isElectronMac}),position:"relative",marginLeft:10,...t.isMobile&&{height:"100%"},...e.style},iconStyle:{width:16,height:16},mobileFeedback:t.isMobile,onClick:e.onClick,className:d.Mfh,...o})})})}},94107:(e,t,o)=>{o.d(t,{Z:()=>T,l:()=>C});o(67294);var n=o(83355),i=o(480),s=o(24405),r=o(44292),a=o(9291),l=o(19719),d=o(24677),c=o(43250),u=o(34700),p=o(98742),g=o(48451),h=o(57538),m=o(74948),b=o(24646),v=o(36391),f=o(64970),S=o(88923),x=o(31945),y=o(73063),w=o(26388),M=o(85893);const k=(0,a.defineMessages)({updates:{id:"topbar.updatesButton.title",defaultMessage:"Updates"}});class j extends n.Z{constructor(){super(...arguments),this.peekStoreTarget=this.createComputedStore((()=>S.default.state.open&&S.default.state.target))}renderComponent(){const{spaceStore:e,buttonPopupStore:t,blockStore:o}=this.props,{device:n}=this.environment;if(this.peekStoreTarget.state!==o){const e=b.J5(this.environment)?(0,M.jsx)("div",{style:{textAlign:"center"},children:(0,M.jsx)(a.FormattedMessage,{defaultMessage:"Close all updates",id:"topbar.updatesButton.closeSidebartTooltip"})}):(0,M.jsx)("div",{style:{textAlign:"center"},children:(0,M.jsx)(a.FormattedMessage,{defaultMessage:"View all updates",id:"topbar.updatesButton.openSidebartTooltip"})});return f.m.state&&(Z(this.props.blockStore,this.environment),f.m.setState(!1),l.Z8({environment:this.environment,pageId:o.pointer.id,isCurrentlyFollowing:(0,h.Z)(o.getFollowSettingsKey()).following,from:"email"})),(0,M.jsx)(w.ZP,{placement:w.ug.Bottom,renderTooltip:()=>e,render:e=>(0,M.jsx)(C,{...e,onClick:()=>Z(this.props.blockStore,this.environment),hovered:b.J5(this.environment)&&!S.default.state.open}),children:e})}return(0,M.jsx)(x.ZP,{onClick:()=>{return e=this.environment,d.ZH(e),void l.gM(e);var e},disabled:!e,popupType:n.isMobile?x.Z4.SlideUp:x.Z4.Popup,buttonPopupStore:t,renderOrigin:e=>(0,M.jsx)(P,{buttonPopupEvents:e}),originGap:8,render:()=>(0,M.jsx)(g.tY,{blockStore:this.props.blockStore,spaceStore:this.props.spaceStore}),style:{width:440,overflow:"hidden"}})}}function C(e){window.__c={n:"TopbarUpdatesIcon"};const{isElectronMac:t}=(0,i.O7)().device,o=(0,a.useIntl)(),n=(0,s.yK)((e=>({icon:{height:20,width:20,fill:e.regularIconColor},button:{...(0,u.X)({noDrag:t}),width:33,height:28,marginRight:2}})),[t]);return(0,M.jsx)(y.Z,{icon:r.d,iconStyle:n.icon,style:n.button,ariaLabel:o.formatMessage(k.updates),className:c.K3y,...e})}j.displayName="TopbarUpdatesButton";const T=j;function P(e){let{buttonPopupEvents:t}=e;window.__c={n:"OriginComponent"};const o=(0,i.O7)(),{device:n}=o,s=(0,M.jsx)(a.FormattedMessage,{defaultMessage:"View past changes to this page",id:"topbar.updatesButton.tooltip"});return n.isMobile?null:(0,M.jsx)(w.ZP,{placement:w.ug.Bottom,renderTooltip:()=>s,render:e=>(0,M.jsx)(C,{...(0,p.Z)(t,e)})})}function Z(e,t){m.handleSidebarButtonClick(t,e,v.gY.Updates,"topbar")}},42543:(e,t,o)=>{o.d(t,{DK:()=>b,Iw:()=>x,cE:()=>v,i3:()=>f,u1:()=>y,wq:()=>S});var n=o(6740),i=o(89101),s=o(19889),r=o(32441),a=o(47839),l=o(69915),d=o(95477),c=o(12534),u=o(46654),p=o(65598),g=o(24042),h=o(68373),m=o(16194);function b(e,t){const o=(0,p.Oh)(e),{id:n}=t.currentUser,i=n?h.U6.createChildStore(e,{table:s.KJ,id:n}):void 0,r=!i||i.isReady();return o&&r}function v(e,t){return!d.default.isAdminMode&&(0,u.IJ)(t,e)}i._j.signup,i._j.product;async function f(e){const{environment:t,route:o}=e;r.T3(t,{variant:"built_with_notion"}),await l.yF(t,{utmContent:"topbar_cta",nextRoute:o})}function S(e){e.target!==e.currentTarget||g.Z.state.isShowingTabBar||(0,c.ZP)({event:e,context:c.Af.EditorDoubleClick,callback:a.toggleMaximized})}function x(e){const t=e.target;t instanceof HTMLElement&&(0,n.E)(t)&&m.Z.setState(!0)}function y(){m.Z.setState(!1)}},71424:(e,t,o)=>{o.d(t,{EZ:()=>i,FD:()=>s,G5:()=>n,rK:()=>r});const n=220,i=24,s=-7,r=-3},90683:(e,t,o)=>{o.d(t,{a:()=>l});o(67294);var n=o(66897),i=o(97880),s=o(70301),r=o(45653),a=o(85893);function l(e){const{actor:t}=e,o={size:e.size??14,style:{marginRight:2,...e.style}};return(0,n.YU)(t)?(0,a.jsx)(s.Z,{botValue:t.asActor,...o}):(0,n.$S)(t)?(0,a.jsx)(r.Z,{userValue:t.asActor,...o}):(0,n.Iq)(t)?(0,a.jsx)(r.Z,{userValue:void 0,...o}):void(0,i.t1)(t)}},34700:(e,t,o)=>{function n(e){return"drag"in e&&e.drag?{WebkitAppRegion:"drag"}:"noDrag"in e&&e.noDrag?{WebkitAppRegion:"no-drag"}:{}}o.d(t,{X:()=>n})},26907:(e,t,o)=>{o.d(t,{B:()=>s,H:()=>n});const n=e=>{const{target:t,inviteTargetsStore:o}=e;return o.state.inviteTargets.some((e=>"newUser"===t.type?e.type===t.type&&t.value.email===e.value.email:"invalidUser"===t.type?e.type===t.type&&t.value.text===e.value.text:e.type===t.type&&e.value.id===t.value.id))};function i(e){return"invalidUser"!==e.type}const s=e=>{const{inviteTargetsStore:t}=e,{inviteTargets:o}=t.state;return o.filter(i)}},20095:(e,t,o)=>{o.d(t,{AQ:()=>u,EB:()=>d,MR:()=>c});o(57658);var n=o(72126),i=o(72141),s=o(63143),r=o(88893),a=o(88280),l=o(46654);function d(e){if(e&&e.blockId)return e.blockId}function c(e,t){const o=e.currentUser.id;if(t.userId===o)return!0;{const e=Date.now();return Boolean(t.present&&t.activityTimestampNearestMinuteMs&&e-t.activityTimestampNearestMinuteMs<=6e4)}}function u(e,t){const o=a.subscriptionDataStoreInstance.state,{remotePresenceData:d,rootStore:c}=t.state;if(!c||!c.canEdit()||!o)return[];let u=[];d&&n.M6(d,(e=>{e&&e.userId&&u.push(e)}));const{pageId:p,lastViewTime:g,lastExitTime:h,omittedUserIds:m,...b}=e.state;n.M6(b,(e=>{e.isDefined()&&u.push({userId:e.getUserId(),activityTimestampNearestMinuteMs:(0,s.ud)(e.getVisitedAt()),present:!1})})),u=n.mN(u,(e=>e.userId));const v=(0,l.YO)(c).map((e=>{let{permissionItem:t}=e;return t})).filter(i.jg).map((e=>e.user_id)),f=(0,r.CM)(o).map((e=>e.userId)),S=n.G0(v,f),x=new Set(m);return u=u.filter((e=>!!S.includes(e.userId)&&!(!e.present&&x.has(e.userId)))),u=n.MR(u,(e=>{let{activityTimestampNearestMinuteMs:t}=e;return t?-t:0})),u}},51811:(e,t,o)=>{o.d(t,{EX:()=>n,HB:()=>l,IS:()=>d,Tj:()=>a,yW:()=>r});let n=function(e){return e[e.Sidebar=0]="Sidebar",e[e.SidebarMobile=1]="SidebarMobile",e[e.MobileBottomBarPhone=2]="MobileBottomBarPhone",e[e.MobileBottomBarTablet=3]="MobileBottomBarTablet",e[e.TopbarMobile=4]="TopbarMobile",e[e.RenderAsPage=5]="RenderAsPage",e}({});const i=new Map,s=new Map;function r(e,t){i.set(c(e),t)}function a(e){return i.get(c(e))}function l(e,t){s.set(u(e),t)}function d(e){return s.get(u(e))??[]}function c(e){return Object.keys(e).sort().map((t=>{const o=e[t];return JSON.stringify(o)})).join("-")}function u(e){return Object.keys(e).sort().map((t=>{const o=e[t];return JSON.stringify(o)})).join("-")}},57538:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(57883),i=o(97880);function s(e){switch(e){case"all":return{following:!0,followSettings:(0,n.yI)({explicitly_set_by_user:!0})};case"important":return{following:!0,followSettings:(0,n.GC)({explicitly_set_by_user:!0})};case"comments":return{following:!0,followSettings:(0,n.r$)({explicitly_set_by_user:!0})};case"none":return{following:!1,followSettings:(0,n.vU)({explicitly_set_by_user:!0})};default:(0,i.t1)(e)}}},48451:(e,t,o)=>{o.d(t,{$H:()=>s,HX:()=>r,LV:()=>a,tY:()=>i});var n=o(77907);(0,n.lazyComponent)(n.deps.notifications,(e=>e.GetNotifiedFor));const i=(0,n.lazyComponent)(n.deps.notifications,(e=>e.TopbarUpdatesMenu)),s=(0,n.lazyComponent)(n.deps.notifications,(e=>e.UpdateSidebar)),r=(0,n.lazyComponent)(n.deps.notifications,(e=>e.NotificationInboxPanel)),a=(0,n.lazyComponent)(n.deps.notifications,(e=>e.MobileInboxPopup))},64719:(e,t,o)=>{o.d(t,{E:()=>z});var n=o(67294),i=o(480),s=o(86628),r=o(24405),a=o(64788),l=o(5257),d=o(56666),c=o(55964),u=o(80875),p=o(30681),g=o(95369),h=o(72126),m=o(9291),b=o(25888),v=o(79698),f=o(39634),S=o(64921),x=o(52275),y=o(31945),w=o(96525),M=o(78140),k=o(32163),j=o(72495),C=o(34700),T=o(87279),P=o(98742),Z=o(95697),I=o(4023),B=o(80444),_=o(30806),F=o(61931),E=o(36591),R=o(97880),O=o(58188),D=o(85893);const L={tasks:{key:"tasks",label:(0,D.jsx)(m.FormattedMessage,{id:"HomeFeaturesMenu.tasks.label",defaultMessage:"My Tasks"})},tips:{key:"tips",label:(0,D.jsx)(m.FormattedMessage,{id:"HomeFeaturesMenu.tips.label",defaultMessage:"Learn"})},templates:{key:"templates",label:(0,D.jsx)(m.FormattedMessage,{id:"HomeFeaturesMenu.templates.label",defaultMessage:"Featured Templates"}),shouldShow:e=>{let{isMobile:t}=e;return!t}}},U=["tasks","tips","templates"];function V(e){let{parent:t}=e;window.__c={n:"HomeFeaturesMenu"};const o=(0,i.O7)(),a=(0,s.VK)((()=>U.map((e=>L[e])).filter((e=>{var t;return(null===(t=e.shouldShow)||void 0===t?void 0:t.call(e,o.device))??!0}))),[o.device]),l=(0,i.MO)(),d=(0,s.VK)((()=>B.default.state.currentSpaceViewStore),[]),c=(0,s.VK)((()=>(null==d?void 0:d.getHomeEnabledFeatures())??{}),[d]),u=(0,n.useCallback)((e=>{d&&O.aG({environment:o,currentSpaceViewStore:d,feature:e,from:"home_more_menu"})}),[d,o]),p=(0,r.yK)((e=>({selectedOptionCheck:{width:l?16:14},icon:{width:20,height:20}})),[l]);let g;g=l?{menuType:T.og.Modal,title:(0,D.jsx)(m.FormattedMessage,{id:"HomeFeaturesMenu.title",defaultMessage:"Experimental features"}),right:(0,D.jsx)(m.FormattedMessage,{defaultMessage:"Done",id:"settingItem.buttonPopup.done.label"}),onClickRight:t.close}:{menuType:T.og.Popup,width:200};const h=[{key:"settings-item-section",render:e=>(0,D.jsx)(j.Z,{...e}),items:a.map((e=>{let{key:t,label:o}=e;return{key:t,action:()=>u(t),render:e=>(0,D.jsx)(x.Z,{...e,title:o,shouldWrapCaption:!0,right:Boolean(c[t])?(0,D.jsx)("div",{style:p.selectedOptionCheck,children:(0,E.e)()}):void 0})}}))}];return(0,D.jsx)(M.Z,{...g,children:(0,D.jsx)(k.Z,{type:k.i.Vertical,sections:h.filter(R.$K),initialFocus:void 0})})}const A=n.memo(V);var N=o(64964),K=o(38755),H=o(34980);function G(e){let{onClose:t}=e;window.__c={n:"OpenOnStartMenu"};const o=(0,i.O7)(),a=(0,s.VK)((()=>(0,H.o)()),[]),{isPhone:l,isElectron:d}=(0,i.Fy)(),c=(0,s.VK)((()=>(0,K.g4)(o,B.default.state.currentSpaceViewStore)),[o]),u=(0,n.useCallback)((e=>{const n=c;O.N({userAction:"userHomeActions.setPersonalHomeAsLandingPage",environment:o,option:e,from:"home_more_menu"}),N.d4({item:{label:(0,D.jsx)(m.FormattedMessage,{defaultMessage:"Updated default landing page",id:"openOnStartMenu.snackbar.updatedDefaultLandingPage"})},undoFunc:()=>O.N({userAction:"userHomeActions.setPersonalHomeAsLandingPage.undo",environment:o,option:n,from:"home_toast_undo_button"})}),t("selectedOption")}),[c,o,t]),p=(0,r.yK)((e=>({selectedOptionCheck:{width:l?16:14},icon:{width:20,height:20}})),[l]);let g;g=l?{menuType:T.og.Modal,title:(0,D.jsx)(m.FormattedMessage,{id:"openOnStartMenuSetting.title",defaultMessage:"Open on start"}),right:(0,D.jsx)(m.FormattedMessage,{defaultMessage:"Done",id:"settingItem.buttonPopup.done.label"}),onClickRight:()=>t("clickedDone")}:{menuType:T.og.Popup,width:250,onClickOutside:()=>t("clickedOutside")};const h=[{key:"settings-item-section",render:e=>(0,D.jsx)(j.Z,{...e}),items:a.map((e=>{let{key:t,label:o,renderIcon:n}=e;return{key:t,action:()=>u(t),render:e=>(0,D.jsx)(x.Z,{...e,title:o,icon:n(p.icon),shouldWrapCaption:!0,right:c===t?(0,D.jsx)("div",{style:p.selectedOptionCheck,children:(0,E.e)()}):void 0})}}))}];return(0,D.jsx)(M.Z,{...g,children:(0,D.jsx)(k.Z,{style:(0,C.X)({noDrag:d}),type:k.i.Vertical,sections:h,initialFocus:void 0})})}const W=n.memo(G);function z(e){window.__c={n:"HomeTopbarActionButtons"};const t=(0,i.O7)(),{device:o}=t,a=(0,i.MO)(),l=(0,s.VK)((()=>e.store.hasCover()),[e.store]),c=(0,n.useCallback)((()=>(0,_.lj)({environment:t})),[t]),u=(0,r.yK)((e=>({dotsIcon:{width:l?12:18,height:l?12:18,fill:e.regularIconColor},moreIconPhone:{width:26},pencilIcon:{width:20,height:20,padding:2},button:a?{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",paddingLeft:8,paddingRight:8,marginRight:2,...l?(0,F.Er)({theme:e,isPhone:a,buttonState:"base",hasCover:l}):{}}:{...(0,C.X)({noDrag:o.isElectron}),display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:4,...l?(0,F.Er)({theme:e,isPhone:a,buttonState:"base",hasCover:l}):{}},buttonHovered:l?(0,F.Er)({theme:e,isPhone:a,buttonState:"hovered"}):{},buttonPressed:l?(0,F.Er)({theme:e,isPhone:a,buttonState:"pressed"}):{},moreButtonStyle:a?{}:{width:250,maxHeight:"80vh"}})),[o,l,a]);return e.isInvalidPage?null:(0,D.jsx)(y.ZP,{popupType:a?y.Z4.SlideUp:y.Z4.Popup,renderOrigin:e=>(0,D.jsx)(S.Z,{style:u.button,hoveredStyle:u.buttonHovered,pressedStyle:u.buttonPressed,mobileFeedback:a,...(0,P.Z)(e,{onClick:c}),children:a?(0,p.I)(u.moreIconPhone):(0,d.o)(u.dotsIcon)}),render:e=>(0,D.jsx)(q,{mainMenuParent:e}),originGap:4,trapFocus:!0,forceInitialInbound:!0,style:u.moreButtonStyle})}function q(e){let{mainMenuParent:t}=e;window.__c={n:"HomeMoreMenu"};const{isPhone:o}=(0,i.Fy)(),n=(0,i.O7)(),d=(0,m.useIntl)(),p=(0,s.VK)((()=>B.default.state.mainEditorCurrentBlockStore),[]),S=(0,s.VK)((()=>(0,Z.QI)("beta_wave_3_only")),[]),C=(0,s.VK)((()=>Boolean(null==p?void 0:p.getCover())),[p]),_=(0,r.yK)((e=>({coverPhotoIcon:{width:18,height:18,padding:2,marginLeft:1,marginRight:1},pageIcon:{width:20,height:20,padding:2},messageIcon:{width:20,height:20,padding:2},chevronRightIcon:{width:14,height:14,fill:e.lightIconColor},eyeIcon:{width:20,height:20}})),[]),F=[{key:"all",render:e=>(0,D.jsx)(j.Z,{...e}),items:h.oA([{key:"changeDefaultPage",render:e=>(0,D.jsx)(w.Z,{...e,stopClickPropagation:!0,popupType:o?y.Z4.SlideUp:y.Z4.Popup,render:e=>(0,D.jsx)(W,{onClose:o=>(e=>{let{immediateParent:o,closeMainParent:n}=e;o.close(),n&&t.close()})({immediateParent:e,closeMainParent:"selectedOption"===o})}),placementToOrigin:I.u.Left,renderOrigin:t=>(0,D.jsx)(x.Z,{...(0,P.Z)(e,t),icon:(0,g.S)(_.pageIcon),right:(0,l.o)(_.chevronRightIcon),title:(0,D.jsx)(m.FormattedMessage,{id:"HomeTopbarActionButtons.changeStartPage",defaultMessage:"Change default start page"})})}),action:()=>{}},{key:"showHideTiles",render:e=>(0,D.jsx)(w.Z,{...e,stopClickPropagation:!0,popupType:o?y.Z4.SlideUp:y.Z4.Popup,render:e=>(0,D.jsx)(A,{parent:e}),placementToOrigin:I.u.Left,renderOrigin:t=>(0,D.jsx)(x.Z,{...(0,P.Z)(e,t),icon:(0,c.N)(_.eyeIcon),right:(0,l.o)(_.chevronRightIcon),title:(0,D.jsx)(m.FormattedMessage,{id:"HomeTopbarActionButtons.showHideTiles",defaultMessage:"Show/hide tiles"})})}),action:()=>{}},{key:"manageCoverPhoto",render:e=>(0,D.jsx)(x.Z,{...e,icon:(0,a.P)(_.coverPhotoIcon),right:(0,l.o)(_.chevronRightIcon),onClick:e=>{if(!p)return;const t=e.currentTarget.getBoundingClientRect();v.j({environment:n,intl:d,store:p,rect:t})},title:C?(0,D.jsx)(m.FormattedMessage,{id:"HomeTopbarActionButtons.changeBackground",defaultMessage:"Change background"}):(0,D.jsx)(m.FormattedMessage,{id:"HomeTopbarActionButtons.addBackground",defaultMessage:"Add background"})}),action:()=>{}},S?{key:"provide-feedback",render:e=>(0,D.jsx)(x.Z,{...e,icon:(0,u.k)(_.messageIcon),title:(0,D.jsx)(m.FormattedMessage,{id:"HomeTopbarActionButtons.provideFeedback",defaultMessage:"Provide feedback"})}),action:()=>{b.V(n,{item:"help_feedback",from:"home_more_menu"}),f.j({environment:n,from:"help_button"})}}:void 0])}];return(0,D.jsx)(M.Z,{menuType:o?T.og.ActionSheet:T.og.Popup,children:(0,D.jsx)(k.Z,{type:k.i.Vertical,sections:F,initialFocus:void 0})})}},81170:(e,t,o)=>{o.d(t,{Z:()=>g});o(67294);var n=o(480),i=o(24405),s=o(84169),r=o(9291),a=o(12714),l=o(73063),d=o(26388),c=o(34700),u=o(94841),p=o(85893);const g=function(){window.__c={n:"TopbarTasksLearnMoreButton"};const e=(0,r.useIntl)(),t=(0,n.O7)(),o=(0,r.defineMessages)({helpTitle:{defaultMessage:"Learn about tasks",id:"myTasks.helpTooltip.title"}}),g=(0,i.yK)((e=>({iconStyle:{width:20,height:20,fill:e.regularIconColor},iconContainer:{width:33,height:28}})),[]);return(0,p.jsx)(d.ZP,{placement:d.ug.Bottom,renderTooltip:t=>e.formatMessage(o.helpTitle),render:n=>(0,p.jsx)(l.Z,{icon:()=>(0,s.m)(g.iconStyle),ariaLabel:e.formatMessage(o.helpTitle),style:{...(0,c.X)({noDrag:t.device.isElectronMac}),...g.iconContainer},onClick:e=>{e.preventDefault(),a.D({environment:t,url:u.h5,targetSelf:!1})},...n})})}},34980:(e,t,o)=>{o.d(t,{o:()=>d});o(57658),o(67294);var n=o(89968),i=o(95369),s=o(56996),r=o(9291),a=o(95697),l=o(85893);function d(){const e=[];return(0,a.QI)("dev_or_beta")&&e.push({key:"personal_home",label:(0,l.jsx)(r.FormattedMessage,{id:"pageOnAppStoreSetting.home.label",defaultMessage:"Home"}),renderIcon:e=>(0,s.z)({width:20,height:20,...e})}),e.push({key:"last_visited_page",label:(0,l.jsx)(r.FormattedMessage,{id:"pageOnAppStoreSetting.lastVisitedPage.label",defaultMessage:"Last visited page"}),renderIcon:e=>(0,n.Y)({width:20,height:20,...e})},{key:"first_page",label:(0,l.jsx)(r.FormattedMessage,{id:"pageOnAppStoreSetting.firstPage.label",defaultMessage:"Top page in sidebar"}),renderIcon:e=>(0,i.S)({width:20,height:20,padding:2,...e})}),e}},57345:(e,t,o)=>{o.d(t,{Cv:()=>j,a6:()=>k,lG:()=>M,qg:()=>P,zd:()=>T});o(67294);var n=o(33728),i=o(68626),s=o(91155),r=o(72141),a=o(4615),l=o(9291),d=o(50906),c=o(47307),u=o(76464),p=o(64964),g=o(19306),h=o(26907),m=o(46654),b=o(18245),v=o(88923),f=o(99332),S=o(29677),x=o(66708),y=o(28578),w=o(85893);function M(e){v.default.state.open?f.Z.setState({...f.Z.state,open:!0}):x.Z.setState({...x.Z.state,open:!0}),d.DB(e,{share_menu_session_id:y.ZP.state.sessionId})}function k(e){v.default.state.open?f.Z.setState({...f.Z.state,open:!1}):x.Z.setState({...x.Z.state,open:!1}),d.Rb(e,{share_menu_session_id:y.ZP.state.sessionId}),y.ZP.reset()}function j(e){const{success:t,inviteTargets:o,requestedUserEmails:n}=e;if(0!==o.length){if(!t||0!==(null==n?void 0:n.length))return t&&n.length>0?n.length===o.length?void p.oV({label:(0,w.jsx)(l.FormattedMessage,{id:"shareMenu.inviteSuccess.snackbarMessage.requestedUsersOnly",defaultMessage:"Sent request to invite {users} to this page",values:{users:C(o)}})}):void p.oV({label:(0,w.jsx)(l.FormattedMessage,{id:"shareMenu.inviteSuccess.snackbarMessage.requestedAndInvitedUsers",defaultMessage:"Invited {users} and requested inviting {numberOfRequestedUsers, plural, one {{numberOfRequestedUsers} guest} other {{numberOfRequestedUsers} guests}}",values:{users:C(o.filter((e=>!(0,S.fZ)(e)&&!(0,S.cl)(e)||!n.includes(e.value.email)))),numberOfRequestedUsers:n.length}})}):void p.oV({label:(0,w.jsx)(l.FormattedMessage,{id:"shareMenu.inviteFailure.snackbarMessage",defaultMessage:"Failed to invite {users}",values:{users:C(o)}})});p.oV({label:(0,w.jsx)(l.FormattedMessage,{id:"shareMenu.inviteSuccess.snackbarMessage",defaultMessage:"Successfully invited {users}",values:{users:C(o)}})})}}function C(e){return(0,g.W)(e.map((e=>"group"===e.type?e.value.name??"group":"invalidUser"===e.type?e.value.text:e.value.email)))}async function T(e){const{inviteTargetsStore:t}=e,o=(0,w.jsx)(l.FormattedMessage,{id:"shareMenu.closeInviteDialog.confirmationMessage",defaultMessage:"Your changes have not been saved. Discard changes?"}),n=(0,w.jsx)(l.FormattedMessage,{id:"shareMenu.closeInviteDialog.confirmationButton.label",defaultMessage:"Yes"}),i=(0,w.jsx)(l.FormattedMessage,{id:"shareMenu.closeInviteDialog.cancelButton.label",defaultMessage:"Cancel"});if(t.state.inviteTargets.length>0){return(await c.confirmUserActionV2({message:o,acceptLabel:n,cancelLabel:i})).accept}return!1}async function P(e){const t=b.default.mark("share_menu.invite_user_lag"),{environment:o,blockStore:l,inviteTargetsStore:d,sudoModeStore:c,onInviteClick:p,onInviteComplete:g,inviteOrigin:v,role:f,emailMessage:S,flowId:x}=e;let y={success:!1,requestedUserEmails:[]};try{y=await async function(e){const{environment:t,blockStore:o,sudoModeStore:i,inviteTargetsStore:s,role:l,inviteOrigin:d,emailMessage:c,onInviteStart:p}=e,g=e.flowId||(0,a.ZP)();if(!(0,r.iC)(l))return{success:!1,requestedUserEmails:[]};const{tokenQuery:b,inviteTargets:v}=s.state;if((0,n.oH)(b.trim())&&0===v.length){const e={type:"newUser",value:{email:b.trim()},source:"email"};h.H({target:e,inviteTargetsStore:s})||s.setState({inviteTargets:[...s.state.inviteTargets,e],tokenQuery:""})}const f=m.mU(o,h.B({inviteTargetsStore:s}));null==p||p();const S=await u.n_({environment:t,store:o,sudoModeStore:i,inviteTargets:f,inviteRole:l,isOnboarding:!1,invite:{inviteFlowId:g,inviteMessage:c,inviteOrigin:d}});return{success:S.success,requestedUserEmails:S.success?Object.keys(S.requestedUsers):[]}}({environment:o,blockStore:l,sudoModeStore:c,inviteTargetsStore:d,role:f,emailMessage:S,inviteOrigin:v,onInviteStart:p,flowId:x})}catch(w){i.log({level:"error",from:"shareMenuActions",type:"handleInviteClick",error:(0,s.Ui)(w)})}finally{null==g||g(y.success,y.requestedUserEmails)}b.default.measure(t,{environment:o})}},61436:(e,t,o)=>{o.d(t,{Z:()=>r});var n=o(49085),i=o(47839);class s extends n.default{getInitialState(){return{isFullScreen:!1}}constructor(){super(),this.updateFromElectronState=()=>{const e=i.fullscreen.get();void 0!==e&&this.setState({isFullScreen:e})},i.fullscreen.addListener(this.updateFromElectronState),this.updateFromElectronState()}}const r=new s},85834:(e,t,o)=>{o.d(t,{TG:()=>r,ZP:()=>l,uq:()=>s});var n=o(49085),i=o(4615);let s=function(e){return e.workspace_member="workspace_member",e.request_workspace_member="request_workspace_member",e.page_guest="page_guest",e.closed="closed",e}({}),r=function(e){return e[e.closed=0]="closed",e[e.share_page=1]="share_page",e[e.share_workspace=2]="share_workspace",e[e.request_workspace=3]="request_workspace",e}({});class a extends n.default{getInitialState(){return{inviteStage:r.closed,selection:s.workspace_member,order:[s.workspace_member,s.page_guest],invitedUsers:[],inviteTargets:[],invitedEmailToUserIdMap:{},flowId:(0,i.ZP)()}}startWorkspaceInvite(){this.setState({...this.state,inviteStage:r.share_workspace,order:[s.workspace_member,s.page_guest],selection:s.workspace_member})}startRequestMembership(){this.setState({...this.state,inviteStage:r.request_workspace,order:[s.request_workspace_member,s.page_guest],selection:s.request_workspace_member})}hasGuests(){return this.state.invitedUsers.some((e=>e.isGuest))}getGuestEmails(){return this.state.invitedUsers.filter((e=>e.isGuest)).map((e=>e.email))}}const l=a},14542:(e,t,o)=>{o.d(t,{EP:()=>r,LU:()=>a,NS:()=>s,SS:()=>i,ZP:()=>d});var n=o(49085);const i="loadingLocalImage",s="uploading",r="downloading",a="loaded";class l extends n.default{getInitialState(){return{loadingMode:a}}}const d=l},55899:(e,t,o)=>{o.d(t,{KU:()=>s,ZP:()=>a,fZ:()=>i});var n=o(49085);function i(e){return"existingUser"===e.type}function s(e){return"newUser"===e.type&&"email"!==e.source}class r extends n.default{getInitialState(){return{tokenQuery:"",inviteTargets:[]}}}const a=r},92547:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(49085);class i extends n.default{getInitialState(){return{justUnlocked:!1}}}const s=i},1903:(e,t,o)=>{o.d(t,{Z:()=>r});var n=o(49085),i=o(21202);class s extends n.default{getInitialState(){return{modalOpen:!1,tokenQuery:"",inviteTargets:[],inviteRole:"editor",isInviteTargetsEmpty:!0,table:i.iU,flowId:void 0,inputFocus:"invitee",emailMessage:""}}}const r=s},96809:(e,t,o)=>{o.d(t,{Z:()=>n});const n=new(o(14542).ZP)},8675:(e,t,o)=>{o.d(t,{Z:()=>l});var n=o(49085),i=o(80444),s=o(77080),r=o(68373);class a extends n.default{getInitialState(){return{changePermissionsEnabled:!1,privatePageStore:void 0,loading:!1,error:void 0}}shouldSaveTransactionWithSudoMode(e){const t=e===this.state.privatePageStore,o=s.default.checkGate("enable_get_private_page_info_endpoint"),n=this.doesUserAlreadyHaveEditorAccessOnBlock(e.id);return t&&o&&this.state.changePermissionsEnabled&&!n}shouldUserHaveAccessToPrivatePageBlock(){var e,t;const o=null===(e=i.default.state.currentSpaceStore)||void 0===e?void 0:e.canAdmin(),n="enterprise"===(null===(t=i.default.state.currentSpaceStore)||void 0===t?void 0:t.getSubscriptionTier());return this.state.privatePageStore&&o&&n}doesUserAlreadyHaveEditorAccessOnBlock(e){const t=i.default.state.currentSpaceStore;if(!t)return!1;return r.G.createChildStore(t,{table:"block",id:e}).canAdmin()}}const l=a},69150:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(49085);class i extends n.default{getInitialState(){return{isHovered:!1}}}const s=new i},52878:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(49085),i=o(85834),s=o(1903);class r extends n.default{getInitialState(){return{permissionsInviteStore:new s.Z,contextualInviteStore:new i.ZP}}get stage(){return this.state.contextualInviteStore.state.inviteStage}}const a=r},21884:(e,t,o)=>{o.d(t,{E:()=>n});const n=o(49085).default.createValue({showConvertTooltip:!1,forceShow:!1})},96071:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(49085);class i extends n.default{getInitialState(){return{open:!1}}}const s=i}}]);