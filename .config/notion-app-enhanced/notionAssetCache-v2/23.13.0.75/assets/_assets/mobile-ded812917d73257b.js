"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[5008],{26797:(e,t,i)=>{i.d(t,{Fv:()=>I,JN:()=>M,QG:()=>P,cQ:()=>w,f$:()=>k,fX:()=>T,td:()=>C,xD:()=>A});i(57658);var o=i(30120),n=i(80951),s=i(40506),r=i(53877),a=i(42875),l=i(72126),c=i(6287),d=i(97880),u=i(10906),h=i(95802),m=i(15723),p=i(17746),g=i(68373),b=i(8406),f=i(49865),y=i(75134),v=i(42239),S=i(19785),x=i(9953);function M(e){const{environment:t,droppedStores:i,duplicate:l,calendarBy:d,transaction:h,collectionContextStore:m}=e,p=o.ou.fromMillis(e.startOfDay);let g=!0;for(const o of i){const t=e.collectionStore?e.collectionStore:(0,u.Bm)({store:o,collectionContextStore:m});if(o.getParentTable()===c.v||!t){g=!1;break}S.zw({childStore:o,parentStore:t,transaction:h})||(g=!1)}const y=v.LQ({environment:t,droppedStores:i,duplicate:l,duplicateUseCrdt:!1,transaction:h,resolveTemplateVariables:!1});for(const o of y){const i=e.collectionStore?e.collectionStore:(0,u.Bm)({store:o,collectionContextStore:m}),l=o.getPropertyStore(d),c=n.Gl(l.getValue())||r.Lg((0,a.r)()),y=r.c$(c,(0,a.r)()),v=p.toFormat(r.Iq);let S;if("date"===y.type||"datetime"===y.type)S={...y,start_date:v};else{const e=r.NK(y,(0,a.r)());if(!e.end)return;const t={...y,start_date:v},i=r.NK(t,(0,a.r)()).start.diff(e.start,"days"),o=e.end.plus(i).toFormat(r.Iq);S={...y,start_date:v,end_date:o}}const x=r.c$(S,s.yw(c)||(0,a.r)());i&&f.mp({environment:t,store:o,collectionStore:i,collectionContextStore:m,shouldCoerce:!0,groupsPointer:[],transaction:h,alreadyMovedToCollection:g}),A({environment:t,type:"dateValue",propertyId:d,store:o,transaction:h,dateValue:x}),b.rv({environment:t,collectionContextStore:m,block_id:o.id,property:d,property_type:"date",from:"calendar"})}}function k(e){const{calendarStore:t,direction:i,target:o}=e;t.setState({...t.state,isDragging:!0,target:o,direction:i})}function C(e){const{calendarStore:t,x:i,y:c,calendarBy:d}=e,u=t.state;if(u.isDragging){const e=n.Gl(u.target.getPropertyStore(d).getValue());if(!e)return;const g=r.c$(e,(0,a.r)()),b=u.temporaryValue||e,f=r.c$(b,(0,a.r)()),y=[];u.dayStoreMap.forEach(((e,t)=>{y.push({store:e,timestamp:t})}));const v=y.find((e=>{let{store:t}=e;const o=h.C.getRectFromStore(t);return Boolean(o&&m.uh(o,i,c))}));let S;if(v){const e=o.ou.fromMillis(v.timestamp),t=e.endOf("day"),i=e.toFormat(r.Iq);if(g){const n=r.NK(g,(0,a.r)());if(u.direction===p.t.Left)if(o.Xp.fromDateTimes(e,t).contains(n.start))S=g;else{let e;e="datetimerange"===g.type||"daterange"===g.type?{...g,start_date:i,end_date:g.end_date}:"datetime"===g.type?{type:"datetimerange",start_date:i,start_time:g.start_time,end_date:g.start_date,end_time:g.start_time,time_zone:g.time_zone,reminder:g.reminder}:{type:"daterange",start_date:i,end_date:g.start_date,reminder:g.reminder};const t=r.NK(e,(0,a.r)());S=!n.end&&t.start>n.start||n.end&&t.start>n.end?f:e}else if(n.end?o.Xp.fromDateTimes(e,t).contains(n.end):o.Xp.fromDateTimes(e,t).contains(n.start))S=g;else{let e;e="date"===g.type?{...g,type:"daterange",end_date:i}:"datetime"===g.type?{...g,type:"datetimerange",end_date:i,end_time:"00:00"}:{...g,end_date:i};const t=r.NK(e,(0,a.r)());S=t.end&&t.end<t.start?f:e}}}if(S&&!l.Xy(f,S)){const e=r.c$(S,s.yw(b)||(0,a.r)());t.setState({...u,temporaryValue:e})}}}function T(e){const{environment:t,calendarStore:i,calendarBy:o,transaction:n}=e,s=i.state;s.isDragging&&s.temporaryValue&&(A({type:"dateValue",environment:t,dateValue:s.temporaryValue,propertyId:o,store:s.target,transaction:n}),i.setState({...i.state,isDragging:!1}))}function w(e){const{calendarStore:t}=e,i=t.state;i.isDragging&&t.setState({...i,isDragging:!1})}function I(e){const{environment:t,store:i,collectionStore:s,collectionContextStore:l,startDayOfWeek:c,transaction:d}=e,u=l.dateRangeStart.state,h=(0,a.r)(),m=l.normalizedQueryStore.state;if(!m||!m.calendar_by)return;const p=m.calendar_by,g=r.gQ(u,c,h),b=g.startOf("month"),y=g.endOf("month"),v=o.ou.now().startOf("day");let S;return S=o.Xp.fromDateTimes(b,y).contains(v)?r.hT(v.valueOf(),h):r.hT(r.em(u,c,h).valueOf(),h),x.sW({store:i.getPropertiesStore(),data:{[p]:n.d7(S)},transaction:d}),f.mp({environment:t,store:i,collectionStore:s,collectionContextStore:l,shouldCoerce:!0,groupsPointer:[],transaction:d}),i}function A(e){const{environment:t,store:i,propertyId:o,transaction:s}=e;let l;"timestamp"===e.type?l=r.hT(e.timestampMs.valueOf(),(0,a.r)()):"dateValue"===e.type?l=e.dateValue:(0,d.t1)(e);const c=i.getPropertyValue(o),u=n.d7(l);x.sW({store:i.getPropertiesStore(),data:{[o]:u},transaction:s}),y.H({environment:t,store:i,dateProperty:{id:o,oldValue:c,newValue:u}})}function P(e){const{environment:t,collectionStore:i,calendarBy:o,store:n,insertStores:s,collectionContextStore:r,transaction:a}=e,l=n.getPropertyStore(o).getValue();for(const c of s)f.mp({environment:t,store:c,collectionStore:i,collectionContextStore:r,shouldCoerce:!0,groupsPointer:[],transaction:a}),x.sO({store:c.getPropertyStore(o),value:l,transaction:a});return s.map((e=>g.G.createChildStore(i,e.pointer)))}},59389:(e,t,i)=>{i.d(t,{T_:()=>b,Ud:()=>f,eV:()=>g});var o=i(1302),n=i(45953),s=i(42),r=i(58202),a=i(952),l=i(41433),c=i(96802),d=i(94419),u=i(9953),h=i(24677),m=i(98104),p=i(68422);function g(e){const{environment:t,store:i,transaction:n,preventTextSelection:s,onTextSelection:r}=e,l=i.useCrdt(),c=u.j4({environment:t,type:"text",inMemoryRecordCache:i.inMemoryRecordCache,transaction:n,spaceId:i.pointer.spaceId,useCrdt:l}),p=d.R3({parent:i.getContentStore(),append:c,transaction:n}).child;return s||o.default.afterNextFlush((()=>{h.eP({environment:t,store:p}),m.N_({store:p.getBlockTitleStore()}),null==r||r()})),a.W(t,{from:"template_picker",type:"text",creating_block_id:c.id}),p}function b(e){const{environment:t,store:i,transaction:o}=e;c.is({store:i,transaction:o}),g({environment:t,store:i,transaction:o})}function f(e){var t;const{environment:i,store:c,viewType:d,transaction:h}=e,m=null===(t=c.getBlockTitleStore())||void 0===t?void 0:t.getValue();l.ZI({environment:i,sourceBlockId:"root",targetBlockPointer:c.pointer,sourceBlockSubtree:(0,n.R3)((0,s.iC)({isInline:!1,viewType:d})),targetRecordCache:c.inMemoryRecordCache,transaction:h,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,useCrdt:c.useCrdt()}),p.vs({environment:i,block:c,blockType:"collection_view_page",transaction:h}),m&&u.sO({store:c.getBlockTitleStore(),value:m,transaction:h}),o.default.afterNextFlush((()=>{const e=r.R.findCollectionViewBlockFromStore(c);null==e||e.handleCreated()})),a.W(i,{from:"template_picker",type:"collection_view_page",creating_block_id:c.id})}},87636:(e,t,i)=>{i.d(t,{Z:()=>b});var o=i(67294),n=i(13991),s=i(480),r=i(24405),a=i(22491),l=i(97880),c=i(82990),d=i(17311),u=i(23063),h=i(64921),m=i(26388),p=i(85893);function g(e){window.__c={n:"ActionMenuGroupButton"};const{button:t,isLast:i}=e,n=(0,r.yK)((e=>({button:{display:"flex",alignItems:"center",padding:"4px 6px",fontWeight:c.Z.fontWeight.medium,borderRight:`1px solid ${e.regularDividerColor}`,color:e.actionMenuButtonTextColor,fill:e.actionMenuButtonTextColor},buttonLast:{borderRight:"none"},buttonHovered:{background:e.whiteButtonHoveredBackground},buttonPressed:{background:e.whiteButtonPressedBackground}})),[]);return o.cloneElement(t,{...(0,a.iv)(t.props.style,n.button,i&&n.buttonLast),hoveredStyle:(0,a.iv)(n.buttonHovered,i&&n.buttonLast).style,pressedStyle:n.buttonPressed})}const b=function(e){let{children:t,isVisible:i,position:b,style:f}=e;window.__c={n:"ActionMenuGroup"};const y=(0,s.O7)(),v=(0,r.yK)((e=>({container:{color:e.actionMenuButtonTextColor,fill:e.actionMenuButtonTextColor,fontSize:12,background:e.whiteButtonBackground,boxShadow:e.lightBoxShadow,display:"flex",whiteSpace:"nowrap",borderRadius:d.Z.borderRadius,maxWidth:"calc(100% - 16px)",minHeight:24,overflow:"hidden",pointerEvents:y.device.isMobile?"auto":"none",opacity:y.device.isMobile?1:0,fontFamily:c.Z.getCompositeFontFamily(n.SP).sans,position:"absolute",right:d.Z.horizontal.small,bottom:d.Z.vertical.small,zIndex:2},containerHover:{pointerEvents:"auto",opacity:1},containerTop:{top:d.Z.vertical.small,bottom:void 0}})),[y]),S=o.Children.toArray(t).filter(l.$K),x=S.length;return(0,p.jsx)(u.Z,{isVisible:!0,animationStyle:{opacity:i?1:0},render:()=>(0,p.jsx)("div",{...(0,a.iv)(v.container,f,i&&v.containerHover,"top"===b&&v.containerTop),children:S.map(((e,t)=>{const i=t===x-1;if(e&&"object"==typeof e&&"type"in e){if(e.type===m.ZP&&o.isValidElement(e))return o.cloneElement(e,{render:(t,o)=>{const n=e.props.render(t,o);return(0,p.jsx)(g,{isLast:i,button:n},e.key)}});if(e.type===h.Z&&o.isValidElement(e))return(0,p.jsx)(g,{isLast:i,button:e},e.key)}}))})})}},71638:(e,t,i)=>{i.d(t,{Z:()=>v});var o=i(67294),n=i(83355),s=i(1302),r=i(86628),a=i(49085),l=i(72126),c=i(71644),d=i(75330),u=i(77080),h=i(28155),m=i(40107);function p(e){const{reducerId:t,localReducerResult:i,remoteReducerResult:o,collectionContextStore:n,reducer:s}=e,r=n.reducers.state,a=n.remoteResult.state;if(n.isClientModeEnabled.state)return i;if("aggregation"===s.type||"groups"===s.type){if(null!=a&&a.reducerResults[t])return a.reducerResults[t];return Boolean(a&&"reducer"===a.type&&l.sE(a.reducerResults,((e,t)=>{const i=r[t];return Boolean(i&&"results"===i.reducer.type&&!i.reducer.searchQuery&&"results"===e.type&&e.hasMore&&l.Xy(s.filter,i.reducer.filter))})))?i:o}if("results"===s.type){var c;const e=n.wasCreatedThisSession.state,s=Boolean(a&&"reducer"===a.type&&a.reducerResults[t]),r=(0,h.nx)(null===(c=n.collectionViewStore())||void 0===c?void 0:c.getCollectionSource());if((s||e)&&!r&&i&&"results"===i.type){return{...i,hasMore:o&&"results"===o.type?o.hasMore:i.hasMore}}return o}}var g=i(85893);class b extends n.Z{constructor(){super(...arguments),this.reducerId=this.props.id,this.instanceId=(0,c.ZP)(),this.localResultStoreChangeIsQueued=!1,this.storeTypes={resultStore:a.default.createClass(void 0)},this.handleLocalResultStoreChange=()=>{this.localResultStoreChangeIsQueued||(this.localResultStoreChangeIsQueued=!0,s.default.afterNextFlush(this.dequeueLocalResultStoreChange))},this.dequeueLocalResultStoreChange=()=>{const{resultStore:e}=this.stores;if(this.localResultStoreChangeIsQueued=!1,!this.componentIsMounted)return;const t=this.getCurrentResult();l.Xy(t,e.state)||e.setState(t)}}UNSAFE_willMount(e){const{collectionContextStore:t}=e;t.remoteResult.addListener(this.handleLocalResultStoreChange),t.localResultStore.addListener(this.handleLocalResultStoreChange),this.updateReducer(e),this.handleLocalResultStoreChange()}UNSAFE_willUpdate(e){this.updateReducer(e)}willUnmount(){super.willUnmount();const{collectionContextStore:e,groupsPointer:t}=this.props;d.$D({reducerId:this.reducerId,instanceId:this.instanceId,reducer:void 0,collectionContextStore:e,groupsPointer:t}),e.remoteResult.removeListener(this.handleLocalResultStoreChange),e.localResultStore.removeListener(this.handleLocalResultStoreChange)}renderComponent(){const{render:e}=this.props;if(e)return e(this.stores.resultStore)}updateReducer(e){const{reducer:t,collectionContextStore:i,groupsPointer:o}=e;d.$D({reducerId:this.reducerId,instanceId:this.instanceId,reducer:t,collectionContextStore:i,groupsPointer:o})}getCurrentResult(){const{reducer:e,collectionContextStore:t}=this.props,i=t.localResultStore.state,o=t.remoteResult.state,n=i&&"reducer"===i.type?i.reducerResults[this.reducerId]:void 0,s=o&&"reducer"===o.type?o.reducerResults[this.reducerId]:void 0;return p({reducerId:this.reducerId,localReducerResult:n,remoteReducerResult:s,reducer:e,collectionContextStore:t})}}function f(e){window.__c={n:"MigratedCollectionReducerRequest"};const{resultStore:t,render:i,...n}=e,c=function(e){const{id:t,reducer:i,collectionContextStore:n,groupsPointer:a}=e,c=(0,r.VK)((()=>a),[a],{useDeepEqual:!0}),u=(0,r.VK)((()=>i),[i],{useDeepEqual:!0}),h=(0,o.useRef)(!1),g=(0,m.S)(),[b,f]=(0,o.useReducer)(((e,t)=>l.Xy(e,t)?e:t),void 0),y=(0,o.useCallback)((()=>{const e=n.localResultStore.state,i=n.remoteResult.state,o=e&&"reducer"===e.type?e.reducerResults[t]:void 0,s=i&&"reducer"===i.type?i.reducerResults[t]:void 0;return p({reducerId:t,collectionContextStore:n,reducer:u,localReducerResult:o,remoteReducerResult:s})}),[n,u,t]),v=(0,o.useCallback)((()=>{h.current=!1,g()||f(y())}),[y,g]),S=(0,o.useCallback)((()=>{h.current||(h.current=!0,s.default.afterNextFlush(v))}),[v]);return(0,o.useEffect)((()=>(n.remoteResult.addListener(S),n.localResultStore.addListener(S),()=>{n.remoteResult.removeListener(S),n.localResultStore.removeListener(S)})),[n,S]),(0,o.useEffect)((()=>(d.$D({reducerId:t,instanceId:void 0,reducer:u,collectionContextStore:n,groupsPointer:c}),()=>{d.$D({reducerId:t,instanceId:void 0,reducer:void 0,collectionContextStore:n,groupsPointer:c})})),[n,c,u,t]),(0,o.useEffect)((()=>{S()}),[]),b}(n),u=(0,r.qz)(t,a.default.createClass(void 0));(0,o.useEffect)((()=>{u.setState(c)}),[c,u]);const h=(0,r.VK)((()=>i?i(u):null),[i,u]);return(0,g.jsx)(g.Fragment,{children:h})}b.displayName="CollectionReducerRequest";const y=o.memo(f);const v=function(e){window.__c={n:"CollectionReducerRequest"};const t=(0,r.VK)((()=>u.default.checkGate("use_collection_reducer_request_hook")),[]),[i]=(0,o.useState)(t);return i?(0,g.jsx)(y,{...e}):(0,g.jsx)(b,{...e})}},11335:(e,t,i)=>{i.d(t,{Z:()=>m});i(67294);var o=i(86628),n=i(24405),s=i(80951),r=i(19255),a=i(32566),l=i(21202),c=i(97880),d=i(68373),u=i(14200),h=i(85893);function m(e){const t=e.propertySchema.type;switch(t){case"title":case"text":return(0,h.jsx)(p,{...e});case"relation":return(0,h.jsx)(g,{propertySchema:e.propertySchema,beforeValue:e.beforeValue,afterValue:e.afterValue,rootStore:e.rootStore});case"checkbox":case"number":case"person":case"file":case"url":case"email":case"phone_number":case"created_time":case"created_by":case"last_edited_time":case"last_edited_by":case"last_visited_time":case"formula":case"rollup":case"select":case"multi_select":case"date":case"button":case"status":case"auto_increment_id":case"location":case"verification":return(0,h.jsx)(b,{...e});default:(0,c.t1)(t)}}function p(e){const t={value:r.Mg({before:e.beforeValue.value,after:e.afterValue.value}),spaceId:e.beforeValue.spaceId};return(0,h.jsx)(u.Z,{value:t,propertySchema:e.propertySchema,rootStore:e.rootStore})}function g(e){window.__c={n:"RelationPropertyDiff"};const{beforeValue:t,afterValue:i,propertySchema:n,rootStore:r}=e,a=(0,o.VK)((()=>s.NT({beforeValue:t.value,afterValue:i.value,propertySchema:n,getRecordModel:r.getRecordModel,getBlockTitle:e=>d.G.createChildStore(r,{table:l.iU,id:e.id}).getPropertyValue("title")})),[t,i,n,r]);return(0,h.jsx)(u.Z,{value:{value:a,spaceId:t.spaceId},propertySchema:{type:"title",name:"Title"},rootStore:r})}function b(e){window.__c={n:"ArrowPropertyDiff"};const t=(0,n.yK)((()=>({arrowDiffWrap:{display:"inline-flex",alignItems:"center"}})),[]);return(0,h.jsxs)("div",{style:t.arrowDiffWrap,children:[(0,h.jsx)(u.Z,{value:e.beforeValue,propertySchema:e.propertySchema,rootStore:e.rootStore}),(0,h.jsx)(f,{}),(0,h.jsx)(u.Z,{value:e.afterValue,propertySchema:e.propertySchema,rootStore:e.rootStore})]})}function f(){window.__c={n:"Arrow"};const e=(0,n.yK)((e=>({container:{padding:"0px 8px"},icon:{width:15,height:15,fill:e.mediumIconColor}})),[]);return(0,h.jsx)("div",{style:e.container,children:(0,a.k)(e.icon)})}},52187:(e,t,i)=>{i.d(t,{Z:()=>v});i(67294);var o=i(480),n=i(86628),s=i(24405),r=i(78197),a=i(9291),l=i(1357),c=i(87279),d=i(88632),u=i(53610),h=i(35057),m=i(64921),p=i(31945),g=i(78140),b=(i(64369),i(27386),i(14694)),f=i(44625),y=i(85893);const v=function(e){let{store:t}=e;window.__c={n:"MemberSettingsButton"};const i=(0,o.O7)(),s=(0,n.VK)((()=>(0,h.Mk)()),[]),r=(0,n.VK)((()=>t.isDefined()),[t]),{mobileNative:l}=i,v=(0,n.VK)((()=>(null==l?void 0:l.supportsNativeHomeOnPhone())||!1),[l]),M=(0,n.VK)((()=>d.Z.state.online),[]);return s&&r?(0,y.jsx)(p.ZP,{buttonPopupStore:u.Z,popupType:p.Z4.SlideUp,hidesMobileNativeBottomBar:v,preventSlideUpTransition:v,renderOrigin:e=>(0,y.jsx)(m.Z,{mobileFeedback:!0,...e,children:(0,y.jsx)(b.Z,{left:(0,y.jsx)(S,{}),disableMobileBorder:!0,children:(0,y.jsx)(a.FormattedMessage,{defaultMessage:"Members",id:"memberSettingsButton.mobileSidebar.label"})})}),render:()=>{if(M){const e={menuType:c.og.Modal,title:(0,y.jsx)(a.FormattedMessage,{defaultMessage:"Members",id:"memberSettingsButton.mobileMemberSettings.title"}),right:(0,y.jsx)(a.FormattedMessage,{defaultMessage:"Done",id:"memberSettingsButton.rightActionButton.done"}),onClickRight:()=>x(i),onCancel:()=>x(i)};return(0,y.jsx)(g.Z,{...e,children:(0,y.jsx)(f.Z,{store:t,isMobile:!0})})}}}):null};function S(){window.__c={n:"IconComponent"};const e=(0,s.Fg)();return(0,r.S)({fill:e.mediumIconColor,width:16})}function x(e){const{mobileNative:t}=e,i=()=>{u.Z.setState({open:!1})};null!=t&&t.supportsNativeHomeOnPhone()?l.d(e,i):i()}},44299:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Q});i(67294);var o=i(83355),n=i(13991),s=i(480),r=i(86628),a=i(24405),l=i(41432),c=i(42853),d=i(69634),u=i(5377),h=i(55617),m=i(43410),p=i(1413),g=i(38491),b=i(45137),f=i(73426),y=i(63048),v=i(37612),S=i(55863),x=i(72126),M=i(82990),k=i(9291),C=i(83249),T=i(44886),w=i(52423),I=i(24677),A=i(98104),P=i(75179),j=i(51783),B=i(52533),R=i(68056),Z=i(89224),_=i(5162),F=i(17903),N=i(72653),V=i(69454),D=i(27724),O=i(24666),L=i(64921),E=i(53437),q=i(64131),U=i(82945),K=i(85394),W=i(40464),H=i(32404),G=i(73383),z=i(85893);const $={width:34,justifyContent:"center"};class Y extends o.Z{constructor(){super(...arguments),this.scrollerDiv=void 0,this.currentlyShownTimer=void 0,this.previouslyShownOnNative=!1,this.handleScrollerRef=e=>{e&&(this.scrollerDiv=e)},this.handleActionsScrollDebounced=x.Ds((()=>{return e=this.environment,void C.FG(e);var e}),500),this.listenForPositionChanges=this.createComputedStore((()=>{const e=O.default.state;if("editing"===e.mode){const t=e.multiSelection.end;return{scrollTop:F.Z.state.scrollTop,editing:!0,store:t.store.id,selection:t}}return{scrollTop:F.Z.state.scrollTop,editing:!1}})),this.renderStore=this.createComputedStore((()=>{var e;return j.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state)})),this.shouldShowTextActions=this.createComputedStore((()=>j.oQ(this.props.stores.ignoreSelectionAreaStore,this.environment.TextSelectionCompositionStore))),this.canTriggerBlockActions=this.createComputedStore((()=>!this.shouldShowTextActions.state&&j.Bo(this.pageContext&&this.pageContext.publicEditModeStore.state))),this.canTriggerTextActions=this.createComputedStore((()=>j.eQ(this.pageContext&&this.pageContext.publicEditModeStore.state,this.props.currentBlockStore))),this.hasMultiBlockSelection=this.createComputedStore((()=>{const e=O.default.state;return"editing"===e.mode&&!(0,R.qS)(e.multiSelection)}))}UNSAFE_willMountOrUpdate(){const{device:e}=this.environment,t=this.renderStore.state.shouldShow;if(e.isMobileBrowser){const e=this.props.stores.store.state.isOpen;t?e?void 0!==this.currentlyShownTimer&&(window.clearTimeout(this.currentlyShownTimer),this.currentlyShownTimer=void 0):(this.props.stores.store.setState({...this.props.stores.store.state,isOpen:!0}),this.scrollerDiv&&(this.scrollerDiv.scrollLeft=0)):e&&void 0===this.currentlyShownTimer&&(this.currentlyShownTimer=window.setTimeout((()=>{this.currentlyShownTimer=void 0,this.props.stores.store.setState({...this.props.stores.store.state,isOpen:!1})}),200))}else t!==this.previouslyShownOnNative&&(this.previouslyShownOnNative=t,this.scrollerDiv&&(this.scrollerDiv.scrollLeft=0))}renderComponent(){const{device:e,WindowSizeStore:t}=this.environment,i=this.isOpen(),o=e.isMobile&&N.Z.state;if(this.props.position===B.nd.Bottom){let e=0;return(0,_.Y)("supportsFixedSizeWebView")?e=V.Z.estimatedNativeWebBottomOverlap():o&&(e=t.getSafePaddingBottomCSS(K.MOBILE_BOTTOM_BAR_HEIGHT)),(0,z.jsx)("div",{style:{position:"absolute",bottom:e,left:0,height:42,width:"100%",pointerEvents:i?"auto":"none",opacity:i?1:0,transform:i?"translateY(0)":"translateY(42px)",transition:"opacity 120ms ease-out, transform 120ms ease-out"},children:this.renderActionButtons()})}{this.listenForPositionChanges.state;const e=this.props.stores.ignoreSelectionAreaStore.state.savedTextSelectionRect||Z.getSelectionRect();if(!e)return;const t=document.body.getBoundingClientRect(),o={...e,left:10,top:e.top+10-t.top},{device:n}=this.environment;return(0,z.jsx)(E.ZP,{popupType:n.isMobileNative?E.ZP.PopupType.SlideUp:E.ZP.PopupType.Popup,open:i,preventBlockRenderQueueOnEnter:!0,placementToOrigin:E.ZP.Placement.Bottom,alignmentToOrigin:E.ZP.Alignment.Start,originRect:o,disableMouseCapture:!0,keepFocus:!0,render:()=>(0,z.jsx)("div",{style:{height:42,width:"calc(80wv)",borderRadius:4,overflow:"hidden"},children:this.renderActionButtons()})})}}renderActions(){return j.Tz({environment:this.environment,store:this.props.currentBlockStore})?(0,z.jsx)(ye,{stores:this.props.stores}):this.shouldShowTextActions.state?this.renderTextActions():this.renderBlockActions()}renderActionButtons(){return(0,z.jsxs)("div",{style:he(this.props.position,this.environment,this.theme),children:[this.renderActions(),(0,z.jsx)(L.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...be(this.environment.device.isSmallPhone,this.theme),borderLeft:ue(this.theme),borderRight:"none"},onClick:e=>{return t=this.props.stores,i=this.environment,I.ZH(i),t.store.setState({...t.store.state,isInsertOpen:!1}),de("hide_keyboard",i),void A.sD();var t,i},children:ae})]})}renderBlockActions(){const e=this.canTriggerBlockActions.state;let t=!1,i=!1;const o=this.props.currentBlockStore.getType();if(o){const e=this.props.currentBlockStore.getFormat();(0,l._T)(o,e)||(t=!0),(0,l.lQ)(o)||(i=!0)}const{device:n}=this.environment;return(0,z.jsxs)("div",{ref:this.handleScrollerRef,style:ce(),onScroll:this.handleActionsScrollDebounced,children:[(0,z.jsxs)(L.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...be(this.environment.device.isSmallPhone,this.theme),...!n.isSmallPhone&&{paddingLeft:12,paddingRight:12}},onClick:e=>{return t=this.props.stores,i=this.environment,t.store.setState({...t.store.state,isInsertOpen:!0}),void de("insert",i);var t,i},disabled:!e,children:[re,(0,z.jsx)(me,{})]}),(0,z.jsxs)(L.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...be(this.environment.device.isSmallPhone,this.theme),fontWeight:M.Z.fontWeight.medium},onClick:e=>{this.props.stores.store.setState({...this.props.stores.store.state,isTurnIntoOpen:!0}),de("turn_into",this.environment)},disabled:!e,children:[(0,z.jsx)(k.FormattedMessage,{defaultMessage:"Turn into",id:"mobileActionBar.turnInto.buttonTitle"}),(0,z.jsx)(me,{})]}),(0,z.jsx)(P.Z,{capture:!0,render:e=>(0,z.jsx)(L.Z,{mobileFeedback:!0,disabledFeedback:!0,...e,style:be(this.environment.device.isSmallPhone,this.theme),onClick:e=>{return t=this.environment,void j.Z3(t);var t},disabled:!i,children:(0,z.jsx)("span",{style:{fontSize:19,lineHeight:1,fontWeight:M.Z.fontWeight.medium,marginBottom:n.isAndroid?4:0},children:"@"})})}),(0,z.jsx)(L.Z,{mobileFeedback:!0,disabledFeedback:!0,style:be(this.environment.device.isSmallPhone,this.theme),onClick:e=>{return t=this.environment,void j.ol(t,!1,"mobile_action_bar");var t},disabled:!t,children:se}),(0,z.jsx)(L.Z,{mobileFeedback:!0,disabledFeedback:!0,style:be(this.environment.device.isSmallPhone,this.theme),onClick:e=>{return t=this.environment,void j.vs(t);var t},disabled:!e,children:le}),(0,z.jsx)(L.Z,{mobileFeedback:!0,disabledFeedback:!0,style:be(this.environment.device.isSmallPhone,this.theme),onClick:e=>{return t=this.environment,void j.fn(t);var t},disabled:!e,children:ne}),this.renderBlockMovementActions(),(0,z.jsx)(fe,{}),(0,z.jsxs)(L.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...be(this.environment.device.isSmallPhone,this.theme),fontWeight:M.Z.fontWeight.medium},onClick:e=>{this.props.stores.store.setState({...this.props.stores.store.state,isColorOpen:!0}),de("color",this.environment)},disabled:!e,children:[(0,z.jsx)(k.FormattedMessage,{defaultMessage:"Color",id:"mobileActionBar.color.buttonTitle"}),(0,z.jsx)(me,{})]}),(0,z.jsxs)(L.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...be(this.environment.device.isSmallPhone,this.theme),fontWeight:M.Z.fontWeight.medium},onClick:e=>function(e,t){j.w1(t,e.clientX,e.clientY)}(e,this.environment),disabled:!e,children:[(0,z.jsx)(k.FormattedMessage,{defaultMessage:"More",id:"mobileActionBar.more.buttonTitle"}),(0,z.jsx)(me,{})]})]})}renderBlockMovementActions(){const e=this.canTriggerBlockActions.state,t=D.default.state.stores[0];return(0,z.jsxs)("div",{style:{...be(this.environment.device.isSmallPhone,this.theme),paddingLeft:6,paddingRight:6},children:[(0,z.jsx)(L.Z,{mobileFeedback:!0,disabledFeedback:!0,style:$,disabled:!e||!T.gq(t),onClick:e=>pe(e,this.environment),children:X}),(0,z.jsx)(L.Z,{mobileFeedback:!0,disabledFeedback:!0,style:$,disabled:!e||!T.nt(t),onClick:e=>ge(e,this.environment),children:J}),(0,z.jsx)(L.Z,{mobileFeedback:!0,disabledFeedback:!0,style:$,disabled:!e,onClick:e=>{return t=this.environment,void j.s0(t);var t},children:ee}),(0,z.jsx)(L.Z,{mobileFeedback:!0,disabledFeedback:!0,style:$,disabled:!e,onClick:e=>{return t=this.environment,void j.rZ(t);var t},children:te})]})}renderTextActions(){const e=this.canTriggerTextActions.state,t=this.hasMultiBlockSelection.state,i=this.props.currentBlockStore.canComment(),o=D.default.state.stores[0],s={display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap"};return(0,z.jsxs)("div",{style:ce(),onScroll:this.handleActionsScrollDebounced,children:[(0,z.jsx)(U.Z,{style:be(this.environment.device.isSmallPhone,this.theme),blockStore:D.default.state.stores[0],disabled:!i}),(0,z.jsx)(W.Z,{type:"b",style:be(this.environment.device.isSmallPhone,this.theme),onClick:()=>de("bold",this.environment),disabled:!e,children:(0,z.jsx)("span",{style:{fontWeight:M.Z.fontWeight.semibold},children:(0,z.jsx)(k.FormattedMessage,{defaultMessage:"B",id:"mobileActionBar.bold.symbol"})})}),(0,z.jsx)(W.Z,{type:"i",style:be(this.environment.device.isSmallPhone,this.theme),onClick:()=>de("italic",this.environment),disabled:!e,children:(0,z.jsx)("span",{style:{fontStyle:"italic",fontWeight:M.Z.fontWeight.semibold},children:(0,z.jsx)(k.FormattedMessage,{defaultMessage:"i",id:"mobileActionBar.italic.symbol"})})}),(0,z.jsx)(W.Z,{type:"_",style:be(this.environment.device.isSmallPhone,this.theme),onClick:()=>de("underline",this.environment),disabled:!e,children:(0,z.jsx)("span",{style:{textDecoration:"underline"},children:(0,z.jsx)(k.FormattedMessage,{defaultMessage:"U",id:"mobileActionBar.underline.symbol"})})}),(0,z.jsx)(W.Z,{type:"s",style:be(this.environment.device.isSmallPhone,this.theme),onClick:()=>de("strike_through",this.environment),disabled:!e,children:(0,z.jsx)("span",{style:{textDecoration:"line-through"},children:(0,z.jsx)(k.FormattedMessage,{defaultMessage:"S",id:"mobileActionBar.strikeThrough.symbol"})})}),(0,z.jsx)(L.Z,{mobileFeedback:!0,disabledFeedback:!0,style:s,disabled:!T.gq(o),onClick:e=>pe(e,this.environment),children:X}),(0,z.jsx)(L.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...s,borderRight:ue(this.theme)},disabled:!T.nt(o),onClick:e=>ge(e,this.environment),children:J}),(0,z.jsx)(W.Z,{type:"c",style:be(this.environment.device.isSmallPhone,this.theme),onClick:()=>de("code",this.environment),disabled:!e,children:(0,z.jsx)("span",{style:{fontFamily:M.Z.getCompositeFontFamily(n.SP).githubMono},children:(0,z.jsx)(k.FormattedMessage,{defaultMessage:"Code",id:"mobileActionBar.code.symbol"})})}),(0,z.jsx)(G.Z,{style:be(this.environment.device.isSmallPhone,this.theme),disabled:!e||t,children:(0,z.jsx)("span",{style:{borderBottom:`1px solid ${this.theme.linkDecorationColor}`},children:(0,z.jsx)(k.FormattedMessage,{defaultMessage:"Link",id:"mobileActionBar.link.symbol"})})}),(0,z.jsx)(H.Z,{onClick:()=>de("equation",this.environment),disabled:!e||t,style:be(this.environment.device.isSmallPhone,this.theme),children:(0,d.G)({width:16,height:16})}),(0,z.jsx)(q.Z,{style:be(this.environment.device.isSmallPhone,this.theme),ignoreSelectionAreaStore:this.props.stores.ignoreSelectionAreaStore,disabled:!e})]})}isOpen(){const{device:e}=this.environment;return e.isMobileBrowser?this.props.stores.store.state.isOpen:this.renderStore.state.shouldShow}}Y.displayName="MobileActionBar";const Q=(0,k.injectIntl)(Y),X=(0,h.A)({width:18,height:18,transform:"rotate(90deg)",position:"relative",left:1}),J=(0,h.A)({width:18,height:18,transform:"rotate(-90deg)",position:"relative",left:-1}),ee=(0,p.l)({width:18,height:18,position:"relative",left:2}),te=(0,p.l)({width:18,height:18,transform:"rotate(180deg)",position:"relative",left:2}),ie=(0,S.s)({width:19,height:19}),oe=(0,g.N)({width:19,height:19}),ne=(0,v.y)({width:18,height:18}),se=(0,b.o)({width:18,height:18}),re=(0,y.C)({width:14,height:14}),ae=(0,m.z)({width:18,height:18}),le=(0,u.y)({width:18,height:18});function ce(){return{flexGrow:1,flexShrink:1,marginRight:-1,display:"flex",overflowX:"auto",overflowY:"hidden",WebkitOverflowScrolling:"touch"}}function de(e,t){C.YO(t,{itemName:e})}function ue(e){return`1px solid ${e.regularDividerColor}`}function he(e,t,i){const{device:o,WindowSizeStore:n}=t;return{height:"100%",width:"100%",fontSize:15,display:"flex",boxShadow:e===B.nd.Bottom?i.bottomActionBarShadow:i.mediumBoxShadow,backgroundColor:i.keyboardActionBarBackground,paddingLeft:o.isMobileNative?n.state.paddingLeftCSS:0,paddingRight:o.isMobileNative?n.state.paddingRightCSS:0}}function me(){window.__c={n:"ChevronDownComponent"};const e=(0,a.Fg)();return(0,c.i)({width:10,marginLeft:4,fill:e.lightIconColor})}function pe(e,t){j.$$(t)}function ge(e,t){j.O2(t)}function be(e,t){return{display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:e?8:10,paddingRight:e?8:10,borderRight:ue(t),whiteSpace:"nowrap",height:42,flexShrink:0,flexGrow:0,flexBasis:"auto",color:t.regularTextColor,minWidth:e?42:44}}function fe(){window.__c={n:"BlockUndoActionsComponent"};const e=(0,a.Fg)(),t=(0,s.O7)(),i=(0,r.VK)((()=>t.device.isSmallPhone),[t]),o=(0,r.VK)((()=>w.L0()),[]),n=(0,r.VK)((()=>w.AZ()),[]);return(0,z.jsxs)("div",{style:{...be(i,e),paddingLeft:6,paddingRight:6},children:[(0,z.jsx)(L.Z,{mobileFeedback:!0,disabledFeedback:!0,style:$,disabled:!o,onClick:()=>function(e){j.i2(e)}(t),children:ie}),(0,z.jsx)(L.Z,{mobileFeedback:!0,disabledFeedback:!0,style:$,disabled:!n,onClick:()=>function(e){j.GH(e)}(t),children:oe})]})}function ye(e){let{stores:t}=e;window.__c={n:"TemplatesButtonComponent"};const i=(0,a.Fg)(),o=(0,s.O7)(),n=(0,r.VK)((()=>o.device.isSmallPhone),[o]);return(0,z.jsx)("div",{style:{flexGrow:1,flexShrink:1,marginRight:-1,display:"flex",overflowX:"auto",overflowY:"hidden",WebkitOverflowScrolling:"touch"},children:(0,z.jsxs)(L.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...be(n,i),borderRight:"none",fontWeight:M.Z.fontWeight.medium},onClick:e=>{t.store.setState({...t.store.state,isTemplatesOpen:!0}),de("templates",o)},children:[(0,f.i)({width:20,marginRight:8}),(0,z.jsx)(k.FormattedMessage,{defaultMessage:"Choose a template...",id:"mobileActionBar.templates.buttonTitle"}),(0,z.jsx)(me,{})]})})}},87038:(e,t,i)=>{i.r(t),i.d(t,{default:()=>V});var o=i(67294),n=i(83355),s=i(84465),r=i(51454),a=i(9291),l=i(21797),c=i(46225),d=i(11732),u=i(81193),h=i(86282),m=i(75179),p=i(87279),g=i(51783),b=i(80444),f=i(63334),y=i(29798),v=i(49085);class S extends v.default{getInitialState(){return{isOpen:!1,isInsertOpen:!1,isTurnIntoOpen:!1,isColorOpen:!1,isTemplatesOpen:!1}}}const x=S;var M=i(27724),k=i(24666),C=i(34583),T=i(65435),w=i(48019),I=i(56940),A=i(78140),P=i(32163),j=i(40721),B=i(53437),R=i(72495),Z=i(40698),_=i(34574),F=i(85893);class N extends n.Z{constructor(){super(...arguments),this.storeTypes={store:x,ignoreSelectionAreaStore:f.Z,templatePickerMenuListStore:y.Z},this.templatePreviewSectionsStore=this.createComputedStore((()=>{var e,t;return Object.entries((0,T.it)({userPersona:null===(e=b.default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.persona,subscriptionTier:null===(t=b.default.state.currentSpaceStore)||void 0===t?void 0:t.getSubscriptionTier()})).map((e=>{let[t,i]=e;return{key:t,render:e=>(0,F.jsx)(R.Z,{title:(0,F.jsx)(a.FormattedMessage,{...s._5[t]}),children:e.children},t),items:i.map((e=>function(e,t){return{key:e.name,render:t=>(0,o.createElement)(_.Z,{...t,key:e.name,title:e.name,type:"page_template",format:"phone-modal",locked:!1}),action:()=>{h.$7({environment:t,item:e,createNewPage:!1,isPrivate:!1})}}}(e,this.environment)))}}))})),this.handleCloseColorPopup=()=>{this.stores.store.setState({...this.stores.store.state,isColorOpen:!1})},this.handleCloseInsertPopup=()=>{this.stores.store.setState({...this.stores.store.state,isInsertOpen:!1})},this.handleCloseTurnIntoPopup=()=>{this.stores.store.setState({...this.stores.store.state,isTurnIntoOpen:!1})},this.handleCloseTemplatesPopup=()=>{this.stores.store.setState({...this.stores.store.state,isTemplatesOpen:!1})},this.renderStore=this.createComputedStore((()=>{var e;return g.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state)}))}renderComponent(){const{device:e,WindowSizeStore:t}=this.environment,i=this.isOpen(),{makeActionBarComponent:n}=this.props;return(0,F.jsxs)(o.Fragment,{children:[(0,F.jsx)(m.Z,{capture:!0,render:e=>(0,F.jsxs)("div",{...e,style:{position:"relative",width:"100%",height:0,zIndex:r.Eo},children:[n(this.stores),this.renderNativeMenuIgnoreSelectionArea(),this.renderInsertPopup(),this.renderTurnIntoPopup(),this.renderColorPopup(),this.renderTemplatesPopup()]})}),!i&&e.isIPhoneX&&e.isNative&&(0,F.jsx)("div",{style:{position:"absolute",bottom:0,background:"transparent",height:t.state.paddingBottomCSS,width:"100%",pointerEvents:"none",WebkitUserSelect:"none"}})]})}renderNativeMenuIgnoreSelectionArea(){const e=this.environment.NativeMobileActionBarStore;return e?(0,F.jsx)(I.Z,{store:this.stores.ignoreSelectionAreaStore,capture:g.y6(this.environment),ignoreBlockSelection:!1,restoreSelection:"editing"!==k.default.state.mode&&e.state.shouldRestoreSelectionForMenu,render:e=>null}):null}renderInsertPopup(){const{device:e}=this.environment;return(0,F.jsx)(I.Z,{capture:this.stores.store.state.isInsertOpen,ignoreBlockSelection:!1,restoreSelection:!1,render:t=>(0,F.jsx)(B.ZP,{popupType:e.isMobile?B.ZP.PopupType.SlideUp:B.ZP.PopupType.Popup,preventBlockRenderQueueOnEnter:!0,open:this.stores.store.state.isInsertOpen,keepFocus:!0,onDismiss:()=>{t(),this.handleCloseInsertPopup()},render:()=>(0,F.jsx)(A.Z,{menuType:p.og.Modal,title:(0,F.jsx)(a.FormattedMessage,{defaultMessage:"Insert block",id:"mobileActionBar.insertBlock.modalTitle"}),right:(0,F.jsx)(j.CancelMenuText,{}),onClickRight:()=>{t(),this.handleCloseInsertPopup()},children:(0,F.jsx)(w.Z,{sections:c.w.state.insertActions,context:{environment:this.environment,blocks:M.default.state.stores,publicEditMode:void 0},onAccept:this.handleCloseInsertPopup})})})})}renderTurnIntoPopup(){const{device:e}=this.environment;return(0,F.jsx)(I.Z,{capture:this.stores.store.state.isTurnIntoOpen,ignoreBlockSelection:!1,restoreSelection:!0,render:()=>(0,F.jsx)(B.ZP,{popupType:e.isMobile?B.ZP.PopupType.SlideUp:B.ZP.PopupType.Popup,open:this.stores.store.state.isTurnIntoOpen,keepFocus:!0,onDismiss:this.handleCloseTurnIntoPopup,preventBlockRenderQueueOnEnter:!0,render:()=>(0,F.jsx)(A.Z,{menuType:p.og.Modal,title:(0,F.jsx)(a.FormattedMessage,{defaultMessage:"Turn into",id:"mobileActionBar.turnInto.modalTitle"}),right:(0,F.jsx)(j.CancelMenuText,{}),onClickRight:this.handleCloseTurnIntoPopup,children:(0,F.jsx)(w.Z,{sections:[{...d.g,title:""}],context:{environment:this.environment,blocks:M.default.state.stores,publicEditMode:void 0},onAccept:this.handleCloseTurnIntoPopup})})})})}renderColorPopup(){const{device:e}=this.environment;return(0,F.jsx)(I.Z,{capture:this.stores.store.state.isColorOpen,ignoreBlockSelection:!1,restoreSelection:!0,render:()=>(0,F.jsx)(B.ZP,{popupType:e.isMobile?B.ZP.PopupType.SlideUp:B.ZP.PopupType.Popup,open:this.stores.store.state.isColorOpen,keepFocus:!0,onDismiss:this.handleCloseColorPopup,preventBlockRenderQueueOnEnter:!0,render:()=>(0,F.jsx)(A.Z,{menuType:p.og.Modal,title:(0,F.jsx)(a.FormattedMessage,{defaultMessage:"Block color",id:"mobileActionBar.blockColor.modalTitle"}),right:(0,F.jsx)(j.CancelMenuText,{}),onClickRight:this.handleCloseColorPopup,children:(0,F.jsx)(w.Z,{sections:[l.te,l.rz,l.Vm],context:{environment:this.environment,blocks:M.default.state.stores,publicEditMode:void 0},onAccept:this.handleCloseColorPopup})})})})}renderTemplatesPopup(){const{device:e}=this.environment;return(0,F.jsx)(I.Z,{capture:this.stores.store.state.isTemplatesOpen,ignoreBlockSelection:!1,restoreSelection:!1,render:()=>(0,F.jsx)(B.ZP,{popupType:e.isMobile?B.ZP.PopupType.SlideUp:B.ZP.PopupType.Popup,open:this.stores.store.state.isTemplatesOpen,keepFocus:!0,render:()=>(0,F.jsx)(A.Z,{menuType:p.og.Modal,title:(0,F.jsx)(a.FormattedMessage,{defaultMessage:"Templates",id:"mobileActionBar.templates.modalTitle"}),right:(0,F.jsx)(j.CancelMenuText,{}),onClickRight:this.handleCloseTemplatesPopup,children:(0,F.jsx)(P.Z,{type:P.i.Vertical,store:this.stores.templatePickerMenuListStore,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,onAccept:this.handleCloseTemplatesPopup,sections:[{key:"Basic",render:e=>(0,F.jsx)(R.Z,{children:e.children}),items:Z.ss.map((e=>O(e,this.props.currentBlockStore,this.environment,this.theme)))},{key:"Database",render:e=>(0,F.jsx)(R.Z,{title:(0,F.jsx)(a.FormattedMessage,{defaultMessage:"Database",id:"mobileActionBar.databaseSection.title"}),children:e.children}),items:Z.Im.filter((e=>e.shouldShow(this.environment))).map((e=>O(e,this.props.currentBlockStore,this.environment,this.theme)))},...this.templatePreviewSectionsStore.state]})})})})}isOpen(){const{device:e}=this.environment;return e.isMobileBrowser?this.stores.store.state.isOpen:this.renderStore.state.shouldShow}}N.displayName="MobileActionBarWrapper";const V=(0,a.injectIntl)(N);function D(e,t){return e.isLargeDatabaseIcon?{width:16,fill:t.regularIconColor,marginLeft:4,marginRight:4}:{width:20,fill:t.regularIconColor,marginLeft:2,marginRight:2}}function O(e,t,i,n){const s=t;return{key:e.name,render:t=>{var i;return(0,o.createElement)(_.Z,{...t,key:e.name,format:"phone-modal",title:e.name,type:e.type,icon:null===(i=e.iconFn)||void 0===i?void 0:i.call(e,D(e,n)),locked:!1})},action:t=>{s&&C.M_(i)&&(u.rN(i,{template_name:e.name,is_keyboard:"keydown"===t.event.type}),e.onClick(i,s))}}}},54230:(e,t,i)=>{i.r(t),i.d(t,{default:()=>oe});var o=i(30120),n=i(67294),s=i(83355),r=i(86628),a=i(49085),l=i(15145),c=i(40506),d=i(7057),u=i(53877),h=i(42875),m=i(2585),p=i(5257),g=i(72126),b=i(21202),f=i(9291),y=i(26797),v=i(49865),S=i(8055),x=i(82530),M=i(66213),k=i(40863),C=i(84210),T=i(87279);class w extends a.default{getInitialState(){return{}}}const I=w;var A=i(68373),P=i(13401),j=i(71638),B=i(73063),R=i(78140),Z=i(43765),_=i(40721),F=i(72495),N=i(78948),V=i(24405),D=i(6695),O=i(95855),L=i(54497),E=i(82990),q=i(33929),U=i(65598),K=i(80444),W=i(97039),H=i(78030),G=i(52275),z=i(16354),$=i(31278),Y=i(76798),Q=i(85893);const X=function(e){let{time:t,store:i,format:o,schema:s,blockPropertyValueOverlayStore:a,collectionStore:c}=e;window.__c={n:"MobileCalendarDayMenuItem"};const d=(0,V.Fg)(),u=(0,r.VK)((()=>i.getIcon()),[i]),h=(0,r.VK)((()=>i.hasIcon()||!i.isEmptyPage()),[i]),m=(0,r.VK)((()=>i.hasError()),[i]),p=(0,r.VK)((()=>i.isEmptyPage()),[i]),g=(0,C.ZP)({store:i,fullyQualified:!1,pageVisitSource:l.tY.LinkInPage}),b=U.Xp(i,{recursivelyLoadAllDiscussions:!1});return(0,Q.jsx)(z.Z,{href:g,children:(0,Q.jsx)(G.Z,{focused:!1,title:(0,Q.jsxs)(n.Fragment,{children:[t&&(0,Q.jsx)("div",{style:{display:"flex",color:d.mediumTextColor,fontSize:14,marginTop:8,marginBottom:6},children:t}),(0,Q.jsxs)("div",{style:{display:"flex",alignItems:"center",...t&&{marginBottom:8}},children:[h&&!m&&(0,Q.jsx)($.Z,{disabled:!0,icon:u,isEmptyPage:p,size:24,style:{flexShrink:0,marginRight:8}}),m&&(0,L.t)({marginLeft:2,marginRight:10,width:20,fill:d.accentColors.orange[500]}),(0,Q.jsx)(Y.Z,{store:i,style:{fontWeight:E.Z.fontWeight.semibold}}),b>0&&(0,Q.jsxs)("div",{style:{display:"flex",alignItems:"center",color:d.regularDividerColor,fontSize:12,marginLeft:4,flexShrink:0},children:[(0,O.z)({width:12,height:12,marginRight:4,fill:d.mediumIconColor}),b]})]})]}),caption:(0,Q.jsx)(ee,{format:o,schema:s,store:i,blockPropertyValueOverlayStore:a,collectionStore:c})})})};function J(e){let{property:t,schema:i,store:o,blockPropertyValueOverlayStore:n,collectionStore:s}=e;return i[t]?(0,Q.jsx)(W.Z,{store:o,property:t,disabled:!0,locked:!1,format:H.C.Calendar,tableWrap:!1,blockPropertyValueOverlayStore:n,collectionStore:s},t):null}function ee(e){let{format:t,schema:i,store:o,blockPropertyValueOverlayStore:n,collectionStore:s}=e;const r=(t.calendar_properties?t.calendar_properties.filter((e=>e.visible)).map((e=>e.property)):[]).filter((e=>{var t;return D.XU({block:o.getModel(),property:e,schema:i,getRecordModel:o.getRecordModel,userId:null===(t=K.default.state.currentUserStore)||void 0===t?void 0:t.id,userTimeZone:(0,h.r)(),intl:q.default.getIntl()})}));return r.length>0?(0,Q.jsx)("div",{style:{marginTop:8},children:r.map((e=>(0,Q.jsx)(J,{property:e,schema:i,store:o,blockPropertyValueOverlayStore:n,collectionStore:s},e)))}):null}const te={display:"flex",alignItems:"center",height:"100%"};class ie extends s.Z{constructor(){super(...arguments),this.storeTypes={store:I,resultStore:a.default.createClass(void 0)},this.renderResults=()=>{const{disabled:e,collectionContextStore:t}=this.props,i=t.collectionStore();if(!i)return;const o=this.getCurrentStartOfDay(),n=o.endOf("day"),s=this.getCurrentResults();return(0,Q.jsxs)(R.Z,{menuType:T.og.Modal,title:(0,Q.jsxs)("div",{style:te,children:[(0,Q.jsx)(B.Z,{onClick:this.handleLeftClick,icon:m.f,style:{marginRight:8,marginTop:2},mobileFeedback:!0}),(0,Q.jsx)("div",{children:(0,d.ZW)(o,"month_day_long")}),(0,Q.jsx)(B.Z,{onClick:this.handleRightClick,icon:p.o,style:{marginLeft:8,marginTop:2},mobileFeedback:!0})]}),right:(0,Q.jsx)(_.DoneMenuText,{}),onClickRight:this.props.onDismiss,children:[!s&&(0,Q.jsx)(F.Z,{children:(0,Q.jsx)(N.Z,{})}),s&&0===s.length&&(0,Q.jsx)(F.Z,{children:(0,Q.jsx)(Z.Z,{title:(0,Q.jsx)(f.FormattedMessage,{defaultMessage:"No items",id:"mobileCalendarDayMenu.noResults.message"})})}),s&&s.length>0&&(0,Q.jsx)(F.Z,{children:s.map((e=>{const t=A.G.createChildStore(i,{id:e.id,table:b.iU});return(0,Q.jsx)(se,{disabled:this.props.disabled,blockPropertyValueOverlayStore:this.props.blockPropertyValueOverlayStore,collectionContextStore:this.props.collectionContextStore,schema:this.props.schema,calendarBy:this.props.calendarBy,intl:this.props.intl,format:this.props.format,blockStore:t,item:e,currentStartOfDay:o,currentEndOfDay:n},e.id)}))}),!e&&(0,Q.jsx)(F.Z,{topBorder:!0,children:(0,Q.jsx)(P.Z,{focused:!1,onClick:this.handleAddItemClick,title:(0,Q.jsx)(f.FormattedMessage,{defaultMessage:"New item",id:"mobileCalendarDayMenu.newItemButton.label"})})})]})},this.handleLeftClick=()=>{const e=this.getCurrentStartOfDay();this.stores.store.setState({...this.stores.store.state,currentStartOfDay:e.minus({day:1}).valueOf()})},this.handleRightClick=()=>{const e=this.getCurrentStartOfDay();this.stores.store.setState({...this.stores.store.state,currentStartOfDay:e.plus({day:1}).valueOf()})},this.handleAddItemClick=()=>{const{collectionContextStore:e,calendarBy:t}=this.props,i=this.getCurrentStartOfDay(),o=x.createAndCommit({userAction:"MobileCalendarDayMenu.newStore",environment:this.environment,perform:o=>{const n=v.IW({environment:this.environment,collectionContextStore:e,groupsPointer:[],insertAtIndex:0,shouldCoerce:!1,initializeDefaultTemplate:!0,transaction:o,from:"mobile_calendar_day_menu"});if(n)return y.xD({type:"timestamp",environment:this.environment,store:n.newStore,propertyId:t,timestampMs:i.valueOf(),transaction:o}),n.newStore}});if(!o.performResult)return;const n=(0,C.ZP)({store:o.performResult,pageVisitSource:l.tY.Create});this.navigate(n)},this.reducerStore=this.createComputedStore((()=>{const{collectionContextStore:e}=this.props;return(0,k.YG)({collectionContextStore:e,startOfDay:this.getCurrentStartOfDay().valueOf()})}),!0)}navigate(e){this.context.overrideLinkClick?this.context.overrideLinkClick(e):S.c4({environment:this.environment,url:e})}renderComponent(){const{collectionContextStore:e}=this.props,t=this.reducerStore.state;if(t)return(0,Q.jsx)(j.Z,{id:"calendar_day_results",reducer:t,collectionContextStore:e,render:this.renderResults,resultStore:this.stores.resultStore})}getCurrentStartOfDay(){const{currentStartOfDay:e}=this.stores.store.state;return e?o.ou.fromMillis(e):o.ou.fromMillis(this.props.initialStartOfDay)}getCurrentResults(){const{collectionContextStore:e}=this.props,t=e.collectionStore();if(!t)return;const i=this.stores.resultStore.state,o=e.normalizedQueryStore.state,n=e.normalizedSchemaStore.state,s=o?o.calendar_by:void 0;if(!(i&&o&&s&&n))return;let r=g.oA(i.blockIds.map((e=>{const i=A.G.createChildStore(t,{id:e,table:b.iU});return(0,k.BO)({blockStore:i,calendarBy:s,schema:n,getRecordValue:t.getRecordValue,userId:this.environment.currentUser.id,intl:this.props.intl})})));return o.sort||(r=g.MR(r,(e=>e.start))),r}}ie.displayName="MobileCalendarDayMenu",ie.contextTypes={...M.wK,...s.w};const oe=(0,f.injectIntl)(ie);function ne(e){let{item:t,currentStartOfDay:i,currentEndOfDay:o,schema:n,calendarBy:s,intl:r}=e;const a=n[s];if(!a||"date"!==a.type)return;const l=a.date_format||c.sF,m=a.time_format||c.c_,p=t.start,g=t.end,b=Boolean(!(i<=p&&p<=o)||g&&!(i<=g&&g<=o));if(t.end){const e=u.iC(t.start.valueOf(),t.end?t.end.valueOf():t.start.valueOf(),t.timeZone??(0,h.r)());return b?(0,d.ZV)({value:e,date_format:l,time_format:m,userTimeZone:t.timeZone,allowRelativeDates:!0,intl:r}):(0,d.ns)({start_time:e.start_time,end_time:e.end_time,time_format:m,humanReadable:!0,intl:r})}return(0,d.mr)({start_time:u.CQ(t.start.valueOf(),t.timeZone??(0,h.r)()).start_time,time_format:m,humanReadable:!0,intl:r})}function se(e){let{blockStore:t,item:i,currentStartOfDay:o,currentEndOfDay:n,disabled:s,blockPropertyValueOverlayStore:a,collectionContextStore:l,schema:c,calendarBy:d,intl:u,format:h}=e;window.__c={n:"Item"};const m=(0,r.VK)((()=>l.collectionStore()),[l]);return m?(0,Q.jsx)(X,{store:t,time:i.includeTime?ne({schema:c,calendarBy:d,intl:u,item:i,currentStartOfDay:o,currentEndOfDay:n}):void 0,disabled:s,format:h,schema:c,blockPropertyValueOverlayStore:a,collectionStore:m},i.id):null}},21326:(e,t,i)=>{i.r(t),i.d(t,{default:()=>I});var o=i(67294),n=i(71644),s=i(51811),r=i(480),a=i(86628),l=i(27328),c=i(59054),d=i(70203),u=i(35793),h=i(8055),m=i(87531),p=i(29974),g=i(81598),b=i(28344),f=i(41625),y=i(75179),v=i(38755),S=i(80444),x=i(98180),M=i(66881),k=i(69454),C=i(85893);const T=function(){window.__c={n:"MobileAssistantMenu"};const e=(0,r.O7)(),[t,i]=(0,o.useState)(!1),n=(0,a.VK)((()=>M.g.state),[]),s=(0,a.VK)((()=>(0,l.w_)(e.TabbedRouterStore.state)),[e]),T=(0,a.VK)((()=>{var e,t;return Boolean("web"===s.type&&("nativeTab"===s.route.name&&"assistant"===s.route.tab||"nativeTab"===(null===(e=s.redirectedTo)||void 0===e?void 0:e.route.name)&&"assistant"===(null===(t=s.redirectedTo)||void 0===t?void 0:t.route.tab)))}),[s]),w=(0,a.VK)((()=>e.WindowSizeStore.state.paddingTopCSS),[e.WindowSizeStore]),I=(0,a.VK)((()=>k.Z.mobileNativeBottomPadding(e)),[e]),A=(0,a.VK)((()=>({paddingLeft:e.WindowSizeStore.state.paddingLeftCSS,paddingRight:e.WindowSizeStore.state.paddingRightCSS})),[e]);return(0,c.r5)((async()=>{const t=u.Bs(),o=S.default.state.currentSpaceViewStore;if(t){const i=p.F1({environment:e,spaceId:t})??(o?await(0,v.rg)(e,o):void 0);i&&S.default.setState({...S.default.state,mainEditorCurrentBlockStore:i})}const{assistantActions:s}=await g.L6.loader();if(!x.Z.getActiveSessionId()||n.shouldReset){var r;M.g.update((e=>({...e,shouldReset:!1})));const t=Boolean(n.query&&n.query.length>m.LR),o=await s.resetAndInitializeAssistantSession({environment:e,primeTextInput:t?void 0:n.query});t&&await s.commitHumanStep({environment:e,text:(0,d.TPx)(n.query),sessionId:o.sessionId});const l=null===(r=x.Z.getSessionContext(o.sessionId))||void 0===r||null===(r=r.assistantConfigurationStore)||void 0===r?void 0:r.state;var a;if(l)b.trackQnAOpened(e,{configurationState:l,runtimeState:null===(a=x.Z.getSessionContext(o.sessionId))||void 0===a||null===(a=a.assistantRuntimeStore)||void 0===a?void 0:a.state,hasQuery:t,from:n.from??"mobile_app_start",searchSessionId:n.searchSessionId,isReminder:!1});i(!0)}else T&&i(!0)}),[e,n,i,T]),(0,o.useEffect)((()=>{var i;T&&t&&(null===(i=e.mobileNative)||void 0===i||i.markTransitionReady({type:"assistant"}))}),[e.mobileNative,T,t]),(0,C.jsx)(y.Z,{capture:!0,render:t=>(0,C.jsx)("div",{style:{paddingTop:w,paddingBottom:I,...A,flex:1,minWidth:0},...t,children:(0,C.jsx)(f.Q,{renderAsFullPage:!0,showBackButton:!0,onClose:()=>h.op(e)})})})};var w=i(58925);const I=function(e){const{route:t}=e;return"updates"===t.tab?(0,C.jsx)(w.Z,{format:s.EX.RenderAsPage,renderId:(0,n.ZP)()}):"assistant"===t.tab?(0,C.jsx)(T,{}):null}},61671:(e,t,i)=>{i.d(t,{Z:()=>f});i(67294);var o=i(480),n=i(86628),s=i(24405),r=i(16001),a=i(9291),l=i(1357),c=i(87279),d=i(97799),u=i(64921),h=i(31945),m=i(78140),p=i(15311),g=i(14694),b=i(85893);const f=function(e){let{passwordRequestStore:t}=e;window.__c={n:"NotificationSettingsButton"};const i=(0,s.Fg)(),l=(0,o.O7)(),{device:f,mobileNative:v}=l,S=(0,n.VK)((()=>d.Z.state.open),[]),x=(0,n.VK)((()=>d.Z.state.source!==d.Y.Updates&&((null==v?void 0:v.supportsNativeHomeOnPhone())||!1)),[v]);return(0,b.jsx)(h.ZP,{popupType:f.isMobile?h.Z4.SlideUp:h.Z4.Popup,hidesMobileNativeBottomBar:x,preventSlideUpTransition:x,buttonPopupStore:d.Z,renderOrigin:e=>(0,b.jsx)(u.Z,{mobileFeedback:f.isMobile,...e,children:(0,b.jsx)(g.Z,{left:(0,r.r)({fill:i.mediumIconColor,width:16}),style:{background:S?i.buttonHoveredBackground:"none"},disableMobileBorder:!0,children:(0,b.jsx)(a.FormattedMessage,{defaultMessage:"Notifications & settings",id:"notificationSettingsButton.mobileSidebar.label"})})}),render:()=>{let e;return e=f.isMobile?{menuType:c.og.Modal,title:(0,b.jsx)(a.FormattedMessage,{defaultMessage:"Notifications & settings",id:"notificationSettingsButton.mobileSidebar.title"}),right:(0,b.jsx)(a.FormattedMessage,{defaultMessage:"Done",id:"notificationSettingsButton.rightActionButton.done"}),onClickRight:()=>y(l),onCancel:()=>y(l),whiteBackground:!0}:{menuType:c.og.Popup},(0,b.jsx)(m.Z,{...e,children:(0,b.jsx)(p.Z,{isMobile:!0,passwordRequestStore:t})})}})};function y(e){const{mobileNative:t}=e,i=()=>{d.Z.setState({open:!1})};d.Z.state.source!==d.Y.Updates&&((null==t?void 0:t.supportsNativeHomeOnPhone())||!1)?l.d(e,i):i()}},65496:(e,t,i)=>{i.d(t,{Z:()=>w});var o=i(67294),n=i(83355),s=i(9291),r=i(96802),a=i(79698),l=i(82530),c=i(28651),d=i(50627),u=i(94841),h=i(14542),m=i(96809),p=i(87636),g=i(23063),b=i(64921),f=i(12981),y=i(65107),v=i(68785),S=i(32854),x=i(81865),M=i(97496),k=i(56282),C=i(85893);class T extends n.Z{constructor(){super(...arguments),this.lastProxiedUrl=void 0,this.storeTypes={mouseStore:c.Z},this.renderControl=e=>{let{isVisible:t,isRepositioning:i,handleCancelClick:o,handleRepositionClick:n,handleSavePositionClick:r}=e;if(this.props.disabled||m.Z.state.loadingMode!==h.LU)return;const{device:a}=this.environment,{isMobile:l}=a;return(0,C.jsx)(g.Z,{isVisible:!0,animationStyle:{width:I(this.props.store),opacity:t?1:0},render:()=>(0,C.jsx)("div",{style:{position:"absolute",pointerEvents:t?"auto":"none",maxWidth:"100%",top:48},children:(0,C.jsxs)(p.Z,{isVisible:t,position:"bottom",style:{marginRight:this.props.paddingRight,marginLeft:this.props.paddingLeft},children:[!i&&(0,C.jsx)(b.Z,{style:{borderRight:l?"none":void 0,...M.ar},onClick:this.handleChangeCoverClick,children:(0,C.jsx)(s.FormattedMessage,{defaultMessage:"Change cover",id:"pageCover.changeCover.text"})}),!i&&!l&&(0,C.jsx)(b.Z,{style:{...M.ar,borderRight:"none"},onClick:e=>n(e,this.lastProxiedUrl),children:(0,C.jsx)(s.FormattedMessage,{defaultMessage:"Reposition",id:"pageCover.reposition.text"})}),i&&!l&&(0,C.jsx)(b.Z,{style:M.ar,onClick:r,children:(0,C.jsx)(s.FormattedMessage,{defaultMessage:"Save position",id:"pageCover.savePosition.text"})}),i&&!l&&(0,C.jsx)(b.Z,{style:{...M.ar,borderRight:"none"},onClick:o,children:(0,C.jsx)(s.FormattedMessage,{defaultMessage:"Cancel",id:"pageCover.reposition.cancelText"})})]})})})},this.handleChangeCoverClick=e=>{const{intl:t,store:i}=this.props;this.stores.mouseStore.reset();const o=e.target.getBoundingClientRect();a.j({environment:this.environment,intl:t,store:i,rect:o})},this.coverWithRecordStore=this.createComputedStore((()=>this.props.store.getCover()),!0),this.isPersonalHome=this.createComputedStore((()=>(0,u.WE)(this.props.store)))}renderComponent(){const e=this.coverWithRecordStore.getState();if(!e)return;const t=m.Z.state,i=t.loadingMode!==h.LU&&t.loadingMode!==h.SS;return(0,C.jsx)(k.Z,{mouseStore:this.stores.mouseStore,onFlushTemporaryPosition:e=>function(e,t,i){const{imagePosition:o,reset:n}=e;l.createAndCommit({userAction:"PageCover.handleFlushTemporaryPosition",environment:i,perform:e=>{r.Mp({store:t,coverPosition:o,transaction:e}),n()}})}(e,this.props.store,this.environment),renderControl:this.renderControl,source:"page",store:this.props.store,style:{display:"flex",flexDirection:"column",alignItems:"center",height:this.props.height,cursor:"default"},render:n=>(0,C.jsxs)(o.Fragment,{children:[(0,C.jsx)(x.Z,{url:e.cover,isAuthenticated:!0,permissionRecord:e.pointer,width:this.props.proxyWidth,render:(e,o)=>{this.lastProxiedUrl=o;const s={width:"100%",height:this.props.height,objectFit:"cover",opacity:i?.5:1,objectPosition:`center ${100*(1-(n.imagePosition||0))}%`,borderRadius:0},r={width:"100%",height:this.props.height};return(0,C.jsx)(y.B,{src:o,placeholderSrc:i?t.dataURL:void 0,placeholderBehavior:i?"force-show-placeholder":"show-placeholder-if-loading-src",containerStyle:r,imageStyle:s,onLoadComplete:A})}}),i&&(0,C.jsxs)("div",{style:f.I,children:[(0,C.jsx)(v.Z,{style:{width:16,height:16,marginRight:4}}),(0,C.jsx)("div",{style:{minWidth:30,textAlign:"right"},children:(0,C.jsx)(S.Z,{percentage:t.uploadProgress})})]})]})})}}T.displayName="PageCover";const w=(0,s.injectIntl)(T);function I(e){let t;return t=!!e.isFullWidth()?"100%":d.zL,t}function A(){m.Z.reset()}},5480:(e,t,i)=>{i.d(t,{Z:()=>ve});var o=i(67294),n=i(83355),s=i(480),r=i(86628),a=i(24405),l=i(97107),c=i(9291),d=i(42858),u=i(82530),h=i(97978),m=i(98742),p=i(36896),g=i(44604),b=i(80444),f=i(64921),y=i(31945),v=i(79954),S=i(14694),x=i(15145),M=i(1800),k=i(35840),C=i(64994),T=i(54992),w=i(55863),I=i(42973),A=i(21202),P=i(75754),j=i(12714),B=i(1357),R=i(39865),Z=i(95477),_=i(23586),F=i(12457),N=i(43250),V=i(33929),D=i(87279),O=i(18514),L=i(77907),E=i(75822),q=i(74948),U=i(88632),K=i(68373),W=i(72087),H=i(20755),G=i(73063),z=i(68894),$=i(68785),Y=i(78140),Q=i(32163),X=i(43765),J=i(40721),ee=i(11470),te=i(43145),ie=i(72495),oe=i(30506),ne=i(26388),se=i(83182),re=i(46247),ae=i(66957),le=i(85893);const ce=(0,c.defineMessages)({filterByPlaceholder:{id:"sidebarTrash.filterBy.placeholder",defaultMessage:"Search pages in trash..."}});class de extends n.Z{constructor(){super(...arguments),this.storeTypes={requestStore:W.Z},this.renderTrashPages=(e,t)=>{const{device:i}=this.environment,n=t?t.results:[],{mainEditorCurrentBlockStore:s}=b.default.state;if(!s)return;const r=n.map((e=>K.G.createChildStore(s,{table:A.iU,id:e}))).filter((e=>e.isDefined()&&!g.Z.state.excludePages.has(e.id))).map((e=>({key:e.id,action:t=>{let{event:o}=t;if("metaKey"in o&&o.metaKey){const t=(0,M.Z)({baseUrl:Z.default.domainBaseUrl,pageId:e.id,pageVisitSource:x.tY.SidebarTrash});j.D({environment:this.environment,url:t})}else P._({environment:this.environment,store:e,pageVisitSource:x.tY.SidebarTrash}),p.Z.setState({...p.Z.state,open:!1});i.isMobile&&q.close()},render:t=>(0,le.jsx)(ee.Z,{...t,dontShrinkRight:!0,store:e,right:(0,le.jsxs)("div",{style:{display:"flex",gap:4},children:[(0,le.jsx)(ne.ZP,{placement:ne.ug.Bottom,renderTooltip:()=>(0,le.jsx)(c.FormattedMessage,{defaultMessage:"Restore",id:"sidebarTrash.restorePageButton.tooltip"}),render:t=>(0,le.jsx)(G.Z,{icon:w.s,iconStyle:{width:16,height:16,color:this.theme.mediumIconColor},...t,onClick:()=>function(e,t){const{currentSpaceStore:i}=b.default.state;if(!i)return;R.DV({environment:t,block:e,spaceId:e.pointer.spaceId||i.id})}(e,this.environment),ariaLabel:this.props.intl.formatMessage({defaultMessage:"Restore page",id:"sidebarTrash.restorePageButton.ariaLabel"})})}),(0,le.jsx)(ne.ZP,{placement:ne.ug.Bottom,renderTooltip:()=>(0,le.jsx)(c.FormattedMessage,{defaultMessage:"Permanently delete page",id:"sidebarTrash.permanentlyDeletePageButton.tooltip"}),render:t=>(0,le.jsx)(G.Z,{icon:T.p,iconStyle:{width:16,height:16,color:this.theme.mediumIconColor},...t,onClick:()=>function(e,t){R.Rn({environment:t,blocks:[e]})}(e,this.environment),ariaLabel:this.props.intl.formatMessage({defaultMessage:"Permanently delete page",id:"sidebarTrash.permanentlyDeletePageButton.ariaLabel"})})})]})})})));return 0===r.length&&g.Z.state.filter?(0,le.jsx)(ie.Z,{style:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:i.isMobile?(0,le.jsx)(X.Z,{title:(0,le.jsx)(c.FormattedMessage,{defaultMessage:"No matches",id:"sidebarTrash.mobileFilterBy.noMatchesTitle"})}):(0,le.jsx)(H.Z,{icon:C.h,title:(0,le.jsx)(c.FormattedMessage,{defaultMessage:"No matches",id:"sidebarTrash.filterBy.noMatchesTitle"}),description:(0,le.jsx)(c.FormattedMessage,{defaultMessage:"Try checking for typos",id:"sidebarTrash.filterBy.noMatchesDescription"})})}):0===r.length?(0,le.jsx)(ie.Z,{style:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:i.isMobile?(0,le.jsx)(X.Z,{title:(0,le.jsx)(c.FormattedMessage,{defaultMessage:"No results",id:"sidebarTrash.mobileFilterBy.noResultsTitle"})}):(0,le.jsx)(H.Z,{icon:T.p,title:(0,le.jsx)(c.FormattedMessage,{defaultMessage:"No results",id:"sidebarTrash.filterBy.noResultsTitle"}),description:(0,le.jsx)(c.FormattedMessage,{defaultMessage:"Trashed pages appear here",id:"sidebarTrash.filterBy.noResultsDescription"})})}):(0,le.jsxs)(o.Fragment,{children:[(0,le.jsx)(Q.Z,{type:Q.i.Vertical,initialFocus:void 0,sections:[{key:0,items:r,render:e=>(0,le.jsx)(ie.Z,{...e})}]}),(0,le.jsx)(F.Z,{show:this.stores.requestStore.state.loading,showDelay:500,showHold:200,render:e=>{if(e)return(0,le.jsx)("div",{style:{height:44,display:"flex",flex:1,alignItems:"center",justifyContent:"center"},children:(0,le.jsx)($.Z,{})})}}),(0,le.jsx)(te.Z,{onChange:this.handleScrollOffsetChange})]})},this.handleSwipeLeft=()=>{const e=ue.indexOf(g.Z.state.currentTab),t=ue[e+1];void 0!==t&&this.changeTab(t)},this.handleSwipeRight=()=>{const e=ue.indexOf(g.Z.state.currentTab),t=ue[e-1];void 0!==t&&this.changeTab(t)},this.handleTabChange=e=>{const t=ue[e];this.changeTab(t)},this.handleScrollOffsetChange=e=>{const{requestStore:t}=this.stores,{ready:i,loading:o,result:n}=t.state,s=n;e<=g.Z.loadMoreOffset&&s&&i&&!o&&!s.endOfResultsReached&&g.Z.setState({...g.Z.state,limit:g.Z.state.limit+g.Z.limitIncrement})}}UNSAFE_willMount(e){super.UNSAFE_willMount(e),g.Z.setState({...g.Z.state,limit:g.Z.startLimit,excludePages:new Set})}willUnmount(){g.Z.setState({...g.Z.state,filter:""})}renderComponent(){const{mobileNative:e}=this.environment;return null!=e&&e.supportsNativeHomeOnPhone()?this.renderNativeHomeEnabledLayout():this.renderLayout()}renderLayout(){const{device:e}=this.environment;let t;return t=e.isMobile?{menuType:D.og.Modal,title:(0,le.jsx)(c.FormattedMessage,{defaultMessage:"Trash",id:"sidebarTrash.menu.header"}),left:(0,le.jsx)(me,{}),right:(0,le.jsx)(J.DoneMenuText,{}),onClickRight:()=>fe(this.environment),onCancel:()=>fe(this.environment),header:this.renderHeaderWithTabs()}:{menuType:D.og.Popup,height:"50vh",width:414,header:this.renderHeaderWithTabs(),footer:(0,le.jsx)(he,{})},(0,le.jsx)(oe.Z,{onSwipeLeft:this.handleSwipeLeft,onSwipeRight:this.handleSwipeRight,render:e=>(0,le.jsx)(Y.Z,{...t,...e,className:N.TYv,children:this.renderPages()})})}renderNativeHomeEnabledLayout(){const e={menuType:D.og.Modal,title:(0,le.jsx)(c.FormattedMessage,{defaultMessage:"Trash",id:"sidebarTrash.menu.header"}),left:(0,le.jsx)(me,{}),right:(0,le.jsx)(J.DoneMenuText,{}),onClickRight:()=>fe(this.environment),onCancel:()=>fe(this.environment),header:this.renderSearchInput()};return(0,le.jsx)(Y.Z,{...e,className:N.TYv,children:this.renderPages()})}renderHeaderWithTabs(){const{device:e}=this.environment,t=g.Z.state.currentTab,i=ue.indexOf(t);return(0,le.jsxs)(o.Fragment,{children:[(0,le.jsx)(ae.Z,{tabs:[(0,le.jsx)(c.FormattedMessage,{defaultMessage:"All pages",id:"sidebarTrash.allPages.tabHeader"},"allPages"),(0,le.jsx)(c.FormattedMessage,{defaultMessage:"In current page",id:"sidebarTrash.inCurrentPage.tabHeader"},"currentPage"),(0,le.jsx)(c.FormattedMessage,{defaultMessage:"Last edited by me",id:"sidebarTrash.lastEditedByMe.tabHeader"},"lastEditedByMe")],selectedIndex:i,onChange:this.handleTabChange}),(0,le.jsx)("div",{style:{margin:e.isMobile?0:"10px 0"},children:this.renderSearchInput()})]})}renderSearchInput(){const{device:e}=this.environment;return(0,le.jsx)(z.ZP,{inputLeft:e.isMobile?(0,le.jsx)(F.Z,{show:this.stores.requestStore.state.loading,showDelay:500,showHold:200,render:e=>e?(0,le.jsx)($.Z,{style:pe(this.theme)}):(0,k.R)(pe(this.theme))}):void 0,style:{...e.isAndroid&&{borderBottom:"none"}},showClearButton:!0,placeholder:V.default.formatMessage(ce.filterByPlaceholder),focus:!e.isMobile||void 0,value:g.Z.state.filter,onChange:be})}renderPages(){if(!U.Z.state.online)return(0,le.jsx)(ie.Z,{style:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,le.jsx)(H.Z,{icon:I.i,title:(0,le.jsx)(c.FormattedMessage,{defaultMessage:"You're offline",id:"sidebarTrash.goOnline.title"}),description:(0,le.jsx)(c.FormattedMessage,{defaultMessage:"Please go online to view the Trash",id:"sidebarTrash.goOnline.description"})})});{const{filter:e,limit:t,currentTab:i}=g.Z.state,o=`${e}:${t}${i}`;return(0,le.jsx)(_.Z,{requestStore:this.stores.requestStore,request:o,performRequest:e=>async function(e,t){const{currentSpaceStore:i,mainEditorCurrentBlockStore:o,currentUserStore:n}=b.default.state;if(!i||!o||!n)return;const{limit:s,filter:r,currentTab:a}=g.Z.state;let l,c;if("in_current_page"===a)if(o.isCollectionView()){if(!o.isDefined())return;const e=o.getCollectionPointer();if(!e)return;c=e.id}else c=o.id;else"last_edited_by_me"===a&&(l=n.id);const d=await L.deps.searchActions.loader();return await d.searchTrashPages({environment:t,query:r,limit:s,ancestorId:c,spaceId:i.id,editedById:l})}(0,this.environment),render:this.renderTrashPages,debounce:E.vp})}}changeTab(e){var t,i;g.Z.setState({...g.Z.state,currentTab:e,limit:g.Z.startLimit}),this.stores.requestStore.setState({...this.stores.requestStore.state,result:null}),t=this.environment,i={tab:e},h.j(t,"toggle_trash_tab",i)}}de.displayName="SidebarTrash";const ue=["all_pages","in_current_page","last_edited_by_me"];function he(){return(0,le.jsx)(ie.Z,{topBorder:!0,disableDesktopPadding:!1,children:(0,le.jsx)(se.Z,{title:(0,le.jsx)(c.FormattedMessage,{defaultMessage:"Learn about deleting and restoring pages",id:"sidebarTrash.learnMore.prompt"}),href:(0,O.UY)("guides.trash"),analyticsFrom:"trash"})})}function me(){return(0,le.jsx)(re.Z,{href:(0,O.UY)("guides.trash"),analyticsFrom:"trash"})}function pe(e){return{width:14,height:14,flexGrow:0,flexShrink:0,color:e.lightIconColor}}const ge=(0,c.injectIntl)(de);function be(e){g.Z.setState({...g.Z.state,filter:e.target.value,limit:g.Z.startLimit})}function fe(e){const{mobileNative:t}=e,i=()=>{p.Z.setState({...p.Z.state,open:!1})};null!=t&&t.supportsNativeHomeOnPhone()?B.d(e,i):i()}class ye extends n.Z{constructor(){super(...arguments),this.renderOrigin=e=>{const{onClick:t,...i}=(0,m.Z)(e,{onClick:this.props.onClick,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave});return(0,le.jsx)(v.Z,{store:this.clonedStore,canDropOnto:!0,onSelectableDrop:e=>function(e,t){const{droppedStores:i,duplicate:o}=e;o||u.createAndCommit({userAction:"SidebarTrashButton.handleDrop",environment:t,perform:e=>{d.Cl({environment:t,blocks:i,transaction:e})}})}(e,this.environment),analyticsName:"sidebar_trash",shouldShowDropZone:!0,children:(0,le.jsx)(f.Z,{...i,style:this.props.buttonStyle,onClick:t||(e=>Me(e,this.environment)),mobileFeedback:this.props.isMobile,children:(0,le.jsx)(S.Z,{left:(0,le.jsx)(xe,{}),style:{...p.Z.state.open&&{background:this.theme.buttonHoveredBackground}},disableMobileBorder:!0,children:(0,le.jsx)(c.FormattedMessage,{defaultMessage:"Trash",id:"sidebarTrashButton.text"})})})})}}UNSAFE_willMount(e){super.UNSAFE_willMount(e),this.clonedStore=e.store.clone()}renderComponent(){const{device:e,mobileNative:t}=this.environment,i=(null==t?void 0:t.supportsNativeHomeOnPhone())||!1;return(0,le.jsx)(y.ZP,{popupType:e.isMobile?y.Z4.SlideUp:y.Z4.Popup,hidesMobileNativeBottomBar:i,preventSlideUpTransition:i,buttonPopupStore:p.Z,alignmentToOrigin:y.vR.Start,placementToOrigin:y.pO.Right,originGap:0,onClick:e=>Me(e,this.environment),isFullWidthOnMobile:!0,render:()=>(0,le.jsx)(Se,{}),preventScaleTransition:!0,renderOrigin:this.renderOrigin})}}ye.displayName="SidebarTrashButton";const ve=ye;function Se(){window.__c={n:"SidebarTrashComponent"};const{currentSpaceStore:e}=(0,r.VK)((()=>b.default.state),[]);return e?(0,le.jsx)(ge,{spaceStore:e}):null}function xe(){window.__c={n:"IconComponent"};const e=(0,a.Fg)(),t=(0,s.O7)(),{device:i}=t,o=e.mediumIconColor;return i.isMobile?(0,l.w)({fill:o,height:16}):(0,l.w)({fill:o,width:14})}function Me(e,t){g.Z.setState({...g.Z.state,currentTab:"all_pages"}),function(e){h.j(e,"open_trash")}(t)}},40698:(e,t,i)=>{i.d(t,{Im:()=>_,K0:()=>A,b6:()=>F,dQ:()=>w,pd:()=>P,re:()=>I,ss:()=>B});i(57658);var o=i(15145),n=i(35013),s=i(21321),r=i(69628),a=i(17948),l=i(42696),c=i(10405),d=i(82356),u=i(54855),h=i(46783),m=i(73426),p=i(4615),g=i(9291),b=i(57549),f=i(75754),y=i(59389),v=i(82530),S=i(33929),x=i(89014),M=i(67940),k=i(92083),C=i(29949);const T=(0,g.defineMessages)({emptyWithIcon:{defaultMessage:"Empty page with icon",id:"templatePickerHelpers.basicTemplateItems.emptyWithIcon"},empty:{defaultMessage:"Empty page",id:"templatePickerHelpers.basicTemplateItems.empty"},templates:{defaultMessage:"Templates",id:"templatePickerHelpers.basicTemplateItems.templates"},import:{defaultMessage:"Import",id:"templatePickerHelpers.basicTemplateItems.import"}}),w={name:S.default.formatMessage(T.empty),iconFn:u.a,type:"empty_page",shouldShow:()=>!0,onClick:(e,t)=>{v.createAndCommit({userAction:"templatePickerHelpers.emptyTemplateItems",environment:e,perform:i=>{y.eV({environment:e,store:t,transaction:i})}})}},I={name:S.default.formatMessage(T.templates),type:"templates",iconFn:e=>(0,m.i)(e),shouldShow:()=>!0,onClick:()=>{C.Z.open({cloneTo:"current_page",analyticsFrom:"newPage"})}},A={name:S.default.formatMessage(T.templates),type:"templates",iconFn:e=>(0,h.w)(e),shouldShow:()=>!0,onClick:()=>{C.Z.open({cloneTo:"current_page",analyticsFrom:"newPage"})}},P={name:S.default.formatMessage(T.import),type:"import",iconFn:d.l,shouldShow:()=>!0,onClick:(e,t)=>{const i=(0,p.ZP)();M.Z.setState({flowId:i}),b.Sy(e,{from:"new_page",flowId:i}),k.Z.setState({...k.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0})}},j=(0,g.defineMessages)({pageWithIcon:{defaultMessage:"Page with icon",id:"templatePickerHelpers.mobileBasicTemplateItems.pageWithIcon"},emptyPage:{defaultMessage:"Empty page",id:"templatePickerHelpers.mobileBasicTemplateItems.emptyPage"}}),B=[{name:S.default.formatMessage(j.pageWithIcon),type:"page_with_icon",shouldShow:()=>!0,onClick:(e,t)=>{v.createAndCommit({userAction:"templatePickerHelpers.mobileBasicTemplateItems",environment:e,perform:i=>{y.T_({environment:e,store:t,transaction:i})}})}},{name:S.default.formatMessage(j.emptyPage),type:"empty_page",shouldShow:()=>!0,onClick:(e,t)=>{v.createAndCommit({userAction:"templatePickerHelpers.mobileBasicTemplateItems",environment:e,perform:i=>{y.eV({environment:e,store:t,transaction:i})}})}}],R=(0,g.defineMessages)({table:{defaultMessage:"Table",id:"templatePickerHelpers.databaseTemplateNames.table"},board:{defaultMessage:"Board",id:"templatePickerHelpers.databaseTemplateNames.board"},list:{defaultMessage:"List",id:"templatePickerHelpers.databaseTemplateNames.list"},calendar:{defaultMessage:"Calendar",id:"templatePickerHelpers.databaseTemplateNames.calendar"},gallery:{defaultMessage:"Gallery",id:"templatePickerHelpers.databaseTemplateNames.gallery"},timeline:{defaultMessage:"Timeline",id:"templatePickerHelpers.databaseTemplateNames.timeline"},tableView:{defaultMessage:"Table view",id:"templatePickerHelpers.databaseTemplateNames.tableView"},boardView:{defaultMessage:"Board view",id:"templatePickerHelpers.databaseTemplateNames.boardView"},listView:{defaultMessage:"List view",id:"templatePickerHelpers.databaseTemplateNames.listView"},calendarView:{defaultMessage:"Calendar view",id:"templatePickerHelpers.databaseTemplateNames.calendarView"},galleryView:{defaultMessage:"Gallery view",id:"templatePickerHelpers.databaseTemplateNames.galleryView"},timelineView:{defaultMessage:"Timeline view",id:"templatePickerHelpers.databaseTemplateNames.timelineView"}});function Z(e){const{environment:t,store:i,viewType:n}=e;v.createAndCommit({userAction:"templatePickerHelpers.handleClickForViewType",environment:t,perform:e=>{y.Ud({environment:t,store:i,viewType:n,transaction:e}),f._({environment:t,store:i,pageVisitSource:o.tY.LinkInPage});const s=i.getCollectionViewStores()[0];s&&(0,x.u)(s.id,{viewType:n})}})}const _=[{name:S.default.formatMessage(R.table),type:"table",iconFn:l.t,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>Z({environment:e,store:t,viewType:"table"})},{name:S.default.formatMessage(R.board),type:"board",iconFn:n.i,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>Z({environment:e,store:t,viewType:"board"})},{name:S.default.formatMessage(R.list),type:"list",iconFn:a.O,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>Z({environment:e,store:t,viewType:"list"})},{name:S.default.formatMessage(R.timeline),type:"timeline",iconFn:c._,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>Z({environment:e,store:t,viewType:"timeline"})},{name:S.default.formatMessage(R.calendar),type:"calendar",iconFn:s.N,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>Z({environment:e,store:t,viewType:"calendar"})},{name:S.default.formatMessage(R.gallery),type:"gallery",iconFn:r.n,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>Z({environment:e,store:t,viewType:"gallery"})}];function F(e,t){const i=new Map(e.map((e=>[e.type,e])));return t.reduce(((e,t)=>(i.has(t)&&e.push(i.get(t)),e)),[])}},56282:(e,t,i)=>{i.d(t,{Z:()=>C});i(67294);var o=i(73935),n=i(83355),s=i(13991),r=i(6740),a=i(49085),l=i(12137),c=i(8848),d=i(22491),u=i(72126),h=i(82990),m=i(63143),p=i(9291),g=i(24677),b=i(28651),f=i(27724);class y extends a.default{getInitialState(){return{showFadeInAnimation:!1,isRepositioning:!1}}}const v=y;var S=i(23063),x=i(6685),M=i(85893);class k extends n.Z{constructor(){super(...arguments),this.storeTypes={focusStore:a.default.createClass(!1),mouseStore:b.Z,withImageRepositioningStore:v},this.renderDraggable=()=>(0,M.jsx)(x.Z,{onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,onDraggableDragEnd:this.handleDragEnd,onDraggableDragCancel:this.handleDragCancel,disabled:!this.isRepositioning(),render:e=>(0,M.jsx)("div",{...(0,d.iv)(this.getDragContainerStyle()),...e,children:this.props.render({imagePosition:this.getRenderedCoverPosition(),isRepositioning:this.isRepositioning(),showFadeInAnimation:!1})})}),this.shouldBeActiveStore=this.createComputedStore((()=>0===f.default.state.stores.length)),this.handleFocus=e=>{const t=e.target;void 0!==t&&t instanceof HTMLElement&&(0,r.E)(t)&&this.stores.focusStore.setState(!0)},this.handleBlur=e=>{this.stores.focusStore.setState(!1)},this.handleMouseMove=e=>{this.mouseStore.setState({...this.mouseStore.state,mouseEntered:!0})},this.handleMouseLeave=e=>{this.mouseStore.setState({...this.mouseStore.state,mouseEntered:!1})},this.handleMouseMoveThrottled=(0,u.P2)(this.handleMouseMove,100),this.handleMouseLeaveDebounced=(0,u.Ds)(this.handleMouseLeave,100),this.handleWindowMouseDown=e=>{const t=o.findDOMNode(this);t&&!t.contains(e.target)&&this.isRepositioning()&&this.props.onFlushTemporaryPosition({imagePosition:this.getRenderedCoverPosition(),reset:()=>{this.mouseStore.reset(),this.stores.withImageRepositioningStore.reset()}})},this.handleRepositionClick=(e,t)=>{g.ZH(this.environment);const i=new Image;i.onload=()=>{this.stores.withImageRepositioningStore.setState({...this.stores.withImageRepositioningStore.state,isRepositioning:!0,image:i})},t&&(i.src=t)},this.handleCancelClick=e=>{this.stores.withImageRepositioningStore.reset()},this.handleSavePositionClick=e=>{this.props.onFlushTemporaryPosition({imagePosition:this.getRenderedCoverPosition(),reset:()=>{this.stores.withImageRepositioningStore.reset()}})},this.handleDragStart=e=>{const t=this.isRepositioning(),{image:i}=this.stores.withImageRepositioningStore.state;if(i&&t){const e=o.findDOMNode(this);if(e&&e instanceof Element){const t=e.getBoundingClientRect().width/i.width*i.height,o=this.getRenderedCoverPosition();this.stores.withImageRepositioningStore.setState({...this.stores.withImageRepositioningStore.state,startDragImageScreenHeight:t,startDragRenderedPosition:o})}}},this.handleDragMove=e=>{if(this.isRepositioning()){const{startDragRenderedPosition:t,startDragImageScreenHeight:i}=this.stores.withImageRepositioningStore.state,o=e.diffY/(i||0)+(t||0);this.stores.withImageRepositioningStore.setState({...this.stores.withImageRepositioningStore.state,temporaryPosition:(0,u.NM)((0,l.Z)(o,0,1),4)})}},this.handleDragEnd=()=>{this.stores.withImageRepositioningStore.setState({...this.stores.withImageRepositioningStore.state,startDragImageScreenHeight:void 0,startDragRenderedPosition:void 0})},this.handleDragCancel=()=>{this.stores.withImageRepositioningStore.setState({...this.stores.withImageRepositioningStore.state,startDragImageScreenHeight:void 0,startDragRenderedPosition:void 0})}}didMount(){super.didMount(),window.addEventListener("mousedown",this.handleWindowMouseDown)}willUnmount(){super.willUnmount(),window.removeEventListener("mousedown",this.handleWindowMouseDown)}UNSAFE_willMountOrUpdate(){this.isRepositioning()&&!this.shouldBeActiveStore.state&&this.stores.withImageRepositioningStore.reset()}renderComponent(){const{device:e}=this.environment,{style:t}=this.props,{isMobile:i}=e,o=this.isRepositioning(),{mouseEntered:n}=this.mouseStore.state,s=this.stores.focusStore.state;return(0,M.jsxs)("div",{onFocus:this.handleFocus,onBlur:this.handleBlur,onMouseEnter:this.handleMouseMoveThrottled,onMouseMove:this.handleMouseMoveThrottled,onMouseLeave:this.handleMouseLeaveDebounced,...(0,d.iv)({position:"relative",width:"100%"},t),children:[this.renderDraggable(),this.renderDragMessage(),this.props.renderControl({handleRepositionClick:this.handleRepositionClick,handleSavePositionClick:this.handleSavePositionClick,handleCancelClick:this.handleCancelClick,isVisible:i||n||s||o,isRepositioning:o})]})}renderDragMessage(){const{isRepositioning:e}=this.stores.withImageRepositioningStore.state;if(!this.props.small)return(0,M.jsx)(S.Z,{isVisible:!0,animationStyle:{opacity:e?1:0},render:()=>(0,M.jsx)("div",{style:{background:c.ZP.blackWithAlpha(.4),borderRadius:4,color:c.ZP.white,fontSize:12,fontFamily:h.Z.getCompositeFontFamily(s.SP).sans,width:180,left:"calc(50% - 90px)",padding:"0.3em 1.5em 0.3em",pointerEvents:"none",position:"absolute",top:"calc(50% - 10px)",textAlign:"center"},"aria-hidden":!e,children:(0,M.jsx)(p.FormattedMessage,{defaultMessage:"Drag image to reposition",id:"withImageRepositioning.dragImage.text"})})})}isRepositioning(){return this.stores.withImageRepositioningStore.state.isRepositioning}getRenderedCoverPosition(){const{temporaryPosition:e}=this.stores.withImageRepositioningStore.state;return(0,u.hj)(e)?e:function(e,t){if("gallery"===e||"board"===e){const e=t.getFormat().card_cover_position;if((0,u.hj)(e))return e}const i=.5;if(t.isCollectionView()){const e=t.getCollectionViewCollectionStore();if(e){const t=e.getFormat().collection_cover_position;return(0,m.z4)(t)?i:t}}const o=t.getFormat().page_cover_position;if((0,u.hj)(o))return o;return i}(this.props.source,this.props.store)}get mouseStore(){return this.props.mouseStore||this.stores.mouseStore}getDragContainerStyle(){return{width:"100%",cursor:this.isRepositioning()?"move":"inherit"}}}k.displayName="WithImageRepositioning";const C=k},30664:(e,t,i)=>{i.d(t,{Z:()=>j});var o=i(67294),n=i(480),s=i(6740),r=i(86628),a=i(24405),l=i(84169),c=i(9291),d=i(25888),u=i(13991),h=i(88642),m=i(39634),p=i(97978),g=i(79897),b=i(58455),f=i(77080);var y=i(43250),v=i(98742),S=i(77907),x=i(475),M=i(16194),k=i(55031),C=i(64921),T=i(31945),w=i(26388),I=i(14694),A=i(85893);function P(e){window.__c={n:"HelpButtonOrigin"};const t=(0,n.O7)(),{isMobile:i}=t.device,d=(0,c.useIntl)(),u=(0,a.Fg)(),h=(0,r.VK)((()=>x.Z.state.open),[]),m=(0,a.yK)((e=>({helpIcon:{fill:e.mediumIconColor,width:16,height:16},hoveredStyle:{background:e.whiteButtonHoveredBackground},pressedStyle:{background:e.whiteButtonPressedBackground}})),[]),p=(0,o.useCallback)((e=>{const t=e.target;t instanceof HTMLElement&&(0,s.E)(t)&&M.Z.setState(!0)}),[]),g=(0,o.useCallback)((()=>{M.Z.setState(!1)}),[]);if(i)return(0,A.jsx)(C.Z,{hovered:h,testId:y.lmr,mobileFeedback:i,...e,children:(0,A.jsx)(I.Z,{left:(0,l.m)(m.helpIcon),disableMobileBorder:!0,children:(0,A.jsx)(c.FormattedMessage,{defaultMessage:"Help & feedback",id:"helpButton.mobileHelpFeedbackButton.label"})})});const b=d.formatMessage({defaultMessage:"Help, feedback, and keyboard shortcuts",id:"helpButton.desktopHelpButton.ariaLabel"}),f=(0,v.Z)(e,{onFocus:p,onBlur:g});return(0,A.jsx)(A.Fragment,{children:(0,A.jsx)(w.ZP,{renderTooltip:()=>(0,A.jsx)("span",{children:(0,A.jsx)(c.FormattedMessage,{defaultMessage:"Help, feedback, and {br}keyboard shortcuts",id:"helpButton.desktopHelpButton.tooltip",values:{br:(0,A.jsx)("br",{})}})}),render:e=>(0,A.jsx)(C.Z,{ariaLabel:b,className:y.lmr,testId:y.lmr,style:(0,k.y)(t,{theme:u,rightEdgeDistance:16,isInPeekRenderer:!1}),hoveredStyle:m.hoveredStyle,pressedStyle:m.pressedStyle,...(0,v.Z)(f,e),children:"?"})})})}const j=(0,c.injectIntl)((function(){window.__c={n:"HelpButton"};const e=(0,n.O7)(),{isMobile:t}=e.device,i=(0,r.VK)((()=>{var t;return(null===(t=e.mobileNative)||void 0===t?void 0:t.supportsNativeHomeOnPhone())||!1}),[e]),s=(0,o.useCallback)((()=>{d.Ar(e,{from:"corner"}),function(e){const t=b.default.state;if((0,p.Ug)()&&t.isZendeskEnabled){const{userHighestPlanType:i,isSalesAssistedPlan:o}=(0,g.rf)(e);h.j({locale:u.SP,analyticsSettings:t,isForethoughtEnabled:f.default.checkGate("forethought"),forethoughtInitializeArgs:m.z(e),userHighestPlanType:i,isSalesAssistedPlan:o,cookieService:e.cookieService})}}(e)}),[e]);return(0,A.jsx)(T.ZP,{popupType:t?T.Z4.SlideUp:T.Z4.Popup,hidesMobileNativeBottomBar:i,preventSlideUpTransition:i,renderOrigin:e=>(0,A.jsx)(P,{...e}),originGap:t?0:12,placementToOrigin:t?T.pO.Right:T.pO.Top,alignmentToOrigin:t?T.vR.Center:T.vR.End,buttonPopupStore:x.Z,onClick:s,render:()=>(0,A.jsx)(S.LazyHelpButtonContent,{shouldRenderAsStaticModal:i})})}))},61679:(e,t,i)=>{i.d(t,{$K:()=>y,Ar:()=>h,Cq:()=>k,bU:()=>g,cx:()=>v,hy:()=>b,i2:()=>S,kg:()=>x,mZ:()=>f,rO:()=>M,us:()=>p});var o=i(94184),n=i.n(o),s=i(67294),r=i(60177),a=i(64338),l=i(24405),c=i(73420),d=i(97053),u=i(85893);function h(e){let{children:t,type:i,gap:o,withBottomPadding:s,style:r}=e;window.__c={n:"Layout"};const a=(0,d.Bt)(i);return(0,u.jsx)("div",{className:n()("layout",{"layout-wide":"wide"===i,"layout-wide-right-margin-expanded":"wide-right-margin-expanded"===i,"layout-side-peek":"side-peek"===i,"layout-center-peek":"center-peek"===i,"layout-home":"home"===i,"layout-home-phone":"home-phone"===i,"layout-phone":"phone"===i,"layout-tablet":"tablet"===i,"layout-template-preview":"template-preview"===i,"layout-chat":"chat"===i}),style:{paddingBottom:s?a:void 0,gap:o,...r},children:t})}const m="layout-nested-grid",p="hide-scrollbar";function g(e){return(0,u.jsx)("div",{className:n()("layout-content",e.className),style:e.style,children:e.children})}function b(e){return(0,u.jsx)("div",{className:"layout-full",style:e.style,children:e.children})}function f(e){return(0,u.jsx)("div",{className:"layout-margin-left",children:e.children})}function y(e){return(0,u.jsx)("div",{className:"layout-margin-right",children:e.children})}const v=(0,s.forwardRef)((function(e,t){return(0,u.jsx)("div",{className:n()(m,e.className),onClick:e.onClick,style:e.style,role:e.role,id:e.id,"aria-labelledby":e["aria-labelledby"],ref:t,children:e.children})}));function S(e){return(0,u.jsx)("div",{className:n()(m,"layout-margin-scrollable",{[p]:e.hideScrollbar}),style:e.style,children:(0,u.jsx)(g,{children:e.children})})}function x(e){let{items:t,style:i}=e;window.__c={n:"LayoutTabs"};const[o,n]=s.useState(0),d=(0,s.useRef)([]),h=(0,r.Dl)();(0,a.q7)(null==h?void 0:h.domLock);const m=(0,l.yK)((e=>({icon:{width:16,height:16,fill:"currentColor"},label:{fontSize:14,fontWeight:600},tab:"centered"===i?{cursor:"pointer",border:"none",padding:"6px 12px",borderRadius:20,color:e.text.secondary,background:"none"}:{cursor:"pointer",border:"none",borderBottom:"2px solid",borderColor:"transparent",padding:"6px 8px 12px",color:e.text.secondary,background:"none"},tabSelected:"centered"===i?{color:e.text.primary,background:e.tint.regular}:{color:e.text.primary,borderColor:e.regularTextColor}})),[i]),p=(0,s.useId)(),b=(0,s.useCallback)((e=>`${p}-tab-${e}`),[p]),f=(0,s.useCallback)((e=>`${p}-tabpanel-${e}`),[p]),y=(0,s.useCallback)((e=>{let i;var s;("ArrowLeft"===e.key?(e.preventDefault(),i=(o+t.length-1)%t.length):"ArrowRight"===e.key&&(e.preventDefault(),i=(o+1)%t.length),void 0!==i)&&(n(i),null===(s=d.current[i])||void 0===s||s.focus())}),[o,t.length]);return(0,u.jsxs)(v,{children:[(0,u.jsx)(g,{children:(0,u.jsx)("div",{role:"tablist",children:(0,u.jsx)(c.X2,{justifyContent:"centered"===i?"center":"flex-start",children:t.map(((e,t)=>{var i;return(0,u.jsx)("button",{ref:e=>{e&&(d.current[t]=e)},id:b(t),role:"tab","aria-controls":f(t),"aria-selected":t===o,tabIndex:t===o?void 0:-1,onKeyDown:y,style:{...m.tab,...t===o&&m.tabSelected},onClick:e=>{e.stopPropagation(),n(t)},children:(0,u.jsxs)(c.X2,{gap:4,alignItems:"center",children:[null===(i=e.icon)||void 0===i?void 0:i.call(e,m.icon),e.label&&(0,u.jsx)("div",{style:m.label,children:e.label})]})},e.key)}))})})}),(0,u.jsx)(v,{id:f(o),role:"tabpanel","aria-labelledby":b(o),children:t[o]?t[o].children:null})]})}function M(e){return(0,u.jsx)("div",{className:"layout-column",style:{"--min-column-width":`${e.minWidth}px`,...e.style},children:e.children})}function k(e){return(0,u.jsxs)(M,{minWidth:e.minWidth,children:[e.left,e.right]})}},97053:(e,t,i)=>{i.d(t,{Bt:()=>k,Nr:()=>S,Qg:()=>M,WJ:()=>C,h9:()=>v,m4:()=>y,xC:()=>x});var o=i(480),n=i(97511),s=i(86628),r=i(41432),a=i(61045),l=i(57819),c=i(10906),d=i(92650),u=i(19124),h=i(12534),m=i(61931),p=i(16772),g=i(19111),b=i(94896),f=i(17963);function y(e){(0,h.ZP)({event:e,context:h.Af.EditorMouseDown,callback:()=>{}})}function v(e){(0,h.ZP)({event:e,context:h.Af.EditorClick,callback:()=>{}})}function S(e){return(0,s.VK)((()=>Boolean(f.Z.state.pageMap[e.id])||b.Z.state.pages.has(e.id)),[e.id])}function x(e,t){const i=(0,o.O7)(),r=(0,n.l)(),a=S(e),l=M(e);return(0,s.VK)((()=>{const o=i.currentUser.isLoggedIn(),n=r&&r.publicEditModeStore.state;return Boolean(e&&t&&e.isDefined()&&!e.isLocked()&&e.canEdit()&&!e.hasContent()&&o&&(!(null!=n&&n.hasPublicPermission)||"edit"===(null==n?void 0:n.permission))&&!a&&t.state.ready&&!l&&(!(0,u.GD)(n)||"completionPopup"!==p.default.state.type))}),[i,l,t,r,a,e])}function M(e){return(0,s.VK)((()=>{if(e.isCollectionView()){const t=e.getCollectionViewSourceCollectionStore();return!!t&&t.isSyncedCollection()}return e.isType(r.Ti.externalObjectInstancePage)}),[e])}function k(e){const{device:t,WindowSizeStore:i}=(0,o.O7)(),n=(0,s.VK)((()=>{const e=i.state.height,o=t.isMobile&&g.Z.state.open?e:0;return a._4()+o}),[i,t.isMobile]);return(0,s.VK)((()=>Boolean((0,l.RR)(p.default.state))?600:"home-phone"===e?m.jq:t.isTablet?380:t.isIOS?Math.max(350,n):t.isMobile?400:"side-peek"===e||"center-peek"===e?80:"home"===e?m.XX:"30vh"),[t,n,e])}function C(e){const t=(0,o.O7)(),i=(0,s.VK)((()=>(0,d.fg)(t,e)),[t,e]);return(0,s.VK)((()=>i&&!e.isFullWidth()?(0,d.gC)(t,(0,c.en)(e),(0,c.Ks)(e)):0),[t,i,e])}},67648:(e,t,i)=>{i.r(t),i.d(t,{default:()=>pe});var o=i(67294),n=i(83355),s=i(68719),r=i(480),a=i(41432),l=i(8848),c=i(72126),d=i(97880),u=i(36054),h=i(74487);function m(e,t,i){const{content:o,apiRequestValue:n}=i;return{id:e,content:o,action:{type:t,apiRequestValue:n}}}const p=["insertBlock","turnInto","textColor","textSelectionColor"],g=["textFormatting","slashMenu","turnInto","textColor","textSelectionColor"];function b(e,t){return{type:e,apiRequestValue:t}}function f(e,t,i){const o={type:e,from:i,data:t};return JSON.stringify(o)}const y={showActionBarMenu:h.object({required:{type:h.literal("showActionBarMenu"),data:h.object({required:{actionBarMenuId:h.literals("textColor","insertBlock","turnInto","template")},optional:{}})},optional:{}}),blockAction:h.object({required:{type:h.literals("blockAction"),data:h.object({required:{action:h.literals("bold","italic","underline","strikethrough","link","code","equation","mention","trash","comment","filePicker","indent","unindent","moveUp","moveDown","undo","redo","dismissKeyboard","more","ai")},optional:{}})},optional:{from:h.literals("mobile_action_bar","mobile_text_formatting_menu")}})},v=Object.keys(y);let S=function(e){return e[e.InvalidActionType=0]="InvalidActionType",e[e.MissingPayload=1]="MissingPayload",e[e.InvalidRequestType=2]="InvalidRequestType",e[e.InvalidData=3]="InvalidData",e}({});class x{constructor(e,t){this.type=e,this.message=t}}function M(e){return 0===e.reduce(((e,t)=>e+t.items.length),0)}var k=i(70203),C=i(9291),T=i(50906),w=i(83249),I=i(44886),A=i(52423),P=i(24677),j=i(84084),B=i(993),R=i(98104),Z=i(82530),_=i(72899),F=i(81598),N=i(28020),V=i(19124),D=i(33929),O=i(51783),L=i(68056),E=i(45162),q=i(85720),U=i(35328);var K=i(77907),W=i(41662),H=i(64359),G=i(5162),z=i(80444),$=i(27724),Y=i(10743),Q=i(24666),X=(i(57658),i(21797)),J=i(46225),ee=i(11732),te=i(68204),ie=i(31352);function oe(e){const{type:t,actionSections:i,closeParentMenu:o,context:n}=e,s={},r=[];for(const a of i){const e={id:`${a.key}`,title:a.title,items:a.actions.map((e=>{var i;const r=`${e.key}-${e.displayName||""}`;return s[r]={...e,closeParentMenu:o},{id:r,title:e.displayName||"",icon:(null===(i=e.nativeImageReference)||void 0===i?void 0:i.call(e,n))??{},action:b("webAction_genericAction",{menuType:t,actionId:r}),checked:!1}}))};r.push(e)}return{actions:s,sections:r}}function ne(e){const{key:t,displayName:i,analyticsName:o,closeParentMenu:n,action:s}=e,r=i;return{key:`action ${t}`,displayName:i?D.default.formatMessage(i):void 0,analyticsName:o||`textformatting_action_${t}`,searchName:r?`${D.default.formatMessage(r)} ${r.defaultMessage}`:void 0,validators:[],action:s,closeParentMenu:Boolean(n)}}const se={bold:ne({key:"bold",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.pk(t,["b"])}}),italic:ne({key:"italic",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.pk(t,["i"])}}),underline:ne({key:"underline",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.pk(t,["_"])}}),strikethrough:ne({key:"strikethrough",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.pk(t,["s"])}}),code:ne({key:"code",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.pk(t,["c"])}}),comment:ne({key:"comment",closeParentMenu:!0,action:async e=>{var t;let{environment:i}=e;await(null===(t=i.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),O.ol(i,!0,"mobile_action_bar")}}),equation:ne({key:"equation",closeParentMenu:!0,action:async e=>{var t;let{environment:i}=e;await(null===(t=i.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),O._W(i)}}),filePicker:ne({key:"filePicker",closeParentMenu:!0,action:async e=>{var t;let{environment:i}=e;await(null===(t=i.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),O.vs(i)}}),indent:ne({key:"indent",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.O2(t)}}),unindent:ne({key:"unindent",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.$$(t)}}),moveDown:ne({key:"moveDown",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.rZ(t)}}),moveUp:ne({key:"moveUp",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.s0(t)}}),undo:ne({key:"undo",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.i2(t)}}),redo:ne({key:"redo",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.GH(t)}}),trash:ne({key:"trash",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.fn(t)}}),mention:ne({key:"mention",closeParentMenu:!0,action:async e=>{var t;let{environment:i}=e;await(null===(t=i.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),O.Z3(i)}}),ai:ne({key:"ai",closeParentMenu:!0,action:async e=>{var t;let{environment:i}=e;await(null===(t=i.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),O.QG(i)}}),link:ne({key:"link",closeParentMenu:!0,action:async e=>{var t;let{environment:i}=e;await(null===(t=i.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),O.UF(i)}}),more:ne({key:"more",closeParentMenu:!1,action:e=>{let{environment:t}=e;O.w1(t,void 0,void 0)}}),dismissKeyboard:ne({key:"dismissKeyboard",closeParentMenu:!0,action:e=>{let{environment:t}=e}})},re=(e,t)=>{const i=ie.zK(t.textStore,t.oldTextValue,!t.isAddMenu);return(0,te.sG)({sections:J.v.state.insertActions,context:e,query:i||""}).flatMap((e=>e.actions)).map((t=>{var i;const o=`${t.key}-${t.displayName||""}`,n=(null===(i=t.nativeImageReference)||void 0===i?void 0:i.call(t,e))??{},s=b("webAction_genericAction",{menuType:"insertBlock",actionId:o});return m(o,"webAction_genericAction",{content:{type:"text_and_icon",imageReference:n,accessibilityText:t.displayName||"",text:t.displayName||""},apiRequestValue:s.apiRequestValue})})).filter(d.$K)},ae=e=>{const t=te.L1([ee.g],e).flatMap((t=>t.actions.map((t=>{var i;const o=`${t.key}-${t.displayName||""}`,n=(null===(i=t.nativeImageReference)||void 0===i?void 0:i.call(t,e))??{},s=b("webAction_genericAction",{menuType:"turnInto",actionId:o});return m(o,"webAction_genericAction",{content:{type:"text_and_icon",imageReference:n,accessibilityText:t.displayName||"",text:t.displayName||""},apiRequestValue:s.apiRequestValue})})))).filter(d.$K);return[m("mab.button.back","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"chevron.backward.2",localImageIdentifier:"back"},accessibilityText:""},apiRequestValue:{subMenuType:null}}),...t]},le=(e,t)=>{const i=te.L1("textColor"===t?[X.rz,X.Vm]:[X.b4,X.Sw],e).flatMap((i=>i.actions.map((i=>{var o;const n=`${i.key}-${i.displayName||""}`,s=(null===(o=i.nativeImageReference)||void 0===o?void 0:o.call(i,e))??{},r=b("webAction_genericAction",{menuType:t,actionId:n});return m(n,"webAction_genericAction",{content:{type:"text_and_icon",imageReference:s,accessibilityText:i.displayName||"",text:i.displayName||""},apiRequestValue:r.apiRequestValue})})))).filter(d.$K);return[m("mab.button.back","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"chevron.backward.2",localImageIdentifier:"back"},accessibilityText:""},apiRequestValue:{subMenuType:null}}),...i]};var ce=i(85893);const de=(0,C.defineMessages)({templatesButtonTitle:{defaultMessage:"Choose a template...",id:"mobileActionBar.templateButtonTitle"},actionMenuInsertBlockTitle:{defaultMessage:"Insert Block",id:"mobileActionBar.actionMenuTitle.insertBlock"},actionMenuTurnIntoTitle:{defaultMessage:"Turn Into",id:"mobileActionBar.actionMenuTitle.turnInto"},actionMenuColorTitle:{defaultMessage:"Color",id:"mobileActionBar.actionMenuTitle.blockColor"},accessibilityInsert:{defaultMessage:"Add block",id:"mobileActionBar.accessibility.insertBlock"},accessibilityTurnInto:{defaultMessage:"Turn into block",id:"mobileActionBar.accessibility.turnInto"},accessibilityFilePicker:{defaultMessage:"Add image",id:"mobileActionBar.accessibility.filePicker"},accessibilityMention:{defaultMessage:"Add mention",id:"mobileActionBar.accessibility.mention"},accessibilityBlockColor:{defaultMessage:"Change block color",id:"mobileActionBar.accessibility.blockColor"},accessibilityTextFormatting:{defaultMessage:"Open text formatting menu",id:"mobileActionBar.accessibility.textFormatting"},accessibilityComment:{defaultMessage:"Add comment",id:"mobileActionBar.accessibility.comment"},accessibilityTrash:{defaultMessage:"Delete block",id:"mobileActionBar.accessibility.trash"},accessibilityIndent:{defaultMessage:"Indent block",id:"mobileActionBar.accessibility.indent"},accessibilityDedent:{defaultMessage:"Unindent block",id:"mobileActionBar.accessibility.unindent"},accessibilityMoveUp:{defaultMessage:"Move a block up",id:"mobileActionBar.accessibility.moveUp"},accessibilityMoveDown:{defaultMessage:"Move a block down",id:"mobileActionBar.accessibility.moveDown"},accessibilityUndo:{defaultMessage:"Undo edit",id:"mobileActionBar.accessibility.udno"},accessibilityRedo:{defaultMessage:"Redo edit",id:"mobileActionBar.accessibility.redo"},accessibilityMore:{defaultMessage:"More block actions",id:"mobileActionBar.accessibility.more"},accessibilityBold:{defaultMessage:"Bold",id:"mobileActionBar.accessibility.bold"},accessibilityItalics:{defaultMessage:"Italicize",id:"mobileActionBar.accessibility.italics"},accessibilityUnderline:{defaultMessage:"Underline",id:"mobileActionBar.accessibility.underline"},accessibilityStrikethrough:{defaultMessage:"Strikethrough",id:"mobileActionBar.accessibility.strikethrough"},accessibilityTextColor:{defaultMessage:"Text color",id:"mobileActionBar.accessibility.textColor"},accessibilityCode:{defaultMessage:"Code",id:"mobileActionBar.accessibility.code"},accessibilityLink:{defaultMessage:"Add link",id:"mobileActionBar.accessibility.link"},accessibilityEquation:{defaultMessage:"Add equation",id:"mobileActionBar.accessibility.equation"},accessibilityCloseTextFormattingMenu:{defaultMessage:"Close text formatting menu",id:"mobileActionBar.accessibility.close"},accessibilityDismissKeyboard:{defaultMessage:"End editing",id:"mobileActionBar.accessibility.endEditing"},accessibilityCloseActionMenu:{defaultMessage:"Close menu",id:"mobileActionBar.accessibility.closeMenu"},accessibilityAi:{defaultMessage:"AI Assist",id:"mobileActionBar.accessibility.ai"}}),ue={text:!1,to_do:!0,bulleted_list:!0,numbered_list:!0,toggle:!0,column:!1,transclusion_container:!1,callout:!1,quote:!1};function he(e){var t;window.__c={n:"MobileActionBarBridgeComponent"};const{onAction:i,fallbackRenderer:n,...a}=e,l=null===(t=(0,r.O7)().mobileNative)||void 0===t?void 0:t.api.renderMobileActionBar,c=(0,s.e)(l,a);return function(e,t,i,n){var s;const a=null===(s=(0,r.O7)().mobileNative)||void 0===s?void 0:s.componentEvents;(0,o.useEffect)((()=>{if(a&&n&&t)return a.addListener(e,t,i,n)}),[e,t,i,n,a])}("MobileActionBar",c,"onAction",i),!c&&n?(0,ce.jsx)(ce.Fragment,{children:n()}):null}class me extends n.Z{constructor(){super(...arguments),this.handleMobileActionBarBridgeEvent=e=>{const{action:t}=e;switch(t.type){case"nativeAction_hideKeyboard":break;case"nativeAction_setMenuType":!function(e,t){const i=function(e){if("nativeAction_setMenuType"!==e.type)return new x(S.InvalidActionType,void 0);const t=e.apiRequestValue;if(!t||!("menuType"in t))return new x(S.MissingPayload,void 0);const i=h.object({required:{menuType:h.literals(...p,null)},optional:{}}),o=(0,u.Gu)(i,t);return o?new x(S.InvalidRequestType,JSON.stringify(o)):t.menuType}(e);if(i instanceof x)return void console.error(JSON.stringify(i));if((t.NativeMobileActionBarStore?t.NativeMobileActionBarStore.state.menuType:null)===i)ge(null,!0,t);else if((0,G.Y)("supportsNativeMobileDynamicActionBar")&&"insertBlock"===i){ge(null,!0,t);const e=Q.default.state,i="editing"===e.mode&&(0,L.QY)(e.multiSelection);i&&Z.createAndCommit({userAction:"NativeMobileActionBar.SlashMenu.insertSlash",environment:t,perform:e=>{B.hJ({environment:t,store:i.store,string:j.pZ(),selection:i.selection,disableMentions:!1,disableDateMentions:!1,disableDateReminderMentions:!1,disableSlashCommands:!1,disableEmojiCommands:!0,transaction:e})}})}else switch(ge(i,!0,t),i){case"insertBlock":O.Oh(t,"insert");break;case"turnInto":O.Oh(t,"turn_into");break;case"textColor":O.Oh(t,"color","mobile_action_bar");break;case"textSelectionColor":O.Oh(t,"color","mobile_text_formatting_menu")}}(t,this.environment);break;case"nativeAction_setSubMenuType":!function(e,t){const i=function(e){if("nativeAction_setSubMenuType"!==e.type)return new x(S.InvalidActionType,void 0);const t=e.apiRequestValue;if(!t||!("subMenuType"in t))return new x(S.MissingPayload,void 0);const i=h.object({required:{subMenuType:h.literals(...g,null)},optional:{}}),o=(0,u.Gu)(i,t);return o?new x(S.InvalidRequestType,JSON.stringify(o)):t.subMenuType}(e);if(i instanceof x)return void console.error(JSON.stringify(i));be(i,!0,t)}(t,this.environment);break;case"webAction_generic":!function(e,t,i,o,n,s,r){const a=function(e){if("webAction_generic"!==e.type)return new x(S.InvalidActionType,void 0);const t=e.apiRequestValue;if(!t||!("jsonPayload"in t))return new x(S.MissingPayload,void 0);const i=JSON.parse(t.jsonPayload),o=h.object({required:{type:h.literals(...v)},optional:{}}),n=(0,u.Gu)(o,i);if(n)return new x(S.InvalidRequestType,JSON.stringify(n));const s=i,r=y[s.type],a=(0,u.Gu)(r,s);return a?new x(S.InvalidData,JSON.stringify(a)):s}(e);if(a instanceof x)return void console.error(JSON.stringify(a));switch(a.type){case"blockAction":if("dismissKeyboard"===a.data.action){!function(e,t){P.ZH(t),W.HM.clearSelection(),e.store.update((e=>({...e,isInsertOpen:!1}))),ge(null,!1,t),be(null,!1,t),O.Oh(t,"hide_keyboard"),R.sD()}(s,r);break}const e=se[a.data.action];if(!e)break;const l=e.action;if(l){const{mainEditorCurrentBlockStore:s}=z.default.state;if(!s)break;const{device:a}=r;e.closeParentMenu&&!a.isTablet&&ge(null,!0,r),l({environment:r,blocks:[s],publicEditMode:void 0,lazyDependencies:{markdownLinkifyIt:t,tinyMceMicrosoftWordPasteFilter:i,ai:o,assistant:n}})}switch(a.data.action){case"comment":w.YO(r,{itemName:"comment",from:a.from})}break;case"showActionBarMenu":switch(a.data.actionBarMenuId){case"insertBlock":!function(e,t){e.store.update((e=>({...e,isInsertOpen:!0}))),O.Oh(t,"insert")}(s,r);break;case"textColor":!function(e,t){e.store.update((e=>({...e,isColorOpen:!0}))),O.Oh(t,"color")}(s,r);break;case"turnInto":!function(e,t){e.store.update((e=>({...e,isTurnIntoOpen:!0}))),O.Oh(t,"turn_into")}(s,r);break;case"template":!function(e,t){P.ZH(t),R.sD(),e.store.update((e=>({...e,isTemplatesOpen:!0}))),O.Oh(t,"templates")}(s,r)}}}(t,this.props.markdownLinkifyIt,this.props.tinyMceMicrosoftWordPasteFilter,this.props.ai,this.props.assistant,this.props.stores,this.environment);break;case"webAction_genericAction":this.handleActionRegistryAction(t)}},this.handleTextSelectionCompositeStoreChanged=()=>{if(!this.textSelectionCompositeStore.state)return;const{source:e}=this.textSelectionCompositeStore.state,{NativeMobileActionBarStore:t,device:i}=this.environment;"TextSelectionStore"!==e||null===(null==t?void 0:t.state.menuType)||i.isTablet||ge(null,!0,this.environment)},this.handleTextSelectionStoreChanged=()=>{if(!this.textSelectionPositionsStore.state)return;const{NativeMobileActionBarStore:e}=this.environment;e&&e.state.isSubMenuOverridden&&be(null,!1,this.environment)},this.actionBarTextSelectionStore=this.createComputedStore((()=>{const e="editing"===Q.default.state.mode&&Q.default.state.multiSelection,t=this.props.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState,i=t&&"editing"===t.mode&&t.multiSelection;return e||i||void 0}),!0),this.textSelectedBlocksStore=this.createComputedStore((()=>{var e;const t=this.actionBarTextSelectionStore.state;return t&&(null===(e=(0,E.tp)({multiSelection:t,focus:void 0,filterCommonAncestors:!1}))||void 0===e?void 0:e.stores)})),this.disableMentionCommentsStore=this.createComputedStore((()=>{const e=this.actionBarTextSelectionStore.state,t=Boolean(e&&(0,L.qS)(e)),i=this.props.currentBlockStore.getType();return{disableCommentAction:function(e,t){if(e&&(0,a._T)(e,t))return!0;return!1}(i,this.props.currentBlockStore.getFormat())||Boolean(this.renderStore.state.disableComment),disableLinkAction:!t,disableMentionAction:!t||function(e){if(e&&(0,a.lQ)(e))return!0;return!1}(i),disableEquationAction:!t}})),this.disableIndentStore=this.createComputedStore((()=>{const e=$.default.state.stores;return{disableIndent:!e.every(I.nt),disableUnindent:!e.every(I.gq)}})),this.disableUndoRedoStore=this.createComputedStore((()=>({disableUndo:!A.L0(),disableRedo:!A.AZ()}))),this.isEditingCurrentPageTitleStore=this.createComputedStore(N.JE),this.isEditingCollectionViewTitleStore=this.createComputedStore(N.VV),this.showTemplatesButtonStore=this.createComputedStore((()=>O.Tz({environment:this.environment,store:this.props.currentBlockStore}))),this.reactiveMemoizedNativeMenusStore=this.createComputedStore((()=>this.memoizedNativeMenus({blocks:$.default.state.stores,environment:this.environment}))),this.getCurrentActionBarSchema=this.createComputedStore(this.recomputeCurrentActionBarSchema.bind(this),!0,"getCurrentActionBarSchema"),this.buttonSectionsConfigStore=this.createComputedStore((()=>{var e,t;const{NativeMobileActionBarStore:i}=this.environment,o=Boolean(this.renderStore.state.disableStyleAnnotations),n=i?i.state.menuType:null;var s=null;const r=this.showTemplatesButtonStore.state,a=Boolean(null==i||null===(e=i.state)||void 0===e?void 0:e.isSubMenuOverridden),l=Y.Z.state.open,c=this.shouldShowTextActions.state,d=i?i.state.subMenuType:null;a?s=d:l?(s="slashMenu",null==i||i.update((e=>({...e,isSubMenuOverridden:!1,subMenuType:null})))):c&&!o&&(s="textFormatting",null==i||i.update((e=>({...e,isSubMenuOverridden:!1,subMenuType:null}))));const u=!this.canTriggerTextActions.state,h=!this.canTriggerBlockActions.state,{disableCommentAction:m,disableLinkAction:p,disableMentionAction:g,disableEquationAction:b}=this.disableMentionCommentsStore.state,{disableIndent:f,disableUnindent:y}=this.disableIndentStore.state,v=this.isEditingCurrentPageTitleStore.state||this.isEditingCollectionViewTitleStore.state,{disableUndo:S,disableRedo:x}=this.disableUndoRedoStore.state,k=(0,V.GD)(null===(t=this.pageContext)||void 0===t?void 0:t.publicEditModeStore.state),C=H.Z.state.isActive,T=v||C,w=this.reactiveMemoizedNativeMenusStore.state;return{selectedSubMenu:s,createAIAction:k,disableAIAction:T,disableBlockActions:h,disableCommentAction:m,disableMentionAction:g,selectedMenuType:n,disableTextFormatting:o,disableTextColorAction:M(w.textColor.sections),disableDeleteBlock:v,disableInsertBlockAction:M(w.insertBlock.sections),disableTurnIntoAction:M(w.turnInto.sections),shouldShowTemplatesButton:r,disableIndent:f,disableUnindent:y,disableUndo:S,disableRedo:x,disableTextActions:u,isEditingTitle:v,disableLinkAction:p,disableEquationAction:b,shouldShowTextActions:!0===c}})),this.templateButtonSectionsStore=this.createComputedStore((()=>({id:"mab.buttonSection.template",buttons:[m("mab.button.choose_template","webAction_generic",{content:{type:"text_and_icon",imageReference:{localImageIdentifier:"template"},text:D.default.formatMessage(de.templatesButtonTitle)},apiRequestValue:{jsonPayload:f("showActionBarMenu",{actionBarMenuId:"template"})}})]}))),this.primaryActionButtonSectionsStoreV2=this.createComputedStore((()=>{const{createAIAction:e,disableAIAction:t,disableBlockActions:i,disableCommentAction:o,disableMentionAction:n,selectedMenuType:s,disableInsertBlockAction:r,disableTurnIntoAction:a,disableTextFormatting:c,disableDeleteBlock:u,disableUndo:h,disableIndent:p,disableUnindent:g}=this.buttonSectionsConfigStore.state,b=this.textSelectedBlocksStore.state;return function(e){const{createAIAction:t,disableAIAction:i,disableBlockActions:o,disableCommentAction:n,disableMentionAction:s,selectedMenuType:r,disableInsertBlockAction:a,disableTurnIntoAction:c,disableTextFormatting:u,disableDeleteBlock:h,disableUndo:p,disableIndent:g,disableUnindent:b,someBlockPrioritizesIndentation:y,supportsSectionAnimation:v,supportsDynamicMobileActionBar:S,accessibilityTexts:x}=e,M=!(o||g&&b),k={ai:t?m("mab.button.ai","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"sparkles",localImageIdentifier:"ai",imageTintColor:(0,l.J1)(l.FN.light.purple[500])},disabled:i,accessibilityText:x.ai},apiRequestValue:{jsonPayload:f("blockAction",{action:"ai"})}}):void 0,insert:m("mab.button.insert","nativeAction_setMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"plus",localImageIdentifier:"insertBlock"},accessibilityText:x.insert,disabled:o||a,selected:"insertBlock"===r},apiRequestValue:{menuType:"insertBlock"}}),turnInto:S?m("mab.button.turnInto","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.2.squarepath",localImageIdentifier:"turnInto"},disabled:o||c,selected:"turnInto"===r,accessibilityText:x.turnInto},apiRequestValue:{subMenuType:"turnInto"}}):m("mab.button.turnInto","nativeAction_setMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.2.squarepath",localImageIdentifier:"turnInto"},disabled:o||c,selected:"turnInto"===r,accessibilityText:x.turnInto},apiRequestValue:{menuType:"turnInto"}}),filePicker:m("mab.button.filePicker","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"photo.on.rectangle.angled",localImageIdentifier:"filePicker"},disabled:o,accessibilityText:x.filePicker},apiRequestValue:{jsonPayload:f("blockAction",{action:"filePicker"})}}),mention:m("mab.button.mention","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"at",localImageIdentifier:"mention"},disabled:s,accessibilityText:x.mention},apiRequestValue:{jsonPayload:f("blockAction",{action:"mention"})}}),comment:m("mab.button.comment","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"bubble.left",localImageIdentifier:"comment"},disabled:n,accessibilityText:x.comment},apiRequestValue:{jsonPayload:f("blockAction",{action:"comment"},"mobile_action_bar")}}),biu:m("bold.italic.underline","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"textformat",localImageIdentifier:"textFormat"},disabled:u,accessibilityText:x.textFormatting},apiRequestValue:{subMenuType:"textFormatting"}}),delete:m("mab.button.delete","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"trash",localImageIdentifier:"trash"},disabled:h,accessibilityText:x.trash},apiRequestValue:{jsonPayload:f("blockAction",{action:"trash"})}}),undo:m("mab.button.undo","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.uturn.backward",localImageIdentifier:"undo"},accessibilityText:x.undo,disabled:p},apiRequestValue:{jsonPayload:f("blockAction",{action:"undo"})}}),more:m("mab.button.more","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"ellipsis",localImageIdentifier:"more"},accessibilityText:x.more,disabled:o},apiRequestValue:{jsonPayload:f("blockAction",{action:"more"})}}),indent:m("mab.button.indent","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"decrease.indent",localImageIdentifier:"unindent"},accessibilityText:x.indent,disabled:o||b},apiRequestValue:{jsonPayload:f("blockAction",{action:"unindent"})}}),unindent:m("mab.button.unindent","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"increase.indent",localImageIdentifier:"indent"},accessibilityText:x.unindent,disabled:o||g},apiRequestValue:{jsonPayload:f("blockAction",{action:"indent"})}}),moveUp:m("mab.button.moveUp","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.up.to.line.alt",localImageIdentifier:"moveUp"},accessibilityText:x.moveUp,disabled:o},apiRequestValue:{jsonPayload:f("blockAction",{action:"moveUp"})}}),moveDown:m("mab.button.moveDown","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.down.to.line.alt",localImageIdentifier:"moveDown"},accessibilityText:x.moveDown,disabled:o},apiRequestValue:{jsonPayload:f("blockAction",{action:"moveDown"})}})};if(M&&y){const e=[k.indent,k.unindent,k.moveUp,k.moveDown].filter(d.$K),t=[k.ai,k.insert,k.turnInto,k.filePicker,k.biu,k.comment,k.undo,k.mention,k.delete,k.more].filter(d.$K);return v?[{id:"mab.buttonSection.listPrioritized",buttons:e,skipSectionDivider:!0},{id:"mab.buttonSection.main",buttons:t}]:[{id:"mab.buttonSection.listPrioritized",buttons:e.concat(t),skipSectionDivider:!0}]}return[{id:"mab.buttonSection.main",buttons:[k.ai,k.insert,k.turnInto,k.filePicker,k.biu,k.comment,k.undo,k.mention,k.delete,k.indent,k.unindent,k.moveUp,k.moveDown,k.more].filter(d.$K)}]}({createAIAction:e,disableAIAction:t,disableBlockActions:i,disableCommentAction:o,disableMentionAction:n,selectedMenuType:s,disableInsertBlockAction:r,disableTurnIntoAction:a,disableTextFormatting:c,disableDeleteBlock:u,disableUndo:h,disableIndent:p,disableUnindent:g,someBlockPrioritizesIndentation:!!b&&b.some((e=>{const t=e.getType();return t&&ue[t]})),supportsSectionAnimation:this.environment.device.isIOS,supportsDynamicMobileActionBar:(0,G.Y)("supportsNativeMobileDynamicActionBar"),accessibilityTexts:{insert:D.default.formatMessage(de.accessibilityInsert),turnInto:D.default.formatMessage(de.accessibilityTurnInto),filePicker:D.default.formatMessage(de.accessibilityFilePicker),mention:D.default.formatMessage(de.accessibilityMention),comment:D.default.formatMessage(de.accessibilityComment),textFormatting:D.default.formatMessage(de.accessibilityTextFormatting),trash:D.default.formatMessage(de.accessibilityTrash),ai:D.default.formatMessage(de.accessibilityAi),undo:D.default.formatMessage(de.accessibilityUndo),more:D.default.formatMessage(de.accessibilityMore),indent:D.default.formatMessage(de.accessibilityIndent),unindent:D.default.formatMessage(de.accessibilityDedent),moveUp:D.default.formatMessage(de.accessibilityMoveUp),moveDown:D.default.formatMessage(de.accessibilityMoveDown)}})})),this.textFormattingButtonSectionsStoreV2=this.createComputedStore((()=>{const{disableCommentAction:e,selectedMenuType:t,disableTextActions:i,disableTextColorAction:o,disableLinkAction:n,disableEquationAction:s,disableBlockActions:r,disableTurnIntoAction:a,disableAIAction:c,createAIAction:u,shouldShowTextActions:h}=this.buttonSectionsConfigStore.state;return function(e){const{disableTextActions:t,boldSelected:i,italicSelected:o,underlineSelected:n,strikeSelected:s,codeSelected:r,linkSelected:a,equationSelected:c,selectedMenuType:u,disableTextColorAction:h,disableCommentAction:p,disableLinkAction:g,disableEquationAction:b,textColorImageReference:y,supportsDynamicMobileActionBar:v,accessibilityTexts:S,disableBlockActions:x,disableTurnIntoAction:M,disableAIAction:k,createAIAction:C,shouldShowTextActions:T}=e,w=T?"textSelectionColor":"textColor",I={back:m("mab.button.back","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"chevron.backward.2",localImageIdentifier:"back"},accessibilityText:S.close},apiRequestValue:{subMenuType:null}}),bold:m("mab.button.bold","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"bold",localImageIdentifier:"bold"},accessibilityText:S.bold,disabled:t,selected:i},apiRequestValue:{jsonPayload:f("blockAction",{action:"bold"})}}),italic:m("mab.button.italic","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"italic",localImageIdentifier:"italic"},disabled:t,selected:o,accessibilityText:S.italics},apiRequestValue:{jsonPayload:f("blockAction",{action:"italic"})}}),underline:m("mab.button.underline","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"underline",localImageIdentifier:"underline"},disabled:t,selected:n,accessibilityText:S.underline},apiRequestValue:{jsonPayload:f("blockAction",{action:"underline"})}}),strikethrough:m("mab.button.strikethrough","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"strikethrough",localImageIdentifier:"strikethrough"},disabled:t,selected:s,accessibilityText:S.strikethrough},apiRequestValue:{jsonPayload:f("blockAction",{action:"strikethrough"})}}),color:v?m("mab.button.textFormatting.textSelectionColor.native","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:y,disabled:t||h,selected:u===w,accessibilityText:S.textColor},apiRequestValue:{subMenuType:w}}):m("mab.button.textFormatting.textSelectionColor.native","nativeAction_setMenuType",{content:{type:"icon",imageReference:y,disabled:t||h,selected:u===w,accessibilityText:S.textColor},apiRequestValue:{menuType:w}}),comment:m("mab.button.textFormatting.comment","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"bubble.left",localImageIdentifier:"comment"},disabled:t||p,accessibilityText:S.comment},apiRequestValue:{jsonPayload:f("blockAction",{action:"comment"},"mobile_text_formatting_menu")}}),link:m("mab.button.link","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"link",localImageIdentifier:"link"},accessibilityText:S.link,disabled:t||g,selected:a},apiRequestValue:{jsonPayload:f("blockAction",{action:"link"})}}),code:m("mab.button.code","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"chevron.left.slash.chevron.right",localImageIdentifier:"code"},accessibilityText:S.code,disabled:t,selected:r},apiRequestValue:{jsonPayload:f("blockAction",{action:"code"})}}),equation:m("mab.button.equation","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"x.squareroot",localImageIdentifier:"equation"},accessibilityText:S.equation,disabled:t||b,selected:c},apiRequestValue:{jsonPayload:f("blockAction",{action:"equation"})}}),cancel:m("mab.button.cancel","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"xmark.circle.fill",localImageIdentifier:"cancel",imageTintColor:"#72706B64"},accessibilityText:S.close},apiRequestValue:{subMenuType:null}}),turnInto:m("mab.button.turnInto","nativeAction_setMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.2.squarepath",localImageIdentifier:"turnInto"},disabled:x||M,selected:"turnInto"===u,accessibilityText:S.turnInto},apiRequestValue:{menuType:"turnInto"}}),ai:C?m("mab.button.ai","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"sparkles",localImageIdentifier:"ai",imageTintColor:(0,l.J1)(l.FN.light.purple[500])},disabled:k,accessibilityText:S.ai},apiRequestValue:{jsonPayload:f("blockAction",{action:"ai"})}}):void 0};let A;return A=T?[I.back,I.turnInto,I.ai,I.color,I.comment,I.bold,I.italic,I.underline,I.strikethrough,I.link,I.code,I.equation].filter(d.$K):[I.back,I.color,I.bold,I.italic,I.underline,I.strikethrough,I.link,I.code,I.equation],{id:"mab.buttonSection.textFormatting",shouldFadeIn:!0,buttons:A}}({disableTextActions:i,disableCommentAction:e,disableLinkAction:n,disableEquationAction:s,selectedMenuType:t,disableTextColorAction:o,disableBlockActions:r,disableTurnIntoAction:a,disableAIAction:c,createAIAction:u,shouldShowTextActions:h,textColorImageReference:fe(this.textSelectionColorStore.state,this.theme),supportsDynamicMobileActionBar:(0,G.Y)("supportsNativeMobileDynamicActionBar"),accessibilityTexts:{bold:D.default.formatMessage(de.accessibilityBold),italics:D.default.formatMessage(de.accessibilityItalics),underline:D.default.formatMessage(de.accessibilityUnderline),strikethrough:D.default.formatMessage(de.accessibilityStrikethrough),textColor:D.default.formatMessage(de.accessibilityTextColor),comment:D.default.formatMessage(de.accessibilityComment),code:D.default.formatMessage(de.accessibilityCode),link:D.default.formatMessage(de.accessibilityLink),equation:D.default.formatMessage(de.accessibilityEquation),close:D.default.formatMessage(de.accessibilityCloseTextFormattingMenu),turnInto:D.default.formatMessage(de.accessibilityTurnInto),ai:D.default.formatMessage(de.accessibilityAi)},...this.textFormattingSelectionStore.state})})),this.mainButtonSectionsStoreV2=this.createComputedStore((()=>{const{shouldShowTemplatesButton:e}=this.buttonSectionsConfigStore.state;return e?[this.templateButtonSectionsStore.state]:this.primaryActionButtonSectionsStoreV2.state})),this.textSelectionPositionsStore=this.createComputedStore((()=>{const e=this.textSelectionCompositeStore.state;if(!e)return;const{source:t,...i}=e;return i}),!0),this.slashSubMenuStore=this.createComputedStore((()=>{if(!(0,G.Y)("supportsNativeMobileDynamicActionBar"))return{id:"mab.buttonSection.slashMenu",shouldFadeIn:!0,buttons:[]};const e=Y.Z.state;if(!e.open)return{id:"mab.buttonSection.slashMenu",shouldFadeIn:!0,buttons:[]};const t={environment:this.environment,blocks:$.default.state.stores,publicEditMode:void 0};return{id:"mab.buttonSection.slashMenu",shouldFadeIn:!0,buttons:re(t,e)}})),this.turnIntoSubmenuStore=this.createComputedStore((()=>{if(!(0,G.Y)("supportsNativeMobileDynamicActionBar"))return{id:"mab.buttonSection.turnInto",shouldFadeIn:!0,buttons:[]};const e={environment:this.environment,blocks:$.default.state.stores,publicEditMode:void 0};return{id:"mab.buttonSection.turnInto",shouldFadeIn:!0,buttons:ae(e)}})),this.textColorSubmenuStore=this.createComputedStore((()=>{if(!(0,G.Y)("supportsNativeMobileDynamicActionBar"))return{id:"mab.buttonSection.textColor",shouldFadeIn:!0,buttons:[]};const e={environment:this.environment,blocks:$.default.state.stores,publicEditMode:void 0};return{id:"mab.buttonSection.textColor",shouldFadeIn:!0,buttons:le(e,"textColor")}})),this.textSelectionColorSubmenuStore=this.createComputedStore((()=>{if(!(0,G.Y)("supportsNativeMobileDynamicActionBar"))return{id:"mab.buttonSection.textSelectionColor",shouldFadeIn:!0,buttons:[]};const e={environment:this.environment,blocks:$.default.state.stores,publicEditMode:void 0};return{id:"mab.buttonSection.textSelectionColor",shouldFadeIn:!0,buttons:le(e,"textSelectionColor")}})),this.textSelectionCompositeStore=this.createComputedStore((()=>{const e=(e,t)=>{if(!e||"editing"!==e.mode)return;const{multiSelection:i}=e;return{startRecord:i.start.store.pointer,startIndex:i.start.index,endRecord:i.end.store.pointer,endIndex:i.end.index,source:t}};return e(Q.default.state,"TextSelectionStore")||e(this.props.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState,"IgnoreSelectionAreaStore")}),!0),this.renderStore=this.createComputedStore((()=>{var e;const t=O.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state);if(!t){const e=this.environment.NativeMobileActionBarStore;null!==(null==e?void 0:e.state.menuType)&&c.gw((()=>{var e;O.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state)||ge(null,!1,this.environment)}),500),null!==(null==e?void 0:e.state.subMenuType)&&c.gw((()=>{var e;O.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state)||be(null,!1,this.environment)}),500)}return t})),this.shouldShowTextActions=this.createComputedStore((()=>O.oQ(this.props.stores.ignoreSelectionAreaStore,this.environment.TextSelectionCompositionStore))),this.canTriggerBlockActions=this.createComputedStore((()=>O.Bo(this.pageContext&&this.pageContext.publicEditModeStore.state))),this.canTriggerTextActions=this.createComputedStore((()=>O.eQ(this.pageContext&&this.pageContext.publicEditModeStore.state,this.props.currentBlockStore))),this.memoizedNativeMenus=c.HP((e=>{const{blocks:t,environment:i}=e;return o={environment:i,blocks:t,publicEditMode:void 0},{insertBlock:oe({type:"insertBlock",actionSections:te.L1(J.v.state.insertActions,o),context:o,closeParentMenu:!0}),turnInto:oe({type:"turnInto",actionSections:te.L1([ee.g],o),context:o,closeParentMenu:!0}),textColor:oe({type:"textColor",actionSections:te.L1([X.rz,X.Vm],o),context:o,closeParentMenu:!0}),textSelectionColor:oe({type:"textSelectionColor",actionSections:te.L1([X.b4,X.Sw],o),context:o,closeParentMenu:!0})};var o}),(e=>{let{blocks:t,environment:i}=e;const o=t.map((e=>e.key)).join(",");return`${i.key}-${o}`})),this.textFormattingSelectionStore=this.createComputedStore((()=>{let e;e="editing"===Q.default.state.mode?(0,q.k2)([k.GKr.Bold,k.GKr.Italic,k.GKr.Underline,k.GKr.Strike,k.GKr.Code,k.GKr.Link,k.GKr.Equation,k.GKr.Highlight],Q.default.state.multiSelection,Q.default.state.forceExtendAnnotations):{};const t=e[k.GKr.Highlight];return{boldSelected:Boolean(e[k.GKr.Bold]),italicSelected:Boolean(Boolean(e[k.GKr.Italic])),underlineSelected:Boolean(Boolean(e[k.GKr.Underline])),strikeSelected:Boolean(Boolean(e[k.GKr.Strike])),codeSelected:Boolean(e[k.GKr.Code]),linkSelected:Boolean(e[k.GKr.Link]),equationSelected:Boolean(e[k.GKr.Equation]),highlightColor:t?(0,k.zIN)(t):void 0}})),this.textSelectionColorStore=this.createComputedStore((()=>{const{NativeMobileActionBarStore:e}=this.environment,t=e&&null!==e.state.menuType?this.props.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState:void 0;if(!t)return this.textFormattingSelectionStore.state.highlightColor;const i="editing"===t.mode&&(0,q.a6)("h",t.multiSelection,t.forceExtendAnnotations);return i?(0,k.zIN)(i):void 0}))}didMount(){this.textSelectionCompositeStore.addListener(this.handleTextSelectionCompositeStoreChanged),this.textSelectionPositionsStore.addListener(this.handleTextSelectionStoreChanged)}willUnmount(){this.textSelectionCompositeStore.removeListener(this.handleTextSelectionCompositeStoreChanged),this.textSelectionPositionsStore.removeListener(this.handleTextSelectionStoreChanged),this.props.renderApi&&this.props.renderApi({type:"unmount",id:""})}renderComponent(){const{fallbackRenderer:e,stores:t}=this.props;return(0,ce.jsx)(he,{isOpen:this.renderStore.state.shouldShow,canShow:this.renderStore.state.canShowNativeBar,isEmpty:this.renderStore.state.isEmpty,schema:this.getCurrentActionBarSchema.state,onAction:this.handleMobileActionBarBridgeEvent,fallbackRenderer:e&&(()=>e(t))})}recomputeCurrentActionBarSchema(){const{selectedMenuType:e,selectedSubMenu:t}=this.buttonSectionsConfigStore.state,i=(0,G.Y)("supportsNativeMobileDynamicActionBar"),o=this.reactiveMemoizedNativeMenusStore.state;return function(e){const{selectedMenu:t,selectedSubMenu:i,nativeMenus:o,buttonSections:n,nativeSubMenus:s,accessibilityTexts:r}=e;return{nativeMenus:o,nativeSubMenus:s,state:{buttonSections:n,selectedMenu:t,selectedSubMenu:i,dismissKeyboardButton:null!==t?m("mab.dismissKeyboard","nativeAction_setMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"xmark.circle.fill",localImageIdentifier:"cancel",imageTintColor:"#72706B64"},accessibilityText:r.closeActionMenu},apiRequestValue:{menuType:null}}):m("mab.dismissKeyboard","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"keyboard.chevron.compact.down",localImageIdentifier:"keyboardDown"},accessibilityText:r.dismissKeyboard},apiRequestValue:{jsonPayload:f("blockAction",{action:"dismissKeyboard"})}}),mutatedNativeMenus:{},localizedMessages:{}}}}({selectedMenu:e,selectedSubMenu:t,nativeMenus:{textColor:{id:"textColor",title:D.default.formatMessage(de.actionMenuColorTitle),sections:i?[]:o.textColor.sections},textSelectionColor:{id:"textSelectionColor",title:D.default.formatMessage(de.actionMenuColorTitle),sections:i?[]:o.textSelectionColor.sections},insertBlock:{id:"insertBlock",title:D.default.formatMessage(de.actionMenuInsertBlockTitle),sections:i?[]:o.insertBlock.sections},turnInto:{id:"turnInto",title:D.default.formatMessage(de.actionMenuTurnIntoTitle),sections:i?[]:o.turnInto.sections}},nativeSubMenus:{textFormatting:[this.textFormattingButtonSectionsStoreV2.state],slashMenu:[this.slashSubMenuStore.state],turnInto:[this.turnIntoSubmenuStore.state],textColor:[this.textColorSubmenuStore.state],textSelectionColor:[this.textSelectionColorSubmenuStore.state]},buttonSections:this.mainButtonSectionsStoreV2.state,accessibilityTexts:{dismissKeyboard:D.default.formatMessage(de.accessibilityDismissKeyboard),closeActionMenu:D.default.formatMessage(de.accessibilityCloseActionMenu)}})}handleActionRegistryAction(e){var t,i;const{markdownLinkifyIt:o,tinyMceMicrosoftWordPasteFilter:n,ai:s,assistant:r}=this.props,a=null===(t=e.apiRequestValue)||void 0===t?void 0:t.menuType,l=null===(i=e.apiRequestValue)||void 0===i?void 0:i.actionId;if(!a||!l)return;const c=this.memoizedNativeMenus({environment:this.environment,blocks:$.default.state.stores})[a].actions[l];if(!c)return;const d=c.action;d&&(c.closeParentMenu&&ge(null,!0,this.environment),(0,G.Y)("supportsNativeMobileDynamicActionBar")&&Y.Z.state.open&&Z.createAndCommit({userAction:"NativeMobileActionBar.SlashMenu.handleAccept",environment:this.environment,perform:e=>{j.RL({environment:this.environment,transaction:e})}}),d({environment:this.environment,blocks:$.default.state.stores,publicEditMode:void 0,lazyDependencies:{markdownLinkifyIt:o,tinyMceMicrosoftWordPasteFilter:n,ai:s,assistant:r}}));const u=$.default.state.stores[0];if(u){const e=u.getType(),t=u.getFormat();T.dh(this.environment,{analyticsName:c.analyticsName,action_type:c.analyticsActionType,from:"slash_menu",block_id:u.id,block_type:e,is_toggleable:e?(0,U._A)(e,t):void 0,slash_menu_filter_length:0,slash_menu_section:`Mobile Action Bar ${a}`})}}}function pe(e){window.__c={n:"NativeMobileActionBarWithDeps"};const t=(0,C.useIntl)(),{value:i}=(0,K.useDependency)(K.deps.markdownLinkifyIt),{value:o}=(0,K.useDependency)(K.deps.tinyMceMicrosoftWordPasteFilter),{value:n}=(0,K.useDependency)(_.E0),{value:s}=(0,K.useDependency)(F.L6);return(0,ce.jsx)(me,{...e,intl:t,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:o,ai:n,assistant:s})}function ge(e,t,i){var o;null===(o=i.NativeMobileActionBarStore)||void 0===o||o.update((i=>({...i,menuType:e,shouldRestoreSelectionForMenu:t})))}function be(e,t,i){const{NativeMobileActionBarStore:o}=i;null==o||o.update((i=>({...i,isSubMenuOverridden:t,subMenuType:e}))),null!==e&&O.Oh(i,e)}function fe(e,t){let i="textColor";const o=l.E_.find((t=>t===e));let n;"default"===e||o&&(o.includes("background")?(n="background",i="textBackgroundColor"):n="color");const s=n&&o?(0,l.fi)(o,t)[n]:void 0;return{localImageIdentifier:i,imageTintColor:s?(0,l.J1)(s):void 0}}me.displayName="NativeMobileActionBar"},40090:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Qe});i(57658);var o=i(67294),n=i(83355),s=i(1302),r=i(480),a=i(86628),l=i(24405),c=i(27328),d=i(99747),u=i(15145),h=i(8848),m=i(42853),p=i(63261),g=i(44495),b=i(14198),f=i(6568),y=i(35840),v=i(89101),S=i(21202),x=i(82990),M=i(51454),k=i(9291),C=i(50906),T=i(83249),w=i(19719),I=i(11302),A=i(75754),P=i(8055),j=i(1357),B=i(87531),R=i(24677),Z=i(29974),_=i(98104),F=i(82530),N=i(39865),V=i(3043),D=i(7476),O=i(34047),L=i(24098),E=i(28020),q=i(43250),U=i(87279),K=i(46654),W=i(58239),H=i(18514),G=i(38755),z=i(77907),$=i(64719),Y=i(81170),Q=i(94841),X=i(57345),J=i(74948),ee=i(24646),te=i(38676),ie=i(21853),oe=i(4023),ne=i(5162),se=i(80444),re=i(77080),ae=i(92547),le=i(69454),ce=i(42330),de=i(30496),ue=i(68373),he=i(24666),me=i(52258),pe=i(66708),ge=i(91754),be=i(15560),fe=i(64921),ye=i(31945),ve=i(61519),Se=i(73063),xe=i(78140),Me=i(40721),ke=i(89728),Ce=i(53437),Te=i(31278),we=i(76798),Ie=i(45653),Ae=i(39849),Pe=i(84178),je=i(81258),Be=i(84708),Re=i(61208),Ze=i(85893);function _e(){window.__c={n:"MobileUpdatesModalPageTab"};const e=(0,o.useCallback)((()=>(0,Ze.jsx)(Re.Z,{message:(0,Ze.jsx)(k.FormattedMessage,{defaultMessage:"Any changes to this page will show up here.",id:"updatesModal.currentPageTab.emptyPrompt"}),title:(0,Ze.jsx)(k.FormattedMessage,{defaultMessage:"No page updates",id:"updatesModal.currentPageTab.emptyPromptTitle"})})),[]),t=(0,a.VK)((()=>se.default.state.currentSpaceStore),[]),i=(0,a.VK)((()=>se.default.state.mainEditorCurrentBlockStore),[]),n=(0,a.VK)((()=>{var e;const t=null==i||null===(e=i.getCollectionPointer())||void 0===e?void 0:e.id,o=null==i?void 0:i.isCollectionView();return null!=i&&i.isDefined()?{id:i.id,isCollection:o,collectionId:t}:void 0}),[i]),s=(0,l.yK)((()=>({getNotifiedFor:{padding:18}})),[]);return t&&n&&i?(0,Ze.jsxs)("div",{children:[(0,Ze.jsx)("div",{style:s.getNotifiedFor,children:(0,Ze.jsx)(Pe.GetNotifiedFor,{navigableBlock:i,from:"page_updates",buttonPopupStore:je.Z})}),(0,Ze.jsx)(Be.Z,{navigableBlock:i,collectionId:n.collectionId,spaceId:t.id,empty:e,source:"updates_sidebar"},"current-page")]}):null}var Fe=i(92955),Ne=i(22789),Ve=i(13612),De=i(35767),Oe=i(10388),Le=i(61881),Ee=i(61394),qe=i(84920),Ue=i(24097),Ke=i(42543),We=i(72485),He=i(86467),Ge=i(7715),ze=i(82774),$e=i(94107);class Ye extends n.Z{constructor(){super(...arguments),this.isMyTasks=this.createComputedStore((()=>(0,E.qG)(this.props.store.id))),this.hasUnreadCommentsStore=this.createComputedStore((()=>(0,O.DF)({blockStore:this.props.store,currentUserId:this.environment.currentUser.id}).some((e=>!e.getResolved()&&(0,O.NI)(e).some((t=>D.t({discussionStore:e,commentStore:t})))))),!1)}renderComponent(){const{store:e}=this.props,{WindowSizeStore:t,device:i}=this.environment,o=(0,K.IJ)(this.environment,this.props.store),n=new ae.Z,s=(e.isLocked()||n.state.justUnlocked)&&e.canEdit(),r=(!o||e.canEditCollection())&&i.isPhone&&(e.isRestricted()||s);return(0,Ze.jsx)(L.Z,{capture:!0,render:i=>(0,Ze.jsxs)("header",{...i,style:{width:"100%",maxWidth:"100vw",zIndex:M.lI},children:[o?(0,Ze.jsx)(ut,{store:this.props.store,shouldShowAddTo:this.props.shouldShowAddTo}):this.renderNormalTopbar(),r&&(0,Ze.jsxs)(ge.Z,{styleKey:ge.v.White,isMobile:!0,style:{justifyContent:"unset"},children:[(0,Ze.jsx)(Ne.Z,{store:this.props.store,isMobile:!0,lockStore:n},this.props.store.id),e.isRestricted()&&(0,Ze.jsxs)(Ze.Fragment,{children:[s&&(0,Ze.jsx)(ve.Z,{vertical:!0,size:10,style:{height:"50%"}}),(0,Ze.jsx)(Ge.Z,{style:{marginRight:8},onClick:()=>X.lG(this.environment)})]})]}),this.props.isOffline&&(0,Ze.jsx)(ge.Z,{styleKey:ge.v.White,isMobile:!0,children:(0,Ze.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"100%",paddingLeft:t.getSafePaddingLeftCSS(10),paddingRight:t.getSafePaddingRightCSS(14)},children:[(0,b.K)({width:26,marginRight:12}),(0,Ze.jsx)("div",{children:(0,Ze.jsx)(k.FormattedMessage,{defaultMessage:"You're offline",id:"topbarMobile.offline.message"})})]})}),(0,Ze.jsx)(z.LazyBannersRenderer,{banners:this.props.banners,isMobile:!0,isInPeekRenderer:!1})]})})}renderNormalTopbar(){const{store:e,pageVisitStore:t,presenceStore:i,hideActionButtons:o}=this.props,{device:n}=this.environment,{isTablet:s}=n,r=this.props.isInvalidPage,a=nt(this.environment),l=(0,Q.WE)(e);let c=this.renderRightButtons();!function(e,t){return e&&function(e){return e.isEmptyTitle()&&e.isEmptyPage()}(t)}(this.props.shouldShowAddTo,this.props.store)?this.isMyTasks.state&&(c=(0,Ze.jsx)(et,{store:this.props.store,spaceViewStore:this.props.spaceViewStore,isInvalidPage:this.props.isInvalidPage})):c=(0,Ze.jsx)(mt,{});const d=l?(0,Ze.jsxs)(Ze.Fragment,{children:[(0,Ze.jsx)(be.Z,{style:{background:this.theme.home.betaBadge.background,color:this.theme.home.betaBadge.color}}),(0,Ze.jsx)($.E,{store:e,isInvalidPage:Boolean(r)})]}):(0,Ze.jsxs)(Ze.Fragment,{children:[e.isRestricted()&&s&&(0,Ze.jsx)(Ge.Z,{style:{marginRight:8},onClick:()=>X.lG(this.environment)}),s&&e.canEdit()&&t&&i&&(0,Ze.jsx)(He.Z,{rootStore:e,pageVisitStore:t,presenceStore:i}),c]});return(0,Ze.jsxs)("div",{onClick:()=>ct(this.environment),style:at(this.props.shouldShowAddTo,this.environment,this.theme),className:q.ZHw,children:[(u=this.environment,(ot(u)||!(0,ne.Y)("supportsNativeHome"))&&(0,Ze.jsx)(rt,{})),a&&(0,Ze.jsx)(Ee.Z,{supportsNativeHomeTabPhone:!s&&(0,ne.Y)("supportsNativeHome")}),!r&&(0,Ze.jsx)(gt,{shouldShowAddTo:this.props.shouldShowAddTo,store:this.props.store,saveParent:this.props.saveParent,showingHistoryButtons:a}),e.canEditCollection()&&s&&(0,Ze.jsx)(Ne.Z,{store:e,isMobile:!1},e.id),(0,Ze.jsx)(qe.Z,{}),!o&&d]});var u}renderRightButtons(){const{store:e,spaceStore:t,isInvalidPage:i}=this.props;if(i)return;const n=Boolean(t&&!t.canEdit()),s=e.canEdit(),r=(0,Le.UP)({isSpaceGuest:n,canEditPage:s}),a=(0,Le.W2)({canEditPage:s,device:this.environment.device}),l=re.default.checkGate("show_topbar_layout_info_button");return(0,Ze.jsxs)(o.Fragment,{children:[(0,Ze.jsx)(Xe,{}),r&&(0,Ze.jsx)(it,{store:this.props.store}),this.renderCommentsButton(),l&&(0,Ze.jsx)(pt,{intl:this.props.intl}),a&&(0,Ze.jsx)($e.l,{onClick:()=>{return e=this.environment,de.Z.setState({open:!0}),void w.gM(e);var e}}),(0,Ze.jsx)(tt,{store:this.props.store,collectionViewStore:this.props.collectionViewStore})]})}renderCommentsButton(){return(0,Ze.jsx)(ye.ZP,{buttonPopupStore:ie.Z,popupType:ye.Z4.SlideUp,alignmentToOrigin:oe.v.Start,placementToOrigin:oe.u.Right,originGap:0,stopClickPropagation:!0,isWideTabletWidth:!0,render:e=>(0,Ze.jsx)(xe.Z,{menuType:U.og.Modal,scrollerStyle:{paddingBottom:0},title:(0,Ze.jsx)(k.FormattedMessage,{defaultMessage:"Comments",id:"topbarMobile.commentsMenu.title"}),right:(0,Ze.jsx)(Me.DoneMenuText,{}),onClickRight:e.close,children:(0,Ze.jsx)(De.J,{timeMounted:Date.now(),location:"popup"})}),isFullWidthOnMobile:!0,preventScaleTransition:!0,renderOrigin:e=>(0,Ze.jsxs)("div",{style:{position:"relative",height:"100%"},children:[(0,Ze.jsx)(Se.Z,{icon:f.a,iconStyle:{width:26,height:26,fill:"inherit"},isDarkIconColor:!0,style:{marginLeft:6,marginRight:6,height:"100%"},mobileFeedback:!0,...e}),this.hasUnreadCommentsStore.state&&(0,Ze.jsx)("div",{style:{position:"absolute",top:9,right:5,height:8,width:8,borderRadius:4,background:h.ZP.red}})]})})}}Ye.displayName="TopbarMobile";const Qe=(0,k.injectIntl)(Ye);function Xe(){window.__c={n:"PageUpdatesPopupOrigin"};const e={menuType:U.og.Modal,title:(0,Ze.jsx)(k.FormattedMessage,{defaultMessage:"Page Updates",id:"pageUpdatesModal.mobileMenu.title"}),right:(0,Ze.jsx)(Me.DoneMenuText,{}),onClickRight:()=>de.Z.setState({open:!1}),whiteBackground:!0},t=(0,a.VK)((()=>de.Z.state.open),[]);return(0,Ze.jsx)(Ce.ZP,{open:t,popupType:ye.Z4.SlideUp,alignmentToOrigin:oe.v.Start,placementToOrigin:oe.u.Right,onDismiss:()=>de.Z.setState({open:!1}),originGap:0,isWideTabletWidth:!0,render:()=>(0,Ze.jsx)(xe.Z,{...e,children:(0,Ze.jsx)(_e,{})}),isFullWidthOnMobile:!0,preventScaleTransition:!0})}function Je(e){const t=e.getParentStore(),{currentSpaceStore:i}=se.default.state;return t instanceof ue.H2&&i&&t.id===i.id}function et(e){let{store:t,spaceViewStore:i,isInvalidPage:o}=e;return o||!i?null:(0,Ze.jsxs)(Ze.Fragment,{children:[(0,Ze.jsx)(Ue.Z,{store:t,spaceViewStore:i}),(0,Ze.jsx)(Y.Z,{})]})}function tt(e){let{store:t,collectionViewStore:i}=e;return(0,Ze.jsx)(We.Z,{store:t,collectionViewStore:i,buttonPopupStore:me.Z})}function it(e){let{store:t}=e;return(0,Ze.jsx)(ze.Z,{store:t,buttonPopupStore:pe.Z})}function ot(e){return(0,ne.Y)("supportsNativeHome")&&e.device.isTablet}function nt(e){const{TabbedRouterStore:t}=e,i=(0,H.NW)(e)||"native"===(0,c.w_)(t.state).type;return!(0,H.__)(e)||i}function st(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0;const{mobileNative:o}=e;return{flexGrow:0,marginLeft:null!=o&&o.supportsNativeHomeOnPhone()?t?0:20:2,overflow:"auto",WebkitOverflowScrolling:"touch",marginRight:i?16:8,height:"100%"}}function rt(){window.__c={n:"HamburgerButton"};const e=(0,r.O7)();return(0,Ze.jsxs)(fe.Z,{mobileFeedback:!0,style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,height:"100%",width:36,marginLeft:4},onClick:()=>{var t;if(ot(e))null===(t=e.mobileNative)||void 0===t||t.toggleNativeHome();else if((0,ee.Jr)(e))J.setExpand({environment:e,isExpanded:!te.sidebarExpandedStore.state,from:"topbar_mobile"});else{const{NativeMobileActionBarStore:t}=e,i=t?t.state.menuType:null;"editing"===he.default.state.mode||null!==i?(_.ZH(e),null==t||t.clear(!1),le.Z.onHide((()=>{s.default.afterNextFlush((()=>J.open({fromElectron:!1})))}))):J.open({fromElectron:!1})}T.jD(e)},children:[(0,p._)({width:18,height:18}),(0,Ze.jsx)(Fe.Z,{type:e.device.isMobileBrowser?"allSpaces":"otherSpaces",color:Ae.N.Red,style:{position:"absolute",top:9,right:1}})]})}function at(e,t,i){const{WindowSizeStore:o}=t;return{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",maxWidth:"100vw",height:d.g,marginTop:o.state.paddingTopCSS,paddingLeft:o.getSafePaddingLeftCSS(0),paddingRight:e?o.getSafePaddingRightCSS(0):o.getSafePaddingRightCSS(7),boxShadow:`0 1px 0 ${i.regularDividerColor}`,background:i.contentBackground,transition:"box-shadow 300ms",WebkitUserSelect:"none",cursor:"pointer"}}function lt(){window.__c={n:"ChevronComponent"};const e=(0,l.Fg)();return(0,m.i)({marginLeft:4,width:10,fill:e.lightTextColor})}function ct(e){R.ZH(e)}async function dt(e,t,i){await I.$X({environment:i,blocks:[e],moveToContext:"quick_add",onAccept:e=>function(e,t,i){const{currentSpaceStore:o}=se.default.state;o&&t&&(0,W.rq)({currentUserId:i.currentUser.id,spaceId:o.id,value:e}),T.xx(i)}(e,t,i),isAddTo:!0,isDefaultPrivateLocation:Je(e)})}function ut(e){let{store:t,shouldShowAddTo:i}=e;window.__c={n:"PublicPageTopbarComponent"};const n=(0,l.Fg)(),s=(0,r.O7)(),c=Boolean(s.currentUser.isLoggedIn()||s.publicDomainUserId),d=(0,a.VK)((()=>s.device.isTablet),[s]),h=(0,a.VK)((()=>at(i,s,n)),[s,i,n]),m=(0,a.VK)((()=>st(s,!0,d)),[s,d]);return(0,Ze.jsxs)("div",{onClick:()=>ct(s),style:h,className:q.ZHw,children:[s.currentUser.isLoggedIn()&&(0,Ze.jsxs)(o.Fragment,{children:[(0,Ze.jsx)(fe.Z,{style:{display:"flex",alignItems:"center",height:"100%",paddingLeft:14,paddingRight:14,fontWeight:x.Z.fontWeight.medium,color:n.regularTextColor,whiteSpace:"nowrap"},mobileFeedback:!0,onClick:()=>function(e){const{currentUserRootStore:t,currentUserSettingsStore:i}=se.default.state;t&&i&&Z.L5({environment:e,userRootStore:t,userSettingsStore:i,pageVisitSource:u.tY.SwitchSpace})}(s),children:(0,Ze.jsx)(k.FormattedMessage,{defaultMessage:"Back",id:"topbarMobile.backButton.label"})}),(0,Ze.jsx)("div",{style:{height:18,width:1,flexShrink:0,marginRight:6,background:n.darkDividerColor}})]}),(0,Ze.jsx)(V.l2,{store:t,style:m,maxAncestorCount:1,showCurrentPageControls:!1,ancestorMaxWidth:100,currentPageMaxWidth:220,isMobile:!0}),(0,Ze.jsx)("div",{style:{flexGrow:1,flexShrink:1}}),(0,Ze.jsx)(ke.Z,{onClick:()=>function(e){B.UT({environment:e,analyticsFrom:"public-page-topbar"})}(s),children:(0,y.R)({width:20,height:20})}),(0,Ze.jsx)(Ve.Z,{store:t,buttonPopupStore:me.Z,useEllipsisIcon:!c}),!c&&(0,Ze.jsx)(Oe.C,{onClick:()=>async function(e){await(0,Ke.i3)({environment:e,route:v._j.signup})}(s)})]})}function ht(e){let{store:t,saveParent:i}=e;window.__c={n:"AddToComponent"};const o=(0,l.Fg)(),n=(0,r.O7)(),s=(0,a.VK)((()=>t.getParentStore()),[t]),c=(0,a.VK)((()=>Je(t)),[t]),d=(0,a.VK)((()=>t instanceof ue.H2?(0,G.Wd)(n,t):t.getIcon()),[t,n]),u=(0,a.VK)((()=>(null==s?void 0:s.table)===S.iU&&s.isEmptyPage()),[s]),h=(0,a.VK)((()=>s instanceof ue.H2?(0,G.rn)(n,s):void 0),[n,s]),m=(0,a.VK)((()=>(0,E.B7)(n)),[n]),p=(0,a.VK)((()=>function(e){let t=0;return t=ot(e)?8:nt(e)?6:16,{display:"flex",alignItems:"center",paddingLeft:t,paddingRight:12,fontSize:x.Z.fontSize.UIRegular.mobile,lineHeight:x.Z.lineHeight.UIRegular.mobile,whiteSpace:"nowrap",minWidth:0}}(n)),[n]);if(s instanceof ue.T5||s instanceof ue.zq||s instanceof ue.Vf)return null;if(s){if(c){const e=o.mediumTextColor;return(0,Ze.jsxs)(fe.Z,{mobileFeedback:!0,style:p,onClick:()=>dt(t,i,n),children:[(0,Ze.jsx)(k.FormattedMessage,{defaultMessage:"<mediumcolor>Add to</mediumcolor>{userAvatar}<mediumweight>Private pages</mediumweight>",id:"topbarMobile.addToPrivateSectionButton.label",values:{mediumcolor:t=>(0,Ze.jsx)("span",{style:{color:e,marginRight:8},children:t}),mediumweight:e=>(0,Ze.jsx)("span",{style:{fontWeight:x.Z.fontWeight.medium,marginLeft:4},children:e}),userAvatar:(0,Ze.jsx)(Ie.Z,{size:22,avatarShouldShowShadow:!0,userStore:m})}}),(0,Ze.jsx)(lt,{})]})}return(0,Ze.jsxs)(fe.Z,{mobileFeedback:!0,style:p,onClick:()=>dt(t,i,n),children:[(0,Ze.jsxs)("span",{style:{color:o.mediumTextColor},children:[(0,Ze.jsx)(k.FormattedMessage,{defaultMessage:"Add to",id:"topbarMobile.addToPageOrWorkspaceSectionButton.label"})," "]}),(0,Ze.jsx)(Te.Z,{disabled:!0,icon:d,isEmptyPage:u,title:h,size:24,style:{marginLeft:8,marginRight:4}}),(0,Ze.jsx)(we.Z,{style:{fontWeight:x.Z.fontWeight.semibold},store:s}),(0,Ze.jsx)(lt,{})]})}return null}function mt(){window.__c={n:"CancelQuickAddComponent"};const e=(0,r.O7)();return(0,Ze.jsx)(fe.Z,{mobileFeedback:!0,style:{display:"flex",alignItems:"center",height:"100%",paddingLeft:16,paddingRight:16,fontWeight:x.Z.fontWeight.medium,color:h.ZP.blue},onClick:t=>function(e,t){const i=se.default.state.mainEditorCurrentBlockStore,o=ce.ZP.state.lastPageId;if(i){var n;const e=null===(n=t.mobileNative)||void 0===n?void 0:n.supportsNativeHomeOnPhone();e?j.d(t):o?A._({environment:t,store:ue.G.createChildStore(i,{table:S.iU,id:o}),showMoveTo:!1,saveParent:!1,redirect:e,pageVisitSource:u.tY.BackForward}):P.c4({environment:t,url:v._j.root,redirect:!0}),F.createAndCommit({userAction:"TopbarMobile.handleCancelQuickAdd",environment:t,perform:e=>{N.y8({environment:t,blocks:[i],transaction:e}),e.postSubmitCallbacks.push((e=>{e||C.dh(t,{analyticsName:"delete",from:"mobile_topbar",block_id:i.id,block_type:"page"})}))}})}}(0,e),children:(0,Ze.jsx)(k.FormattedMessage,{defaultMessage:"Cancel",id:"topbarMobile.cancelQuickAddButton.label"})})}function pt(e){let{intl:t}=e;return(0,Ze.jsx)(ye.ZP,{popupType:ye.Z4.SlideUp,originGap:0,stopClickPropagation:!0,isWideTabletWidth:!0,render:e=>(0,Ze.jsx)(xe.Z,{menuType:U.og.Modal,scrollerStyle:{paddingBottom:0},title:(0,Ze.jsx)(k.FormattedMessage,{defaultMessage:"Details",id:"topbarMobile.header.info"}),right:(0,Ze.jsx)(Me.DoneMenuText,{}),onClickRight:e.close}),isFullWidthOnMobile:!0,preventScaleTransition:!0,renderOrigin:e=>(0,Ze.jsx)("div",{style:{position:"relative",height:"100%"},children:(0,Ze.jsx)(Se.Z,{ariaLabel:t.formatMessage({defaultMessage:"Info",id:"topbarMobile.infoButton.label"}),icon:g.D,iconStyle:{width:26,height:26,fill:"inherit"},isDarkIconColor:!0,style:{marginLeft:6,marginRight:6,height:"100%"},mobileFeedback:!0,...e})})})}function gt(e){let{showingHistoryButtons:t=!0,shouldShowAddTo:i,store:o,saveParent:n}=e;window.__c={n:"BreadcrumbsComponent"};const s=(0,r.O7)(),l=(0,a.VK)((()=>s.device.isTablet),[s]),c=(0,a.VK)((()=>st(s,t,l)),[s,l,t]);return i?(0,Ze.jsx)(ht,{store:o,saveParent:n}):(0,Ze.jsx)(V.l2,{store:o,style:c,maxAncestorCount:l?2:1,showCurrentPageControls:!1,ancestorMaxWidth:l?160:100,currentPageMaxWidth:l?240:220,isMobile:!0})}},30439:(e,t,i)=>{i.r(t),i.d(t,{TopLevelMobileComponents:()=>f});i(67294);var o=i(480),n=i(86628),s=i(30664),r=i(52187),a=i(61671),l=i(5480),c=i(23586),d=i(43250),u=i(71119),h=i(75538),m=i(27177),p=i(80444),g=i(72087),b=i(85893);function f(){window.__c={n:"TopLevelMobileComponents"};const e=(0,o.O7)(),t=(0,n.qz)(void 0,g.Z),i=(0,n.VK)((()=>{const e=h.default.state;return e.isOnboarding&&"workspace_setup"===e.stage}),[]),f=(0,n.VK)((()=>p.default.state.currentSpaceStore),[]),y=(0,n.VK)((()=>p.default.state.mainEditorCurrentBlockStore),[]),v=(0,n.VK)((()=>f&&f.canEdit()),[f]);return i?(0,b.jsx)(b.Fragment,{}):(0,b.jsxs)("div",{className:d.alX,children:[(0,b.jsx)(m.Z,{createType:"add-account"}),f&&(0,b.jsx)(r.Z,{store:f}),(0,b.jsx)(c.Z,{request:{},render:()=>null,requestStore:t,performRequest:()=>(0,u.pu)(e)}),(0,b.jsx)(a.Z,{passwordRequestStore:t}),v&&y&&(0,b.jsx)(l.Z,{store:y,isMobile:!0}),(0,b.jsx)(s.Z,{})]})}},67940:(e,t,i)=>{i.d(t,{Z:()=>r});var o=i(49085),n=i(4615);class s extends o.default{getInitialState(){return{flowId:void 0}}getOrCreateFlowId(){const e=this.state.flowId||(0,n.ZP)();return this.state.flowId&&this.setState({flowId:e}),e}}const r=new s},53610:(e,t,i)=>{i.d(t,{Z:()=>o});const o=new(i(61766).Z)},66881:(e,t,i)=>{i.d(t,{g:()=>o});const o=i(49085).default.createValue({shouldReset:!1})}}]);