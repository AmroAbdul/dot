"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[9308],{23844:(e,t,r)=>{r.r(t),r.d(t,{default:()=>g});r(67294);var o=r(30251),n=r(86628),i=r(47025),s=(r(21703),r(57658),r(14714));const l="grouped_chart_results";function u(e){let{xAxisType:t,groupResults:r,aggregationResults:o}=e;if((0,s.A1)(t)){const e=[],n=[];if(r.forEach((t=>{const r=t.value,i=(0,s.Hd)(r),l=o[i];if(!l)throw new Error(`Could not find aggregation for the chart group ${i}`);const u=function(e){var t,r,o,n;if((0,s.Mc)(e)&&("day"===(null===(t=e.value)||void 0===t?void 0:t.type)||"month"===(null===(r=e.value)||void 0===r?void 0:r.type)||"week"===(null===(o=e.value)||void 0===o?void 0:o.type)||"year"===(null===(n=e.value)||void 0===n?void 0:n.type)))return e.value.range.start_date}(r),a=function(e){const t=e.aggregationResult;if("number"===t.type)return t.value}(l);if(u&&a){n.push(new Date(u));const t={ds:u,values:{value:a}};e.push(t)}})),e.length>0){const r=new Date(Math.min(...n.map((e=>e.getTime())))).toISOString().split("T")[0],o=new Date(Math.max(...n.map((e=>e.getTime())))).toISOString().split("T")[0];return{xAxisType:t,dataPoints:e,startDate:r,endDate:o}}}}var a=r(8848),c=r(48190),d=r(85893);const p=[{stroke:a.FN.light.blue[500],fill:a.FN.light.blue[100]},{stroke:a.FN.light.yellow[500],fill:a.FN.light.yellow[100]},{stroke:a.FN.light.green[500],fill:a.FN.light.green[100]},{stroke:a.FN.light.purple[500],fill:a.FN.light.purple[100]},{stroke:a.FN.light.orange[500],fill:a.FN.light.orange[100]},{stroke:a.FN.light.pink[500],fill:a.FN.light.pink[100]},{stroke:a.FN.light.red[500],fill:a.FN.light.red[100]}];function f(e){let{collectionContextStore:t,groupedChartReducer:r,chartConfig:i}=e;window.__c={n:"GroupedAxisChart"};const a=(0,c.Z)({id:l,reducer:r,collectionContextStore:t}),f=(0,n.VK)((()=>{if(!a)return;const e=a.results,t=a.aggregationResults;if(!t)return;const r=i.dataConfig.xAxis.groupBy.type;return(0,s.A1)(r)?u({xAxisType:r,groupResults:e,aggregationResults:t}):void 0}),[a,i],{useDeepEqual:!0}),g=[{key:"value",stroke:p[0].stroke,fill:p[0].fill,renderLabel:e=>(0,d.jsxs)("div",{children:["value: ",e]})}];return f&&(0,s.A1)(f.xAxisType)?(0,d.jsx)("div",{style:{paddingLeft:120,paddingTop:20},children:(0,d.jsx)(o.TimeSeries,{width:600,height:400,startDate:f.startDate,endDate:f.endDate,data:f.dataPoints,layers:g})}):null}const g=function(e){let{collectionContextStore:t,format:r,schema:o}=e;window.__c={n:"CollectionChartView"};const{chartConfig:l,error:u}=(0,n.VK)((()=>(0,i.Fs)({chartConfig:r.chart_config,collectionSchema:o})),[r,o]),a=(0,n.VK)((()=>{if("axis"!==(null==l?void 0:l.type))return;const{groupBy:e}=l.dataConfig.xAxis,{property:t}=e,r=o[t];if(r&&(0,s.LG)(r)&&(0,i.p0)(r.type)){const t=function(e){if("axis"===e.type){return"record_count"===e.dataConfig.series[0].type?"count":void 0}return}(l);if(!t)return;return{type:"groups",limit:1e3,groupBy:e,groupSortPreference:[],aggregation:{aggregator:t}}}}),[l,o],{useDeepEqual:!0});return u?(0,d.jsxs)("div",{style:{paddingLeft:120,paddingTop:20},children:["Error: ",u.type]}):(0,d.jsx)(d.Fragment,{children:a&&"axis"===(null==l?void 0:l.type)&&(0,d.jsx)(f,{chartConfig:l,collectionContextStore:t,groupedChartReducer:a})})}},48190:(e,t,r)=>{r.d(t,{P:()=>d,Z:()=>c});var o=r(67294),n=r(1302),i=r(86628),s=r(28155),l=r(40107),u=r(72126),a=r(75330);function c(e){const{id:t,reducer:r,collectionContextStore:s,groupsPointer:c}=e,p=(0,i.VK)((()=>c),[c],{useDeepEqual:!0}),f=(0,i.VK)((()=>r),[r],{useDeepEqual:!0}),g=(0,i.VK)((()=>s.collectionViewStore()),[s]),h=(0,o.useRef)(!1),y=(0,l.S)(),[v,m]=(0,o.useReducer)(((e,t)=>u.Xy(e,t)?e:t),void 0),x=(0,o.useCallback)((()=>{const e=s.localResultStore.state,r=s.remoteResult.state,o=e&&"reducer"===e.type?e.reducerResults[t]:void 0,n=r&&"reducer"===r.type?r.reducerResults[t]:void 0;return d({reducerId:t,collectionContextStore:s,reducer:f,localReducerResult:o,remoteReducerResult:n})}),[s,f,t]),R=(0,o.useCallback)((()=>{h.current=!1,y()||m(x())}),[x,y]),C=(0,o.useCallback)((()=>{h.current||(h.current=!0,n.default.afterNextFlush(R))}),[R]);return(0,o.useEffect)((()=>(s.remoteResult.addListener(C),s.localResultStore.addListener(C),()=>{s.remoteResult.removeListener(C),s.localResultStore.removeListener(C)})),[s,C]),(0,o.useEffect)((()=>(a.$D({reducerId:t,instanceId:void 0,reducer:f,collectionContextStore:s,groupsPointer:p}),()=>{a.$D({reducerId:t,instanceId:void 0,reducer:void 0,collectionContextStore:s,groupsPointer:p})})),[s,g,p,f,t]),(0,o.useEffect)((()=>{C()}),[]),v}function d(e){const{reducerId:t,localReducerResult:r,remoteReducerResult:o,collectionContextStore:n,reducer:i}=e,l=n.reducers.state,a=n.remoteResult.state;if(n.isClientModeEnabled.state)return r;if("aggregation"===i.type||"groups"===i.type){if(null!=a&&a.reducerResults[t])return a.reducerResults[t];const e=Boolean(a&&"reducer"===a.type&&u.sE(a.reducerResults,((e,t)=>{const r=l[t];return Boolean(r&&"results"===r.reducer.type&&!r.reducer.searchQuery&&"results"===e.type&&e.hasMore&&u.Xy(i.filter,r.reducer.filter))})));return e?r:o}if("results"===i.type){var c;const e=n.wasCreatedThisSession.state,i=Boolean(a&&"reducer"===a.type&&a.reducerResults[t]),l=(0,s.nx)(null===(c=n.collectionViewStore())||void 0===c?void 0:c.getCollectionSource());if((i||e)&&!l&&r&&"results"===r.type){return{...r,hasMore:o&&"results"===o.type?o.hasMore:r.hasMore}}return o}}},47054:(e,t,r)=>{r.d(t,{AD:()=>a});r(57658);var o=r(30120),n=r(59730),i=r(63143);const s=7;function l(e){if(void 0===e)return o.ou.utc();const t={zone:"utc"};return"number"==typeof e?o.ou.fromMillis(e,t):o.ou.fromISO(e,t)}function u(e,t){const r=t?l(t):o.ou.utc(),i=l(e??function(e){const{days:t,endDate:r,startDate:i}=e;if(t<=0)throw new n.p8("Days must be greater than 0");const s=r?l(r):o.ou.utc();if(!s.isValid)throw new n.p8(`endDate ${r} is in an invalid format`);const u=i?l(i).toMillis():0,a=s.minus({days:t-1}).toMillis();return Math.max(a,u)}({days:s,endDate:t}));if(!i.isValid)throw new n.p8(`startDate ${e} is in an invalid format`);if(!r.isValid)throw new n.p8(`endDate ${t} is in an invalid format`);if(i>r)throw new n.p8(`startDate ${e} => ${i.toISO()} is after endDate ${t} => ${r.toISO()}`);return{startTimestamp:i.toMillis(),endTimestamp:r.toMillis()}}function a(e,t){const{startTimestamp:r,endTimestamp:o}=u(e,t),n=[];for(var s=r;s<=o;)n.push(l(s).toISODate()),s+=i.A0;return n}}}]);