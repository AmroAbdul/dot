"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[5203],{73657:(e,t,r)=>{r.d(t,{Z:()=>s});r(67294);var o=r(28992),i=r(85893);const s=function(e){return(0,i.jsx)(o.Z,{...e,style:{background:"none",borderBottom:"none",boxShadow:"",marginTop:2,marginBottom:6,paddingTop:4,paddingBottom:4,minHeight:"none",...e.style}})}},75203:(e,t,r)=>{r.r(t),r.d(t,{default:()=>R});r(67294);var o=r(83355),i=r(480),s=r(12396),n=r(56666),p=r(39132),l=r(61061),a=r(72126),d=r(82990),c=r(9291),h=r(36610),y=r(31869),u=r(96802),m=r(82530),g=r(87279),x=r(29376),b=r(4023),v=r(29798),f=r(73657),S=r(52275),j=r(31945),P=r(79131),C=r(73063),T=r(78140),w=r(32163),k=r(53437),Z=r(72495),M=r(26388),_=r(85893);class L extends o.Z{constructor(){super(...arguments),this.storeTypes={menuListStore:v.Z},this.renderRelationPropertyMenuPopup=e=>{const t=this.allRelatedTargetProperties.state;if(!t)return;const r=t.filter((e=>e.visible)),o=t.filter((e=>!e.visible));return(0,_.jsxs)(T.Z,{menuType:g.og.Popup,maxWidth:240,maxHeight:500,children:[0===t.length&&(0,_.jsx)(Z.Z,{children:(0,_.jsx)(f.Z,{caption:(0,_.jsx)(c.FormattedMessage,{defaultMessage:"No properties",id:"database.relationMenu.noProperties"})})}),t.length>0&&(0,_.jsx)(w.Z,{type:w.i.Vertical,store:this.stores.menuListStore,initialFocus:void 0,sections:a.oA([r.length>0&&{key:"visible_and_hidden_properties",render:e=>(0,_.jsx)(Z.Z,{...e,noTextOverflow:!0,isTitleUppercase:!1,title:(0,_.jsx)(c.FormattedMessage,{defaultMessage:"Shown in relation",id:"database.relationMenu.shownInRelationTitle"}),desktopTitleStyle:{height:18},children:(0,_.jsx)(O,{collectionStore:this.props.collectionStore,property:this.props.property,disabled:this.props.disabled,menuListStore:this.stores.menuListStore,visibleProperties:r,hiddenProperties:o,children:e.children})}),items:a.oA([...I({properties:r,visibility:!0},this.environment,this.theme,this.props.collectionStore,this.props.targetCollectionStore,this.props.property,this.props.disabled),o.length>0&&{key:"group-header-hidden-property",render:e=>(0,_.jsx)(F,{props:e,children:(0,_.jsx)(_.Fragment,{})}),action:()=>{}},...I({properties:o,visibility:!1},this.environment,this.theme,this.props.collectionStore,this.props.targetCollectionStore,this.props.property,this.props.disabled)])},0===r.length&&o.length>0&&{key:"hidden_properties",render:e=>(0,_.jsx)(F,{props:e,children:(0,_.jsx)(O,{collectionStore:this.props.collectionStore,property:this.props.property,disabled:this.props.disabled,menuListStore:this.stores.menuListStore,visibleProperties:r,hiddenProperties:o,children:e.children})}),items:I({properties:o,visibility:!1},this.environment,this.theme,this.props.collectionStore,this.props.targetCollectionStore,this.props.property,this.props.disabled)}])})]})},this.allRelatedTargetProperties=this.createComputedStore((()=>{const{collectionStore:e,targetCollectionStore:t,property:r}=this.props,o=x.U1({collectionStore:e,property:r}),i=Object.keys(t.getSchema()).map((e=>o.find((t=>t.property===e))??{property:e,visible:!1})),s=o.map((e=>e.property)),n=e=>{const t=s.indexOf(e);return-1!==t?t:1/0};return i.sort(((e,t)=>n(e.property)-n(t.property))),i}),!0)}renderComponent(){const{device:e}=this.environment;if(!e.isPhone||"section"===this.props.rowType)return(0,_.jsx)(M.ZP,{renderTooltip:()=>(0,_.jsx)(c.FormattedMessage,{id:"database.RelationCustomizeLayoutMenu.tooltip.button.message",defaultMessage:"Customize shown properties"}),placement:"section"===this.props.rowType?b.u.Top:b.u.Right,render:e=>(0,_.jsx)(j.ZP,{popupType:k.kQ.Popup,alignmentToOrigin:b.v.Start,...e,renderOrigin:t=>(0,_.jsx)(C.Z,{icon:n.o,iconStyle:{width:16,color:this.theme.mediumIconColor,fill:this.theme.mediumIconColor},...t,...e}),onClick:()=>{h.gP(this.environment,{from:"section"===this.props.rowType?"relation_section":"configure_relation_modal"})},originGap:16,render:this.renderRelationPropertyMenuPopup})})}}L.displayName="RelationPropertyCustomizeLayoutMenu";const R=L;function F(e){const{props:t,children:r}=e;return(0,_.jsx)(Z.Z,{...t,noTextOverflow:!0,isTitleUppercase:!1,title:(0,_.jsx)(c.FormattedMessage,{defaultMessage:"Hidden in relation",id:"database.relationMenu.hiddenInRelationTitle"}),desktopTitleStyle:{height:19},children:r,disableDesktopPadding:!0})}function I(e,t,r,o,i,n,c){const{properties:h,visibility:u}=e;return a.oA(h.map((e=>function(e,t,r,o,i,n,a){const{propertyFormat:c,visibility:h}=e,u=!h,m=i.getSchema();if(!m)return;const g=m[c.property];return g?{key:c.property,render:e=>(0,_.jsx)(S.Z,{...e,showDragHandle:!a,title:(0,_.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,_.jsx)(s.ZP,{icon:g.icon,type:g.type,size:16,theme:r,style:{fill:r.regularIconColor}}),(0,_.jsx)("span",{style:{marginLeft:8,...d.Z.textOverflowStyle},children:g.name})]}),right:(0,_.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,_.jsx)(C.Z,{icon:u?l.B:p.c,iconStyle:{width:16,height:16},isDarkIconColor:!u,onClick:()=>{y.qK({propertyFormat:c,visibility:h,collectionStore:o,property:n,environment:t})},disabled:a||"title"===c.property})})}),action:()=>{}}:void 0}({propertyFormat:e,visibility:u},t,r,o,i,n,c))))}function O(e){window.__c={n:"PropertyDraggableListComponent"};const t=(0,i.O7)(),{collectionStore:r,property:o,menuListStore:s,disabled:n,visibleProperties:p,hiddenProperties:l,children:d}=e,c=a.oA([...p.map((e=>e.property)),p.length>0&&l.length>0&&{key:"group-header-hidden-property",draggable:!1},...l.map((e=>e.property))]);return(0,_.jsx)(P.ZP,{direction:"vertical",keys:c,renderKey:(e,t)=>d[t],onDrop:e=>{!function(e,t,r,o,i){const{newPropertyKeys:s}=e,n=x.U1({collectionStore:r,property:o}),p=s.indexOf("group-header-hidden-property"),l=a.oA(s.filter((e=>!e.startsWith("group-header-"))).map(((e,t)=>{const r=n.find((t=>t.property===e));return r?p>0?"title"===e&&t>=p?r:{...r,visible:Boolean(t<p)}:r:{property:e,visible:!(p>0)||Boolean(t<p)}}))),d=n.filter((e=>!s.includes(e.property))),c={...x.ZI(r)};c[o]||(c[o]={}),c[o].related_properties=[...l,...d],m.createAndCommit({userAction:"RelationPropertyCustomizeLayoutMenu.handlePropertyReorder",environment:t,perform:e=>{u.FH({stores:[r],update:{collection_relation_options:c},transaction:e})}}),i.reset()}({newPropertyKeys:e},t,r,o,s)},disabled:n})}},39132:(e,t,r)=>{r.d(t,{c:()=>s});r(67294);var o=r(45238),i=r(85893);const s=(0,o.I)("eye",{viewBox:"0 0 32 32",svg:(0,i.jsx)("path",{d:"M16.006 25.812c8.863 0 14.994-7.17 14.994-9.406C31 14.16 24.858 7 16.006 7 7.252 7 1 14.16 1 16.406c0 2.236 6.252 9.406 15.006 9.406zm0-3.242a6.194 6.194 0 01-6.197-6.164c-.012-3.452 2.744-6.164 6.197-6.164 3.419 0 6.185 2.711 6.185 6.164 0 3.364-2.766 6.164-6.185 6.164zm0-3.94c1.228 0 2.246-1.007 2.246-2.224 0-1.228-1.018-2.235-2.246-2.235-1.24 0-2.258 1.007-2.258 2.235 0 1.217 1.018 2.224 2.258 2.224z"})})}}]);