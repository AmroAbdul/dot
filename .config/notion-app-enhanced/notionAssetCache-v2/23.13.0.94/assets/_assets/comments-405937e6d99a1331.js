"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[8324],{7476:(e,t,o)=>{o.d(t,{t:()=>r});var i=o(80444),n=o(56681),s=o(34047);function r(e){var t;let{discussionStore:o,commentStore:r}=e;if(!r.isDefined())return!1;const a=null===(t=i.default.state.currentUserStore)||void 0===t?void 0:t.id;const l=n.Z.state.lastInteractionTimes[o.id];if(r.getCreatedById()===a)return!1;const d=function(){if(!o.isDefined()||!a)return 0;const{pageVisitStore:e}=i.default.state,{lastViewTime:t,lastExitTime:n}=e.state;return n||t}();if(void 0===d)return!1;const c=(0,s.NI)(o).filter((e=>e.getCreatedById()===a)).reverse()[0],u=r.getCreatedTime();return!u||!(c&&u<c.getCreatedTime())&&(!(l&&u<l)&&u>d)}},63202:(e,t,o)=>{o.r(t),o.d(t,{default:()=>Ke});var i=o(67294),n=o(1302),s=o(480),r=o(6740),a=o(97511),l=o(33125),d=o(86628),c=o(24405),u=o(59194),m=o(69651),p=o(72141),g=o(21202),h=o(82990),f=o(9291),x=o(54564),v=o(47307),S=o(9953),b=o(61045),C=o(98104),y=o(82530),w=o(74136),j=o(26388),k=o(64369),M=o(42402),L=o(67706),I=o(65085),R=o(12740),D=o(65187),T=o(11368),_=o(4708),Z=o(65598),B=o(16402),V=o(89574),F=o(61766),P=o(77080),K=o(96049),A=o(79797),E=o(17707),N=o(95306),z=o(34047),O=o(82994),U=(o(57658),o(15145)),W=o(41432),H=o(37652),$=o(56666),G=o(27714),X=o(25651),q=o(40350),J=o(18101),Q=o(45238),Y=o(85893);const ee=(0,Q.I)("resolve",{viewBox:"0 0 16 16",svg:(0,Y.jsx)(Y.Fragment,{children:(0,Y.jsx)("path",{d:"M6.6123 14.2646C7.07715 14.2646 7.43945 14.0869 7.68555 13.7109L14.0566 3.96973C14.2344 3.69629 14.3096 3.44336 14.3096 3.2041C14.3096 2.56152 13.8311 2.09668 13.1748 2.09668C12.7236 2.09668 12.4434 2.26074 12.1699 2.69141L6.57812 11.5098L3.74121 7.98926C3.48828 7.68848 3.21484 7.55176 2.83203 7.55176C2.16895 7.55176 1.69043 8.02344 1.69043 8.66602C1.69043 8.95312 1.7793 9.20605 2.02539 9.48633L5.55273 13.7588C5.84668 14.1074 6.1748 14.2646 6.6123 14.2646Z"})})});var te=o(98519),oe=o(37612),ie=o(72126),ne=o(19889),se=o(97880),re=o(893),ae=o(52275),le=o(31945),de=o(73063),ce=o(78140),ue=o(32163),me=o(72495),pe=o(83182),ge=o(95477),he=o(43250),fe=o(87279),xe=o(18514),ve=o(80444),Se=o(90895);function be(e){window.__c={n:"CommentActionGroup"};const{discussionLocation:t}=e,o=(0,f.useIntl)(),n=(0,s.O7)(),r=n.device,l=(0,i.useRef)(null),c=(0,a.l)(),u=(0,d.VK)((()=>Boolean(e.discussionStore.getResolved())),[e.discussionStore]),m=(0,d.VK)((()=>e.store.isDefined()),[e.store]),g=(0,d.VK)((()=>{var e;return null===(e=ve.default.state.currentUserStore)||void 0===e?void 0:e.id}),[]),h=(0,d.VK)((()=>{const t=e.store.getCreatedById();return e.store.getCreatedByTable()===ne.KJ&&g===t}),[g,e.store]),v=(0,d.VK)((()=>{var e;const t=null===(e=ve.default.state.currentSpaceStore)||void 0===e?void 0:e.getRole();return t&&p.zz(t)}),[]),S=(0,d.VK)((()=>e.blockStore.getRole()),[e.blockStore]),b=(0,d.VK)((()=>{var e;return null==c||null===(e=c.publicEditModeStore.state)||void 0===e?void 0:e.permission}),[null==c?void 0:c.publicEditModeStore]),C="comment_only"===S||"comment"===b;if(!m||!g)return null;const w=()=>{y.createAndCommit({userAction:"Comment.handleReopen",environment:n,perform:t=>{E.bh({environment:n,commentStore:e.store,discussionStore:e.discussionStore,transaction:t,discussionLocation:e.discussionLocation})}})},j=t=>{y.createAndCommit({userAction:"Comment.handleResolve",environment:n,perform:t=>{E.DX({environment:n,commentStore:e.store,discussionStore:e.discussionStore,transaction:t,discussionLocation:e.discussionLocation})}}),x.Xv(),null==t||t.stopPropagation()},k=()=>{var t,o;const i=e.store.getParentStore();if(!i||null==i||!i.isDefined())return null;let s=i.getParentStore();if(null===(t=s)||void 0===t||!t.isDefined())return null;var r;s.getType()===W.Ti.tableRow&&(s=null===(r=s)||void 0===r?void 0:r.getParentBlockStore());if(null===(o=s)||void 0===o||!o.isDefined())return null;const a=s.getModel().getRenderUrl({baseUrl:ge.default.domainBaseUrl,getRecordModel:e.store.getRecordModel,discussionId:i.id,pageVisitSource:U.tY.CopyLink});re.RD({environment:n,stringValue:a,copiedMessage:re.tq.copiedLinkToClipboard})};if(!n.currentUser.isLoggedIn())return null;const M=S&&p.rz(S);if(M)return null;const L=e.isFirstComment&&"comment_unfurl"!==t&&!r.isMobile&&!C&&!M,I=[];!r.isMobile||C||M||(u?I.push("reopen"):I.push("resolve")),h&&I.push("edit"),e.isFirstComment&&I.push("copyLink"),(h||v)&&I.push("delete");const R=I.length>0;return R||L||e.canShowReactions?(0,Y.jsx)(le.ZP,{ref:l,popupType:r.isMobile?le.Z4.SlideUp:le.Z4.Popup,buttonPopupStore:e.buttonPopupStore,placementToOrigin:le.pO.Right,stopClickPropagation:!0,renderOrigin:i=>(0,Y.jsx)(Ce,{buttonConfig:{resolve:{visible:L,resolved:u,onResolve:j,onReopen:w},react:{visible:e.canShowReactions,onReact:()=>{var i;(0,Se.openEmojiMenuForReaction)(n,o,e.store,(null===(i=l.current)||void 0===i?void 0:i.getAnchor())??null,t,e.handleReaction)}},moreActions:{visible:R}},visible:e.visible,buttonPopupEvents:i,discussionLocation:e.discussionLocation,store:e.store}),render:t=>{let o;o=r.isMobile?{menuType:fe.og.ActionSheet}:{menuType:fe.og.Popup};const i=I.map((t=>"reopen"===t?{key:"reopen",render:e=>(0,Y.jsx)(ae.Z,{...e,icon:(0,H.V)({height:16,width:16}),title:(0,Y.jsx)(f.FormattedMessage,{id:"comment.reopenDiscussion.button",defaultMessage:"Re-open discussion"})}),action:w}:"resolve"===t?{key:"resolve",render:e=>(0,Y.jsx)(ae.Z,{...e,icon:(0,te.k)({height:16,width:16}),title:(0,Y.jsx)(f.FormattedMessage,{id:"comment.resolveDiscussion.button",defaultMessage:"Resolve comments"})}),action:()=>j()}:"edit"===t?{key:"edit",render:e=>(0,Y.jsx)(ae.Z,{...e,icon:(0,X.R)({height:16,width:16}),title:(0,Y.jsx)(f.FormattedMessage,{id:"comment.editComment.button",defaultMessage:"Edit comment"})}),action:e.handleEditComment}:"delete"===t?{key:"delete",render:e=>(0,Y.jsx)(ae.Z,{...e,icon:(0,oe.y)({height:16,width:16}),title:(0,Y.jsx)(f.FormattedMessage,{id:"comment.deleteComment.button",defaultMessage:"Delete comment"})}),action:e.handleDeleteComment}:"copyLink"===t?{key:"copyLink",render:e=>(0,Y.jsx)(ae.Z,{...e,icon:(0,G.N)({height:16,width:16}),title:(0,Y.jsx)(f.FormattedMessage,{id:"comment.copyLinkToDiscussion.button",defaultMessage:"Copy link to discussion"})}),action:k}:void(0,se.t1)(t)));return(0,Y.jsx)("div",{className:he.G6g,children:(0,Y.jsxs)(ce.Z,{...o,children:[(0,Y.jsx)(ue.Z,{type:ue.i.Vertical,initialFocus:void 0,onAccept:t.close,sections:ie.oA([i.length&&{key:0,render:e=>(0,Y.jsx)(me.Z,{...e}),items:i}])}),!r.isMobile&&(0,Y.jsx)(me.Z,{topBorder:!0,disableDesktopPadding:!1,children:(0,Y.jsx)(pe.Z,{title:(0,Y.jsx)(f.FormattedMessage,{defaultMessage:"Learn about comments",id:"comments.learn"}),href:(0,xe.UY)("guides.comments"),analyticsFrom:"comments"})})]})})}}):null}function Ce(e){window.__c={n:"ActionGroupOrigin"};const{buttonPopupEvents:t,discussionLocation:o}=e,{resolved:i,onResolve:n,onReopen:r}=e.buttonConfig.resolve,a=(0,s.O7)().device,l=(0,c.yK)((t=>({addIcon:{width:15,fill:t.mediumIconColor},container:{display:"flex",boxShadow:t.lightBoxShadow,position:"absolute",flexShrink:0,padding:"2px",backgroundColor:t.buttonGroupBackground,...a.isMobile?{borderRadius:4,marginTop:4,right:16}:{marginRight:"margin_comments"===o?0:8,marginTop:"updates_sidebar"===e.discussionLocation?6:0,right:"margin_comments"===o?12:16,top:"margin_comments"===o?6:0,opacity:e.visible?1:0,gap:1,borderRadius:4,transition:"opacity 100ms ease-out",zIndex:1}}})),[a.isMobile,o,e.discussionLocation,e.visible]);return(0,Y.jsxs)("div",{style:l.container,children:[e.buttonConfig.react.visible&&(0,Y.jsx)(j.ZP,{renderTooltip:()=>(0,Y.jsx)(f.FormattedMessage,{defaultMessage:"Add reaction",id:"comment.actions.addReaction.label"}),render:t=>(0,Y.jsx)(de.Z,{hasBackground:!1,showShadow:!1,icon:()=>(0,q.V)(l.addIcon),onClick:e.buttonConfig.react.onReact,style:{height:22,width:22,flex:"0 0 auto"},...t})}),e.buttonConfig.resolve.visible&&(0,Y.jsx)(j.ZP,{renderTooltip:()=>i?(0,Y.jsx)(f.FormattedMessage,{defaultMessage:"Re-open",id:"comment.actions.reopenButton.label"}):(0,Y.jsx)(f.FormattedMessage,{defaultMessage:"Resolve",id:"comment.actions.resolveButton.label"}),render:e=>(0,Y.jsx)(de.Z,{hasBackground:!1,showShadow:!1,icon:i?J.b:ee,onClick:i?r:n,style:{height:22,width:22,flex:"0 0 auto"},...e})}),e.buttonConfig.moreActions.visible&&(0,Y.jsx)(j.ZP,{renderTooltip:()=>(0,Y.jsx)(f.FormattedMessage,{defaultMessage:"More actions",id:"comment.actions.moreActions.label"}),render:e=>(0,Y.jsx)(de.Z,{...t,...e,hasBackground:!1,showShadow:!1,icon:$.o,style:{height:22,width:22,flex:"0 0 auto"}})})]})}var ye=o(70775),we=o(95538),je=o(70203),ke=o(31781),Me=o(53471),Le=o(68785),Ie=o(33742),Re=o(69721),De=o(79954),Te=o(32238);function _e(e){if("image"!==e.getType())return!1;const t=je.QaF(e.getPropertyValue("source"));return void 0!==t&&!(0,we.y_)(t,".jfif")&&!(0,we.y_)(t,".webp")}function Ze(e){window.__c={n:"CommentContent"};const t=e.discussionFormat===z.O2.Sidebar?ke.vW.SidebarComment:ke.vW.PageComment,o=(0,d.VK)((()=>P.default.checkGate("comments_density_image_handling")),[]),{filmStripFiles:i,embedBlockStores:n}=(0,d.VK)((()=>{if(e.collapsed)return{filmStripFiles:Me.nQ(e.contentStores),embedBlockStores:[]};if(e.discussionFormat===z.O2.Page&&e.contentStores.filter((e=>_e(e))).length>1){const[t,o]=ie.uK(e.contentStores,(e=>_e(e)));return{filmStripFiles:Me.nQ(t),embedBlockStores:o}}return{filmStripFiles:[],embedBlockStores:e.contentStores}}),[e.contentStores,e.collapsed,e.discussionFormat]),s=n.length>0&&n.map((i=>(0,Y.jsx)(De.Z,{store:i,analyticsName:"comment_media",actionSectionGroupKey:"comment_media",canTriggerContextMenu:!0,style:{marginTop:8,...o?{marginTop:0}:{}},children:Ie.ZP.hasRendererForStore(i)?(0,Y.jsx)(Ie.ZP,{disabled:!1,disableDrag:!0,store:i,disableResizers:!0,preserveScale:!0,inlineContentStyle:{height:"auto",width:"auto",maxHeight:240,maxWidth:"100%",cursor:"zoom-in"},blockLocation:t,iconSvg:()=>(0,Y.jsx)(Le.Z,{style:o?{}:{marginRight:10}}),onRemoveBlockFromComment:e.onRemoveContent,children:(0,Y.jsx)(f.FormattedMessage,{defaultMessage:"Uploading file...",id:"comment.embeddedFile.uploadInProgressMessage"})}):(0,Y.jsx)(Re.Z,{disabled:!1,store:i})},i.id))),r=i.length>0&&(0,Y.jsx)(Te.Z,{files:i,disableRemove:!0});return(0,Y.jsxs)(Y.Fragment,{children:[r,s]})}function Be(){window.__c={n:"CommentNewBar"};const e=(0,c.yK)((e=>({newBarLine:{height:"0px",borderBottom:`1px solid ${e.darkDividerColor}`,width:"100%",marginLeft:0},newBarWrapper:{color:e.mediumTextColor,textTransform:"uppercase",fontSize:10.5,letterSpacing:.5,fontWeight:h.Z.fontWeight.semibold,display:"flex",alignItems:"center",marginRight:16,marginLeft:16,marginTop:10,marginBottom:10},newBarText:{padding:"0 10px"}})),[]);return(0,Y.jsxs)("div",{style:e.newBarWrapper,children:[(0,Y.jsx)("div",{style:e.newBarLine}),(0,Y.jsx)("div",{style:e.newBarText,children:(0,Y.jsx)(f.FormattedMessage,{id:"comment.newIndicator.label",defaultMessage:"New comments"})}),(0,Y.jsx)("div",{style:e.newBarLine})]})}var Ve=o(93575);const Fe=14;function Pe(e,t){switch(e){case"margin_comments":return 0;case"updates_sidebar":return t?36:35;case"comment_unfurl":return 29;case"block_menu":case"page_discussion":return t?36:32;default:return 32}}const Ke=function(e){window.__c={n:"Comment"};const{store:t,discussionContext:o,maxLines:U,discussionLocation:W,shouldShowThreadLine:H}=e,$=(0,s.O7)(),G=(0,f.useIntl)(),[X,q]=(0,i.useState)(!1),[J,Q]=(0,i.useState)(!1),[ee,te]=(0,i.useState)(!1),oe=(0,d.VK)((()=>P.default.checkGate("comments_density_image_handling")),[]),ie=Pe(W,oe),ne=(0,d.VK)((()=>e.store.isDefined()?new O.Z($,e.store.getSpaceId()):void 0),[$,e.store]),se=(0,d.VK)((()=>Z.le(e.store).filter((e=>(0,A.Vh)(e,{table:g.iU,id:e.id},"alive").getValue()))),[e.store]),re=(0,d.VK)((()=>e.discussionStore.getResolved()),[e.discussionStore]),ae=(0,d.VK)((()=>null==ne?void 0:ne.state.files),[ne]),le=(0,d.VK)((()=>null==ne?void 0:ne.state.textStore),[ne]),de=(0,i.useCallback)((e=>{const t=e.target;t instanceof HTMLElement&&(0,r.E)(t)&&Q(!0)}),[]),ce=(0,i.useCallback)((()=>{Q(!1)}),[]),ue=(0,i.useCallback)((()=>{K.Z.state||te(!0)}),[]),me=(0,i.useCallback)((()=>{te(!1)}),[]),pe=(0,a.l)(),ge=(0,d.qz)(void 0,F.Z),he=(0,d.VK)((()=>ge.state.open),[ge]),fe=(0,d.VK)((()=>{const t=e.discussionStore.getComments();return Boolean(t&&t[0]===e.store.id)}),[e.discussionStore,e.store.id]),xe=(0,d.VK)((()=>{var t;const o=e.blockStore.getRole(),i=fe&&"comment_unfurl"!==W,n=o&&p.rz(o),{device:s}=$,r="comment_only"===o||pe&&"comment"===(null===(t=pe.publicEditModeStore.state)||void 0===t?void 0:t.permission),a=i&&!s.isMobile&&!r&&!n;return ee||J||e.hoveringDiscussion&&i||he||s.isMobile||e.showResolveButtonByDefaultIfPossible&&a}),[e.blockStore,e.hoveringDiscussion,e.showResolveButtonByDefaultIfPossible,fe,W,$,pe,ee,J,he]),ve=(0,i.useContext)(T.Ue),Ce=(0,d.VK)((()=>{const e=t.getCreatedByPointer();return e?{createdByPointer:e,lastEditedTime:t.getLastEditedTime(),createdTime:t.getCreatedTime(),text:t.getText(),reactions:t.getUserVisibleReactions()}:null}),[t]),we=(0,d.VK)((()=>{if(!Ce)return null;const e=A.t1.createChildStore(t,Ce.createdByPointer);return{displayName:e.getDisplayName(G),store:e}}),[Ce,G,t]),je=(0,d.VK)((()=>(0,_.En)()),[]),ke=(0,i.useCallback)((()=>{y.createAndCommit({userAction:"Comment.deleteComment",environment:$,perform:t=>{E.YF({environment:$,commentStore:e.store,transaction:t,discussionLocation:W})},skipUpdatingEditedMetadata:!0})}),[$,e.store,W]),Me=(0,i.useCallback)((async()=>{await v.confirmUserAction({message:(0,Y.jsx)(f.FormattedMessage,{defaultMessage:"Would you like to delete this comment?",id:"comment.confirmDialog.deleteComment.prompt"}),acceptLabel:(0,Y.jsx)(f.FormattedMessage,{defaultMessage:"Delete",id:"comment.confirmDialog.deleteComment.deleteButton.label"})})&&(ke(),x.Xv(),N.Cd($))}),[ke,$]),Le=(0,i.useCallback)((async t=>{const o=Z.zP(e.store).getValue(),i=Z.le(e.store).filter((e=>e.id!==t.id)),n=o&&o.length>0,s=0===i.length;!n&&s?(await Me(),q(!1)):y.createAndCommit({userAction:"Comment.handleRemoveFileFromActions",environment:$,perform:o=>{E.Zo({commentStore:e.store,fileBlocks:[t],transaction:o})}})}),[$,Me,e.store]),Ie=(0,i.useCallback)((()=>{Ke.current&&b.bx({element:Ke.current,scrollers:{verticalScroller:null==ve?void 0:ve.verticalScroller},vertical:{reveal:"closest"},horizontal:void 0,animate:!0})}),[ve]),Re=(0,i.useCallback)((async()=>{if(!ne)return;const t=Z.zP(e.store).getValue()||[],o=ne.state.textStore;y.createAndCommit({userAction:"Comment.handleEditComment",environment:$,perform:e=>{S.sO({store:o,value:t,transaction:e})}}),q(!0),await n.default.afterNextFlush(),await n.default.afterNextFlush(),C.NX({store:o})}),[ne,$,e.store]),De=(0,i.useCallback)((async()=>{if(!ne)return!1;if(!(0,z.hu)(ne,e.store))return q(!1),!0;if(await v.confirmUserAction({message:(0,Y.jsx)(f.FormattedMessage,{defaultMessage:"Do you want to discard this edit?",id:"comment.confirmDialog.discardEdit.prompt"}),acceptLabel:(0,Y.jsx)(f.FormattedMessage,{defaultMessage:"Discard",id:"comment.confirmDialog.discardEdit.discardButton.label"})}))return q(!1),!0;return!1}),[ne,e.store]),Te=(0,i.useCallback)((async()=>{const t=null==le?void 0:le.getValue();t&&t.length>0||ae&&ae.length>0?y.createAndCommit({userAction:"Comment.handleSubmitEdit",environment:$,perform:o=>{E.DF({environment:$,store:e.store,text:t||[],transaction:o,discussionLocation:W,files:ae||[]})}}):await Me(),q(!1)}),[ae,le,W,$,Me,e.store]),_e=(0,i.useRef)(null),Ke=(0,i.useRef)(null);(0,l.c)(V.Z,(()=>({edit:Re,handleCancelEdit:De,getNode:()=>_e.current,isEditing:()=>X,discussionLocation:W,commentId:e.store.id})),[Re,De,X,W,e.store.id]);const Ae=oe?24:z.Je[W],Ee=null==Ce?void 0:Ce.text,Ne=void 0!==Ee&&Ee.length>0,ze=Ne&&(0,z.p9)(Ee),Oe=function(e){let{discussionLocation:t,isAllEmojis:o,avatarSize:i,newCommentsDesignEnabled:n}=e;const s=Pe(t,n);return(0,c.yK)((e=>({container:{flexGrow:"comment_unfurl"===t?1:void 0},comment:{display:"flex",alignItems:"flex-start",position:"relative",fontSize:Fe,...n?{padding:"comment_unfurl"===t?"10px 0 8px":"8px 0 0px"}:{}},avatar:{marginRight:10,marginTop:"comment_unfurl"===t?16:2,...n?{marginTop:"comment_unfurl"===t?6:0}:{},userSelect:"none",WebkitUserSelect:"none"},threadLine:n?{position:"absolute",backgroundColor:e.stroke.deemphasized,width:1.5,height:"calc(100% - 36px)",left:"margin_comments"===t?"23px":"27px",top:"38px"}:{},userRow:{alignItems:"center",position:"relative",display:"flex",flexDirection:"row",padding:"margin_comments"===t?"4px 16px 0px 12px":"comment_unfurl"===t?"6px 16px 0px 10px":"6px 16px 0px 18px",...n?{padding:"margin_comments"===t?"0 16px 0 12px":"comment_unfurl"===t?"6px 16px 8px 10px":"updates_sidebar"===t?"0 20px 0 16px":"0 16px"}:{},marginTop:"comment_unfurl"===t?-11:void 0,userSelect:"none",WebkitUserSelect:"none"},placeholder:{height:8,width:81,borderRadius:4,background:e.lightDividerColor},unfurlLessWrapper:{color:e.regularTextColor,fontWeight:h.Z.fontWeight.medium,paddingLeft:s,marginLeft:7},unfurlMoreWrapper:{color:e.lightTextColor,fontWeight:"comment_unfurl"===t?h.Z.fontWeight.medium:void 0,...n?{display:"block",marginBottom:-1.5}:{}},attachIcon:{width:18,height:18,fill:e.mediumIconColor},text:{cursor:"comment_unfurl"!==t?"text":void 0,paddingLeft:s,marginLeft:"comment_unfurl"===t?8:void 0,...n?{lineHeight:"18px"}:{},...o?{fontSize:32}:{}},textWrapper:{padding:"margin_comments"===t?"2px 16px 6px 42px":"0px 16px 3px 16px",marginTop:"comment_unfurl"===t?"-14px":void 0,...n?{padding:"margin_comments"===t?"0 16px 0 46px":"comment_unfurl"===t?"4px 16px 0 8px":"updates_sidebar"===t?"0 20px 0 14px":"0 16px 0 14px"}:{}},reactionContainer:{marginLeft:"margin_comments"===t?41:50,marginRight:14,marginTop:4,marginBottom:4},attachmentContainer:{padding:"0px 16px 6px 54px",marginTop:-12,display:"flex",alignItems:"center"},timestamp:{margin:"0 6px",flexBasis:"comment_unfurl"!==t?140:void 0,whiteSpace:"normal",flexGrow:"updates_sidebar"===t||"comment_unfurl"===t?void 0:1,display:"inline",...n?{color:e.text.tertiary}:{}},commentAttachment:{margin:"0px 16px 0px "+("margin_comments"===t?"40px":"50px"),...n?{marginTop:6,marginBottom:6,marginLeft:"margin_comments"===t?46:50}:{}},commentAuthorPlaceholder:{marginRight:8,marginTop:"comment_unfurl"===t?14:2,height:i,width:i,borderRadius:20,flexShrink:0}})),[t,s,o,i,n])}({discussionLocation:W,isAllEmojis:ze,avatarSize:Ae,newCommentsDesignEnabled:oe});if(!ne)return null;if(!Ce||!we)return null;const Ue="comment_unfurl"!==W,We=!!oe&&H;let He,$e;Ce.lastEditedTime&&Ce.lastEditedTime>Ce.createdTime+100?(He=(0,Y.jsx)(f.FormattedMessage,{defaultMessage:"{lastEditedTime} (edited)",id:"comment.editedAtTime.label",values:{lastEditedTime:(0,B.IS)(Ce.lastEditedTime,{useUltraCompactFormat:oe})}}),$e=(0,B.uy)(Ce.lastEditedTime)):(He=(0,B.IS)(Ce.createdTime,{useUltraCompactFormat:oe}),$e=(0,B.uy)(Ce.createdTime));const Ge=(0,Y.jsx)("div",{style:Oe.commentAttachment,children:(0,Y.jsx)(Ze,{contentStores:se,onRemoveContent:Le,discussionFormat:(0,z.ad)(W),collapsed:e.collapsed})});return(0,Y.jsxs)("div",{ref:_e,onClick:e=>X&&e.stopPropagation(),style:Oe.container,children:[e.showNewBar&&(0,Y.jsx)(Be,{}),(0,Y.jsxs)("div",{style:Oe.comment,onFocus:de,onBlur:ce,onMouseMove:ue,onMouseLeave:me,children:[(0,Y.jsxs)("div",{style:{flexGrow:1,minWidth:0},children:[We&&(0,Y.jsx)("div",{style:Oe.threadLine}),(0,Y.jsxs)("div",{style:Oe.userRow,children:[(0,Y.jsx)(ye.S,{authorStore:null==we?void 0:we.store,avatarSize:Ae,avatarStyle:Oe.avatar,placeholderStyle:Oe.commentAuthorPlaceholder}),(0,Y.jsxs)("div",{style:{overflow:"hidden"},children:[(0,Y.jsx)("span",{style:{fontWeight:oe?h.Z.fontWeight.medium:h.Z.fontWeight.semibold,whiteSpace:"normal"},children:je?(0,Y.jsx)(j.ZP,{renderTooltip:()=>we&&we.store instanceof A.U6?(0,Y.jsx)(R.Z,{targetUserStore:we.store}):null,placement:j.ug.Top,alignment:j.v2.End,render:e=>(0,Y.jsx)("span",{...e,children:we.displayName}),delayThreshold:600,allowHover:!0,closeDelay:1500,isLightBackground:!0}):we.displayName||(0,Y.jsx)("span",{style:Oe.placeholder})}),(0,Y.jsx)(k.Z,{isSmall:!0,isSecondaryColor:!0,isMultiline:!0,style:Oe.timestamp,children:(0,Y.jsx)(L.Z,{text:He,tooltipText:$e,icon:m.C})}),"comment_unfurl"===W&&re&&(0,Y.jsx)("div",{style:{display:"inline-flex"},children:(0,Y.jsx)(w.Z,{children:(0,Y.jsx)(f.FormattedMessage,{id:"comment.unfurl.resolvedStatus",defaultMessage:"Resolved"})})})]})]}),!!o&&(0,Y.jsx)("div",{style:{paddingLeft:ie+15,paddingRight:16,...oe&&"updates_sidebar"===W?{paddingRight:20}:{}},children:o}),X?(0,Y.jsx)("div",{style:(0,z.ad)(W)===z.O2.Margin?{marginTop:8}:void 0,children:(0,Y.jsx)(Ve.default,{containerStyle:{padding:"margin_comments"===W?`0px 16px 0px ${oe?46:16}px`:"0px 10px 0px 45px"},showAvatar:!1,parentStore:e.store,blockStore:e.blockStore,onCancel:De,onSubmit:Te,discussionInputStore:ne,isEditingExistingComment:!0,isMobileSlideUpMenu:!0,shouldSaveUnsentComments:!1,commentStore:e.store,discussionFormat:(0,z.ad)(W),canDrop:!0})}):(0,Y.jsxs)(Y.Fragment,{children:[Ne&&!X&&(0,Y.jsx)("div",{style:Oe.textWrapper,children:(0,Y.jsx)(I.Z,{onMore:"comment_unfurl"===W?void 0:()=>{},lessElement:"comment_unfurl"===W?(0,Y.jsx)("span",{className:"notion-link",style:Oe.unfurlLessWrapper,children:(0,Y.jsx)(f.FormattedMessage,{id:"comments.showLessLabel",defaultMessage:"show less"})}):void 0,moreElement:(0,Y.jsxs)(M.Z,{disableUnderline:!0,style:Oe.unfurlMoreWrapper,hoverColor:oe?"blue":void 0,children:["…"," ",(0,Y.jsx)("span",{children:(0,Y.jsx)(f.FormattedMessage,{id:"text.truncated.showMoreLabel",defaultMessage:"more"})})]}),maxLines:e.collapsed?U:void 0,children:(0,Y.jsx)(D.Z,{style:Oe.text,store:Z.zP(e.store),disabled:!0,disableDateMentions:!0,disableEquationInteraction:!0})})}),"comment_unfurl"!==W?Ge:!Ne&&(0,Y.jsxs)("div",{style:Oe.attachmentContainer,children:[(0,Y.jsx)("div",{style:{marginRight:5},children:(0,u.s)(Oe.attachIcon)}),(0,Y.jsx)(f.FormattedMessage,{defaultMessage:"{numberOfAttachments, plural, one {{numberOfAttachments} attachment} other {{numberOfAttachments} attachments}}",values:{numberOfAttachments:se.length},id:"comment.unfurl.attachments.title"})]})]}),(0,Y.jsx)("div",{ref:Ke,children:Ue&&Ce.reactions.length>0&&(0,Y.jsx)("div",{style:Oe.reactionContainer,children:(0,Y.jsx)(Se.default,{parentStore:e.store,discussionLocation:W})})})]}),"comment_unfurl"!==W&&!X&&(0,Y.jsx)(be,{store:e.store,discussionStore:e.discussionStore,blockStore:e.blockStore,discussionLocation:W,visible:xe,isFirstComment:fe,buttonPopupStore:ge,canShowReactions:Ue,handleEditComment:Re,handleDeleteComment:Me,handleReaction:Ie})]})]})}},41645:(e,t,o)=>{o.d(t,{Z:()=>c});o(67294);var i=o(480),n=o(86628),s=o(73063),r=o(26388),a=o(75179),l=o(77080),d=o(85893);const c=function(e){window.__c={n:"CommentActionButton"};const t=(0,i.O7)(),{icon:o,onClick:c,tooltip:u}=e,m=(0,n.VK)((()=>l.default.checkGate("comments_density_image_handling")),[]);return(0,d.jsx)(a.Z,{capture:!0,render:e=>(0,d.jsx)(r.ZP,{renderTooltip:()=>u,render:i=>(0,d.jsx)(s.Z,{ariaLabel:u,icon:o,iconStyle:{width:t.device.isMobile?20:16,height:t.device.isMobile?20:16},style:{marginLeft:t.device.isMobile?16:10,...m?{marginLeft:t.device.isMobile?16:0}:{}},onClick:c,...i,...e})})})}},70775:(e,t,o)=>{o.d(t,{S:()=>g});o(67294);var i=o(86628),n=o(24405),s=o(54368),r=o(77420),a=o(19889),l=o(97880),d=o(70301),c=o(45653),u=o(83420),m=o(77080),p=o(85893);function g(e){let{authorStore:t,avatarSize:o,avatarStyle:g,placeholderStyle:h}=e;window.__c={n:"CommentAuthorAvatar"};const f=(0,n.Fg)(),x=(0,i.VK)((()=>(0,u.TL)(t)),[t]),v=(0,i.VK)((()=>m.default.checkGate("comments_density_image_handling")),[]);return x.asActor?x.table===a.KJ?(0,p.jsx)(c.Z,{hasTooltip:!0,userValue:x.asActor,style:g,size:o,avatarShouldShowShadow:!v}):x.table===r.cZ?(0,p.jsx)(d.Z,{botValue:x,size:o,style:g}):x.table===s.y?(0,p.jsx)("div",{style:{...h,background:f.lightDividerColor}}):void(0,l.t1)(x):(0,p.jsx)("div",{style:{...h,background:f.lightDividerColor}})}},43590:(e,t,o)=>{o.r(t),o.d(t,{default:()=>oe});var i=o(67294),n=o(1302),s=o(480),r=o(33125),a=o(86628),l=o(24405),d=o(72126),c=o(70203),u=o(97880),m=o(9291),p=o(47307),g=o(61045),h=o(98104),f=o(82530),x=o(53336),v=o(79954),S=o(93963),b=o(65598),C=o(89574),y=o(46351),w=o(95802),j=o(21853),k=o(34859),M=o(77080),L=o(96049),I=o(45589),R=o(17707),D=o(7476),T=o(34047),_=o(82994),Z=o(63202),B=o(13991),V=o(41432),F=o(99036),P=o(8848),K=o(25501),A=o(59753),E=o(82990),N=o(2456),z=o(33929),O=o(85893);const U=new Set([V.Ti.toggle,V.Ti.bulletedList,V.Ti.numberedList,V.Ti.quote,V.Ti.toDo,V.Ti.code,V.Ti.callout,V.Ti.header,V.Ti.subHeader,V.Ti.subSubHeader,V.Ti.tableRow]);function W(e){window.__c={n:"DiscussionContext"};const t=(0,l.Fg)(),o=(0,a.VK)((()=>{var t;return e.store.isDefined()?null===(t=e.store.getParentStore())||void 0===t?void 0:t.getValue():null}),[e.store]),i=(0,a.VK)((()=>e.blockStore.getSpaceId()),[e.blockStore]),n=(0,a.VK)((()=>{if(!e.store.isDefined())return;const t=e.store.getContext();if(!t)return;return c.VP_(t,(t=>!c.xw5(t)||c.h19(t)===e.store.id))}),[e.store]),s=(0,a.VK)((()=>M.default.checkGate("comments_density_image_handling")),[]),r=o=>{let{textValue:n,propertySchema:r,discussionParentValue:a}=o;const l=(0,O.jsx)("div",{style:{maxHeight:s?64:72,overflow:"hidden",lineHeight:s?"16px":"24px"},children:(0,O.jsx)(N.KX,{value:{value:n,spaceId:i},propertySchema:r,labeled:!1,rootStore:e.blockStore,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!0})});if(!a)return l;const d=a.type;return d===V.Ti.code?(0,O.jsx)(K.Z,{title:(0,N.SP)(a),theme:t,style:{marginTop:0,marginBottom:0},children:(0,O.jsx)("span",{style:{fontFamily:E.Z.getCompositeFontFamily(B.SP).mono,fontSize:12,tabSize:2},children:l})}):(0,N.pH)(d)?(0,O.jsx)(K.Z,{title:(0,N.pH)(d),theme:t,style:{marginTop:0,marginBottom:0},children:l}):l};function d(e){if(!n)return null;const o={display:"flex",alignItems:"flex-start",fontSize:s?13:14,marginTop:s?5:8,marginBottom:8,color:s?t.text.secondary:t.mediumTextColor,width:"100%"},i=F.Kc(z.default.getIntl()).title;return i?(0,O.jsx)("div",{style:o,children:(0,O.jsxs)("div",{style:{display:"flex",width:"100%"},children:[(0,O.jsx)(H,{newCommentsDesignEnabled:s}),r({textValue:n,discussionParentValue:e,propertySchema:i})]})}):null}if("updates_sidebar"===e.discussionLocation){if(!o)return null;if("text"!==o.type)return(0,O.jsx)("div",{onClick:e.onClick,style:{display:"flex",cursor:A.kk.fromBlock(o).isType(V.Zi)?"text":void 0},children:n&&U.has(o.type)?d(o):(0,O.jsxs)("div",{style:{display:"flex",marginTop:8,marginBottom:8,width:"100%"},children:[(0,O.jsx)(H,{newCommentsDesignEnabled:s}),(0,O.jsx)(N.ZP,{blockValue:o,rootStore:e.blockStore,blockPreviewLocation:"comments_sidebar"})]})})}return(0,O.jsx)("div",{onClick:e.onClick,style:{cursor:"text"},children:d()})}function H(e){const{newCommentsDesignEnabled:t}=e;return(0,O.jsx)("div",{style:{width:t?2:3,borderRadius:t?3:4,marginLeft:t?0:2,marginRight:t?6:8,background:P.DB,flexShrink:0,paddingBottom:2}})}var $=o(7189),G=o(72141),X=o(26388),q=o(93575);const J=i.forwardRef(((e,t)=>{window.__c={n:"DiscussionPopupInput"};const o=(0,s.O7)(),{format:i,role:n,showMoreCommentsButton:r,onMoreCommentsClick:d,inputVisible:c}=e,u=n&&G.rz(n),p=o.currentUser.isLoggedIn(),{device:g,WindowSizeStore:h}=o,f=(0,l.Fg)(),x=(0,a.VK)((()=>M.default.checkGate("comments_density_image_handling")),[]),v=(0,a.VK)((()=>({paddingLeft:g.isMobile&&h.getSafePaddingLeftCSS(18)||i===T.O2.Margin&&9||13,paddingRight:g.isMobile&&h.getSafePaddingLeftCSS(14)||i===T.O2.Margin&&12||16})),[h,g.isMobile,i]),S=(0,l.yK)((t=>({container:{paddingTop:e.collapsed?1:4,paddingLeft:v.paddingLeft,paddingRight:v.paddingRight,paddingBottom:(g.isMobile&&i!==T.O2.Page?8:i===T.O2.Sidebar&&14)||0,position:"relative",...x?{borderTopColor:t.stroke.deemphasized,borderTopStyle:"solid",borderTopWidth:c?1:0,padding:0,marginTop:6,...i===T.O2.Page?{marginLeft:14,marginRight:14,marginBottom:-6}:{}}:{}},moreCommentsWrapper:{position:"absolute",display:"flex",justifyContent:"center",alignItems:"flex-start",zIndex:1,left:0,right:0,marginTop:-32,height:30,background:`linear-gradient(to bottom, ${t.contentBackgroundTransparent} 0px, ${t.selectedMarginDiscussionBackground} 30px`,...x?{marginTop:-32}:{}},tooltip:{...(0,X.JS)(t,!1),cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",...x?{marginTop:-4,borderRadius:6,padding:"4px 10px 4px 8px"}:{}}})),[v,g.isMobile,i,e.collapsed,x,c]);return(0,O.jsx)(O.Fragment,{children:p&&!u&&(r||c)&&(0,O.jsxs)("div",{style:S.container,children:[r&&(0,O.jsx)("div",{style:S.moreCommentsWrapper,children:(0,O.jsxs)("div",{style:S.tooltip,onClick:d,children:[(0,O.jsx)("div",{style:{marginRight:5},children:(0,$.K)({fill:f.regularInvertedTextColor,height:12,width:12})}),(0,O.jsx)(m.FormattedMessage,{defaultMessage:"See more",id:"discussion.moreMessageTooltip"})]})}),c&&(0,O.jsx)(q.default,{showAvatar:!!x||"margin_comments"!==e.discussionLocation,containerStyle:x?{padding:"margin_comments"===e.discussionLocation?"12px 12px 4px":"page_discussion"===e.discussionLocation?"12px 12px 4px 2px":"block_menu"===e.discussionLocation?"12px 12px 4px 16px":"12px 16px 12px 16px"}:g.isMobile?void 0:{paddingLeft:5,paddingRight:2},parentStore:e.store,onCancel:e.onCancel,onSubmit:e.onSubmit,discussionInputStore:e.discussionInputStore,isMobileSlideUpMenu:!1,shouldSaveUnsentComments:!0,onEditPreviousComment:e.onEditPreviousComment,inReplyToDiscussionId:e.store.id,discussionFormat:e.format,showCtaButtons:e.showCtaButtons,ref:t,onFileUploaded:e.onFileUploaded})]})})}));var Q=o(62385);function Y(e){window.__c={n:"DiscussionShowAllButton"};const t=(0,a.VK)((()=>M.default.checkGate("comments_density_image_handling")),[]),o=(0,l.yK)((o=>({newBarLine:{height:"0px",borderBottom:`1px solid ${o.darkDividerColor}`,marginLeft:0,flex:1},moreCommentsWrapper:{color:o.lightTextColor,fontSize:14,paddingLeft:t?e.insetButton?14:10:e.insetButton?38:25,flexGrow:1,display:"flex",alignItems:"center"},button:{padding:t?"14px 12px 14px 0":"12px 12px",margin:t?"1px 4px 1px 36px":"1px 4px",borderRadius:4,fontSize:14,color:o.mediumTextColor,width:t?"margin_comments"===e.discussionLocation?"calc(100% - 52px)":"calc(100% - 56px)":"calc(100% - 8px)",justifyContent:"space-between"},buttonHovered:{background:o.focusDiscussionInputBackground},threadLine:t?{position:"absolute",backgroundColor:o.stroke.deemphasized,width:1.5,height:"100%",left:"margin_comments"===e.discussionLocation?"23px":"27px"}:{}})),[e.insetButton,e.discussionLocation,t]);return e.count<=0?null:(0,O.jsxs)("div",{style:t?{position:"relative"}:{},children:[(0,O.jsx)("div",{style:o.threadLine}),(0,O.jsx)(Q.Z,{style:o.button,onClick:e.onClick,hoveredStyle:o.buttonHovered,children:(0,O.jsx)("div",{style:o.moreCommentsWrapper,children:(0,O.jsx)(m.FormattedMessage,{defaultMessage:"Show {moreCommentsNumber, plural, one {{moreCommentsNumber} reply} other {{moreCommentsNumber} replies}}",id:"discussion.showMoreCommentsSidebarButton.label",values:{moreCommentsNumber:e.count}})})},"show")]})}const ee=2,te=5;function oe(e){window.__c={n:"Discussion"};const t=(0,i.useRef)(null),o=(0,s.O7)(),B=(0,a.VK)((()=>M.default.checkGate("comments_density_image_handling")),[]),V=(0,a.VK)((()=>b.D4(e.store)),[e.store]),F=(0,a.VK)((()=>V.filter((e=>e.isDefined()))),[V]),P=(0,i.useRef)(e.discussionInputStore||new _.Z(o,e.store.pointer.spaceId)).current,K=(0,a.VK)((()=>(0,T.n9)(P)),[P]),A=(0,a.VK)((()=>e.store.isDefined()),[e.store]),E=(0,a.VK)((()=>e.store.getResolved()),[e.store]),[N,z]=(0,i.useState)(!1),[U,H]=(0,i.useState)(!1),[$,G]=(0,i.useState)(!0),X=(0,a.qz)(void 0,I.Z),q=(0,a.VK)((()=>X.state.clientRect),[X]),Q=e.format===T.O2.Sidebar,oe=e.format===T.O2.Margin,ne=(0,i.useRef)(null);(0,r.c)(y.Z,(()=>({isSidebarFormat:()=>Q,isMarginFormat:()=>oe,getStore:()=>e.store,getInputStore:()=>P,getNode:()=>ne.current})),[Q,oe,e.store,P]);const se=(0,a.VK)((()=>{if(!Q)return;return(0,T.NI)(e.store).find((t=>D.t({discussionStore:e.store,commentStore:t})))}),[Q,e.store]),re=(0,i.useRef)(se),ae=(0,a.VK)((()=>{const{showAllRepliesAfterTimestamp:t}=e,o=(()=>{var o;if(U||F.length<=te||"block_menu"===e.discussionLocation||"page_discussion"===e.discussionLocation)return F;const i=[t,null===(o=re.current)||void 0===o?void 0:o.getCreatedTime(),null==se?void 0:se.getCreatedTime()].filter(u.$K),n=i.length>0?Math.min(...i):void 0;if(n){const e=F.filter((e=>(e.getCreatedTime()||0)>n)),t=F.filter((e=>(e.getCreatedTime()||0)<=n));return t.length<=te?F:[...d.pm(t,ee),...e]}return d.pm(F,ee)})(),i=new Set(o.map((e=>e.id))),n=F.filter((e=>!i.has(e.id))),s=n.length;return{commentStores:F,commentsToShow:o,commentsToCollapse:n,remainingCommentCount:s,shouldRenderFirstComment:s>0}}),[F,se,e,U],{useDeepEqual:!0}),le=(0,i.useCallback)((()=>{if(!e.store.isDefined())return;const t=e.store.getContext();if(!t)return;return c.VP_(t,(t=>!c.xw5(t)||c.h19(t)===e.store.id))}),[e.store]),de=(0,a.VK)((()=>{if(!Q)return;return(0,T.NI)(e.store).find((t=>D.t({discussionStore:e.store,commentStore:t})))}),[Q,e.store]),ce=i.createRef(),ue=(0,i.useRef)(e.blockStore.clone()).current,me=(0,l.yK)((t=>({discussionWrapper:{...e.format===T.O2.Page&&{margin:"14px -14px 14px"},...e.format===T.O2.Menu&&{paddingTop:B?8:10,paddingBottom:B?8:12,marginLeft:-2,boxShadow:e.isFirst?"none":`0 -1px 0 ${t.regularDividerColor}`,marginTop:e.isFirst?0:1},...e.format===T.O2.Margin&&{paddingTop:B?4:e.collapsed?8:0,paddingBottom:B||e.collapsed?8:14,borderRadius:B?8:4}}})),[e.collapsed,e.format,e.isFirst,B]);(0,i.useEffect)((()=>{o.KatexStore.loadIfNeeded(le)}),[o.KatexStore,le]);const pe=t=>{const{device:i}=o;if(!i.isMobile)return;if(!e.store.isDefined())return;t.stopPropagation(),t.preventDefault(),j.Z.setState({open:!1});const n=d.oA(w.C.findSelectablesFromIds([e.store.getParentId()])),s=null==n?void 0:n[0];s&&g.NQ({component:s,vertical:{reveal:"bottom"},horizontal:{reveal:"closest"},animate:!0})},ge=()=>{const o=(0,T.QT)(V.length);if(!e.collapsed)return(0,O.jsx)(x.Z,{style:{display:"flex",flexDirection:"column",maxHeight:500,overflowY:"scroll",paddingTop:B?void 0:8},ref:t,type:k.Z.Y,store:X,children:V.map(((t,i)=>(0,O.jsx)(Z.default,{store:t,discussionStore:e.store,blockStore:e.blockStore,hoveringDiscussion:N,discussionLocation:e.discussionLocation,showResolveButtonByDefaultIfPossible:e.showResolveButtonByDefaultIfPossible,maxLines:o,shouldShowThreadLine:B?i!==V.length-1:void 0},t.id)))});const i=V[0]&&(0,O.jsx)(Z.default,{store:V[0],discussionStore:e.store,blockStore:e.blockStore,hoveringDiscussion:N,discussionLocation:e.discussionLocation,showResolveButtonByDefaultIfPossible:e.showResolveButtonByDefaultIfPossible,maxLines:o,collapsed:e.collapsed,shouldShowThreadLine:B?1!==V.length:void 0},V[0].id),n=V.length>1&&V[V.length-1]&&(0,O.jsx)(Z.default,{store:V[V.length-1],discussionStore:e.store,blockStore:e.blockStore,hoveringDiscussion:N,discussionLocation:e.discussionLocation,showResolveButtonByDefaultIfPossible:e.showResolveButtonByDefaultIfPossible,maxLines:o,collapsed:e.collapsed,shouldShowThreadLine:!B&&void 0},V[V.length-1].id),s=V.length-2;return(0,O.jsxs)(O.Fragment,{children:[i,(0,O.jsx)(Y,{insetButton:!oe,count:s,onClick:Ce,discussionLocation:e.discussionLocation}),n]})};const he=(0,a.VK)((()=>e.blockStore.getRole()),[e.blockStore]),fe=t.current,xe=(0,a.VK)((()=>(null==fe?void 0:fe.atScrollEnd())??!0),[fe]),ve=$&&!e.collapsed&&oe&&q&&t.current&&!xe,Se=()=>{n.default.afterNextFlush((()=>{t.current&&t.current.scrollToBottom({animate:!0})}))},be=d.Ds((()=>{setTimeout((()=>G(!0)),50)}),50),Ce=e=>{oe||(e.stopPropagation(),H(!0))},ye=()=>{P.reset()};return(0,O.jsx)(v.Z,{store:ue,analyticsName:"discussion",canNativeDropOnto:!0,onNativeDrop:async e=>{let{files:t}=e;ce.current&&await ce.current.uploadFiles(t)},keepTextSelectionOnDrop:!0,shouldShowDropZone:!0,children:(0,O.jsxs)("div",{ref:ne,style:me.discussionWrapper,onMouseMove:()=>{L.Z.state||z(!0)},onMouseLeave:()=>{z(!1)},children:[function(){if(oe)return ge();const{commentStores:t,shouldRenderFirstComment:o,commentsToShow:i,commentsToCollapse:n}=ae,s=i.map(((t,n)=>{var s;return(0,O.jsx)(Z.default,{store:t,discussionStore:e.store,blockStore:e.blockStore,hoveringDiscussion:N,discussionLocation:e.discussionLocation,showResolveButtonByDefaultIfPossible:e.showResolveButtonByDefaultIfPossible,discussionContext:!o&&e.format!==T.O2.Margin&&0===n&&(0,O.jsx)(W,{format:e.format,discussionLocation:e.discussionLocation,store:e.store,blockStore:e.blockStore,onClick:pe}),showNewBar:t.id===(null===(s=re.current)||void 0===s?void 0:s.id)&&0!==n,shouldShowThreadLine:B?n!==i.length-1:void 0},t.id)})),r=o&&(0,O.jsx)(Z.default,{store:t[0],discussionStore:e.store,blockStore:e.blockStore,hoveringDiscussion:N,discussionLocation:e.discussionLocation,showResolveButtonByDefaultIfPossible:e.showResolveButtonByDefaultIfPossible,discussionContext:e.format!==T.O2.Margin&&A&&(0,O.jsx)(W,{format:e.format,discussionLocation:e.discussionLocation,store:e.store,blockStore:e.blockStore,onClick:pe}),shouldShowThreadLine:B?1!==t.length:void 0},t[0].id);return(0,O.jsxs)("div",{style:{position:"relative"},children:[r,Q&&de&&(0,O.jsx)(S.z,{style:ie}),(0,O.jsx)(Y,{insetButton:!oe,count:n.length-1,onClick:Ce,discussionLocation:e.discussionLocation}),s]})}(),E?(0,O.jsx)("div",{style:{height:8}}):(0,O.jsx)(J,{ref:ce,showMoreCommentsButton:!!ve,onMoreCommentsClick:Se,inputVisible:!e.collapsed||!K,store:e.store,format:e.format,discussionInputStore:P,discussionLocation:e.discussionLocation,onCancel:async()=>{if((0,T.hu)(P)){await p.confirmUserAction({message:(0,O.jsx)(m.FormattedMessage,{defaultMessage:"Do you want to discard this reply?",id:"discussion.confirmDialog.discardReply.prompt"}),acceptLabel:(0,O.jsx)(m.FormattedMessage,{defaultMessage:"Discard",id:"discussion.confirmDialog.discardReplyButton.label"})})?(ye(),e.onDismiss&&e.onDismiss()):(await n.default.afterNextFlush(),h.NX({store:P.state.textStore}))}else ye(),e.onDismiss&&e.onDismiss()},onSubmit:async()=>{G(!1);const{device:t}=o,{store:i,discussionLocation:s}=e;f.createAndCommit({userAction:"Discussion.handleSubmitReply",environment:o,perform:e=>{R.Xi({environment:o,discussionStore:i,textValue:P.state.textStore.getValue()||[],transaction:e,discussionLocation:s,files:P.state.files})}}),ye(),h.ZH(o),Se(),be(),t.isMobile||(await n.default.afterNextFlush(),h.N_({store:P.state.textStore}))},onEditPreviousComment:()=>{const t=o.currentUser.id;if(!t)return;const i=b.D4(e.store).filter((e=>e.getCreatedById()===t)),n=d.Z$(i);if(!n)return;const s=C.Z.find((t=>t.commentId===n.id&&t.discussionLocation===e.discussionLocation));s&&(h.ZH(o),s.edit())},showCtaButtons:!!oe||void 0,onFileUploaded:()=>{const e=w.C.findSelectableFromStore(ue);e&&g.NQ({component:e,vertical:{reveal:"bottom"},horizontal:{reveal:"closest"},animate:!0})},role:he})]})})}const ie={marginRight:4,position:"absolute",right:16,top:14}},93575:(e,t,o)=>{o.r(t),o.d(t,{default:()=>Q});var i=o(67294),n=o(1302),s=o(480),r=o(6740),a=o(86628),l=o(24405),d=o(15157),c=o(72126),u=o(9291),m=o(85344),p=o(47307),g=o(67060),h=o(993),f=o(98104),x=o(82530),v=o(53471),S=o(23063),b=o(37601),C=o(3386),y=o(45653),w=o(79954),j=o(65187),k=o(28020),M=o(43250),L=o(33929),I=o(68056),R=o(77080),D=o(24666),T=o(65598);var _=o(34047),Z=o(59194),B=o(91315),V=o(64275),F=o(22962),P=o(83065),K=o(61519),A=o(73063),E=o(75179),N=o(41645),z=o(85893);const O=function(e){window.__c={n:"CommentInputActionBar"};const t=(0,u.useIntl)(),o=(0,s.O7)(),{device:i}=o,n=(0,a.VK)((()=>R.default.checkGate("comments_density_image_handling")),[]),r=(0,l.yK)((e=>({icon:{background:e.mediumIconColor,borderRadius:"50%",marginLeft:o.device.isMobile?16:12,pointerEvents:"auto",height:20,width:20},iconHovered:{background:e.lightIconColor}})),[o.device.isMobile]),{canSend:d,visible:c,onSend:m,onCancel:p,isEditing:g,animated:h,onMention:f,onAttach:x,inline:v}=e,b={opacity:c?1:0};return(0,z.jsx)(S.Z,{isVisible:!0,animationStyle:b,render:()=>(0,z.jsx)("div",{style:{display:"flex",...v?{flexDirection:"column-reverse",alignItems:"end",marginRight:8}:{flexDirection:"row",position:"absolute",bottom:7,right:12,alignItems:"center"},pointerEvents:c?void 0:"none",...h&&b,...n?{marginRight:0,flexGrow:1,width:"min-content"}:{}},children:(0,z.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",...n?{gap:6}:{}},children:[(0,z.jsx)(N.Z,{icon:Z.s,onClick:x,tooltip:t.formatMessage({id:"discussionInput.uploadFile.button.tooltip",defaultMessage:"Attach file"})}),!i.isMobileBrowser&&(0,z.jsx)(N.Z,{icon:F.O,onClick:f,tooltip:t.formatMessage({id:"discussionInput.insertMention.button.tooltip",defaultMessage:"Mention a person, page, or date"})}),g&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{style:{height:14,marginLeft:o.device.isMobile?10:8},children:(0,z.jsx)(K.Z,{vertical:!0,size:1})}),(0,z.jsx)(E.Z,{capture:!0,render:e=>(0,z.jsx)(A.Z,{icon:V.D,isDarkIconColor:!0,onClick:p,iconStyle:{fill:"white",height:o.device.isMobile?18:16,width:o.device.isMobile?18:16},hoveredStyle:r.iconHovered,style:r.icon,...e})})]}),g?(0,z.jsx)(E.Z,{capture:!0,render:e=>(0,z.jsx)(A.Z,{icon:B.r,onClick:m,isBlue:d,disabled:!d,iconStyle:{height:o.device.isMobile?23:21,width:o.device.isMobile?23:21},style:{marginLeft:o.device.isMobile?16:12,pointerEvents:"auto",height:20,width:20},...e})}):(0,z.jsx)(E.Z,{capture:!0,render:e=>(0,z.jsx)(A.Z,{icon:P._,onClick:m,isBlue:d,disabled:!d,iconStyle:{height:o.device.isMobile?26:24,width:o.device.isMobile?26:24},style:{marginLeft:o.device.isMobile?16:12,pointerEvents:"auto",height:20,width:20,...n?{marginLeft:o.device.isMobile?16:2}:{}},...e})})]})})})},U=(0,u.defineMessages)({defaultPlaceholder:{defaultMessage:"Add a comment…",id:"discussionInput.defaultPlaceholder.addComment"},pasteFileIntoCommentNotAllowed:{id:"clipboardActions.pasteFileIntoCommentError.message",defaultMessage:"Sorry, you cannot paste files into a comment."},replyInputPlaceholder:{defaultMessage:"Reply...",id:"updateSidebar.placeholder.addComment"}});var W=o(32238);const H=i.forwardRef(((e,t)=>{var o;window.__c={n:"DiscussionInput"};const w=(0,s.O7)(),{device:Z,currentUser:B}=w,[V,F,P]=(0,a.AF)(e.discussionInputStore),{textStore:K,files:A}=V,E=(0,a.VK)((()=>K.getValue()),[K]),[N,H]=(0,i.useState)(!1),[Q,Y]=(0,i.useState)(!1),ee=(0,i.useRef)(null),{commentStore:te}=e,oe=e.discussionFormat!==_.O2.Page;(0,i.useImperativeHandle)(t,(()=>({uploadFiles:me})));const ie=(0,a.VK)((()=>(0,k.B7)(w)),[w]),ne=(0,a.VK)((()=>R.default.checkGate("comments_density_image_handling")),[]),se=(0,i.useRef)(null===(o=e.blockStore)||void 0===o?void 0:o.clone()),re=(0,a.VK)((()=>{const e=D.default.state;return"editing"===e.mode&&(0,I.qS)(e.multiSelection)&&e.multiSelection.start.store===K}),[K]),ae=(0,a.VK)((()=>({isEmpty:(0,_.n9)(P),hasChanged:(0,_.hu)(P,te)})),[P,te]),le=(0,a.VK)((()=>re||!ae.isEmpty),[ae.isEmpty,re]),de=(0,i.useCallback)((async()=>{const e=D.default.state;"editing"===e.mode&&(0,I.qS)(e.multiSelection)&&e.multiSelection.start.store===K||(f.NX({store:K}),await n.default.afterNextFlush())}),[K]),ce=e=>{const t=P.state;P.setState({...t,files:t.files.filter((t=>t.id!==e.id))})},ue=async e=>{await me(e.files),m.Zq(w,{type:"paste"})},me=(0,i.useCallback)((async t=>{var o;if(await de(),A.length+t.length>10)return void p.showErrorMessage((0,z.jsx)(u.FormattedMessage,{id:"discussionInput.uploadFile.tooManyFilesErrorMessage",defaultMessage:"You cannot upload more than {maxFiles} files per comment.",values:{maxFiles:10}}));const i=t.map(v.Xo);F({...V,files:[...A,...i]}),null===(o=e.onFileUploaded)||void 0===o||o.call(e)}),[de,A,F,V,e]),pe=e.discussionFormat===_.O2.Margin,ge=e.discussionFormat===_.O2.Sidebar,he=e.discussionFormat===_.O2.Page;(0,i.useEffect)((()=>{e.commentStore&&function(e,t){const o=T.le(t),i=v.nQ(o);e.setState({...e.state,files:i})}(P,e.commentStore)}),[P,e.commentStore]);const fe=(0,i.useRef)(!1),xe=(0,i.useCallback)((t=>{t?d.Z.set({userId:B.id,key:J(e.parentStore.id,e.inReplyToDiscussionId),value:t??null}):d.Z.remove({userId:B.id,key:J(e.parentStore.id,e.inReplyToDiscussionId)})}),[B.id,e.inReplyToDiscussionId,e.parentStore.id]);(0,i.useEffect)((()=>{e.shouldSaveUnsentComments&&fe.current&&xe(E),fe.current=!0}),[e.shouldSaveUnsentComments,xe,E]);const ve=(0,i.useRef)(K);(0,i.useEffect)((()=>{if(e.shouldSaveUnsentComments){const t=d.Z.get({userId:B.id,key:J(e.parentStore.id,e.inReplyToDiscussionId)});t&&x.createAndCommit({userAction:"DiscussionInput.willMount",environment:w,perform:e=>{h.sO({environment:w,store:ve.current,value:t,transaction:e})}})}}),[w,B.id,e.inReplyToDiscussionId,e.parentStore.id,e.shouldSaveUnsentComments]);const Se=(0,i.useRef)(A);(0,i.useEffect)((()=>{Se.current=A}),[A]),(0,i.useEffect)((()=>()=>{Se.current&&Se.current.forEach((e=>{"local"===e.type&&e.dataURL&&URL.revokeObjectURL(e.dataURL)}))}),[]);const be=!e.isEditingExistingComment&&(e.discussionFormat===_.O2.Page||e.discussionFormat===_.O2.Menu),Ce=!!ne||!be,ye=()=>{var e;return null===(e=ee.current)||void 0===e?void 0:e.focus()},we=A&&A.length>0,je=e.discussionFormat===_.O2.Menu&&e.inReplyToDiscussionId,ke=!ne&&(!je&&(ge||pe&&!e.isNewComment)),Me=void 0!==e.showCtaButtons?e.showCtaButtons:e.isEditingExistingComment||le||N,Le={paddingBottom:Ce&&Me?ne?0:34:ne?0:4},Ie=!e.isMobileSlideUpMenu,Re=(pe||ge)&&!e.isNewComment,De=(0,l.yK)((t=>({inputWrapper:{display:"flex",flexDirection:"column",alignItems:"bottom",minHeight:pe?void 0:32,width:"100%",fontSize:14,paddingTop:pe?1:4,paddingBottom:pe?1:4,borderRadius:4,boxShadow:!e.isNewComment&&pe?`0px 0px 0px 1px ${t.darkDividerColor}`:void 0,transition:"background 300ms ease",background:Q&&!Me&&t.focusDiscussionInputBackground||Me&&!e.isEditingExistingComment&&(e.isNewComment&&pe?t.selectedMarginDiscussionBackground:t.discussionInputActivatedBackground)||"inherit",cursor:Me?"text":"pointer",alignSelf:"center",position:"relative",...ne?{boxShadow:void 0,paddingTop:0,paddingBottom:"0 !important",flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-end",background:"transparent",minHeight:void 0,overflow:"hidden"}:{}}})),[Q,pe,e.isEditingExistingComment,e.isNewComment,Me,ne]),Te=ne?24:ge?23:20,_e={fontSize:14,marginTop:ge?2:3,marginBottom:2,paddingLeft:he?4:6,paddingRight:10,maxHeight:Z.isMobileNative?"50vh":"70vh",overflowY:"auto",overflowX:"hidden",WebkitOverflowScrolling:"touch",userSelect:"auto",WebkitUserSelect:"auto",...ne?{lineHeight:"18px",padding:"3px 4px",margin:0}:{}},Ze=(0,a.VK)((()=>0===(K.getValue()||[]).length),[K]),Be=function(e){const{isEditing:t,onEditPreviousComment:o,textRef:i}=e;if(!t)return{};const n=e=>{"key"in e&&(e.metaKey||e.ctrlKey)&&i.current&&f.N_({store:i.current.props.store})},s=e=>{"key"in e&&(e.metaKey||e.ctrlKey)&&i.current&&f.NX({store:i.current.props.store})};return{onUp:o??n,onDown:s}}({isEditing:re,shouldTrapCursorInInput:oe,onEditPreviousComment:Ze?e.onEditPreviousComment:void 0,textRef:ee}),Ve=()=>{xe(void 0),e.onSubmit()},Fe=()=>{if(!Z.isMobile)return void Ve();const e="editing"===D.default.state.mode&&D.default.state.multiSelection;e&&x.createAndCommit({userAction:"DiscussionInput.handleEnter",environment:w,perform:t=>{h.hJ({environment:w,string:"\n",multiSelection:e,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t})}})},Pe=(0,z.jsx)(O,{visible:Me,onAttach:async()=>{const{device:e}=w;e.isIOS&&e.isMobileNative&&!e.isTablet&&(f.ZH(w),await n.default.afterNextFlush());const t=await v.y({multiple:!0});await me(t),m.Zq(w,{type:"file_picker"})},onMention:async()=>{await de(),g.lZ(w,{page:!0,heading:!0,createPage:!1,user:!0,inviteUser:!0,bot:!0,date:!0,reminder:!1,templateVariable:!1,group:!0})},canSend:!ae.isEmpty,onSend:Ve,onCancel:e.onCancel,isEditing:e.isEditingExistingComment||!1,animated:pe,inline:!!ne||!Ce});return(0,z.jsx)(C.Z,{debugName:"DiscussionInput",capture:re,onCommandEnter:c.yR,children:(0,z.jsx)(q,{enabled:!!se.current&&!!e.canDrop,store:se.current,onNativeDrop:async e=>{let{files:t}=e;await me(t),m.Zq(w,{type:"drop"})},children:(0,z.jsx)("div",{className:e.isEditingExistingComment?M.hzx:M.wFE,style:{...$,...e.containerStyle||{}},onFocus:e=>{const t=e.target;t instanceof HTMLElement&&(0,r.E)(t)&&H(!0)},onBlur:()=>H(!1),onMouseOver:()=>Y(!0),onMouseOut:()=>Y(!1),children:(0,z.jsxs)("div",{style:G,children:[e.showAvatar&&(0,z.jsx)(y.Z,{userStore:ie,size:Te,avatarShouldShowShadow:!ne,style:{...X,...ne?{marginTop:0}:{}}}),(0,z.jsx)(S.Z,{isVisible:!0,animationStyle:Le,render:()=>(0,z.jsxs)("div",{className:ke?M.Wh_:"",onClick:ye,style:{...De.inputWrapper,...pe&&Le,...ne?{rowGap:4,paddingBottom:0}:{}},tabIndex:-1,children:[(0,z.jsxs)("div",{style:{flexGrow:1,display:"flex"},children:[(0,z.jsx)(j.Z,{style:_e,store:K,parentStore:e.parentStore,disabled:!1,onEnter:Fe,onCommandEnter:Ve,onPasteFiles:ue,onEsc:e.onCancel,...Be,placeholder:L.default.formatMessage(Re?U.replyInputPlaceholder:U.defaultPlaceholder),ref:ee,isDiscussionInput:!0,disableSlashCommands:!0,disableInsertText:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableEmbedMenu:!0,disableDateReminderMentions:!0,disableMobileActionBar:!0,disableStyleAnnotations:Z.isMobileBrowser,disableInsertedDeletedAnnotations:Z.isMobileBrowser,pasteBehavior:"inline"}),!Ce&&Pe]}),we&&(0,z.jsx)("div",{style:{paddingBottom:Ce?8:0,paddingLeft:8,paddingRight:8,...ne?{width:"100%",paddingLeft:4,paddingTop:4}:{}},children:(0,z.jsx)(W.Z,{files:A,onRemoveFile:ce})}),Ce&&Pe]})}),Ie&&(0,z.jsx)(b.Z,{show:re,onDismiss:()=>f.ZH(w)})]})})})})})),$={display:"flex",flexDirection:"column",width:"100%",cursor:"pointer"},G={display:"flex",alignItems:"center",flexGrow:1},X={flexShrink:0,flexGrow:0,marginRight:6,alignSelf:"flex-start",marginTop:6};function q(e){const{enabled:t,children:o,store:i,onNativeDrop:n}=e;return t&&i?(0,z.jsx)(w.Z,{store:i,analyticsName:"discussion_input",canNativeDropOnto:!0,onNativeDrop:n,keepTextSelectionOnDrop:!0,shouldShowDropZone:!0,children:o}):(0,z.jsx)(z.Fragment,{children:o})}function J(e,t){return t?`UnsentDiscussion-${e}-${t}`:`UnsentDiscussion-${e}`}const Q=H},32238:(e,t,o)=>{o.d(t,{Z:()=>H});var i=o(67294),n=o(86628),s=o(24405),r=o(31505),a=o(39301),l=o(73063),d=o(53336),c=o(73744),u=o(34859),m=o(77080),p=o(45589),g=o(480),h=o(95538),f=o(64275),x=o(64921),v=o(54604),S=o(12981),b=o(81865),C=o(85893);function y(e){window.__c={n:"FullScreenImage"};const{url:t,imageNaturalHeight:o,imageNaturalWidth:n}=e,s=(0,i.useMemo)((()=>({display:"block",width:`min(${n}px, 100%)`,height:`min(${o}px, 100%)`,pointerEvents:"auto",objectFit:"cover"})),[n,o]);return(0,C.jsx)("div",{style:w,children:(0,C.jsx)(S.Z,{src:t,style:s,placeholderLoadedStyle:{display:"flex",justifyContent:"center",alignItems:"center"}})})}const w={alignSelf:"center",margin:"0 auto",position:"relative",height:"100%",width:"100%",overflow:"hidden"};const j=function(e){window.__c={n:"DiscussionInputImageRenderer"};const t=(0,i.useRef)(null),{file:o,isLarge:r}=e,a=(0,g.O7)(),l=(0,n.VK)((()=>m.default.checkGate("comments_density_image_handling")),[]),d=(0,s.yK)((e=>({imageThumbnail:{borderRadius:4,border:`1px solid ${e.lightDividerColor}`,objectFit:"cover",height:48,width:48,cursor:"zoom-in",...l?{border:`1px solid ${e.stroke.deemphasized}`,borderRadius:8}:{},...l&&r?{height:"auto",width:214}:{}}})),[l,r]),c=(0,i.useCallback)((()=>{var e;const i=null===(e=t.current)||void 0===e?void 0:e.getImageDimensions();if(!i)return;const{naturalHeight:n,naturalWidth:s}=i;return"local"===o.type?(0,C.jsx)(y,{url:o.dataURL,imageNaturalHeight:n,imageNaturalWidth:s}):(0,C.jsx)(b.Z,{url:o.source,render:(e,t)=>(0,C.jsx)(y,{url:t,error:e,imageNaturalHeight:n,imageNaturalWidth:s}),isAuthenticated:!0,permissionRecord:o.store.pointer})}),[o]),u=(0,i.useCallback)((e=>{var o;e.stopPropagation();const i=null===(o=t.current)||void 0===o?void 0:o.getImageDimensions();i&&v.ui({environment:a,renderFullScreenNode:c,fullScreenNodeRect:i.clientRect,contentAspectRatio:i.naturalHeight/i.naturalWidth})}),[c,a]);return"local"===o.type?(0,C.jsx)(S.Z,{src:o.dataURL,style:d.imageThumbnail,placeholderStyle:d.imageThumbnail,onClick:u,ref:t}):(0,C.jsx)(b.Z,{url:o.source,isAuthenticated:!0,permissionRecord:o.store.pointer,render:(e,o)=>(0,C.jsx)(S.Z,{src:o,style:d.imageThumbnail,placeholderStyle:d.imageThumbnail,onClick:u,ref:t})})};var k=o(95477),M=o(45238);const L=(0,M.I)("document",{viewBox:"0 0 23.5 23.5",svg:(0,C.jsx)("path",{d:"M9.14 8.156a.494.494 0 01-.5-.5c0-.14.047-.258.141-.351a.487.487 0 01.36-.14h5.718a.477.477 0 01.492.492.494.494 0 01-.14.35.464.464 0 01-.352.15H9.141zm0 2.664a.487.487 0 01-.359-.14.504.504 0 01-.14-.36c0-.135.046-.25.14-.343a.487.487 0 01.36-.141h5.718a.477.477 0 01.493.484c0 .14-.047.26-.141.36a.477.477 0 01-.352.14H9.141zm0 2.672a.487.487 0 01-.359-.14.468.468 0 01-.14-.344c0-.14.046-.258.14-.352a.473.473 0 01.36-.148h2.765c.146 0 .266.05.36.148a.48.48 0 01.14.352c0 .135-.047.25-.14.344a.487.487 0 01-.36.14H9.141zm-3.843 4.266V5.968c0-.838.213-1.473.64-1.905.428-.438 1.06-.657 1.899-.657h8.32c.839 0 1.472.219 1.899.656.427.433.64 1.068.64 1.907v11.789c0 .844-.213 1.482-.64 1.914-.427.432-1.06.648-1.899.648h-8.32c-.839 0-1.471-.216-1.899-.648-.427-.432-.64-1.07-.64-1.914zm1.539-.094c0 .36.094.635.281.828.188.193.472.29.852.29h8.062c.38 0 .664-.097.852-.29.187-.193.281-.469.281-.828V6.07c0-.364-.094-.643-.281-.836-.188-.198-.471-.296-.852-.296H7.97c-.38 0-.664.098-.852.296-.187.193-.281.472-.281.836v11.594z"})}),I=(0,M.I)("fileAttachment",{viewBox:"0 0 28 28",svg:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("rect",{width:"28",height:"28",fill:"none"}),(0,C.jsx)("path",{d:"M7.70703 27.3799H21.2783C23.7412 27.3799 24.9854 26.1104 24.9854 23.6348V11.7266C24.9854 10.3555 24.8076 9.74609 23.9697 8.88281L16.5049 1.3418C15.6924 0.516602 15.0322 0.326172 13.8008 0.326172H7.70703C5.26953 0.326172 4 1.58301 4 4.05859V23.6348C4 26.1104 5.25684 27.3799 7.70703 27.3799ZM7.7832 25.8057C6.32324 25.8057 5.57422 25.0312 5.57422 23.5967V4.09668C5.57422 2.7002 6.32324 1.8877 7.7959 1.8877H13.7246V9.53027C13.7246 10.9775 14.4609 11.6631 15.8701 11.6631H23.4238V23.5967C23.4238 25.0312 22.6621 25.8057 21.2021 25.8057H7.7832ZM16.0352 10.1777C15.4512 10.1777 15.21 9.94922 15.21 9.36523V2.20508L23.1064 10.1777H16.0352Z"})]})});var R=o(87292);const D=(0,M.I)("spreadsheet",{viewBox:"0 0 23 24",svg:(0,C.jsx)("path",{d:"M3.32 10.43V8.96h17.422v1.47H3.32zm0 4.343v-1.468h17.422v1.468H3.32zm7.93 3.758V5.203h1.5v13.328h-1.5zm-5.945.625c-.844 0-1.482-.213-1.914-.64-.433-.427-.649-1.058-.649-1.891V7.109c0-.833.216-1.463.649-1.89.432-.433 1.07-.649 1.914-.649H18.68c.849 0 1.49.216 1.922.649.432.427.648 1.057.648 1.89v9.516c0 .833-.216 1.463-.648 1.89-.433.428-1.073.641-1.922.641H5.305zm.093-1.531h13.196c.36 0 .635-.094.828-.281.193-.193.289-.477.289-.852v-9.25c0-.375-.096-.656-.29-.844-.192-.192-.468-.289-.827-.289H5.398c-.364 0-.643.097-.835.29-.188.187-.282.468-.282.843v9.25c0 .375.094.659.282.852.192.187.47.281.835.281z"})}),T=(0,M.I)("videoAttachment",{viewBox:"0 0 28 28",svg:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("rect",{width:"28",height:"28",fill:"none"}),(0,C.jsx)("path",{d:"M14.1333 26.4668C21.103 26.4668 26.8667 20.7031 26.8667 13.7334C26.8667 6.75098 21.103 1 14.1206 1C7.15088 1 1.3999 6.75098 1.3999 13.7334C1.3999 20.7031 7.16357 26.4668 14.1333 26.4668ZM14.1333 24.8164C7.98877 24.8164 3.05029 19.8652 3.05029 13.7334C3.05029 7.58887 7.98877 2.6377 14.1206 2.6377C20.2651 2.6377 25.2163 7.58887 25.229 13.7334C25.229 19.8652 20.2778 24.8164 14.1333 24.8164ZM18.9702 14.3936C19.4653 14.1016 19.4526 13.4287 18.9702 13.1367L11.7212 8.79492C11.2261 8.49023 10.5786 8.73145 10.5786 9.27734V18.2275C10.5786 18.7734 11.188 19.0273 11.7212 18.71L18.9702 14.3936Z"})]})});var _=o(82990),Z=o(34047);const B={doc:{title:"DOC"},docx:{title:"DOCX"},xls:{title:"XLS"},xlsx:{title:"XLSX"},pdf:{title:"PDF"},video:{icon:T}},V={doc:{icon:L},docx:{icon:L},xls:{icon:D},xlsx:{icon:D},pdf:{icon:R.B},video:{icon:T}};function F(e){window.__c={n:"DiscussionInputFileRenderer"};const{file:t,type:o}=e,i=(0,n.VK)((()=>m.default.checkGate("comments_density_image_handling")),[]),r=(0,s.yK)((e=>{let t;switch(o){case"doc":case"docx":t=e.msDocDiscussionInputPreview;break;case"xls":case"xlsx":t=e.msExcelDiscussionInputPreview;break;case"pdf":t=e.pdfDiscussionInputPreview;break;default:t=e.sidebarSecondaryBackground}return i&&(t=e.tint.regular),{wrapper:{height:48,width:220,display:"flex",background:"transparent",borderRadius:5,overflow:"hidden",border:`1px solid ${e.regularDividerColor}`,...i?{width:216,borderRadius:12,padding:"8px 10px 8px 8px",gap:10}:{}},fileTypeArea:{background:t,height:48,width:48,display:"flex",justifyContent:"center",alignItems:"center",flexShrink:0,...i?{width:32,height:32,borderRadius:6}:{}},icon:{height:26,width:26,fill:e.regularIconColor,...i?{width:24,height:24}:{}},fileType:{fontSize:11,lineHeight:"16.8px",fontWeight:_.Z.fontWeight.semibold,color:e.regularInvertedTextColor},fileDescription:{padding:"6px 12px 6px 12px",display:"flex",flexDirection:"column",justifyContent:"center",overflow:"hidden",...i?{padding:0}:{}},fileTitle:{color:e.regularTextColor,textOverflow:"ellipsis",fontSize:14,lineHeight:"19.6px",whiteSpace:"nowrap",overflow:"hidden",width:"100%",paddingBottom:20,...i?{fontWeight:_.Z.fontWeight.medium,lineHeight:"18px",color:e.text.primary}:{}},fileSize:{color:e.lightTextColor,fontSize:12,lineHeight:"16.8px",width:"100%",...i?{lineHeight:"15px",color:e.text.secondary}:{}}}}),[o,i]),a=i?V[o]:B[o],l=i?(0,Z.sS)(t.size):t.size;return(0,C.jsxs)("div",{style:r.wrapper,children:[(0,C.jsx)("div",{style:r.fileTypeArea,children:a?"title"in a?(0,C.jsx)("div",{style:r.fileType,children:a.title}):a.icon(r.icon):I(r.icon)}),(0,C.jsxs)("div",{style:r.fileDescription,children:[(0,C.jsx)("div",{style:r.fileTitle,children:t.name}),(0,C.jsx)("div",{style:r.fileSize,children:l})]})]})}const P={image:j,pdf:F,doc:F,xls:F,embed:F},K={"application/vnd.openxmlformats-officedocument.wordprocessingml.document":"docx","application/msword":"doc","application/vnd.ms-excel":"xls","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"xlsx",image:"image"};function A(e){return"local"===e.type?function(e){const[t]=e.split("/");return K[e]||K[t]}(e.file.type)||(0,h.Dz)({url:e.file.name,baseUrl:k.default.domainBaseUrl,publicDomainName:k.default.publicDomainName}):(0,h.y_)(e.source,".doc")?"doc":(0,h.y_)(e.source,".docx")?"docx":(0,h.y_)(e.source,".xls")?"xls":(0,h.y_)(e.source,".xlsx")?"xlsx":(0,h.Dz)({url:e.source,baseUrl:k.default.domainBaseUrl,publicDomainName:k.default.publicDomainName})}function E(e){let{file:t,onRemoveFile:o,disableRemove:s,isLarge:r}=e;window.__c={n:"DiscussionInputFilePreview"};const[a,d]=(0,i.useState)(!1),c=(0,n.VK)((()=>m.default.checkGate("comments_density_image_handling")),[]),u=(0,i.useCallback)((()=>null==o?void 0:o(t)),[t,o]),p=(0,g.O7)(),h=!s&&(a||p.device.isMobile);(0,i.useEffect)((()=>()=>{"local"===t.type&&t.dataURL&&URL.revokeObjectURL(t.dataURL)}),[t]);const v=A(t),S=P[v]||F;return(0,C.jsxs)(x.Z,{style:{...O,...c?{width:"fit-content"}:{}},hoveredStyle:N,pressedStyle:z,onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),children:[(0,C.jsx)(S,{file:t,type:v,isLarge:c?r:void 0}),h&&(0,C.jsx)(l.Z,{icon:f.D,style:U,hasBackground:!0,isDarkIconColor:!0,hovered:!1,showShadow:!0,onClick:u})]})}const N={background:"none"},z={background:"none"},O={display:"flex",alignItems:"center",justifyContent:"center",position:"relative",paddingRight:"10px",cursor:"pointer"},U={position:"absolute",top:"-5px",right:"6px",height:18,width:18,borderRadius:18,padding:4},W=.8;function H(e){window.__c={n:"DiscussionInputFilmStrip"};const t=(0,i.useRef)(null),o=(0,n.VK)((()=>m.default.checkGate("comments_density_image_handling")),[]),g=(0,s.yK)((e=>({leftArrowStyle:{left:10,top:26,background:e.mediumIconColor,...X},rightArrowStyle:{right:10,top:26,background:e.mediumIconColor,...X},iconStyle:{height:6,fill:e.contentBackground},hoveredStyle:{background:e.regularIconColor}})),[]),[{scrollLeft:h,scrollWidth:f,clientWidth:x},,v]=(0,n.AF)(void 0,p.Z),S=(0,i.useCallback)((e=>{var o;e.stopPropagation(),null===(o=t.current)||void 0===o||o.scrollByOffset(0,-W*x,{animate:!0})}),[x]),b=(0,i.useCallback)((e=>{var o;e.stopPropagation(),null===(o=t.current)||void 0===o||o.scrollByOffset(0,W*x,{animate:!0})}),[x]),y=(0,i.useCallback)((()=>{var e;null===(e=t.current)||void 0===e||e.getClientRect()}),[]);(0,i.useEffect)((()=>(c.lj(window,"resize",y),()=>{c.ZV(window,"resize",y)})),[y]);const w=(0,i.useMemo)((()=>Math.floor(h)>0),[h]),j=(0,i.useMemo)((()=>Math.ceil(h+x)<f),[h,f,x]);if((0,i.useEffect)((()=>{y()}),[e.files,y]),0===e.files.length)return null;const k=e.files.filter((e=>"local"===e.type||Boolean(e.source)));return o&&k.length<=3?(0,C.jsx)("div",{style:{...G,...o?{flexDirection:"column",gap:8}:{}},children:k.map((t=>(0,C.jsx)(E,{file:t,onRemoveFile:e.onRemoveFile,disableRemove:e.disableRemove,isLarge:o},t.id)))}):(0,C.jsxs)("div",{style:G,children:[(0,C.jsx)(d.Z,{style:{...$,...o?{paddingTop:0}:{}},ref:t,type:u.Z.X,onScroll:y,zIndex:0,store:v,children:k.map((t=>(0,C.jsx)(E,{file:t,onRemoveFile:e.onRemoveFile,disableRemove:e.disableRemove},t.id)))}),w&&(0,C.jsx)(l.Z,{icon:r.Y,hovered:!1,showShadow:!0,onClick:S,style:g.leftArrowStyle,iconStyle:g.iconStyle,hoveredStyle:g.hoveredStyle}),j&&(0,C.jsx)(l.Z,{icon:a.n,hovered:!1,showShadow:!0,onClick:b,style:g.rightArrowStyle,iconStyle:g.iconStyle,hoveredStyle:g.hoveredStyle})]})}const $={overflow:"scroll",display:"flex",alignItems:"flex-start",flexDirection:"row",paddingTop:10},G={display:"flex",paddingRight:0,position:"relative"},X={position:"absolute",borderRadius:4,width:16,height:16,opacity:1,flexShrink:0,boxShadow:"none"}},82386:(e,t,o)=>{o.r(t),o.d(t,{default:()=>k});var i=o(67294),n=o(480),s=o(86628),r=o(24405),a=o(36488),l=o(56940),d=o(53437),c=o(3553),u=o(73935),m=o(83355),p=o(14568),g=o(49085);class h extends g.default{getInitialState(){return{}}}const f=h;class x extends m.Z{constructor(){super(...arguments),this.storeTypes={store:f},this.rootNode=void 0,this.observer=void 0,this.handleMutation=()=>{this.rootNode&&this.stores.store.setState({node:this.rootNode})}}get registries(){return[p.Z]}didMount(){this.props.capture&&this.startListeners()}UNSAFE_willUpdate(e){e.capture&&!this.props.capture?this.startListeners():!e.capture&&this.props.capture&&this.stopListeners()}willUnmount(){this.stopListeners()}startListeners(){const e=u.findDOMNode(this);e&&(this.rootNode=e,this.observer=new MutationObserver(this.handleMutation),this.observer.observe(this.rootNode,{attributes:!0,subtree:!0}))}stopListeners(){this.observer&&(this.observer.disconnect(),this.rootNode=void 0,this.observer=void 0)}renderComponent(){return i.Children.only(this.props.children)}}x.displayName="SlideUpInputArea";const v=x;var S=o(18821),b=o(34047),C=o(92650),y=o(48514),w=o(93575),j=o(85893);const k=function(){window.__c={n:"NewDiscussionMenu"};const e=(0,n.O7)(),{device:t,WindowSizeStore:o}=e,i=(0,s.VK)((()=>y.Z.state.rect),[]),u=(0,s.VK)((()=>{if(y.Z.state.open){const{blockStore:t,discussionInputStore:o}=y.Z.state;return{blockStore:t,discussionInputStore:o,canMarginCommentsRender:(0,C.az)(e,t)}}return null}),[e]),m=(0,s.VK)((()=>({paddingLeft:t.isMobileNative?o.getSafePaddingLeftCSS(10):10,paddingRight:t.isMobileNative?o.getSafePaddingRightCSS(10):10})),[o,t.isMobileNative]),p=(0,r.yK)((()=>({inputWrapper:{width:t.isMobileNative?"100%":470,maxWidth:t.isMobileBrowser?"90vw":"100%",paddingTop:8,paddingBottom:t.isAndroid?12:8,paddingLeft:m.paddingLeft,paddingRight:m.paddingRight}})),[t,m]),g=()=>{S.ZL(e)},h=()=>{u&&S.uK(u.discussionInputStore,e)};return null!=u&&u.canMarginCommentsRender?null:(0,j.jsx)(d.ZP,{popupType:t.isMobileNative?d.ZP.PopupType.SlideUp:d.ZP.PopupType.Popup,keepFocus:!0,open:null!==u,originRect:i,placementToOrigin:d.ZP.Placement.Bottom,alignmentToOrigin:d.ZP.Alignment.Center,originGap:4,onDismiss:h,render:()=>{if(u){const{blockStore:e,discussionInputStore:t}=u;return(0,j.jsx)(l.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,render:()=>(0,j.jsx)(v,{capture:!0,children:(0,j.jsx)(a.Z,{capture:!0,allowOpenLinkMenu:!0,render:()=>(0,j.jsx)(c.Z,{store:e,droppable:!0,render:()=>(0,j.jsx)("div",{style:p.inputWrapper,children:(0,j.jsx)(w.default,{showAvatar:!0,parentStore:e,onCancel:h,onSubmit:g,discussionInputStore:t,isMobileSlideUpMenu:!0,shouldSaveUnsentComments:!1,discussionFormat:b.O2.Page,blockStore:e,canDrop:!0})})},e.id)})})})}}})}},90895:(e,t,o)=>{o.r(t),o.d(t,{default:()=>U,openEmojiMenuForReaction:()=>O});var i=o(67294),n=o(73935),s=o(480),r=o(86628),a=o(24405),l=o(8848),d=o(40350),c=o(97880),u=o(82990),m=o(9291),p=o(27153),g=o(4615),h=o(80396),f=o(23867),x=o(19889),v=o(94419),S=o(79797),b=o(85344),C=o(9953),y=o(82530);function w(e){const{discussionLocation:t,environment:o,transaction:i,commentStore:n,icon:s}=e,r=function(e){let{commentStore:t,icon:o}=e;const i=(0,S.Vh)(t,t.pointer,"reactions").getValue();if(void 0===i)return;return i.map((e=>{const o=S.t1.createChildStore(t,{table:h.yo,id:e,spaceId:(0,f.C)(t.pointer.spaceId)});if(o.isDefined())return o})).filter(c.$K).find((e=>e.getIcon()===o))}({commentStore:n,icon:s});if(void 0===o.currentUser.id)return;const a={table:x.KJ,id:o.currentUser.id};null!=r&&r.isDefined()?function(e){var t;let{store:o,actorPointer:i,transaction:n,environment:s,discussionLocation:r}=e;const a={store:o,actorPointer:i,transaction:n,environment:s,discussionLocation:r};(null===(t=o.getActors())||void 0===t?void 0:t.some((e=>e.id===i.id)))?function(e){const{store:t,actorPointer:o,discussionLocation:i,transaction:n,environment:s}=e;if(!t.isDefined())return;const r=t.getParentStore(),a=null==r?void 0:r.getParentStore();b.Em({environment:s,reaction_value:t.getIcon(),comment_id:t.getParentId(),discussion_id:null==a?void 0:a.id,parent_block_id:null==a?void 0:a.getParentId(),reaction_count:t.getActors().length??0,from:i});const l=t.getModel();y.applyOperation({transaction:n,store:t,operation:l.ops.removeActor(o)})}(a):function(e){const{store:t,actorPointer:o,discussionLocation:i,transaction:n,environment:s}=e;if(!t.isDefined())return;const r=t.getParentStore(),a=null==r?void 0:r.getParentStore();b.pP({environment:s,reaction_value:t.getIcon(),comment_id:t.getParentId(),discussion_id:null==a?void 0:a.id,parent_block_id:null==a?void 0:a.getParentId(),reaction_count:t.getActors().length??0,from:i});const l=t.getModel();y.applyOperation({transaction:n,store:t,operation:l.ops.appendActor(o)})}(a)}({environment:o,store:r,actorPointer:a,transaction:i,discussionLocation:t}):function(e){let{environment:t,transaction:o,commentStore:i,icon:n,currentActorPointer:s,discussionLocation:r}=e;const a=(0,g.ZP)(),l=i.getParentStore();b.pP({environment:t,reaction_value:n,comment_id:i.id,discussion_id:null==l?void 0:l.id,parent_block_id:null==l?void 0:l.getParentId(),reaction_count:0,from:r});const d=C.Ue({environment:t,table:h.yo,args:{id:a,spaceId:(0,f.C)(i.pointer.spaceId),commentId:i.id,icon:n,actorPointer:s},inMemoryRecordCache:i.inMemoryRecordCache,transaction:o}),c=(0,S.Vh)(i,i.pointer,"reactions");v.R3({parent:c,append:d,transaction:o})}({environment:o,transaction:i,commentStore:n,icon:s,currentActorPointer:a,discussionLocation:t})}var j=o(64921),k=o(73063),M=o(26388),L=o(11059),I=o(72187),R=o(31945),D=o(78140),T=o(28992),_=o(66957),Z=o(87279);var B=o(70775),V=o(85893);function F(e){let{reactionStores:t,initialIndex:o}=e;window.__c={n:"ReactionSheetContent"};const[n,s]=i.useState(o),a=(0,m.useIntl)(),l=(0,r.VK)((()=>t.map((e=>e.getIcon()))),[t]),d=(0,r.VK)((()=>t[n].getActorStores().map((e=>({id:e.id,store:e,name:e.getDisplayName(a)}))).filter(c.$K)),[t,n,a]);return(0,V.jsxs)(D.Z,{menuType:Z.og.ActionSheet,children:[(0,V.jsx)(_.Z,{tabStyle:{flex:1,justifyContent:"center",display:"flex",minWidth:60},tabs:l,selectedIndex:n,onChange:e=>s(e)}),d.map((e=>(0,V.jsx)(T.Z,{title:e.name,dontShrinkIcon:!0,icon:(0,V.jsx)(B.S,{authorStore:e.store,avatarSize:20,avatarStyle:{width:20,height:20},placeholderStyle:{width:20,height:20}})},e.id)))]})}function P(e){window.__c={n:"ReactionSheet"};const t=(0,s.Fy)(),o=(0,r.VK)((()=>e.commentStore.getUserVisibleReactions()),[e.commentStore]),n=(0,i.useRef)(null),a=function(e){const t=(0,s.O7)(),{onLongPress:o,hapticsEnabled:n=!0,timeout:r=300}=e,a=(0,i.useCallback)((()=>{var e,i,s;n&&(null!==(e=t.mobileNative)&&void 0!==e&&e.buzz?t.mobileNative.buzz():null===(i=(s=window.navigator).vibrate)||void 0===i||i.call(s,20)),o()}),[t.mobileNative,n,o]),l=(0,i.useRef)(),d=(0,i.useCallback)((()=>clearTimeout(l.current)),[]);return(0,i.useEffect)((()=>d),[d]),{onTouchStart:(0,i.useCallback)((()=>{clearTimeout(l.current),l.current=setTimeout(a,r)}),[r,a]),onTouchEnd:d,onTouchCancel:d}}({onLongPress:()=>{var e;return null===(e=n.current)||void 0===e?void 0:e.setOpen(!0)}});if(!t.isMobile)return(0,V.jsx)(V.Fragment,{children:e.children});const l=o.findIndex((t=>!e.reactionStore||t===e.reactionStore))??0;return(0,V.jsx)(R.ZP,{ref:n,renderOrigin:()=>(0,V.jsx)("div",{...a,children:e.children}),popupType:t.isTablet?R.Z4.Popup:R.Z4.SlideUp,render:()=>(0,V.jsx)(F,{initialIndex:l,reactionStores:o})},e.commentStore.id)}function K(){const{isMobile:e}=(0,s.Fy)();return(0,a.yK)((t=>({reaction:{display:"flex",margin:"1px",padding:"1px 6px 1px 6px",justifyContent:"center",gap:"4px",border:`1px solid ${t.regularDividerColor}`,borderRadius:"100px",fontSize:14,lineHeight:"20px",fontVariantNumeric:"tabular-nums",background:t.whiteButtonBackground},count:{color:t.mediumTextColor,fontSize:e?u.Z.fontSize.UISmall.mobile:u.Z.fontSize.UISmall.desktop,lineHeight:"20px"},countReacted:{color:t.blueColor},reacted:{background:l.ZP.blueWithAlpha(.08),border:`1px solid ${t.filterPillBorder}`,fontWeight:500},reactedHover:{background:l.ZP.blueWithAlpha(.18)},emojiStyle:{color:"black",display:"inline-block"}})),[e])}function A(e){let{store:t,disabled:o,onClick:i}=e;window.__c={n:"Reaction"};const n=(0,r.VK)((()=>t.getActors()),[t]),a=(0,r.VK)((()=>t.getIcon()),[t]),l=K(),{currentUser:d}=(0,s.O7)();if(!n||!a)return null;if(0===n.length)return null;const c=n.some((e=>e.id===d.id)),u={...l.reaction,...c&&l.reacted},m={...l.count,...c&&l.countReacted};return(0,V.jsx)(M.ZP,{textWrap:!0,style:{maxWidth:350,width:"max-content"},placement:M.ug.Bottom,delayThreshold:300,renderTooltip:()=>(0,V.jsx)(E,{store:t,icon:a}),render:e=>(0,V.jsxs)(j.Z,{disabled:o,style:u,hoveredStyle:c?l.reactedHover:void 0,onClick:i,...e,children:[(0,V.jsx)("span",{style:l.emojiStyle,children:(0,V.jsx)(L.Z,{size:14,char:a})}),(0,V.jsx)("span",{style:m,children:n.length})]})})}function E(e){let{store:t,icon:o}=e;window.__c={n:"ReactionTooltip"};const i=(0,a.yK)((e=>({text:{color:e.mediumInvertedTextColor}})),[]),n=(0,m.useIntl)(),s=(0,r.VK)((()=>t.getActorStores()),[t]),l=(0,r.VK)((()=>s.map((e=>e.getDisplayName(n))).filter(c.$K)),[s,n]);return l.length>5?(0,V.jsx)(m.FormattedMessage,{defaultMessage:"{additionalNames, plural, one {{names} and {additionalNames} other <medium>reacted with</medium> {icon}} other {{names} and {additionalNames} others <medium>reacted with</medium> {icon}}}",id:"ReactionBar.hoverTooltip.textAbbreviated",values:{additionalNames:l.length-5,names:l.slice(0,5).join(", "),medium:e=>(0,V.jsx)("span",{style:i.text,children:e}),icon:(0,V.jsx)(L.Z,{size:14,char:o})}}):(0,V.jsx)(m.FormattedMessage,{defaultMessage:"{numberOfNames, plural, one {{nameOrNames} <medium>reacted with</medium> {icon}} other {{nameOrNames} <medium>reacted with</medium> {icon}}}",id:"ReactionBar.hoverTooltip.text",values:{numberOfNames:l.length,nameOrNames:l.join(", "),medium:e=>(0,V.jsx)("span",{style:i.text,children:e}),icon:(0,V.jsx)(L.Z,{size:14,char:o})}})}function N(e){window.__c={n:"NewReaction"};const{commentStore:t,discussionLocation:o,onEmojiSelection:n,disableDropShadow:r}=e,l=(0,s.O7)(),c=(0,i.useRef)(null),u=(0,s.Fy)(),p=(0,a.yK)((e=>({container:{padding:2,display:"flex",boxShadow:e.lightBoxShadow,backgroundColor:e.buttonGroupBackground,borderRadius:u.isMobile?3:4,...r&&{borderWidth:1,borderStyle:"solid",borderColor:u.isMobile?"transparent":e.stroke.regular,borderRadius:6,boxShadow:void 0}},addIcon:{width:15,fill:e.mediumIconColor},iconButton:{height:22,width:22,flex:"0 0 auto"}})),[u.isMobile,r]),g=(0,m.useIntl)();return(0,V.jsx)("div",{style:p.container,children:(0,V.jsx)(k.Z,{hasBackground:!0,ariaLabel:g.formatMessage({defaultMessage:"Add reaction",id:"ReactionBar.newReaction.ariaLabel"}),showShadow:!1,icon:()=>(0,d.V)(p.addIcon),style:p.iconButton,ref:c,onClick:()=>O(l,g,t,null==c?void 0:c.current,o,n)})})}function z(e){let{commentStore:t,discussionLocation:o,onEmojiSelection:n}=e;window.__c={n:"NewInlineReaction"};const r=(0,a.Fg)(),l=(0,s.O7)(),c=(0,i.useRef)(null),u=K(),p=(0,m.useIntl)(),g=(0,d.V)({width:15,height:20,marginTop:.5,marginLeft:.5,fill:r.mediumIconColor});return(0,V.jsx)(j.Z,{style:{...u.reaction,minWidth:"2em"},ref:c,onClick:()=>O(l,p,t,null==c?void 0:c.current,o,n),children:g})}function O(e,t,o,i,s,r){const a=n.findDOMNode(i);if(!a)return;if(!(a instanceof Element))return;const l=a.getBoundingClientRect();p.$(e,{originGap:4,originRect:l,popupWidth:I.FZ,popupHeight:I.kX,isSmallWidth:!1,title:t.formatMessage({defaultMessage:"Reaction",id:"ReactionBar.emojiModalMenu.title"}),currentTab:"emoji",tabs:[{type:"emoji",title:(0,V.jsx)(m.FormattedMessage,{defaultMessage:"Emojis",id:"recordIcon.emojiTab.title"}),hideRandomButton:!0,onChange:(t,i)=>{r&&r(),y.createAndCommit({environment:e,userAction:"Comment.toggleReactionFromMenu",perform:n=>{w({environment:e,transaction:n,commentStore:o,icon:t,discussionLocation:s}),i&&i.keepVisible||p.Z()}})}}]})}const U=function(e){window.__c={n:"ReactionBar"};const{parentStore:t,discussionLocation:o,onClick:i,disableDropShadow:n}=e,a=(0,r.VK)((()=>t.canComment()),[t]),l=(0,r.VK)((()=>t.getUserVisibleReactions()),[t]),d=(0,s.O7)();return(0,V.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px",marginTop:"4px",marginBottom:"4px"},children:[l.map((e=>(0,V.jsx)(P,{reactionStore:e,commentStore:t,children:(0,V.jsx)(A,{disabled:!a,store:e,onClick:()=>{e.isDefined()&&(i&&i(),y.createAndCommit({environment:d,userAction:"Comment.toggleReaction",perform:i=>{w({environment:d,transaction:i,commentStore:t,icon:e.getIcon(),discussionLocation:o})}}))}})},e.id))),a&&l.length>0&&(0,V.jsx)(P,{commentStore:t,children:(0,V.jsx)(z,{commentStore:t,discussionLocation:o,onEmojiSelection:i})}),a&&0===l.length&&(0,V.jsx)(N,{commentStore:t,discussionLocation:o,onEmojiSelection:i,disableDropShadow:n})]})}},70418:(e,t,o)=>{o.r(t),o.d(t,{default:()=>ie});var i=o(67294),n=o(480),s=o(86628),r=o(24405),a=o(10906),l=o(23063),d=o(82136),c=o(92650),u=o(14577),m=o(72126),p=o(44805),g=o(80503),h=o(51454),f=o(39500),x=o(49427),v=o(36391),S=o(24229),b=o(50628),C=o(17707),y=o(92120),w=o(48514),j=o(97880),k=o(69651),M=o(37240),L=o(19889),I=o(82990),R=o(9291),D=o(64369),T=o(67706),_=o(43250),Z=o(65598),B=o(16402),V=o(79797),F=o(70775),P=o(85893);function K(e){let{discussionData:{groupedDiscussionsData:t,id:o},onClick:n}=e;window.__c={n:"GroupedMarginDiscussionItem"};const[a,l]=(0,i.useState)(!1),d=(0,i.useCallback)((()=>{l(!0)}),[]),u=(0,i.useCallback)((()=>{l(!1)}),[]),m=(0,i.useCallback)((async e=>{const o=t[0].discussionStore;await n(e,o)}),[n,t]),p=(0,s.VK)((()=>t.flatMap((e=>(0,Z.D4)(e.discussionStore)))),[t]),g=(0,s.VK)((()=>{const e=t[0].parentBlockStore;return[...new Set(p.map((e=>e.getCreatedById())).filter(j.$K))].map((t=>V.U6.createChildStore(e,{table:L.KJ,id:t}))).slice(0,3)}),[t,p]),h=(0,s.VK)((()=>{const e=p.map((e=>e.getLastEditedTime()));return Math.max(...e)}),[p]),f=(0,r.yK)((e=>({discussion:{border:`1px solid ${e.regularDividerColor}`,borderRadius:4,background:a?e.hoveredMarginDiscussionBackground:e.contentBackground,width:c.Z,display:"flex",padding:"10px 12px",cursor:"pointer"},userAvatarsContainer:{display:"flex",marginRight:6,justifyContent:"center",alignItems:"center",flexDirection:"row-reverse"},hiddenUsers:{fontSize:14,color:e.mediumTextColor,marginRight:6},commentCount:{fontSize:14,fontWeight:I.Z.fontWeight.semibold,whiteSpace:"normal",marginLeft:6},textPlaceholder:{background:e.lightDividerColor,height:14,width:81,borderRadius:4,marginLeft:4},lastEditedTime:{margin:"1px 0px 0px 6px",whiteSpace:"normal",display:"flex",justifyContent:"center",alignItems:"center",lineHeight:"21px"},commentAuthorAvatarStyle:{width:20,height:20,borderRadius:20,marginRight:-3,position:"relative",userSelect:"none",WebkitUserSelect:"none"},commentAuthorPlaceholderStyle:{width:20,height:20,borderRadius:20,marginRight:-3,position:"relative"},secondaryLabel:{fontSize:I.Z.fontSize.UISmall.desktop,marginLeft:4,color:e.lightTextColor,marginTop:1,whiteSpace:"normal",display:"flex",justifyContent:"center",alignItems:"center",lineHeight:"21px"},expandIcon:{width:I.Z.fontSize.UISmall.desktop,height:I.Z.fontSize.UISmall.desktop,fill:e.lightTextColor,marginTop:1}})),[a]);return(0,P.jsx)("div",{style:f.discussion,onMouseEnter:d,onMouseLeave:u,onClick:m,className:_.S9A,children:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("div",{style:f.userAvatarsContainer,children:g.map((e=>(0,P.jsx)(F.S,{authorStore:e,avatarSize:20,avatarStyle:f.commentAuthorAvatarStyle,placeholderStyle:f.commentAuthorPlaceholderStyle},e.id)))}),p.length>0?(0,P.jsx)("div",{style:f.commentCount,children:(0,P.jsx)(R.FormattedMessage,{defaultMessage:"{numComments, plural, one {{numComments} comment} other {{numComments} comments}}",id:"marginComments.collapsed.numComments.count",values:{numComments:p.length}})}):(0,P.jsx)("div",{style:f.textPlaceholder}),a?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("div",{style:{marginLeft:10,display:"flex",justifyContent:"center",alignItems:"center"},children:(0,M.s)(f.expandIcon)}),(0,P.jsx)("div",{style:f.secondaryLabel,children:(0,P.jsx)(R.FormattedMessage,{defaultMessage:"Expand",id:"marginComments.collapsed.expand.label"})})]}):h&&(0,P.jsx)(D.Z,{isSmall:!0,isSecondaryColor:!0,isMultiline:!0,style:f.lastEditedTime,children:(0,P.jsx)(T.Z,{text:(0,B.IS)(h),tooltipText:(0,B.uy)(h),icon:k.C})})]})})}var A=o(74725),E=o(18821),N=o(34047),z=o(93575);function O(e){let{discussionData:{parentBlockStore:t,discussionInputStore:o},isVisible:s}=e;window.__c={n:"NewMarginDiscussionItem"};const a=(0,i.useRef)(null),l=(0,n.O7)(),d=(0,i.useCallback)((()=>{E.ZL(l)}),[l]),u=(0,i.useCallback)((()=>{E.uK(o,l)}),[l,o]),m=(0,i.useMemo)((()=>[`.${_.mJW}`]),[]);(0,A.O)({active:s,closeHandler:u,ref:a,excludedSelectors:m,ignoreKeydown:!0});const p=(0,r.yK)((e=>({discussion:{borderRadius:6,boxShadow:e.marginDiscussionSelectedShadow,width:c.Z,background:e.selectedMarginDiscussionBackground},discussionInputContainer:{borderRadius:6,padding:"6px 4px 4px 8px"}})),[]);return(0,P.jsx)("div",{style:p.discussion,ref:a,className:_.S9A,children:(0,P.jsx)(z.default,{parentStore:t,discussionInputStore:o,shouldSaveUnsentComments:!1,isMobileSlideUpMenu:!1,discussionFormat:N.O2.Margin,onSubmit:d,onCancel:u,isNewComment:!0,blockStore:t,canDrop:!0,showAvatar:!1,containerStyle:p.discussionInputContainer,showCtaButtons:!0})})}var U=o(22491),W=o(85344),H=o(54564),$=o(89574),G=o(82994),X=o(43590);function q(e){let{discussionData:{discussionStore:t,parentBlockStore:o},timeMounted:s,onClick:a,isVisible:l,isDiscussionSelected:d,isDiscussionHovered:u}=e;window.__c={n:"SingleMarginDiscussionItem"};const m=(0,i.useRef)(null),p=(0,n.O7)(),[g,h]=(0,i.useState)((()=>new G.Z(p,t.pointer.spaceId))),f=t.id,x=(0,i.useMemo)((()=>[`.${(0,U.dk)({discussionId:f})}`,`.${_.mJW}`,`.${_.S9A}`]),[f]),v=(0,i.useCallback)((async()=>{const e=$.Z.find((e=>e.isEditing()));if(e){if(!(await e.handleCancelEdit()))return}H.LZ()}),[]);(0,A.O)({active:l&&d,closeHandler:v,ref:m,excludedSelectors:x,ignoreKeydown:!0});const S=(0,r.yK)((e=>({discussion:{border:d?void 0:`1px solid ${e.lightDividerColor}`,borderRadius:6,padding:d?"1px":void 0,background:d?e.selectedMarginDiscussionBackground:u?e.hoveredMarginDiscussionBackground:e.contentBackground,boxShadow:d?e.marginDiscussionSelectedShadow:void 0,width:c.Z,willChange:"transform",transition:"transform 200ms ease",transform:d?"translateX(-20px)":u?"translateX(-5px)":void 0,cursor:d?void 0:"pointer"}})),[u,d]),b=(0,i.useCallback)((async e=>{d||(W.Uw(p,{discussion_id:t.id,from:"margin_comments",parent_block_id:t.getParentId()}),await a(e,t))}),[a,t,d,p]);return(0,P.jsx)("div",{style:S.discussion,onClick:b,ref:m,className:_.S9A,children:(0,P.jsx)(X.default,{store:t,blockStore:o,format:N.O2.Margin,isFirst:!1,isOnly:!1,showResolveButtonByDefaultIfPossible:!1,discussionLocation:"margin_comments",showAllRepliesAfterTimestamp:s,discussionInputStore:g,collapsed:!d})})}const J=i.memo(q);function Q(e){window.__c={n:"MarginDiscussionItem"};const{discussionData:t,isLastItem:o,isDiscussionSelected:n,discussionItemElementMap:s}=e,a=(0,r.yK)((()=>({discussionContainer:{transition:"background 300ms ease\n\t\t\t\t"+(t.hide?"":", top 200ms ease-in-out"),top:t.offsetTop,position:"absolute",paddingBottom:o?c.Vs:c.wo,zIndex:n?1:void 0,opacity:t.hide?0:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",pointerEvents:"auto"}})),[t.hide,t.offsetTop,n,o]);let l;const d=t.type;"existing"===d?l=(0,P.jsx)(J,{...e,discussionData:t}):"new"===d?l=(0,P.jsx)(O,{...e,discussionData:t}):"grouped"===d?l=(0,P.jsx)(K,{...e,discussionData:t}):(0,j.t1)(d);const u=(0,i.useCallback)((()=>{y.Z.setState({source:"margin_comments",discussionIds:[t.id]})}),[t.id]),m=(0,i.useCallback)((()=>{y.Z.setState({discussionIds:[]})}),[]),p=(0,i.useCallback)((e=>{s.set(t.id,e)}),[t.id,s]);return(0,P.jsx)("div",{style:a.discussionContainer,onMouseEnter:u,onMouseLeave:m,ref:p,children:l})}const Y=i.memo(Q),ee=`.${p.zd}, .${p.FB}`;function te(e){let{pageBlockStore:t,timeMounted:o,isVisible:a,animating:l,pageViewBlockAccessor:d,width:p}=e;window.__c={n:"MarginCommentsContent"};const j=(0,n.O7)(),k=(0,i.useRef)(null),M=(0,i.useRef)(new Map),L=(0,i.useRef)(new Map),I=(0,s.VK)((()=>y.Z.getFirstSelectedDiscussionId()),[]),R=(0,i.useCallback)((async(e,o)=>{(0,f.X9)()||e.target instanceof Element&&e.target.closest(ee)||await C.Ri({discussionStore:o,currentBlockStore:t,environment:j,analyticsFrom:"margin_comments",currentEl:k.current})}),[t,j]),[D,T]=(0,i.useState)({data:[],hasNewDiscussion:!1,selectedDiscussion:void 0}),[_,Z]=(0,i.useState)(!1),{WindowSizeStore:B}=j,V=g.R6(j.device.isElectronMac);(0,i.useEffect)((()=>{if(!a)return;const e=new u.Z((()=>({selectableRectMap:b.Z.state.selectableRectMap,pageContentStores:t.getContentStores(),sidebarIsAnimating:v.ZP.state.isAnimating,windowHeight:B.state.height})),{debugName:"effectDataStore"}),o=new u.Z((()=>c.EM.state),{debugName:"discussionStoresStore"}),i=new u.Z((()=>{const e=w.Z.state;if(e.open&&e.rect&&x.Z.isBlockInFrame(e.blockStore))return{blockStore:e.blockStore,discussionInputStore:e.discussionInputStore}}),{debugName:"newMarginDiscussionArgsStore"}),n=new u.Z((()=>S.Z.getFramePageFirstSelectedDiscussionId()),{debugName:"selectedDiscussionIdStore"});let s=!1;const r=(0,m.Ds)((()=>{const{selectableRectMap:r,pageContentStores:a,sidebarIsAnimating:u,windowHeight:m}=e.state,p=o.state,g=i.state,h=n.state;if(l||u)return;const f=d();if(!(f&&k.current&&r&&r.size))return;(0,c.H0)({discussionStores:p,pageContentStores:a,marginDiscussionItemRefs:M.current,selectedDiscussionId:h,newMarginDiscussionArgs:g,marginContainerElement:k.current,pageViewBlockElement:f,onComputeComplete:(e,t)=>{s||(L.current=t,_||Z(!0),T(e))},computedOnce:_,topbarHeight:V,windowHeight:m,isFullWidth:t.isFullWidth(),prevSelectedDiscussionId:D.selectedDiscussion,previousDiscussionElements:L.current})}),5);return e.addListener(r),o.addListener(r),n.addListener(r),i.addListener(r),()=>{s=!0,e.removeListener(r),o.removeListener(r),n.removeListener(r),i.removeListener(r)}}),[a,l,d,_,t,D.selectedDiscussion,B,V]);const F=(0,r.yK)((()=>({marginCommentsContainer:{display:"flex",flexDirection:"column",paddingTop:8,paddingBottom:8,paddingLeft:c.fS,paddingRight:c.fS,width:p-2*c.fS,flexShrink:0,height:"100%",position:"relative",pointerEvents:"none",zIndex:h.p8}})),[p]);return(0,P.jsx)("div",{style:F.marginCommentsContainer,ref:k,children:D.data.map(((e,t)=>(0,P.jsx)(Y,{discussionData:e,timeMounted:o,onClick:R,isVisible:a,discussionItemElementMap:M.current,isDiscussionSelected:e.selected||"new"===e.type,isDiscussionHovered:e.id===I,isLastItem:t===D.data.length-1},`margin-discussion-${e.id}`)))})}const oe=i.memo(te);function ie(e){let{pageBlockStore:t,isVisible:o,pageViewBlockAccessor:u,context:m,isCollapsedAnchor:p}=e;window.__c={n:"MarginCommentsSection"};const[g,h]=(0,i.useState)(!1),f=(0,n.O7)(),x=(0,i.useMemo)((()=>(new Date).getTime()),[]),v=(0,s.VK)((()=>t.isFullWidth()||m===d.S.CollectionPageView),[m,t]),S=(0,s.VK)((()=>p?{paddingLeft:v?96:42,height:0}:v?void 0:{position:"absolute",right:(0,c.oS)(f,(0,a.en)(t),(0,a.Ks)(t))}),[v,f,t,p]),b=(0,i.useCallback)((()=>{h(!0)}),[]),C=(0,i.useCallback)((()=>{h(!1)}),[]),y=(0,r.yK)((()=>({marginCommentsSection:{display:o||g?"flex":"none",flexShrink:0,pointerEvents:"none",width:o?c.QB:0,...S}})),[o,g,S]);return(0,P.jsx)(l.Z,{isVisible:!0,animationStyle:{opacity:o?1:0},onAnimationStart:b,onAnimationEnd:C,render:()=>(0,P.jsx)("div",{style:y.marginCommentsSection,children:(0,P.jsx)(oe,{pageBlockStore:t,timeMounted:x,isVisible:o,animating:g,pageViewBlockAccessor:u,width:c.QB})})})}},67706:(e,t,o)=>{o.d(t,{Z:()=>l});o(67294);var i=o(24405),n=o(82990),s=o(53437),r=o(26388),a=o(85893);function l(e){let{text:t,tooltipText:o,icon:l}=e;window.__c={n:"InlineTextWithIconTooltip"};const d=(0,i.yK)((e=>({icon:{height:"1em",width:"1em",marginRight:"0.25em",fill:e.mediumIconColor,marginBottom:"0.1em"},tooltip:{background:e.contentBackground,boxShadow:e.lightBoxShadow},container:{display:"flex",alignItems:"center",fontWeight:n.Z.fontWeight.regular,color:e.mediumTextColor,fontSize:n.Z.fontSize.UISmall.desktop,textAlign:"center"},text:{display:"inline"}})),[]);return(0,a.jsx)(r.ZP,{style:d.tooltip,render:e=>(0,a.jsx)("div",{style:d.text,...e,children:t}),renderTooltip:()=>(0,a.jsxs)("div",{style:d.container,children:[l(d.icon),(0,a.jsx)("div",{children:o})]}),alignment:s.ZP.Alignment.Start,placement:s.ZP.Placement.Bottom})}},12740:(e,t,o)=>{o.d(t,{Z:()=>P});o(57658);var i=o(67294),n=o(480),s=o(86628),r=o(24405),a=o(6695),l=o(9999),d=o(69651),c=o(72126),u=o(4615),m=o(21202),p=o(19889),g=o(82990),h=o(9291),f=(o(95477),o(66890)),x=o(80444),v=o(77556),S=o(88632),b=o(77080),C=o(19671),y=o(79797),w=o(76117),j=o(88893),k=o(88280),M=o(97039),L=o(78030),I=o(45653),R=o(29551),D=o(99036),T=(o(51365),o(33929)),_=(o(61766),o(13023),o(24118)),Z=(o(53876),o(12867),o(85893));_.Ae;function B(e){return(0,s.VK)((()=>{if(!e)return{collectionStore:void 0,schema:void 0,format:void 0};const t=e.getAssociatedCollectionStore();let o,i;return o=t?t.getSchema():D.Kc(T.default.getIntl()),t&&(i=a.iB(t.getFormat(),o,void 0,a.j5.Collection)),{collectionStore:t,schema:o,format:i}}),[e])}const V=["Title","Pronoun","Teams (via Teams DB)","Office","Manager","Languages (Fluency)","Tenure"],F={"Teams (via Teams DB)":"Teams","Languages (Fluency)":"Languages"};function P(e){let{targetUserStore:t}=e;window.__c={n:"PeopleProfilePopup"};const o=(0,r.yK)((e=>({wrapper:{minWidth:100,maxWidth:300},profile:{padding:"10px 12px 12px 10px"},content:{padding:"8px 10px 10px"},breadcrumb:{color:e.text.secondary},profileTitle:{paddingLeft:20,fontSize:18,lineHeight:1.25,fontWeight:g.Z.fontWeight.semibold,color:e.text.primary},profileSubtitle:{paddingLeft:20,paddingTop:2,fontSize:g.Z.fontSize.UISmall.desktop,color:e.icon.primary,paddingBottom:1},profileMeetingContainer:{display:"flex",alignItems:"center",paddingLeft:20,paddingTop:2,cursor:"pointer"},profileMeetingLeftIcon:{},profileMeetingText:{paddingLeft:4,paddingRight:4,fontSize:g.Z.fontSize.UISmall.desktop,lineHeight:1.25,color:e.text.primary},profileMeetingRightIcon:{},profileKeyRow:{minWidth:80},profileKeyText:{textTransform:"capitalize",fontWeight:500},description:{padding:"6px 8px 12px 20px",fontSize:g.Z.fontSize.UISmall.desktop,color:e.icon.primary,borderTop:`1px solid ${e.regularDividerColor}`}})),[]),l=(0,s.VK)((()=>x.default.state.currentSpaceStore),[]),d=(0,s.VK)((()=>x.default.state.currentUserStore),[]),c=(0,s.VK)((()=>!!t&&t.isDefined()),[t]),p=(0,s.VK)((()=>{if(!t)return;const e=t.getEmail();if(!e)return;const o=b.default.getConfigKey("notion_people_block_id","data")[e];if(!o)return;return y.G.createChildStore(t,{table:m.iU,id:(0,u.Mt)(o)})}),[t]),{collectionStore:h,schema:S,format:w}=B(p),j=function(e){let{collectionStore:t,format:o,schema:i,userPeopleCollectionPage:n}=e;return(0,s.VK)((()=>{var e;if(!(t&&o&&i&&n))return;const s=a.iB(o,i,void 0,a.j5.Collection),r=null==s||null===(e=s.collection_page_properties)||void 0===e?void 0:e.filter((e=>{var t;const o=null===(t=i[e.property])||void 0===t?void 0:t.name;return void 0!==o&&V.includes(o)}));if(!r)return;const l={};return r.forEach((e=>{var o;l[(null===(o=i[e.property])||void 0===o?void 0:o.name)||""]=(0,Z.jsx)(M.Z,{store:n,property:e.property,locked:!0,disabled:!0,format:L.C.Page,onTab:()=>{},onUntab:()=>{},tableWrap:!1,blockPropertyValueOverlayStore:C.Z,collectionStore:t})})),l}),[t,i,o,n])}({collectionStore:h,format:w,schema:S,userPeopleCollectionPage:p}),k=(0,n.O7)(),I=(0,i.useMemo)((()=>new v.Z(k)),[k]);(0,i.useEffect)((()=>{h&&I.setContext({type:"collectionPage",collectionStore:h})}),[I,h]);const D=(0,s.VK)((()=>!!(t&&d&&c)&&t.id===d.id),[t,d,c]);return t&&c&&l?p&&I&&j?(0,Z.jsx)("div",{style:o.wrapper,children:(0,Z.jsx)(f.L1,{value:I,children:(0,Z.jsxs)(R.Ht,{children:[(0,Z.jsx)(R.gq,{gap:3,alignItems:"center",style:o.profile,children:(0,Z.jsx)(K,{userStore:t,styles:o})}),(0,Z.jsxs)("div",{style:o.description,children:[(0,Z.jsx)(A,{userProfile:j,styles:o}),D?(0,Z.jsx)(R.gq,{gap:1,alignItems:"center",children:(0,Z.jsx)(E,{spaceStore:l,limit:5,styles:o})}):void 0]})]})})}):(0,Z.jsx)("div",{style:o.wrapper,children:(0,Z.jsxs)(R.Ht,{children:[(0,Z.jsx)(R.gq,{gap:3,alignItems:"center",style:o.profile,children:(0,Z.jsx)(K,{userStore:t,styles:o})}),D?(0,Z.jsx)("div",{style:o.description,children:(0,Z.jsx)(R.gq,{gap:1,alignItems:"center",children:(0,Z.jsx)(E,{spaceStore:l,limit:5,styles:o})})}):void 0]})}):null}function K(e){let{userStore:t,styles:o}=e;window.__c={n:"UserContactCard"};const i=(0,h.useIntl)(),{name:n,email:r,firstName:a}=(0,s.VK)((()=>{var e;return{name:t.getFullName(i),email:t.getEmail(),firstName:null===(e=t.getFullName(i))||void 0===e?void 0:e.split(" ")[0]}}),[t,i]);return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(I.Z,{userStore:t,size:70,borderStyle:"none"}),(0,Z.jsxs)(R.Ht,{gap:1,children:[(0,Z.jsx)("div",{style:o.profileTitle,children:n}),(0,Z.jsx)("div",{style:o.profileSubtitle,children:r}),a?(0,Z.jsxs)("div",{style:o.profileMeetingContainer,onClick:()=>{window.open(`https://calendar.notion.so/meet-with/${r}`,"_blank")},children:[(0,Z.jsx)("div",{style:o.profileMeetingLeftIcon,children:(0,d.C)({width:12,height:12})}),(0,Z.jsx)("div",{style:o.profileMeetingText,children:(0,Z.jsx)(h.FormattedMessage,{id:"people.profile.setMeeting",defaultMessage:"Meet with {name}",values:{name:a}})}),(0,Z.jsx)("div",{style:o.profileMeetingRightIcon,children:(0,l.J)({width:12,height:12})})]}):void 0]})]})}function A(e){let{userProfile:t,styles:o}=e;return t?(0,Z.jsx)(Z.Fragment,{children:V.filter((e=>t[e])).map((e=>(0,Z.jsxs)(R.gq,{gap:1,alignItems:"center",children:[(0,Z.jsx)(R.Ht,{children:(0,Z.jsx)(R.gq,{style:o.profileKeyRow,children:(0,Z.jsx)("div",{style:o.profileKeyText,children:F[e]?F[e]:e})})}),(0,Z.jsx)(R.Ht,{style:{transform:"scale(0.9)",transformOrigin:"center left"},children:t[e]})]},e)))}):null}function E(e){let{spaceStore:t,limit:o,styles:i}=e;window.__c={n:"UserSimilarity"};const{userSimilarityList:n}=(0,s.VK)((()=>{const e=k.subscriptionDataStoreInstance.state,i=e?j.CM(e):[],n=w.p.state||{},s=i.map((e=>{const t=n[e.userId];return{id:e.userId,similarity:t||0}})).sort(((e,t)=>t.similarity-e.similarity)).slice(0,o),r=[],a=c.yW(s.map((e=>{const o=y.U6.createChildStore(t,{table:p.KJ,id:e.id});return r.push({id:e.id,similarity:e.similarity,userStore:o}),o.isReady()})));return{isOnline:S.Z.state.online,subscriptionDataStoreData:e,userSimilarityData:w.p.state||{},visibleUsersLoaded:a,visibleUsers:i,userSimilarityList:r}}),[t,o]);return t&&n&&0!==n.length?(0,Z.jsxs)(R.gq,{gap:1,alignItems:"center",style:{paddingTop:4},children:[(0,Z.jsx)(R.Ht,{children:(0,Z.jsx)(R.gq,{style:i.profileKeyRow,children:(0,Z.jsx)("div",{style:i.profileKeyText,children:"Coworkers"})})}),(0,Z.jsx)(R.Ht,{children:(0,Z.jsx)(R.gq,{gap:5,children:(0,Z.jsx)("div",{children:(0,Z.jsx)("div",{style:{display:"flex",position:"relative",float:"right"},children:n.map((e=>(0,Z.jsx)("div",{style:{marginLeft:1.5},children:(0,Z.jsx)(I.Z,{userStore:e.userStore,size:18})},e.id)))})})})})]}):null}},93963:(e,t,o)=>{o.d(t,{z:()=>a});o(67294);var i=o(24405),n=o(9291),s=o(85893);const r=8;function a(e){let{color:t,size:o,style:a}=e;window.__c={n:"StatusDot"};const l=(0,n.useIntl)(),d=(0,i.yK)((e=>({dot:{height:o||r,width:o||r,background:t||e.blueColor,flexShrink:0,borderRadius:"100%",pointerEvents:"none",...a}})),[o,t,a]);return(0,s.jsx)("div",{role:"img","aria-label":l.formatMessage({id:"statusDot.ariaLabel",defaultMessage:"New"}),style:d.dot})}},66957:(e,t,o)=>{o.d(t,{Z:()=>u});var i=o(67294),n=o(480),s=o(86628),r=o(24405),a=o(87279),l=o(89728),d=o(85893);function c(e){let{tabs:t,selectedIndex:o,onChange:c,separatorIndexes:u,right:m,style:p,rightStyle:g,tabStyle:h,tabTitleStyle:f,tabBorderStyle:x,selectedTabStyle:v,readOnly:S,hideTabBorder:b}=e;window.__c={n:"TabBarMenuItem"};const C=(0,i.useContext)(a.Xp),{device:y,WindowSizeStore:w}=(0,n.O7)(),{safePaddingLeft:j,safePaddingRight:k}=(0,s.VK)((()=>({safePaddingLeft:w.getSafePaddingLeftCSS(16),safePaddingRight:w.getSafePaddingRightCSS(16)})),[w]),M=(0,r.yK)((e=>{const t={paddingTop:6,paddingBottom:6,whiteSpace:"nowrap",minWidth:0,flexShrink:0,color:e.mediumTextColor,...h},o=`inset 0 -1px 0 ${e.regularDividerColor}`,i=C.menuType===a.og.Popup,n={fontSize:16,paddingTop:2,paddingLeft:i?16:j,paddingRight:i?16:k,zIndex:2,height:44,background:e.popoverBackground};return{container:{overflowY:"visible",overflowX:"auto",display:"flex",width:"100%",position:"relative",boxShadow:b?void 0:o,...y.isMobile?n:{fontSize:14,paddingLeft:8,paddingRight:8,zIndex:1},...p},separator:{display:"inline-flex",alignItems:"center",margin:"0 4px",paddingBottom:4,whiteSpace:"nowrap",minWidth:0,flexShrink:0,color:e.regularDividerColor},mobile:{},tab:t,selectedTab:{...t,position:"relative",color:e.regularTextColor,...v},border:{borderBottom:`2px solid ${e.regularTextColor}`,position:"absolute",bottom:0,left:8,right:8,...x},rightContainer:{flexGrow:1,display:"flex",alignItems:"center",justifyContent:"flex-end",color:e.mediumTextColor,...g}}}),[C.menuType,y.isMobile,g,j,k,v,p,x,h,b]);return(0,d.jsxs)("div",{className:"hide-scrollbar",style:M.container,children:[t.map(((e,t)=>{const n=t===o;return(0,d.jsxs)(i.Fragment,{children:[(0,d.jsxs)("div",{style:n?M.selectedTab:M.tab,children:[(0,d.jsx)(l.Z,{style:f,onClick:()=>c(t),disabled:S,mobileFeedback:y.isMobile,children:e}),n&&(0,d.jsx)("div",{style:M.border})]},`tabButton-${t}`),u&&u.includes(t)&&(0,d.jsx)("div",{style:M.separator,className:"notranslate",children:"|"},`${t}-separator`)]},t)})),m&&(0,d.jsx)("div",{style:M.rightContainer,children:m})]})}const u=i.memo(c)},83420:(e,t,o)=>{o.d(t,{TL:()=>u,nc:()=>c,ue:()=>d});var i=o(66897),n=o(54368),s=o(77420),r=o(19889),a=o(97880),l=o(79797);function d(e){const{parentStore:t,pointer:o}=e,n=(0,l.Kv)(t,o).getValue();if(n)return(0,i.LU)({table:o.table,value:n})}function c(e){const{parentStore:t,pointer:o}=e;return o.table===s.cZ?l.Qx.createChildStore(t,o):o.table===r.KJ?l.U6.createChildStore(t,o):o.table===n.y?l.fg.createChildStore(t,o):void(0,a.t1)(o)}function u(e){return e.table===s.cZ?(0,i.ON)(e.getValue()):e.table===r.KJ?(0,i.m3)(e.getValue()):e.table===n.y?(0,i.I4)(e.getValue()):void(0,a.t1)(e)}},14568:(e,t,o)=>{o.d(t,{Z:()=>s});var i=o(35431);class n extends i.Z{}const s=new n},63334:(e,t,o)=>{o.d(t,{Z:()=>s});var i=o(49085);class n extends i.default{getInitialState(){return{}}}const s=n},7189:(e,t,o)=>{o.d(t,{K:()=>s});o(67294);var i=o(45238),n=o(85893);const s=(0,i.I)("arrowDownSmall",{viewBox:"0 0 12 12",svg:(0,n.jsx)("path",{d:"M5.99756 0.850098C5.53564 0.850098 5.21875 1.17236 5.21875 1.65576V7.61768L5.27246 8.7832L4.19287 7.53711L2.98438 6.33398C2.84473 6.18896 2.66211 6.09229 2.42578 6.09229C2.00684 6.09229 1.68994 6.40381 1.68994 6.84424C1.68994 7.04834 1.77051 7.23633 1.93164 7.40283L5.42285 10.8994C5.56787 11.0498 5.78809 11.1357 5.99756 11.1357C6.2124 11.1357 6.42725 11.0498 6.57227 10.8994L10.0688 7.40283C10.23 7.23633 10.3105 7.04834 10.3105 6.84424C10.3105 6.40381 9.99365 6.09229 9.57471 6.09229C9.34375 6.09229 9.16113 6.18896 9.01611 6.33398L7.80762 7.53711L6.72803 8.7832L6.77637 7.61768V1.65576C6.77637 1.17236 6.46484 0.850098 5.99756 0.850098Z"})})},37652:(e,t,o)=>{o.d(t,{V:()=>s});o(67294);var i=o(45238),n=o(85893);const s=(0,i.I)("arrowLeft",{viewBox:"0 0 30 30",svg:(0,n.jsx)("polygon",{points:"29 14 4.813 14 13.406 5.406 12 4 1 15 12 26 13.406 24.594 4.813 16 29 16"})})},91315:(e,t,o)=>{o.d(t,{r:()=>s});o(67294);var i=o(45238),n=o(85893);const s=(0,i.I)("circleCheckFilled",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M8 16c4.377 0 8-3.631 8-8 0-4.376-3.631-8-8.008-8C3.624 0 0 3.624 0 8c0 4.369 3.631 8 8 8zm-.886-4.165c-.267 0-.487-.11-.69-.384l-1.97-2.416a.852.852 0 01-.187-.51c0-.352.274-.643.627-.643.228 0 .4.07.596.33l1.592 2.055 3.35-5.38c.148-.236.352-.362.556-.362.345 0 .667.236.667.604 0 .173-.102.353-.196.518l-3.686 5.804c-.165.259-.393.384-.66.384z"})})},64275:(e,t,o)=>{o.d(t,{D:()=>s});o(67294);var i=o(45238),n=o(85893);const s=(0,i.I)("closeSmall",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M3.732 11.052c-.303.308-.32.877.011 1.202.33.33.894.32 1.203.011L8 9.21l3.05 3.05c.32.325.872.32 1.197-.011a.857.857 0 00.01-1.197L9.21 8.002l3.05-3.056a.857.857 0 00-.01-1.197.857.857 0 00-1.198-.01L8 6.788 4.946 3.732c-.31-.303-.878-.32-1.203.01-.325.331-.314.895-.01 1.203l3.055 3.056-3.056 3.05z"})})},31505:(e,t,o)=>{o.d(t,{Y:()=>s});o(67294);var i=o(45238),n=o(85893);const s=(0,i.I)("collectionTimelineArrowLeft",{viewBox:"0 0 9 7",svg:(0,n.jsx)("path",{d:"M0 3.5021C0 3.70786 0.0939831 3.93041 0.237195 4.06479L3.11934 6.76065C3.28493 6.91602 3.48633 7 3.67877 7C4.17106 7 4.48881 6.68506 4.48881 6.27774C4.48881 6.03839 4.37245 5.86203 4.22029 5.72345L3.19095 4.77025L2.56887 4.22855L3.47737 4.27055L8.13625 4.27055C8.6554 4.27055 9 3.96401 9 3.5021C9 3.04019 8.6554 2.73365 8.13625 2.73365L3.47737 2.73365L2.56887 2.77564L3.19095 2.23395L4.22029 1.27654C4.37245 1.13377 4.48881 0.961608 4.48881 0.722255C4.48881 0.314937 4.17106 0 3.67877 0C3.48633 0 3.28493 0.0839832 3.11487 0.239352L0.237195 2.93941C0.0939831 3.07378 0 3.29634 0 3.5021Z"})})},39301:(e,t,o)=>{o.d(t,{n:()=>s});o(67294);var i=o(45238),n=o(85893);const s=(0,i.I)("collectionTimelineArrowRight",{viewBox:"0 0 9 7",svg:(0,n.jsx)("path",{d:"M9 3.4979C9 3.29214 8.90602 3.06959 8.7628 2.93521L5.88066 0.239352C5.71507 0.0839835 5.51368 3.13148e-07 5.32123 2.96324e-07C4.82894 2.53287e-07 4.51119 0.314937 4.51119 0.722256C4.51119 0.961608 4.62755 1.13797 4.77971 1.27654L5.80905 2.22975L6.43113 2.77145L5.52263 2.72945L0.863749 2.72945C0.344604 2.72945 -6.62078e-07 3.03599 -7.02459e-07 3.4979C-7.4284e-07 3.95981 0.344604 4.26635 0.863749 4.26635L5.52263 4.26635L6.43113 4.22436L5.80905 4.76605L4.77971 5.72346C4.62755 5.86623 4.51119 6.03839 4.51119 6.27774C4.51119 6.68506 4.82894 7 5.32123 7C5.51367 7 5.71507 6.91602 5.88513 6.76065L8.7628 4.06059C8.90602 3.92622 9 3.70366 9 3.4979Z"})})},22962:(e,t,o)=>{o.d(t,{O:()=>s});o(67294);var i=o(45238),n=o(85893);const s=(0,i.I)("mention",{viewBox:"0 0 20 20",svg:(0,n.jsx)("path",{d:"M1 9.86523C1 15.2939 4.72705 18.6807 9.98975 18.6807C11.3511 18.6807 12.4634 18.5312 13.1606 18.2905C13.6919 18.1079 13.8828 17.8174 13.8828 17.4521C13.8828 17.0537 13.6089 16.7715 13.1523 16.7715C13.0195 16.7715 12.8784 16.7881 12.6958 16.8213C11.9238 16.9873 11.2266 17.1118 10.2637 17.1118C5.74805 17.1118 2.74316 14.4058 2.74316 9.91504C2.74316 5.56543 5.61523 2.56055 9.88184 2.56055C13.7417 2.56055 16.7383 4.97607 16.7383 9.11816C16.7383 11.3511 15.9995 12.8452 14.8125 12.8452C14.0239 12.8452 13.5757 12.3472 13.5757 11.4839V6.44531C13.5757 5.84766 13.252 5.49072 12.6709 5.49072C12.0981 5.49072 11.7578 5.84766 11.7578 6.44531V7.10107H11.6333C11.21 6.09668 10.2305 5.49072 9.01855 5.49072C6.90186 5.49072 5.43262 7.28369 5.43262 9.89844C5.43262 12.5547 6.91846 14.3892 9.11816 14.3892C10.3799 14.3892 11.3013 13.7417 11.7578 12.6045H11.8823C12.1147 13.7168 13.0942 14.3809 14.4307 14.3809C16.8877 14.3809 18.3984 12.1895 18.3984 8.96045C18.3984 4.1626 14.8706 1 9.89014 1C4.66064 1 1 4.56104 1 9.86523ZM9.5415 12.7207C8.26318 12.7207 7.46631 11.6499 7.46631 9.92334C7.46631 8.21338 8.27148 7.14258 9.5498 7.14258C10.8364 7.14258 11.6582 8.20508 11.6582 9.89844C11.6582 11.625 10.8281 12.7207 9.5415 12.7207Z"})})},40350:(e,t,o)=>{o.d(t,{V:()=>s});o(67294);var i=o(45238),n=o(85893);const s=(0,i.I)("reactionAdd",{viewBox:"0 0 16 16",svg:(0,n.jsxs)("g",{children:[(0,n.jsx)("path",{d:"M8.7207 12.0259C8.7207 12.4243 9.04492 12.7446 9.43945 12.7446H11.4199V14.7251C11.4199 15.1235 11.7441 15.4438 12.1426 15.4438C12.5371 15.4438 12.8613 15.1235 12.8613 14.7251V12.7446H14.8418C15.2363 12.7446 15.5605 12.4243 15.5605 12.0259C15.5605 11.6274 15.2363 11.3032 14.8418 11.3032H12.8613V9.32666C12.8613 8.92822 12.5371 8.604 12.1426 8.604C11.7441 8.604 11.4199 8.92822 11.4199 9.32666V11.3032H9.43945C9.04492 11.3032 8.7207 11.6274 8.7207 12.0259Z"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.02947 13.6952C8.43019 13.8731 7.79681 13.9688 7.14258 13.9688C3.46729 13.9688 0.439453 10.9409 0.439453 7.25928C0.439453 3.58398 3.46094 0.556152 7.14258 0.556152C10.8179 0.556152 13.8457 3.58398 13.8457 7.25928C13.8457 7.72257 13.7979 8.1755 13.7069 8.61336C13.439 8.02567 12.8508 7.61289 12.1648 7.60415C12.1724 7.49021 12.1763 7.37521 12.1763 7.25928C12.1763 4.47266 9.9292 2.22559 7.14258 2.22559C4.34961 2.22559 2.11523 4.47266 2.11523 7.25928C2.11523 10.0522 4.35596 12.2993 7.14258 12.2993C7.34385 12.2993 7.54226 12.2876 7.73717 12.2649C7.83478 12.9674 8.35636 13.53 9.02947 13.6952ZM6.02539 5.83105C6.02539 6.31982 5.67627 6.67529 5.28271 6.67529C4.88916 6.67529 4.55908 6.31982 4.55908 5.83105C4.55908 5.33594 4.88916 4.98047 5.28271 4.98047C5.67627 4.98047 6.02539 5.33594 6.02539 5.83105ZM9.73242 5.83105C9.73242 6.31982 9.3833 6.67529 8.99609 6.67529C8.60254 6.67529 8.26611 6.31982 8.26611 5.83105C8.26611 5.33594 8.59619 4.98047 8.99609 4.98047C9.38965 4.98047 9.73242 5.33594 9.73242 5.83105ZM9.37695 8.9668C9.37695 9.39844 8.48193 10.2808 7.14258 10.2808C5.79688 10.2808 4.90186 9.39844 4.90186 8.9668C4.90186 8.80811 5.06055 8.72559 5.21289 8.80176L5.22971 8.81029C5.68936 9.04333 6.22701 9.31592 7.14258 9.31592C8.01512 9.31592 8.53968 9.05921 8.99207 8.83782C9.01689 8.82568 9.04149 8.81364 9.06592 8.80176C9.21826 8.73193 9.37695 8.80811 9.37695 8.9668Z"})]})})},18101:(e,t,o)=>{o.d(t,{b:()=>s});o(67294);var i=o(45238),n=o(85893);const s=(0,i.I)("reopen",{viewBox:"0 0 14 14",svg:(0,n.jsx)("path",{d:"M1.64844 7.88477C1.64844 10.791 3.98047 13.1289 6.88086 13.1289C9.78125 13.1289 12.1133 10.791 12.1133 7.88477C12.1133 7.53906 11.873 7.29297 11.5273 7.29297C11.1934 7.29297 10.9707 7.53906 10.9707 7.88477C10.9707 10.1582 9.14844 11.9805 6.88086 11.9805C4.61328 11.9805 2.79688 10.1582 2.79688 7.88477C2.79688 5.59961 4.60156 3.78906 6.86328 3.78906C7.25 3.78906 7.60742 3.81836 7.90625 3.88281L6.3125 5.46484C6.20703 5.57617 6.1543 5.69922 6.1543 5.85156C6.1543 6.17383 6.39453 6.41992 6.71094 6.41992C6.875 6.41992 7.00977 6.36719 7.10938 6.26172L9.51758 3.83594C9.64062 3.71289 9.69922 3.57227 9.69922 3.41406C9.69922 3.26172 9.63477 3.10938 9.51758 2.99219L7.10938 0.548828C7.00977 0.4375 6.875 0.378906 6.71094 0.378906C6.39453 0.378906 6.1543 0.636719 6.1543 0.953125C6.1543 1.10547 6.20703 1.24023 6.30664 1.3457L7.72461 2.74609C7.4668 2.69336 7.16797 2.66406 6.86328 2.66406C3.96875 2.66406 1.64844 4.98438 1.64844 7.88477Z"})})},83065:(e,t,o)=>{o.d(t,{_:()=>s});o(67294);var i=o(45238),n=o(85893);const s=(0,i.I)("sendArrow",{viewBox:"0 0 20 20",svg:(0,n.jsx)("path",{d:"M9.79883 18.5894C14.6216 18.5894 18.5894 14.6216 18.5894 9.79883C18.5894 4.96777 14.6216 1 9.79053 1C4.95947 1 1 4.96777 1 9.79883C1 14.6216 4.96777 18.5894 9.79883 18.5894ZM9.79883 14.3062C9.20947 14.3062 8.76953 13.9077 8.76953 13.3433V9.69922L8.86914 8.00586L8.25488 8.84424L7.3916 9.81543C7.23389 10.0063 6.98486 10.1143 6.72754 10.1143C6.21289 10.1143 5.84766 9.75732 5.84766 9.25928C5.84766 8.99365 5.92236 8.79443 6.12158 8.58691L8.96045 5.61523C9.19287 5.35791 9.4585 5.2417 9.79883 5.2417C10.1309 5.2417 10.4048 5.36621 10.6372 5.61523L13.4761 8.58691C13.667 8.79443 13.75 8.99365 13.75 9.25928C13.75 9.75732 13.3848 10.1143 12.8618 10.1143C12.6128 10.1143 12.3638 10.0063 12.2061 9.81543L11.3428 8.86914L10.7202 7.99756L10.8281 9.69922V13.3433C10.8281 13.9077 10.3799 14.3062 9.79883 14.3062Z"})})}}]);