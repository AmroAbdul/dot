"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[4544],{26797:(e,t,o)=>{o.d(t,{Fv:()=>T,JN:()=>w,QG:()=>V,cQ:()=>_,f$:()=>b,fX:()=>M,td:()=>j,xD:()=>k});o(57658);var n=o(30120),i=o(80951),r=o(40506),a=o(53877),s=o(42875),l=o(72126),c=o(6287),d=o(97880),u=o(10906),p=o(95802),g=o(15723),m=o(17746),S=o(79797),f=o(8406),y=o(54569),h=o(75134),x=o(42239),v=o(19785),C=o(9953);function w(e){const{environment:t,droppedStores:o,duplicate:l,calendarBy:d,transaction:p,collectionContextStore:g}=e,m=n.ou.fromMillis(e.startOfDay);let S=!0;for(const n of o){const t=e.collectionStore?e.collectionStore:(0,u.Bm)({store:n,collectionContextStore:g});if(n.getParentTable()===c.v||!t){S=!1;break}v.zw({childStore:n,parentStore:t,transaction:p})||(S=!1)}const h=x.LQ({environment:t,droppedStores:o,duplicate:l,duplicateUseCrdt:!1,transaction:p,resolveTemplateVariables:!1});for(const n of h){const o=e.collectionStore?e.collectionStore:(0,u.Bm)({store:n,collectionContextStore:g}),l=n.getPropertyStore(d),c=i.Gl(l.getValue())||a.Lg((0,s.r)()),h=a.c$(c,(0,s.r)()),x=m.toFormat(a.Iq);let v;if("date"===h.type||"datetime"===h.type)v={...h,start_date:x};else{const e=a.NK(h,(0,s.r)());if(!e.end)return;const t={...h,start_date:x},o=a.NK(t,(0,s.r)()).start.diff(e.start,"days"),n=e.end.plus(o).toFormat(a.Iq);v={...h,start_date:x,end_date:n}}const C=a.c$(v,r.yw(c)||(0,s.r)());o&&y.mp({environment:t,store:n,collectionStore:o,collectionContextStore:g,shouldCoerce:!0,groupsPointer:[],transaction:p,alreadyMovedToCollection:S}),k({environment:t,type:"dateValue",propertyId:d,store:n,transaction:p,dateValue:C}),f.rv({environment:t,collectionContextStore:g,block_id:n.id,property:d,property_type:"date",from:"calendar"})}}function b(e){const{calendarStore:t,direction:o,target:n}=e;t.setState({...t.state,isDragging:!0,target:n,direction:o})}function j(e){const{calendarStore:t,x:o,y:c,calendarBy:d}=e,u=t.state;if(u.isDragging){const e=i.Gl(u.target.getPropertyStore(d).getValue());if(!e)return;const S=a.c$(e,(0,s.r)()),f=u.temporaryValue||e,y=a.c$(f,(0,s.r)()),h=[];u.dayStoreMap.forEach(((e,t)=>{h.push({store:e,timestamp:t})}));const x=h.find((e=>{let{store:t}=e;const n=p.C.getRectFromStore(t);return Boolean(n&&g.uh(n,o,c))}));let v;if(x){const e=n.ou.fromMillis(x.timestamp),t=e.endOf("day"),o=e.toFormat(a.Iq);if(S){const i=a.NK(S,(0,s.r)());if(u.direction===m.t.Left)if(n.Xp.fromDateTimes(e,t).contains(i.start))v=S;else{let e;e="datetimerange"===S.type||"daterange"===S.type?{...S,start_date:o,end_date:S.end_date}:"datetime"===S.type?{type:"datetimerange",start_date:o,start_time:S.start_time,end_date:S.start_date,end_time:S.start_time,time_zone:S.time_zone,reminder:S.reminder}:{type:"daterange",start_date:o,end_date:S.start_date,reminder:S.reminder};const t=a.NK(e,(0,s.r)());v=!i.end&&t.start>i.start||i.end&&t.start>i.end?y:e}else if(i.end?n.Xp.fromDateTimes(e,t).contains(i.end):n.Xp.fromDateTimes(e,t).contains(i.start))v=S;else{let e;e="date"===S.type?{...S,type:"daterange",end_date:o}:"datetime"===S.type?{...S,type:"datetimerange",end_date:o,end_time:"00:00"}:{...S,end_date:o};const t=a.NK(e,(0,s.r)());v=t.end&&t.end<t.start?y:e}}}if(v&&!l.Xy(y,v)){const e=a.c$(v,r.yw(f)||(0,s.r)());t.setState({...u,temporaryValue:e})}}}function M(e){const{environment:t,calendarStore:o,calendarBy:n,transaction:i}=e,r=o.state;r.isDragging&&r.temporaryValue&&(k({type:"dateValue",environment:t,dateValue:r.temporaryValue,propertyId:n,store:r.target,transaction:i}),o.setState({...o.state,isDragging:!1}))}function _(e){const{calendarStore:t}=e,o=t.state;o.isDragging&&t.setState({...o,isDragging:!1})}function T(e){const{environment:t,store:o,collectionStore:r,collectionContextStore:l,startDayOfWeek:c,transaction:d}=e,u=l.dateRangeStart.state,p=(0,s.r)(),g=l.normalizedQueryStore.state;if(!g||!g.calendar_by)return;const m=g.calendar_by,S=a.gQ(u,c,p),f=S.startOf("month"),h=S.endOf("month"),x=n.ou.now().startOf("day");let v;return v=n.Xp.fromDateTimes(f,h).contains(x)?a.hT(x.valueOf(),p):a.hT(a.em(u,c,p).valueOf(),p),C.sW({store:o.getPropertiesStore(),data:{[m]:i.d7(v)},transaction:d}),y.mp({environment:t,store:o,collectionStore:r,collectionContextStore:l,shouldCoerce:!0,groupsPointer:[],transaction:d}),o}function k(e){const{environment:t,store:o,propertyId:n,transaction:r}=e;let l;"timestamp"===e.type?l=a.hT(e.timestampMs.valueOf(),(0,s.r)()):"dateValue"===e.type?l=e.dateValue:(0,d.t1)(e);const c=o.getPropertyValue(n),u=i.d7(l);C.sW({store:o.getPropertiesStore(),data:{[n]:u},transaction:r}),h.H({environment:t,store:o,dateProperty:{id:n,oldValue:c,newValue:u}})}function V(e){const{environment:t,collectionStore:o,calendarBy:n,store:i,insertStores:r,collectionContextStore:a,transaction:s}=e,l=i.getPropertyStore(n).getValue();for(const c of r)y.mp({environment:t,store:c,collectionStore:o,collectionContextStore:a,shouldCoerce:!0,groupsPointer:[],transaction:s}),C.sO({store:c.getPropertyStore(n),value:l,transaction:s});return r.map((e=>S.G.createChildStore(o,e.pointer)))}},58188:(e,t,o)=>{o.d(t,{Lg:()=>u,N:()=>d,aG:()=>c});var n=o(13493),i=o(29369),r=o(82530),a=o(75330),s=(o(77907),o(30806)),l=o(80444);o(72711);function c(e){const{environment:t,currentSpaceViewStore:o,...n}=e,i=o.getModel();if(!i)return;const a=!i.showFeatureOnPersonalHome(e.feature);r.createAndCommit({userAction:"userHomeActions.toggleHomeFeature",environment:t,perform:t=>{r.applyOperation({store:o,operation:{pointer:o.pointer,path:["settings","personal_home","enabled_features"],command:"update",args:{[e.feature]:a}},transaction:t})}}),(0,s.cY)({environment:t,show:a,...n})}function d(e){let{environment:t,option:o,from:n,userAction:i}=e;const a=l.default.state.currentSpaceViewStore;if(!a)return!1;const c=a.getOnAppStartStore().getValue();return r.createAndCommit({userAction:i,environment:t,perform:e=>{r.applyOperation({store:a,operation:{pointer:a.pointer,path:["settings","on_app_start"],command:"set",args:o},transaction:e})}}),(0,s.BX)({environment:t,oldValue:c,newValue:o,from:n}),!0}function u(e){const{environment:t,selectedStore:o,currentSpaceViewStore:l,collectionContextStore:c}=e,d=c.collectionViewStore(),u=c.collectionStore(),p=c.collectionViewBlockStore();if(!(u&&d&&p&&l))return;const g=l.getTeamsStores(),m=o.table===i.e0?g.indexOf(o)+1:0,S=o.table===i.e0?o.id:void 0;r.createAndCommit({environment:t,userAction:"PersonalHomeTrendingPanel.setCollectionViewSourceTeamId",perform:e=>{r.applyOperation({store:d,operation:{pointer:{id:d.id,table:n.n},path:["format","collection_view_source","teamId"],command:"set",args:S},transaction:e}),a.mc({environment:t,collectionViewBlockStore:p,collectionViewStore:d,collectionStore:u,collectionContextStore:c,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1})}}),(0,s.Ay)({environment:t,teamId:S,index:m})}},36821:(e,t,o)=>{o.d(t,{KV:()=>E,Rh:()=>$,U6:()=>W,Wu:()=>Q,Xx:()=>O,YD:()=>q,g9:()=>H,jc:()=>L,m8:()=>U,ys:()=>z,zX:()=>G});var n=o(30120),i=o(15145),r=o(92996),a=o(99036),s=o(40506),l=o(53877),c=o(4615),d=o(98963),u=o(18844),p=o(21202),g=o(15047),m=o(29369),S=o(39927),f=o(94438),y=o(70203),h=o(16732),x=o(40663),v=o(75330),C=o(33929),w=o(77907),b=o(80444),j=o(77080),M=o(79797),_=o(8406),T=o(54642),k=o(26797),V=o(16956),P=o(5149),A=o(96802),F=o(9953),I=o(21862),Z=o(82530),B=o(39865),D=o(37181);const K="week";function O(e){var t;const{environment:o,transaction:n,tasksBlockStore:i,sprintsBlockStore:r}=e;if(!j.default.checkGate("recurring_sprints"))return;const a=null===(t=r.getFormat())||void 0===t?void 0:t.collection_pointer,s=i.getFormat().collection_pointer;a&&s&&R({environment:o,transaction:n,sprintCollectionStore:M.NW.createChildStore(r,a),taskCollectionStore:M.NW.createChildStore(i,s),sprintSettingsConfig:S.i})}function R(e){const{environment:t,sprintSettingsConfig:o,transaction:n,sprintCollectionStore:i,taskCollectionStore:r}=e,a=i.getSpaceId(),s=(0,c.ZP)(),l=(0,c.ZP)();F.ae({environment:t,table:d.cv,inMemoryRecordCache:i.inMemoryRecordCache,value:{id:s,parent_id:i.id,parent_table:i.table,alive:!0,space_id:a,status:o.autoCompleteSprints?"active":"disabled",trigger:{id:(0,c.ZP)(),type:"recurrence",recurrence:X(o)},action_ids:[l]},transaction:n}),A.FH({stores:[i],update:{automation_ids:[...i.getFormat().automation_ids??[],s]},transaction:n}),F.ae({environment:t,table:u.Xj,inMemoryRecordCache:i.inMemoryRecordCache,transaction:n,value:{id:l,parent_id:s,parent_table:d.cv,type:"complete_sprint",alive:!0,space_id:a,config:{sprint_collection:i.getSpaceShardedPointer(),task_collection:r.getSpaceShardedPointer(),complete_sprint_action:o.actionConfig.complete_sprint_action}}})}function E(e){const{environment:t,automationStore:o,transaction:n,newDuration:i,currentSprintBlockStore:r}=e;F.sW({store:o.getTriggerStore().getKeyStore("recurrence"),data:{interval:i},transaction:n}),N({environment:t,transaction:n,automationStore:o,currentSprintBlockStore:r})}function H(e){const{environment:t,automationStore:o,transaction:n,newWeekday:i,currentSprintBlockStore:r}=e;F.sW({store:o.getTriggerStore().getKeyStore("recurrence"),data:{weekdays:[i]},transaction:n}),N({environment:t,transaction:n,automationStore:o,currentSprintBlockStore:r})}function L(e){const{environment:t,automationStore:o,transaction:n,newAutocompleteStatus:i,currentSprintBlockStore:r}=e;F.sW({store:o,data:{status:i?"active":"disabled"},transaction:n}),N({environment:t,transaction:n,automationStore:o,currentSprintBlockStore:r})}function N(e){const{automationStore:t,currentSprintBlockStore:o,transaction:i,environment:a}=e;if("active"!==t.getStatus())return;const l=t.getRecurrence();if(!l)return;const c=(0,f.Su)(l);if(!c)return;const d=o.getPropertyValue(r.b0.Dates);if(!d)return;const u=(0,y.nai)(d)[0];if(!u||"daterange"!==u.type)return;const p=u.start_date,{start_date:g,end_date:m}=(0,f.DW)({currentSprintStartDate:p,sprintSchedule:c});F.sW({store:t.getTriggerStore().getKeyStore("recurrence"),data:{start_date:(0,s.Io)(n.ou.fromISO(g).plus({minutes:1}).toJSDate())},transaction:i}),k.xD({store:o,propertyId:r.b0.Dates,transaction:i,environment:a,type:"dateValue",dateValue:{type:"daterange",start_date:p,end_date:m}})}function W(e){const{transaction:t,newRemainingTasksBehavior:o,actionStore:n}=e;F.sW({store:n.getConfigStore(),data:{complete_sprint_action:o},transaction:t})}async function z(e){var t;const{appTemplatesSetupActions:o,appTemplatesSprintBoardActions:n,appConfigs:a}=await w.deps.AppTemplates.loader(),{environment:s,collectionContextStore:l}=e,{currentSpaceViewStore:c}=b.default.state,d=l.collectionStore(),u=null==d?void 0:d.getParentBlockStore(),S=null==u?void 0:u.getParentStore(),f=null==d||null===(t=d.getFormat())||void 0===t?void 0:t.app_config_uri,y=f&&(0,x.YB)(a(),f);if(!d||!u||!S||!c||S.table!==g.bx&&S.table!==p.iU&&S.table!==m.e0||!y)return;const v=u.getFormat().app_id,C=v?await T.getCollectionViewBlocksByAppId(s,{spaceId:u.getSpaceId(),appId:v}):void 0,j="success"===(null==C?void 0:C.type)&&C.data.result.length?C.data.result.map((e=>M.G.createChildStore(S,{table:p.iU,id:e.blockId,spaceId:u.getSpaceId()}))):[u];await Y({environment:s,taskCollectionStore:d,executeFn:()=>{Z.createAndCommit({userAction:"sprintSettingsActions.handleTurnOnSprints",environment:s,perform:e=>{const t=(0,h.eu)(),a=o.applyFeatures({environment:s,spaceViewStore:c,appParentStore:S,appUri:y.uri,features:[{type:"simple",featureUri:t.uri}],transaction:e,createOrModify:"modify",appCollectionViewBlockStores:j}),d=n.createSprintPage({environment:s,spaceViewStore:c,appParentStore:S,transaction:e,blockStores:a,creationEntryPoint:{type:"sprint_settings"}});P.E3({collectionSettingsStore:l.settingsStore}),d&&(I.r({environment:s,store:d,pageVisitSource:i.tY.Create}),_._H({environment:s,collectionContextStore:l,from:"view_settings",property:r.Es.TaskToSprintRelation,property_type:"relation",is_suggested_property:!0}))}})}})}async function U(e){const{environment:t,collectionContextStore:o,sprintSettingsContext:n,sprintBoardViewBlockIds:a}=e,{sprintCollectionStore:s,automationContext:l,currentCollectionViewBlockStore:c,sprintCollectionViewBlockStore:d,taskCollectionStore:u,taskCollectionViewBlockStore:g}=n;if(!s||!d||!l)return;const m=g.getSpaceId(),S=[d,...a.map((e=>new M.G(t,{id:e,table:p.iU,spaceId:m})))];c.id===g.id?P.E3({collectionSettingsStore:o.settingsStore}):I.r({environment:t,store:g,pageVisitSource:i.tY.LeaveOrRemove}),await Y({environment:t,taskCollectionStore:u,executeFn:()=>{Z.createAndCommit({userAction:"sprintSettingsActions.handleTurnOffSprints",environment:t,perform:e=>{!function(e){const{transaction:t,automationStore:o,blocksToDelete:n,environment:i,taskCollectionStore:a,sprintCollectionStore:s}=e;F.sW({store:s,transaction:t,data:{alive:!1}}),F.sW({store:o,transaction:t,data:{alive:!1,status:"disabled"}}),V.E2({environment:i,collectionStore:a,schema:a.getSchema(),property:r.Es.TaskToSprintRelation,transaction:t,permanentlyDelete:!0}),B.y8({environment:i,blocks:n,transaction:t,permanentlyDelete:!0})}({environment:t,transaction:e,automationStore:l.automationStore,blocksToDelete:S,sprintCollectionStore:s,taskCollectionStore:u})}}),_.y9({environment:t,collectionContextStore:o,property_type:"relation",from:"view_settings",property:r.Es.TaskToSprintRelation})}})}function G(e){const{environment:t,userSettingsStore:o}=e;Z.createAndCommit({userAction:"sprintSettingsActions.handleSeenSprintsEngagementBanner",environment:t,perform:e=>{D.d2({userSettingsStore:o,data:{seen_sprint_settings_engagement_banner:!0},transaction:e})}})}function $(e){e.settingsStore.setState({open:!0,stack:[{type:"main"},{type:"sprintSettings"}]})}function q(e){const{environment:t,collectionContextStore:o,currentViewBlockStore:n,taskCollectionViewBlockStore:i}=e,a=o.collectionViewStore();if(!a)return;const s=a.getFormat(),l=a.getRawQuery();Z.createAndCommit({userAction:"sprintSettingsActions.handleManageSprintFromThisView",environment:t,perform:e=>{if(v.iG({collectionViewStore:a,transaction:e,update:{name:C.default.formatMessage(h.sY.tasksCurrentSprintV2ViewName),query2:{...l,filter:void 0},format:{...s,collection_view_icon:"/icons/playback-play-button_gray.svg",property_filters:h.Jt,app_config_uri:r.g3,hide_linked_collection_name:!0}}}),n.id===i.id){var t;const o=(null===(t=n.getFormat())||void 0===t?void 0:t.app_uri_map)??{},l=s.app_config_uri;l&&delete o[l],A.FH({stores:[i],update:{app_uri_map:{...o,[r.g3]:a.id}},transaction:e})}}})}function Q(e){const{environment:t,sprintSettingsContext:o}=e;if(!j.default.checkGate("recurring_sprints")||!o)return;const n=o.sprintCollectionStore;n&&!o.automationContext&&Z.createAndCommit({userAction:"sprintSettingsActions.ensureCompleteSprintAutomation",environment:t,perform:e=>{R({environment:t,transaction:e,sprintCollectionStore:n,taskCollectionStore:o.taskCollectionStore,sprintSettingsConfig:S.i})}})}async function Y(e){const{executeFn:t,environment:o,taskCollectionStore:n}=e;await async function(e){var t;const{environment:o,taskCollectionStore:n}=e,i=n.getFormat().app_uri_map,s=r.Es.TaskToSprintRelation,l=n.getSchema(),c=(null==i?void 0:i[s])??s,d=l[c];if(!d||!(0,a.p_)(d))return;const u=null===(t=(0,a.j0)(d))||void 0===t?void 0:t.id;if(!u)return;const p=new Set([c]);Object.entries(l).forEach((e=>{var t;let[o,n]=e;n&&(0,a.p_)(n)&&(null===(t=(0,a.j0)(n))||void 0===t?void 0:t.id)===u&&p.add(o)}));const{serverCommitResult:g}=Z.createAndCommit({userAction:"sprintSettingsActions.clearSprintRelationDataFromTaskCollection",environment:o,perform:e=>{for(const t of p)V.E2({environment:o,transaction:e,permanentlyDelete:!0,collectionStore:n,schema:l,property:t});null==i||delete i[s],i&&A.FH({stores:[n],transaction:e,update:{app_uri_map:i}})}});await g}({environment:o,taskCollectionStore:n}),t()}function X(e){return{frequency:K,interval:e.recurrenceConfig.interval,weekdays:e.recurrenceConfig.weekdays,start_date:n.ou.local().set({hour:0,minute:0,second:0,millisecond:0}).toMillis(),timezone:(0,l.Sv)(),hour:0,minute:0}}},59477:(e,t,o)=>{o.r(t),o.d(t,{default:()=>vd});var n=o(67294),i=o(83355),r=o(480),a=o(86628),s=o(4615),l=o(9291),c=o(36610),d=o(5149),u=o(96802),p=o(82530),g=o(74194),m=o(3386),S=(o(57658),o(30120)),f=o(24405),y=o(41892),h=o(59054),x=o(45238),v=o(85893);const C=(0,x.I)("basicClock",{viewBox:"0 0 16 16",svg:(0,v.jsx)("path",{d:"M4.541 7.919a.53.53 0 01-.39-.157.53.53 0 01-.157-.39c0-.155.053-.282.157-.383a.53.53 0 01.39-.157h2.905V2.895c0-.15.053-.278.158-.383a.521.521 0 01.382-.158.53.53 0 01.39.158.521.521 0 01.157.383v4.477a.53.53 0 01-.157.39.53.53 0 01-.39.157H4.541zm3.452 6.207a6.789 6.789 0 01-2.727-.554 7.124 7.124 0 01-2.256-1.524 7.277 7.277 0 01-1.525-2.256 6.788 6.788 0 01-.553-2.728c0-.966.184-1.875.553-2.727A7.241 7.241 0 015.258.557 6.788 6.788 0 017.987.003c.971 0 1.882.184 2.735.554.852.369 1.604.88 2.256 1.53a7.136 7.136 0 011.53 2.25c.37.852.555 1.761.555 2.727 0 .967-.185 1.876-.554 2.728a7.218 7.218 0 01-3.787 3.78 6.789 6.789 0 01-2.728.554zm0-1.395c.789 0 1.525-.145 2.208-.437a5.678 5.678 0 001.805-1.217 5.68 5.68 0 001.217-1.805c.291-.683.437-1.42.437-2.208a5.55 5.55 0 00-.437-2.2 5.66 5.66 0 00-3.029-3.029 5.567 5.567 0 00-2.208-.438c-.784 0-1.52.146-2.208.438A5.6 5.6 0 003.98 3.052a5.715 5.715 0 00-1.21 1.811 5.55 5.55 0 00-.437 2.201c0 .789.146 1.525.438 2.208a5.735 5.735 0 001.21 1.805 5.598 5.598 0 004.013 1.654z"})});var w=o(69651);const b=(0,x.I)("checkboxSquareCheckedDotted",{viewBox:"0 0 16 16",svg:(0,v.jsx)("path",{d:"M3.243 2.712a.648.648 0 00.465.191.664.664 0 00.478-.191.636.636 0 00.199-.465.652.652 0 00-.199-.479.652.652 0 00-.478-.198.636.636 0 00-.465.198.664.664 0 00-.191.479.65.65 0 00.19.465zm2.14 0a.656.656 0 00.471.191c.183 0 .34-.064.472-.191a.626.626 0 00.205-.465.641.641 0 00-.205-.479.644.644 0 00-.472-.198.664.664 0 00-.663.677c0 .178.064.332.192.465zm2.14 0A.664.664 0 008 2.903c.182 0 .34-.064.471-.191a.636.636 0 00.199-.465.652.652 0 00-.199-.479A.644.644 0 008 1.57a.664.664 0 00-.67.677c0 .178.064.332.191.465zm2.146 0c.132.127.29.191.471.191a.641.641 0 00.472-.191.637.637 0 00.198-.465.652.652 0 00-.198-.479.63.63 0 00-.472-.198.644.644 0 00-.471.198.652.652 0 00-.199.479.64.64 0 00.199.465zm2.14 0a.68.68 0 00.478.191.633.633 0 00.465-.191.636.636 0 00.198-.465.652.652 0 00-.198-.479.622.622 0 00-.465-.198.652.652 0 00-.479.198.652.652 0 00-.198.479c0 .178.066.332.198.465zm1.476 1.47a.65.65 0 00.472.198.63.63 0 00.471-.199.644.644 0 00.199-.471.644.644 0 00-.199-.472.63.63 0 00-.471-.198.644.644 0 00-.472.198.656.656 0 00-.191.472c0 .182.063.34.19.471zm0 2.139c.132.132.29.198.472.198a.63.63 0 00.471-.198.644.644 0 00.199-.472.644.644 0 00-.199-.471.63.63 0 00-.471-.199.644.644 0 00-.472.199.656.656 0 00-.191.471c0 .183.063.34.19.472zm0 2.146c.132.133.29.199.472.199a.63.63 0 00.471-.199.644.644 0 00.199-.471.652.652 0 00-.199-.479.63.63 0 00-.471-.198.634.634 0 00-.472.205.656.656 0 00-.191.472c0 .182.063.34.19.471zm0 2.147c.132.132.29.198.472.198a.63.63 0 00.471-.198.644.644 0 00.199-.472.644.644 0 00-.199-.471.62.62 0 00-.471-.205.634.634 0 00-.472.205.656.656 0 00-.191.471c0 .183.063.34.19.472zm0 2.14c.132.132.29.198.472.198a.63.63 0 00.471-.198.644.644 0 00.199-.472.644.644 0 00-.199-.472.63.63 0 00-.471-.198.644.644 0 00-.472.198.656.656 0 00-.191.472c0 .182.063.34.19.472zm-1.477 1.476a.667.667 0 00.479.198.622.622 0 00.465-.198.636.636 0 00.198-.465.652.652 0 00-.198-.478.622.622 0 00-.465-.198.652.652 0 00-.479.198.652.652 0 00-.198.478c0 .178.066.333.198.465zm-2.14 0a.667.667 0 00.48.198.622.622 0 00.464-.198.637.637 0 00.198-.465.652.652 0 00-.198-.478.622.622 0 00-.465-.198.652.652 0 00-.478.198.652.652 0 00-.199.478c0 .178.067.333.199.465zm-2.146 0a.66.66 0 00.486.198.622.622 0 00.464-.198.637.637 0 00.199-.465.652.652 0 00-.199-.478.636.636 0 00-.464-.198.664.664 0 00-.677.677c0 .177.064.332.191.464zm-2.14 0c.133.132.29.198.472.198a.652.652 0 00.479-.198.637.637 0 00.198-.465.652.652 0 00-.198-.478.652.652 0 00-.479-.198.664.664 0 00-.663.677c0 .177.064.332.192.464zm-2.14 0c.133.132.29.198.473.198.182 0 .34-.066.471-.198a.637.637 0 00.199-.465.652.652 0 00-.199-.478.644.644 0 00-.471-.198.664.664 0 00-.663.677c0 .177.063.332.19.464zm-1.476-1.476a.652.652 0 00.479.198.622.622 0 00.465-.198.644.644 0 00.198-.472.644.644 0 00-.198-.472.622.622 0 00-.465-.198.644.644 0 00-.472.198.644.644 0 00-.198.472c0 .182.064.34.191.472zm0-2.14a.652.652 0 00.479.198.622.622 0 00.465-.198.644.644 0 00.198-.472.644.644 0 00-.198-.471.612.612 0 00-.465-.205.634.634 0 00-.472.205.644.644 0 00-.198.471c0 .183.064.34.191.472zm0-2.147a.652.652 0 00.479.199.622.622 0 00.465-.199.644.644 0 00.198-.471.652.652 0 00-.198-.479.622.622 0 00-.465-.198.634.634 0 00-.472.205.644.644 0 00-.198.472c0 .182.064.34.191.471zm0-2.146a.652.652 0 00.479.198.622.622 0 00.465-.198.644.644 0 00.198-.472.644.644 0 00-.198-.471.622.622 0 00-.465-.199.644.644 0 00-.472.199.644.644 0 00-.198.471c0 .183.064.34.191.472zm0-2.14a.652.652 0 00.479.199.622.622 0 00.465-.199.644.644 0 00.198-.471.63.63 0 00-.198-.472.622.622 0 00-.465-.198.644.644 0 00-.472.198.644.644 0 00-.198.472c0 .182.064.34.191.471zm5.161 6.973a.7.7 0 00.342.082c.255 0 .456-.116.602-.349l3.056-4.778a1.27 1.27 0 00.116-.219.587.587 0 00.054-.239.506.506 0 00-.191-.41.661.661 0 00-.43-.157c-.215 0-.393.116-.534.348l-2.7 4.327L5.97 8.146a.713.713 0 00-.252-.225.567.567 0 00-.28-.069.568.568 0 00-.425.185.599.599 0 00-.17.43c0 .155.059.308.177.458l1.614 1.97c.095.113.193.2.293.259z",clipRule:"evenodd"})}),j=(0,x.I)("cursorArrowClickRays",{viewBox:"0 0 16 16",svg:(0,v.jsx)("path",{d:"M7.997 3.766a.604.604 0 01-.595-.595V1.175c0-.322.274-.595.595-.595.328 0 .602.273.602.595V3.17a.606.606 0 01-.602.595zM4.948 4.955a.594.594 0 01-.84 0L2.705 3.54a.607.607 0 010-.84.607.607 0 01.84.006l1.402 1.408a.594.594 0 010 .841zm6.023.068a.607.607 0 010-.84l1.422-1.415a.598.598 0 01.834 0 .602.602 0 010 .847l-1.409 1.408a.602.602 0 01-.847 0zm-3.514 7.725l.062-5.462c.006-.253.266-.349.437-.17l3.74 3.834c.184.198.054.445-.199.458l-1.476.062 1.23 2.843a.241.241 0 01-.11.329l-.683.266c-.123.055-.26-.013-.314-.137l-1.17-2.891-1.038 1.046c-.178.17-.486.089-.479-.178zM3.779 7.997a.606.606 0 01-.601.595H1.175a.604.604 0 01-.595-.595c0-.321.274-.595.595-.595h2.003c.328 0 .601.274.601.595zm8.45 0c0-.321.273-.595.594-.595h1.996c.329 0 .602.274.602.595a.606.606 0 01-.602.595h-1.996a.604.604 0 01-.595-.595zm-7.212 2.98a.594.594 0 010 .841l-1.409 1.409a.616.616 0 01-.847-.007.614.614 0 01.007-.841l1.408-1.402c.232-.225.622-.225.84 0z"})}),M=(0,x.I)("database",{viewBox:"0 0 20 20",svg:(0,v.jsx)("path",{d:"M16.25 5v1.25c0 1.381-2.797 2.5-6.25 2.5s-6.25-1.119-6.25-2.5V5c0-1.381 2.797-2.5 6.25-2.5s6.25 1.119 6.25 2.5zM10 14.375c-2.784 0-4.744-.569-5.963-1.378-.187.237-.287.49-.287.753V15c0 1.381 2.797 2.5 6.25 2.5s6.25-1.119 6.25-2.5v-1.25c0-.262-.103-.516-.287-.753-1.22.806-3.179 1.378-5.963 1.378zM10 10c-2.784 0-4.744-.569-5.963-1.378-.187.237-.287.49-.287.753v1.25c0 1.381 2.797 2.5 6.25 2.5s6.25-1.119 6.25-2.5v-1.25c0-.262-.103-.516-.287-.753C14.742 9.428 12.784 10 10 10z"})});var _=o(84169),T=o(53523);const k=(0,x.I)("rightArrowEmpty",{viewBox:"0 0 22 18",svg:(0,v.jsx)("path",{d:"M21.582 8.955c0-.332-.117-.693-.498-1.055L13.379.693C12.86.205 12.539 0 12.06 0c-.683 0-1.171.537-1.171 1.191v3.692h-7.92c-1.543 0-2.442.879-2.442 2.392v3.37c0 1.513.899 2.392 2.442 2.392h7.92v3.73c0 .655.488 1.143 1.152 1.143.479 0 .87-.195 1.338-.635L21.084 10c.371-.352.498-.723.498-1.045zm-1.758 0c0 .059-.02.107-.097.186l-6.963 6.582a.219.219 0 01-.166.087c-.079 0-.137-.058-.137-.146v-3.78c0-.224-.098-.322-.322-.322h-9.15c-.626 0-.987-.36-.987-.996V7.354c0-.635.361-.997.986-.997h9.15c.225 0 .323-.097.323-.322V2.158c0-.078.059-.137.146-.137.059 0 .118.04.166.079l6.954 6.67c.068.068.097.126.097.185z"})});var V=o(33507),P=o(37612),A=o(82990),F=o(47307),I=o(95193),Z=o(97372),B=o(94166),D=o(64275),K=o(64921);function O(e){window.__c={n:"CollectionSettingsNotification"};const{title:t,icon:o,style:n,children:i,right:r,showCloseButton:a,onClose:s}=e,l=(0,f.Fg)(),c=(0,v.jsx)(K.Z,{onClick:s,style:{display:"flex",alignItems:"center",justifyContent:"center",background:void 0,borderRadius:6,width:16,height:16},children:(0,D.D)({width:14,fill:l.mediumTextColor})});return(0,v.jsxs)("div",{style:{padding:"12px 16px",margin:"4px 12px",fontSize:12,background:l.accentColors.orange[50],borderRadius:6,...n},children:[t&&(0,v.jsxs)("div",{style:{display:"flex",marginBottom:2,alignItems:"center"},children:[o,(0,v.jsx)("div",{style:{fontWeight:A.Z.fontWeight.medium,flexGrow:1},children:t}),a?c:r]}),i]})}var R=o(92996),E=o(96367),H=o(149),L=o(21202),N=o(39927),W=o(70203),z=o(97880),U=o(68305),G=o(36821),$=o(79797);function q(e){var t;const{collectionContextStore:o}=e,i=(0,r.O7)(),s=(0,a.VK)((()=>o.sprintSettingsContextStore.state),[o.sprintSettingsContextStore]),l=(0,a.VK)((()=>null==s?void 0:s.permissionsContext),[s]),c=(0,a.VK)((()=>{var e;return"active"===(null==s||null===(e=s.automationContext)||void 0===e?void 0:e.automationStore.getStatus())}),[null==s||null===(t=s.automationContext)||void 0===t?void 0:t.automationStore]),d=(0,a.VK)((()=>{var e;return o.collectionStore()===(null==s?void 0:s.taskCollectionStore)&&(null===(e=o.collectionViewStore())||void 0===e?void 0:e.getFormat().app_config_uri)!==R.g3}),[o,null==s?void 0:s.taskCollectionStore]),[u,g]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{!async function(){if(g(void 0),!s)return;const{sprintCollectionViewBlockStore:e,sprintCollectionStore:t}=s;if(!e||!t)return;const o=t.getSchema(),n=E.qB[R.p$].current.reducer,r=await U.tA(i,{source:"automation",parentRecordStore:e,collectionPointer:t.getSpaceShardedPointer(),filter:n.getCombinatorFilter(o),limit:1});H.x.isFail(r)||g(r.value.blockIds[0])}()}),[i,s]);const m=(0,a.VK)((()=>{const e=null==s?void 0:s.sprintCollectionViewBlockStore;if(e&&u)return $.G.createChildStore(e,{id:u,table:L.iU,spaceId:e.getSpaceId()})}),[u,null==s?void 0:s.sprintCollectionViewBlockStore]),S=(0,a.VK)((()=>{if(!m)return;const e=m.getPropertyValue(R.b0.Dates);if(!e)return;const t=(0,W.nai)(e)[0];return t&&"daterange"===t.type?t:void 0}),[m]),f=(0,a.VK)((()=>{var e,t,o;if(!s)return;const n=(null===(e=s.automationContext)||void 0===e||null===(e=e.automationActionStore.getConfig())||void 0===e?void 0:e.complete_sprint_action)??N.i.actionConfig.complete_sprint_action,i="active"===(null===(t=s.automationContext)||void 0===t?void 0:t.automationStore.getStatus()),r=null===(o=s.automationContext)||void 0===o?void 0:o.automationStore.getRecurrence();return{autoCompleteSprints:i,actionConfig:{complete_sprint_action:n},recurrenceConfig:{interval:(null==r?void 0:r.interval)??N.i.recurrenceConfig.interval,weekdays:(null==r?void 0:r.weekdays)??N.i.recurrenceConfig.weekdays}}}),[s]),y=(0,a.VK)((()=>(0,z.$K)(m)&&(0,z.$K)(f)),[m,f]),h=n.useCallback((e=>{y&&p.createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:i,perform:t=>{s&&s.sprintCollectionStore&&s.automationContext&&m&&G.KV({environment:i,transaction:t,automationStore:s.automationContext.automationStore,currentSprintBlockStore:m,newDuration:e})}})}),[y,m,i,s]),x=n.useCallback((e=>{y&&p.createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:i,perform:t=>{s&&s.sprintCollectionStore&&s.automationContext&&m&&G.g9({environment:i,transaction:t,automationStore:s.automationContext.automationStore,currentSprintBlockStore:m,newWeekday:e})}})}),[y,m,i,s]),v=n.useCallback((e=>{y&&p.createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:i,perform:t=>{s&&s.sprintCollectionStore&&s.automationContext&&m&&G.jc({environment:i,transaction:t,automationStore:s.automationContext.automationStore,actionStore:s.automationContext.automationActionStore,currentSprintBlockStore:m,newAutocompleteStatus:e})}})}),[y,m,i,s]),C=n.useCallback((e=>{y&&p.createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:i,perform:t=>{s&&s.sprintCollectionStore&&s.automationContext&&G.U6({transaction:t,actionStore:s.automationContext.automationActionStore,newRemainingTasksBehavior:e})}})}),[y,i,s]),w=n.useCallback((async()=>{await G.ys({environment:i,collectionContextStore:o})}),[o,i]),b=n.useCallback((async e=>{s&&await G.m8({environment:i,collectionContextStore:o,sprintSettingsContext:s,sprintBoardViewBlockIds:e})}),[o,i,s]),j=n.useCallback((()=>{s&&G.YD({environment:i,collectionContextStore:o,currentViewBlockStore:s.currentCollectionViewBlockStore,taskCollectionViewBlockStore:s.taskCollectionViewBlockStore})}),[o,i,s]);return{sprintSettingsConfig:f,sprintSettingsPermissionsContext:l,turnOnSprints:w,turnOffSprints:b,automaticSprintCompletionEnabled:c,canManageSprintFromThisView:d,currentSprintDateRange:S,manageSprintFromThisView:j,sprintSettingsConfigUpdater:{canUpdateSprintSettingsConfig:y,handleSprintDurationChange:h,handleSprintStartWeekdayChange:x,handleSprintAutoCompleteChange:v,handleSprintRemainingTasksBehaviorChange:C}}}var Q=o(42922),Y=o(52275),X=o(31945),J=o(16354),ee=o(78140),te=o(32163),oe=o(53437),ne=o(72495),ie=o(86825),re=o(15047),ae=o(29369),se=o(54642),le=o(40663),ce=o(77907);const de="https://www.notion.so/help/sprints",ue=[1,2,3,4,5,6,7,8],pe={1:{key:"one_week",value:1},2:{key:"two_weeks",value:2},3:{key:"three_weeks",value:3},4:{key:"four_weeks",value:4},5:{key:"five_weeks",value:5},6:{key:"six_weeks",value:6},7:{key:"seven_weeks",value:7},8:{key:"eight_weeks",value:8}},ge={MO:"Monday",TU:"Tuesday",WE:"Wednesday",TH:"Thursday",FR:"Friday",SA:"Saturday",SU:"Sunday"},me=(0,l.defineMessages)({sprintsMenuTitle:{id:"sprintSettingsMenu.label",defaultMessage:"Sprints"},setupSprintsTitle:{id:"sprintSettingsMenu.setupSprints.label",defaultMessage:"Set up sprints"},setupSprintsCaption:{id:"sprintSettingsMenu.setupSprints.caption",defaultMessage:"Use sprints to regularly tackle a group of tasks in a recurring, set amount of time."},setupSprintsTeamspaceStatement:{id:"sprintSettingsMenu.setupSprintsTeamspaceStatement.caption",defaultMessage:"We'll also add to your teamspace:"},setupSprintsSprintBoardPageStatement:{id:"sprintSettingsMenu.setupSprintsSprintBoardPageStatement.caption",defaultMessage:"<bold>Sprint board</bold>: To manage tasks and plan your work"},setupSprintsSprintsDatabaseStatement:{id:"sprintSettingsMenu.setupSprintsSprintsDatabaseStatement.caption",defaultMessage:"<bold>Sprints database</bold>: To keep a historical record of what you accomplished"},manual:{id:"sprintSettingsMenu.manual.label",defaultMessage:"Manual"},automatic:{id:"sprintSettingsMenu.automatic.label",defaultMessage:"Auto"},off:{id:"sprintSettingsMenu.off.label",defaultMessage:"Off"},completeSprintNextSprintActionMenuOptionText:{id:"sprintSettingsMenu.remainingTasks.moveToNextSprintOption.label",defaultMessage:"Move to next sprint"},completeSprintNextSprintActionSelectedText:{id:"sprintSettingsMenu.remainingTasks.moveToNextSprintOption.selected.label",defaultMessage:"Next sprint"},completeSprintBacklogActionMenuOptionText:{id:"sprintSettingsMenu.remainingTasks.moveToBacklogOption.label",defaultMessage:"Move to backlog"},completeSprintBacklogActionSelectedText:{id:"sprintSettingsMenu.remainingTasks.moveToBacklogOption.selected.label",defaultMessage:"Backlog"},completeSprintKeepInCurrentSprintActionMenuOptionText:{id:"sprintSettingsMenu.remainingTasks.keepInCurrentSprint.label",defaultMessage:"Keep in current sprint"},completeSprintKeepInCurrentSprintActionSelectedText:{id:"sprintSettingsMenu.remainingTasks.keepInCurrentSprint.selected.label",defaultMessage:"Current sprint"},automatedSprintsToggleTitle:{id:"sprintSettingsMenu.automatedSprintsToggle.label",defaultMessage:"Automated sprints"},automatedSprintsToggleCaption:{id:"sprintSettingsMenu.automatedSprintsToggle.caption",defaultMessage:"Sprints complete automatically before the start of the next sprint."},duration:{id:"sprintSettingsMenu.duration.label",defaultMessage:"Duration"},durationMenuOptionText:{id:"sprintSettingsMenu.duration.option.label",defaultMessage:"{durationValue, plural, one {1 week} other {{durationValue} weeks}}"},startOn:{id:"sprintSettingsMenu.startOn.label",defaultMessage:"Start on"},weekdayOption:{id:"sprintSettings.weekdayOption.label",defaultMessage:"{weekdayName}s"},incompleteTasks:{id:"sprintSettingsMenu.incompleteTasks.label",defaultMessage:"Incomplete tasks"},turnOnSprints:{id:"sprintSettingsMenu.turnOnSprints.button.label",defaultMessage:"Turn on sprints"},turnOffSprints:{id:"sprintSettingsMenu.turnOffSprints.button.label",defaultMessage:"Turn off sprints"},turnOffSprintsModalTitle:{id:"sprintSettingsMenu.turnOffSprints.modal.title.label",defaultMessage:"Turn off sprints?"},turnOffSprintsModalNoSprintBoardsDescription:{id:"sprintSettingsMenu.turnOffSprints.modal.default.description",defaultMessage:"This will delete your sprints database and its linked views."},turnOffSprintsModalWithSprintBoardsDescription:{id:"sprintSettingsMenu.turnOffSprints.modal.withSprintBoards.description",defaultMessage:"This will delete your sprint board(s), sprints database and its linked views."},turnOffAndDeleteModalButton:{id:"sprintSettingsMenu.turnOffAndDeleteModal.button.label",defaultMessage:"Turn off and delete"},learnSprintsTitle:{id:"sprintSettingsMenu.learnSprints.button.label",defaultMessage:"Learn about sprints"},manageSprintFromThisView:{id:"sprintSettingsMenu.manageSprintFromThisView.label",defaultMessage:"Manage sprint from this view"},manageSprintFromThisViewModalTitle:{id:"sprintSettingsMenu.manageSprintFromThisView.modal.title.label",defaultMessage:"Manage sprint from this view?"},manageSprintFromThisViewModalButton:{id:"sprintSettingsMenu.manageSprintFromThisView.button.label",defaultMessage:"Update view"},manageSprintFromThisViewModalAutomaticSprintCompletionDescription:{id:"sprintSettingsMenu.manageSprintFromThisView.modal.automaticSprintCompletion.description",defaultMessage:"The view will be updated with filters for the current sprint."},manageSprintFromThisViewModalManualSprintCompletionDescription:{id:"sprintSettingsMenu.manageSprintFromThisView.modal.manualSprintCompletion.description",defaultMessage:"The view will be updated with filters for the current sprint and a button to complete sprints will be displayed."},sprintStartDateToday:{id:"sprintSettingsMenu.sprintStartDateToday",defaultMessage:"Next sprint starts <time>today</time>}"},sprintStartDateFuture:{id:"sprintSettingsMenu.sprintStartDateFuture",defaultMessage:"Next sprint starts in {days} {days, plural, one {day} other {days}} <time>({formattedDate}</time>)"},sprintStartDateShouldStartPast:{id:"sprintSettingsMenu.sprintStartDateShouldStartPast",defaultMessage:"Next sprint should have started {days} {days, plural, one {day} other {days}} ago <time>({formattedDate})</time>"},sprintStartDateShouldStartToday:{id:"sprintSettingsMenu.sprintStartDateShouldStartToday",defaultMessage:"Next sprint should start <time>today</time>"},sprintStartDateShouldStartFuture:{id:"sprintSettingsMenu.sprintStartDateShouldStartFuture",defaultMessage:"Next sprint should start in {days} {days, plural, one {day} other {days}} <time>({formattedDate})</time>"}}),Se={complete_sprint_and_move_incomplete_tasks_to_next_sprint:{menuOptionText:me.completeSprintNextSprintActionMenuOptionText,selectedText:me.completeSprintNextSprintActionSelectedText},complete_sprint_and_move_incomplete_tasks_to_backlog:{menuOptionText:me.completeSprintBacklogActionMenuOptionText,selectedText:me.completeSprintBacklogActionSelectedText},complete_sprint:{menuOptionText:me.completeSprintKeepInCurrentSprintActionMenuOptionText,selectedText:me.completeSprintKeepInCurrentSprintActionSelectedText}};function fe(e){return(0,v.jsx)(l.FormattedMessage,{...Se[e.completeSprintAction].menuOptionText})}function ye(e){return(0,v.jsx)(l.FormattedMessage,{...Se[e.completeSprintAction].selectedText})}function he(e){const{weekday:t}=e;return(0,v.jsx)(l.FormattedMessage,{...me.weekdayOption,values:{weekdayName:ge[t]}})}function xe(e){return pe[e]}function ve(e){const{sprintDurationValue:t}=e;return(0,v.jsx)(l.FormattedMessage,{...me.durationMenuOptionText,values:{durationValue:pe[t].value}})}function Ce(e){const{numOfSprintBoards:t}=e;return t>0?(0,v.jsx)(l.FormattedMessage,{...me.turnOffSprintsModalWithSprintBoardsDescription}):(0,v.jsx)(l.FormattedMessage,{...me.turnOffSprintsModalNoSprintBoardsDescription})}function we(e){const{automaticSprintCompletionEnabled:t}=e;return t?(0,v.jsx)(l.FormattedMessage,{...me.manageSprintFromThisViewModalAutomaticSprintCompletionDescription}):(0,v.jsx)(l.FormattedMessage,{...me.manageSprintFromThisViewModalManualSprintCompletionDescription})}function be(e){window.__c={n:"SprintSettingsMenu"};const{collectionContextStore:t,collectionSettingsStore:o}=e,{sprintSettingsConfig:n,currentSprintDateRange:i,sprintSettingsPermissionsContext:r,sprintSettingsConfigUpdater:a,turnOffSprints:s,turnOnSprints:l,automaticSprintCompletionEnabled:c,canManageSprintFromThisView:d,manageSprintFromThisView:u}=q({collectionContextStore:t,collectionSettingsStore:o});if(!r||!r.canEdit||!n)return null;let p;return p=r.sprintsEnabled?(0,v.jsx)(je,{...e,updateSprintSettingsConfig:a,onTurnOffSprints:s,automaticSprintCompletionEnabled:c,currentSprintDateRange:i,canManageSprintFromThisView:d,onManageSprintFromThisView:u,sprintSettingsConfig:n}):(0,v.jsx)(Me,{...e,onTurnOnSprints:l}),p}function je(e){window.__c={n:"SprintSettingsEnabledMenuView"};const{sprintSettingsConfig:t,automaticSprintCompletionEnabled:o,currentSprintDateRange:n,canManageSprintFromThisView:i,updateSprintSettingsConfig:r,collectionContextStore:a,onTurnOffSprints:s,onManageSprintFromThisView:c}=e,d=Re(),u=[];return u.push((0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(ne.Z,{topBorder:!0,disableMobileBorders:!0,children:[i&&(0,v.jsx)(Fe,{automaticSprintCompletionEnabled:o,manageSprintFromThisView:c}),(0,v.jsx)(Ae,{turnOffSprints:s,collectionContextStore:a})]},"turn-off-sprints-section"),(0,v.jsx)(ne.Z,{topBorder:!0,children:(0,v.jsx)(J.Z,{href:de,external:!0,children:(0,v.jsx)(B.Z,{icon:_.m,iconStyle:d.icon,title:(0,v.jsx)(l.FormattedMessage,{...me.learnSprintsTitle}),isGray:!0})})})]})),(0,v.jsxs)(Z.ZP,{...e,title:(0,v.jsx)(l.FormattedMessage,{...me.sprintsMenuTitle}),footer:u,children:[(0,v.jsx)(_e,{automaticSprintCompletionEnabled:o,currentSprintDateRange:n}),(0,v.jsxs)(ne.Z,{children:[(0,v.jsx)(Ze,{onChange:r.handleSprintDurationChange,disabled:!r.canUpdateSprintSettingsConfig,sprintSettingsConfig:t}),(0,v.jsx)(Be,{onChange:r.handleSprintStartWeekdayChange,disabled:!r.canUpdateSprintSettingsConfig,sprintSettingsConfig:t}),(0,v.jsx)(De,{onChange:r.handleSprintRemainingTasksBehaviorChange,disabled:!r.canUpdateSprintSettingsConfig,sprintSettingsConfig:t})]}),(0,v.jsx)(ne.Z,{topBorder:!0,children:(0,v.jsx)(Ie,{onChange:r.handleSprintAutoCompleteChange,sprintSettingsConfig:t})})]})}function Me(e){window.__c={n:"SprintSettingsDisabledMenuView"};const{onTurnOnSprints:t}=e,o=Re(),n=[];return n.push((0,v.jsx)(ne.Z,{disableMobileBorders:!0,children:(0,v.jsx)("div",{style:o.buttonWrap,children:(0,v.jsx)(Q.Z,{style:o.button,onClick:async()=>{await t()},isLarge:!0,children:(0,v.jsx)(l.FormattedMessage,{...me.turnOnSprints})})})},"turn-on-sprints-section")),(0,v.jsx)(Z.ZP,{...e,title:(0,v.jsx)(l.FormattedMessage,{...me.setupSprintsTitle}),footer:n,children:(0,v.jsxs)(ne.Z,{disableMobileBorders:!0,children:[(0,v.jsx)(Te,{}),(0,v.jsx)(ke,{}),(0,v.jsx)(Ve,{})]})})}function _e(e){window.__c={n:"SprintSettingsStartDateHeader"};const{automaticSprintCompletionEnabled:t,currentSprintDateRange:o}=e,n=Re();if(!o)return null;const i=S.ou.fromISO(o.end_date).plus({days:1});return(0,v.jsx)(O,{style:n.sprintStartDateHeader,children:(0,v.jsxs)("div",{style:n.sprintStartDateHeaderWrap,children:[k(n.sprintStartDateHeaderIcon),(0,v.jsx)(Oe,{nextSprintStartDate:i,automaticSprintCompletionEnabled:t})]})})}function Te(){window.__c={n:"SprintSettingsMenuDescription"};const e=Re();return(0,v.jsx)("div",{style:{...e.menuDescriptionContainer,...e.menuDescriptionText},children:(0,v.jsx)(l.FormattedMessage,{...me.setupSprintsCaption})})}function ke(){window.__c={n:"SprintSettingsPreviewMedia"};const e=Re();return(0,v.jsx)("div",{style:e.mediaWrap,children:(0,v.jsx)("img",{src:y.Z.images.appPackages.sprintsTurnOnPreviewPng,style:e.media})})}function Ve(){window.__c={n:"SprintSettingsDisclaimer"};const e=Re(),t=t=>(0,v.jsx)("span",{style:e.boldText,children:t});return(0,v.jsxs)("div",{style:e.disclaimerWrap,children:[(0,v.jsx)("div",{children:(0,v.jsx)(l.FormattedMessage,{...me.setupSprintsTeamspaceStatement})}),(0,v.jsx)(Pe,{text:(0,v.jsx)(l.FormattedMessage,{...me.setupSprintsSprintBoardPageStatement,values:{bold:t}}),icon:V.L}),(0,v.jsx)(Pe,{text:(0,v.jsx)(l.FormattedMessage,{...me.setupSprintsSprintsDatabaseStatement,values:{bold:t}}),icon:M})]})}function Pe(e){window.__c={n:"SprintSettingsDisclaimerSubitem"};const{text:t,icon:o}=e,n=Re();return(0,v.jsxs)("div",{style:n.disclaimerSubitem,children:[(0,v.jsx)("div",{children:o(n.disclaimerSubitemIcon)}),(0,v.jsx)("div",{children:t})]})}function Ae(e){window.__c={n:"TurnOffSprintsButton"};const{collectionContextStore:t,turnOffSprints:o}=e,n=(0,r.O7)(),i=(0,a.VK)((()=>t.sprintSettingsContextStore.state),[t.sprintSettingsContextStore]),[{value:s}]=(0,h.r5)((async()=>{if(null==i||!i.taskCollectionStore||null==i||!i.taskCollectionViewBlockStore)return;const e=await async function(e){var t;const{environment:o,collectionStore:n,collectionViewBlockStore:i}=e,{appConfigs:r}=await ce.deps.AppTemplates.loader(),a=i.getSpaceId(),s=i.getParentStore(),l=null===(t=n.getFormat())||void 0===t?void 0:t.app_config_uri,c=l&&(0,le.YB)(r(),l);if(!s||s.table!==re.bx&&s.table!==L.iU&&s.table!==ae.e0||!c)return;const d=await se.getSprintBoardViewBlocks(o,{spaceId:a,taskCollectionId:n.id,parentId:s.id,parentTable:s.table});return"success"===(null==d?void 0:d.type)?d.data.result:[]}({environment:n,collectionStore:i.taskCollectionStore,collectionViewBlockStore:i.taskCollectionViewBlockStore});return e}),[n,null==i?void 0:i.taskCollectionStore,null==i?void 0:i.taskCollectionViewBlockStore]),c=Re();return(0,v.jsx)(B.Z,{icon:P.y,title:(0,v.jsx)(l.FormattedMessage,{...me.turnOffSprints}),isRed:!0,iconStyle:c.icon,onClick:()=>{F.showDialog({description:(0,v.jsx)(Ce,{numOfSprintBoards:s?s.length:0}),message:(0,v.jsx)("div",{style:c.modalTitle,children:(0,v.jsx)(l.FormattedMessage,{...me.turnOffSprintsModalTitle})}),innerStyle:c.modalInnerStyle,showCancel:!0,keepFocus:!0,items:[{label:(0,v.jsx)(l.FormattedMessage,{...me.turnOffAndDeleteModalButton}),color:"red",onAccept:async()=>{await o(s??[])}}]})}})}function Fe(e){window.__c={n:"ManageSprintFromThisViewButton"};const{automaticSprintCompletionEnabled:t,manageSprintFromThisView:o}=e,n=Re();return(0,v.jsx)(B.Z,{icon:j,title:(0,v.jsx)(l.FormattedMessage,{...me.manageSprintFromThisView}),iconStyle:n.icon,onClick:()=>{F.showDialog({description:(0,v.jsx)(we,{automaticSprintCompletionEnabled:t}),message:(0,v.jsx)("div",{style:n.modalTitle,children:(0,v.jsx)(l.FormattedMessage,{...me.manageSprintFromThisViewModalTitle})}),innerStyle:n.modalInnerStyle,showCancel:!0,keepFocus:!0,items:[{label:(0,v.jsx)(l.FormattedMessage,{...me.manageSprintFromThisViewModalButton}),color:"blue",onAccept:o}]})}})}function Ie(e){window.__c={n:"AutoCompleteSprintSwitcherMenuItem"};const{onChange:t,sprintSettingsConfig:o}=e,n=Re();return(0,v.jsx)(ie.Z,{title:(0,v.jsx)(l.FormattedMessage,{...me.automatedSprintsToggleTitle}),caption:(0,v.jsx)(l.FormattedMessage,{...me.automatedSprintsToggleCaption}),focused:!1,on:o.autoCompleteSprints,onClick:()=>{t(!o.autoCompleteSprints)},style:{alignItems:void 0},icon:(0,T.N)(n.icon),shouldWrapCaption:!0})}function Ze(e){const{onChange:t,sprintSettingsConfig:o,disabled:n}=e,i=xe(o.recurrenceConfig.interval),r=ue.map((e=>xe(e)));return(0,v.jsx)(Ke,{title:(0,v.jsx)(l.FormattedMessage,{...me.duration}),right:(0,v.jsx)(ve,{sprintDurationValue:i.value}),icon:C,getMenuItems:e=>r.map((o=>{const r={key:o.key,render:e=>(0,v.jsx)(Y.Z,{...e,disabled:n,title:(0,v.jsx)(ve,{sprintDurationValue:o.value}),checkState:o.key===i.key}),action:()=>{t(o.value),e.close()}};return r})),showChevron:!0})}function Be(e){const{onChange:t,sprintSettingsConfig:o,disabled:n}=e,i=o.recurrenceConfig.weekdays[0],r=["SU","MO","TU","WE","TH","FR","SA"];return(0,v.jsx)(Ke,{title:(0,v.jsx)(l.FormattedMessage,{...me.startOn}),icon:w.C,right:(0,v.jsx)(he,{weekday:i}),getMenuItems:e=>r.map((o=>{const r={key:o,render:e=>(0,v.jsx)(Y.Z,{...e,disabled:n,title:(0,v.jsx)(he,{weekday:o}),checkState:o===i}),action:()=>{t(o),e.close()}};return r})),showChevron:!0})}function De(e){const{onChange:t,sprintSettingsConfig:o,disabled:n}=e,i=o.actionConfig.complete_sprint_action,r=["complete_sprint_and_move_incomplete_tasks_to_next_sprint","complete_sprint_and_move_incomplete_tasks_to_backlog","complete_sprint"];return(0,v.jsx)(Ke,{title:(0,v.jsx)(l.FormattedMessage,{...me.incompleteTasks}),right:(0,v.jsx)(ye,{completeSprintAction:i}),icon:b,getMenuItems:e=>r.map((o=>{const r={key:o,render:e=>(0,v.jsx)(Y.Z,{...e,disabled:n,title:(0,v.jsx)(fe,{completeSprintAction:o}),checkState:o===i}),action:()=>{t(o),e.close()}};return r})),showChevron:!0})}function Ke(e){window.__c={n:"DropdownButton"};const{getMenuItems:t}=e,o=(0,r.Fy)(),n=Re(),i=(0,I.F)({width:250});return(0,v.jsx)(X.ZP,{popupType:o.isMobile?oe.kQ.SlideUp:oe.kQ.Popup,alignmentToOrigin:X.vR.End,placementToOrigin:X.pO.Bottom,renderOrigin:t=>(0,v.jsx)(B.Z,{...e,iconStyle:n.icon,...t}),render:e=>(0,v.jsx)(ee.Z,{...i,children:(0,v.jsx)(te.Z,{type:te.i.Vertical,sections:[{key:0,render:e=>(0,v.jsx)(ne.Z,{enableActionSheetTitle:!0,...e}),items:t(e)}],initialFocus:0})})})}function Oe(e){const{nextSprintStartDate:t,automaticSprintCompletionEnabled:o}=e,n=S.ou.local().startOf("day"),i=t.diff(n,"days").days,r=t.toLocaleString({weekday:"short",month:"short",day:"numeric"}),a=e=>(0,v.jsx)("time",{dateTime:t.toISODate(),children:e});return o?0===i?(0,v.jsx)("div",{children:(0,v.jsx)(l.FormattedMessage,{...me.sprintStartDateToday,values:{time:a}})}):(0,v.jsx)("div",{children:(0,v.jsx)(l.FormattedMessage,{...me.sprintStartDateFuture,values:{time:a,days:i,formattedDate:r}})}):i<0?(0,v.jsx)("div",{children:(0,v.jsx)(l.FormattedMessage,{...me.sprintStartDateShouldStartPast,values:{time:a,days:Math.abs(i),formattedDate:r}})}):0===i?(0,v.jsx)("div",{children:(0,v.jsx)(l.FormattedMessage,{...me.sprintStartDateShouldStartToday,values:{time:a}})}):(0,v.jsx)("div",{children:(0,v.jsx)(l.FormattedMessage,{...me.sprintStartDateShouldStartFuture,values:{time:a,days:i,formattedDate:r}})})}function Re(){const e=(0,r.Fy)();return(0,f.yK)((t=>({icon:{width:16,height:"auto"},menuDescriptionContainer:{margin:"0px 12px"},menuDescriptionText:{fontSize:e.isMobile?A.Z.fontSize.UISmall.mobile:A.Z.fontSize.UISmall.desktop,color:t.mediumTextColor,fontWeight:A.Z.fontWeight.regular,marginLeft:14},button:{width:"100%"},buttonWrap:{margin:"0px 12px"},disclaimerWrap:{margin:"0px 12px",fontSize:e.isMobile?A.Z.fontSize.UIRegular.mobile:A.Z.fontSize.UIRegular.desktop,color:t.mediumTextColor,fontWeight:A.Z.fontWeight.regular},disclaimerSubitem:{display:"flex",padding:"0px 10px",margin:"7px 0px",gap:7},disclaimerSubitemIcon:{color:t.lightIconColor,width:20,height:20,marginTop:e.isMobile?3:1},boldText:{color:t.regularTextColor,fontWeight:A.Z.fontWeight.semibold},mediaWrap:{margin:"0px 12px"},media:{margin:"15px 0px 10px 0px",width:"100%",height:116,border:`1px solid ${t.accentColors.washGlass[0]}`,borderRadius:"5px"},mediaIcon:{width:40,height:40,color:t.lightIconColor},modalTitle:{fontWeight:A.Z.fontWeight.semibold,fontSize:18},modalInnerStyle:{textAlign:"center"},modalReferencedPageName:{color:t.darkTextColor,fontWeight:A.Z.fontWeight.semibold},sprintStartDateHeaderWrap:{display:"flex",flexDirection:"row",alignItems:"start",gap:"8px",color:t.mediumTextColor},sprintStartDateHeaderIcon:{width:16,height:"auto",marginBlockStart:3},sprintStartDateHeader:{background:t.surface.wash}})),[e])}var Ee=o(43261),He=o.n(Ee),Le=o(66897),Ne=o(63362),We=o(3865),ze=o(28751),Ue=o(23290),Ge=o(76205),$e=o(99036),qe=o(80951),Qe=o(84619),Ye=o(76218),Xe=o(88607),Je=o(91856),et=o(65422),tt=o(60019),ot=o(20669),nt=o(25651),it=o(47453),rt=o(24600),at=o(42283),st=o(63030),lt=o(69196),ct=o(53016),dt=o(48524),ut=o(43393),pt=o(32426),gt=o(71500);const mt=(0,x.I)("typesLocation",{viewBox:"0 0 25 25",svg:(0,v.jsxs)("g",{children:[(0,v.jsx)("path",{d:"M12.105 24.21C18.7369 24.21 24.2121 18.7273 24.2121 12.105C24.2121 5.47312 18.7273 0 12.0954 0C5.47523 0 0 5.47312 0 12.105C0 18.7273 5.48484 24.21 12.105 24.21ZM12.105 21.8255C6.71085 21.8255 2.39412 17.4991 2.39412 12.105C2.39412 6.71085 6.70124 2.38452 12.0954 2.38452C17.4895 2.38452 21.8276 6.71085 21.8276 12.105C21.8276 17.4991 17.4991 21.8255 12.105 21.8255Z"}),(0,v.jsx)("path",{d:"M6.75703 16.5939C6.75703 17.4355 7.28742 17.9479 8.17266 17.9479H16.0416C16.9247 17.9479 17.4476 17.4355 17.4476 16.5939V12.0109L12.4683 7.82758C12.236 7.63047 11.9686 7.64008 11.7363 7.82758L6.75703 12.0013V16.5939ZM13.6692 16.7148H10.5429V12.9969C10.5429 12.7178 10.7283 12.5366 11.0128 12.5366H13.2014C13.4977 12.5366 13.6692 12.7178 13.6692 12.9969V16.7148ZM4.81055 11.2199C4.81055 11.5316 5.04469 11.8138 5.43211 11.8138C5.62593 11.8138 5.78554 11.7083 5.9271 11.5806L11.8111 6.65687C12.0145 6.47477 12.2093 6.49609 12.4052 6.65687L18.2775 11.5806C18.4383 11.7083 18.5883 11.8138 18.7725 11.8138C19.1194 11.8138 19.3941 11.5818 19.3941 11.2391C19.3941 11.0315 19.3228 10.873 19.1653 10.7336L13.0078 5.5661C12.4605 5.10508 11.7558 5.10508 11.2181 5.5661L5.03929 10.7357C4.89141 10.8751 4.81055 11.0507 4.81055 11.2199ZM15.8079 8.35282L17.4623 9.75391V6.88399C17.4623 6.62618 17.3004 6.44501 17.033 6.44501H16.249C15.9912 6.44501 15.8079 6.62618 15.8079 6.88399V8.35282Z"})]})});var St=o(72050),ft=o(55159),yt=o(26774),ht=o(34093),xt=o(92607),vt=o(32623),Ct=o(53866),wt=o(3729),bt=o(108),jt=o(83303),Mt=o(56505),_t=o(8938),Tt=o(94308),kt=o(606),Vt=o(67174),Pt=o(29723),At=o(23704),Ft=o(93377),It=o(82207),Zt=o(84799),Bt=o(99144),Dt=o(4328),Kt=o(73427),Ot=o(72080),Rt=o(93060),Et=o(20239),Ht=o(76954),Lt=o(87181),Nt=o(56812),Wt=o(91494),zt=o(68894),Ut=o(62385),Gt=o(26388),$t=o(65183),qt=o(54802),Qt=o(46654),Yt=o(37034),Xt=o(63474),Jt=o(80444),eo=o(77080),to=o(58812),oo=o(6740),no=o(37989),io=o(33907),ro=o(54497),ao=o(77744);const so=(0,x.I)("bolt",{svg:(0,v.jsx)("path",{d:"M4.629 21.418l8.877-11.416c.166-.205.254-.4.254-.625 0-.371-.293-.654-.703-.654H7.539l2.91-7.598C10.84.12 9.766-.428 9.131.412L.254 11.818c-.166.215-.254.41-.254.626 0 .38.293.663.703.663h5.518l-2.91 7.588c-.391 1.006.683 1.553 1.318.723zm.576-2.627l3.272-7.139H2.44l6.377-8.466-.273-.147-3.262 7.139h6.026l-6.377 8.467z"}),viewBox:"0 0 14 22"}),lo=(0,x.I)("boltSlash",{svg:(0,v.jsx)("path",{d:"M1.248 12.444c0 .38.293.663.703.663h5.517l-2.91 7.588c-.39 1.006.684 1.553 1.318.723l4.405-5.664-1.094-1.094-3.008 3.985.274.146 2.129-4.746-2.413-2.393H3.69l1.074-1.416-1.142-1.142-2.12 2.725c-.166.214-.253.41-.253.624zm4.716-6.368L7.058 7.17l3.008-3.984-.274-.147-2.128 4.746 2.392 2.393h2.5l-1.074 1.416 1.143 1.142 2.128-2.734c.166-.205.254-.4.254-.625 0-.371-.293-.654-.703-.654H8.787l2.91-7.598c.39-1.006-.684-1.553-1.319-.713zm8.995 12.735a.754.754 0 001.064 0 .754.754 0 000-1.065L1.287 3.01a.766.766 0 00-1.075 0 .773.773 0 000 1.064z"}),viewBox:"0 0 17 22"});var co=o(56666),uo=o(88437),po=o(73063),go=o(61766),mo=o(35294);const So=(0,l.defineMessages)({automationSummaryCardMoreButtonAriaLabel:{defaultMessage:"More",id:"automations.AutomationSummaryCard.MoreActionsButton.ariaLabel"},automationSummaryCardMoreMenuEditTitle:{defaultMessage:"Edit",id:"automations.AutomationSummaryCard.MoreActionsMenu.Edit.title"},automationSummaryCardMoreMenuDuplicateTitle:{defaultMessage:"Duplicate",id:"automations.AutomationSummaryCard.MoreActionsMenu.Duplicate.title"},automationSummaryCardMoreMenuPauseTitle:{defaultMessage:"Pause",id:"automations.AutomationSummaryCard.MoreActionsMenu.Pause.title"},automationSummaryCardMoreMenuResumeTitle:{defaultMessage:"Resume",id:"automations.AutomationSummaryCard.MoreActionsMenu.Resume.title"},automationSummaryCardMoreMenuDeleteTitle:{defaultMessage:"Delete",id:"automations.AutomationSummaryCard.MoreActionsMenu.Delete.title"}});function fo(e){window.__c={n:"AutomationSummaryMoreActionsButton"};const{focused:t,style:o,onEdit:i,onDelete:r,onDuplicate:s,onDisable:c,onEnable:d}=e,u=(0,l.useIntl)(),p=(0,a.qz)(void 0,go.Z),g=(0,mo.d)();(0,n.useEffect)((()=>{t||p.setState({open:!1})}),[t,p]);const m=(0,f.yK)((e=>({iconButton:{border:`1px solid ${e.regularDividerColor}`,height:26,width:26,...o},iconButtonIcon:{width:16}})),[o]);return(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(X.ZP,{stopClickPropagation:!0,popupType:g,alignmentToOrigin:X.vR.Center,placementToOrigin:X.pO.Bottom,originGap:0,renderOrigin:e=>(0,v.jsx)(po.Z,{ariaLabel:u.formatMessage(So.automationSummaryCardMoreButtonAriaLabel),icon:co.o,iconStyle:m.iconButtonIcon,style:m.iconButton,hasBackground:!0,...e}),render:e=>(0,v.jsx)(yo,{onClose:()=>e.close(),onEdit:i,onDelete:r,onDuplicate:s,onDisable:c,onEnable:d}),buttonPopupStore:p})})}function yo(e){window.__c={n:"MoreActionsMenu"};const{onClose:t,onEdit:o,onDelete:n,onDuplicate:i,onDisable:r,onEnable:a}=e,s=(0,l.useIntl)(),c=(0,I.F)(),d=o?{action:()=>{t(),o()},key:"edit",render:e=>(0,v.jsx)(Y.Z,{...e,icon:(0,nt.R)({height:16,width:16}),title:s.formatMessage(So.automationSummaryCardMoreMenuEditTitle)})}:void 0,u=i?{action:()=>{t(),i()},key:"duplicate",render:e=>(0,v.jsx)(Y.Z,{...e,icon:(0,uo.a)({height:16,width:16}),title:s.formatMessage(So.automationSummaryCardMoreMenuDuplicateTitle)})}:void 0,p=r?{action:()=>{t(),r()},key:"disable",render:e=>(0,v.jsx)(Y.Z,{...e,icon:lo({height:16,width:16}),title:s.formatMessage(So.automationSummaryCardMoreMenuPauseTitle)})}:void 0,g=a?{action:()=>{t(),a()},key:"enable",render:e=>(0,v.jsx)(Y.Z,{...e,icon:so({height:16,width:16}),title:s.formatMessage(So.automationSummaryCardMoreMenuResumeTitle)})}:void 0,m=n?{action:()=>{t(),n()},key:"delete",render:e=>(0,v.jsx)(Y.Z,{...e,icon:(0,P.y)({height:16,width:16}),title:s.formatMessage(So.automationSummaryCardMoreMenuDeleteTitle)})}:void 0;return(0,v.jsx)(ee.Z,{...c,children:(0,v.jsx)(te.Z,{type:te.i.Vertical,sections:[{items:[d,u,p,g,m].filter(z.$K),key:"items",render:e=>(0,v.jsx)(ne.Z,{enableActionSheetTitle:!0,topBorder:!0,...e})}],initialFocus:0})})}var ho=o(92864),xo=o(75024);const vo=6;function Co(e){window.__c={n:"AutomationSummaryCard"};const{actions:t,caption:o,focused:i,hasWarning:a,maxIcons:s,onBlur:l,onClick:c,onDelete:d,onDisable:u,onDuplicate:p,onEdit:g,onEnable:m,onFocus:S,onMouseDown:y,onMouseEnter:h,onMouseLeave:x,title:C,triggers:w}=e,{isMobile:b}=(0,r.Fy)(),j=(0,n.useRef)(null),[M,_]=(0,oo.Z)(),[T,k]=(0,no.Z)(),[V,P]=(0,n.useState)(!1),F=b||V||_||k,I=(0,f.yK)((e=>({wrap:{background:e.cardContentBackground,border:`1px solid ${e.regularDividerColor}`,borderRadius:8,display:"flex",flexDirection:"column",gap:15,padding:15,position:"relative"},moreButtonWrap:{display:F?"block":"none",position:"absolute",right:8,top:8},iconList:{display:"flex",flexWrap:"wrap",gap:5,listStyle:"none",margin:"0 30px 0 0",padding:0},body:{display:"flex",flexDirection:"column",gap:b?4:2},titleWrap:{...a?{alignItems:"center",display:"inline-flex",gap:4}:(0,xo.pd)(2),fontSize:b?16:14,fontWeight:A.Z.fontWeight.medium,lineHeight:"130%"},title:{...a?A.Z.textOverflowStyle:{}},warning:{color:e.accentColors.orange[400],height:"auto",width:b?16:14},caption:{...(0,xo.pd)(2),color:e.lightTextColor,fontSize:b?14:12,fontWeight:A.Z.fontWeight.regular,lineHeight:"130%",margin:0}})),[a,F,b]),Z=(0,n.useCallback)((e=>{P(!0),h&&h(e)}),[h]),B=(0,n.useCallback)((e=>{P(!1),x&&x(e)}),[x]);(0,n.useEffect)((()=>{i&&null!==j.current&&j.current.focus()}),[i]);const D=(0,ao.lq)(j,M,T),O=function(e){const{actionIcons:t,maxIcons:o,triggerIcons:n}=e,i=n.length,r=t.length,a=i>0&&r>0,s=Math.max(o,3),l=a?s-1:s;let c=Math.max(Math.floor(l/2),1),d=Math.max(Math.ceil(l/2),1);if(i<c&&r>d){d+=c-i,c=i}else if(r<d&&i>c){c+=d-r,d=r}const u=[];if(i>0)if(i>c)if(1===c)u.push({color:"gray",type:"truncate",value:i});else{const e=i-(c-1);u.push(...n.slice(0,c-1)),u.push({color:"gray",type:"truncate",value:e})}else u.push(...n);a&&u.push({type:"arrow"});if(r>0)if(r>d)if(1===d)u.push({color:"gray",type:"truncate",value:r});else{const e=r-(d-1);u.push(...t.slice(0,d-1)),u.push({color:"gray",type:"truncate",value:e})}else u.push(...t);return u}({actionIcons:t,maxIcons:ko(s),triggerIcons:w}),R=Boolean(d||u||m||p||g);return(0,v.jsxs)(K.Z,{onBlur:l,onClick:c,onFocus:S,onMouseDown:y,onMouseEnter:Z,onMouseLeave:B,ref:D,style:I.wrap,children:[(0,v.jsxs)("header",{children:[R&&(0,v.jsx)("div",{style:I.moreButtonWrap,children:(0,v.jsx)(fo,{focused:F,onDelete:d,onDisable:u,onEnable:m,onDuplicate:p,onEdit:g})}),(0,v.jsx)("ul",{"aria-hidden":"true",style:I.iconList,children:O.map(((e,t)=>(0,v.jsx)("li",{children:(0,v.jsx)(wo,{icon:e})},t)))})]}),(0,v.jsxs)("div",{style:I.body,children:[(0,v.jsxs)("div",{style:I.titleWrap,children:[(0,v.jsx)("span",{style:I.title,children:C}),a&&(0,ro.t)(I.warning)]}),o&&(0,v.jsx)("p",{style:I.caption,children:o})]})]})}function wo(e){const{icon:t}=e;return"property"===t.type||"page"===t.type||"misc"===t.type?(0,v.jsx)(bo,{color:t.color,icon:t.icon}):"person"===t.type?(0,v.jsx)(To,{actor:t.actor}):"app"===t.type?(0,v.jsx)(Mo,{color:"default",icon:t.icon}):"arrow"===t.type?(0,v.jsx)(jo,{}):"truncate"===t.type?(0,v.jsx)(_o,{color:t.color,value:t.value}):void(0,z.t1)(t.type)}function bo(e){window.__c={n:"StandardIcon"};const{color:t,icon:o}=e,n=Vo(t);return(0,v.jsx)("div",{"aria-hidden":"true",style:n.iconWrap,children:o(n.icon)})}function jo(){window.__c={n:"ArrowIcon"};const e=Vo("default");return(0,v.jsx)("div",{style:{...e.iconWrap,...e.iconArrowWrap},children:(0,io.n)({...e.icon,...e.iconArrow})})}function Mo(e){window.__c={n:"AppIcon"};const{icon:t}=e,o=Vo("default");return(0,v.jsx)("div",{"aria-hidden":"true",style:o.iconAppWrap,children:t(o.iconApp)})}function _o(e){window.__c={n:"TruncateIcon"};const{color:t,value:o}=e,n=Vo(t);return(0,v.jsxs)("div",{style:{...n.iconWrap,...n.truncateWrap},children:["+",o]})}function To(e){window.__c={n:"PersonIcon"};const{actor:t}=e,o=Vo("default");return(0,v.jsx)("div",{"aria-hidden":"true",style:o.iconPersonWrap,children:(0,v.jsx)(ho.ZP,{actor:t,avatarSize:26,format:ho.ZP.Format.Inline,isSingle:!1,showRemoveButton:!1,style:{margin:0}})})}function ko(e){return void 0===e||e<0?vo:e}function Vo(e){const t="default"===e?"gray":e;return(0,f.yK)((e=>{const o="light"===e.mode?400:800,n="light"===e.mode?100:400;return{icon:{fill:e.accentColors[t][o],width:16},iconWrap:{background:e.accentColors[t][n],borderRadius:6,padding:6},iconApp:{width:14},iconAppWrap:{borderRadius:6,borderWidth:1,borderStyle:"solid",borderColor:e.accentColors.gray[n],padding:6},iconPerson:{display:"block",width:"100%"},iconPersonWrap:{alignItems:"center",display:"flex",height:28,justifyContent:"center",width:28},iconArrow:{fill:e.accentColors.gray[600]},iconArrowWrap:{background:void 0},truncateWrap:{alignItems:"center",background:e.accentColors.gray[n],color:e.accentColors[t][o],display:"inline-flex",fontSize:12,fontWeight:A.Z.fontWeight.semibold,height:28,justifyContent:"center",padding:3,width:28}}}),[t])}const Po=(0,l.defineMessages)({automationTabTitle:{defaultMessage:"Automations",id:"database.viewSettings.automationTab.title"},automationTabFilterButton:{defaultMessage:"Filter",id:"database.viewSettings.automationTab.filterButton"},automationTabAddFilterButton:{defaultMessage:"Add filter",id:"database.viewSettings.automationTab.addFilterButton"},automationTabFilterMenuSearchInputPlaceholder:{defaultMessage:"Filter by…",id:"database.viewSettings.automationTab.filterMenuSearchInputPlaceholder"},automationTabFilterMenuNoResults:{defaultMessage:"No results",id:"database.viewSettings.automationTab.filterMenuNoResults"},automationNewAutomationTitle:{defaultMessage:"New automation",id:"database.viewSettings.automationTab.newAutomationTitle"},automationLearnAutomationTitle:{defaultMessage:"Learn about automations",id:"database.viewSettings.automationTab.learnAutomationTitle"},automationDisabledCaption:{defaultMessage:"Paused",id:"database.viewSettings.automationTab.disabledCaption"},automationEmptyViewEditorPublic:{defaultMessage:"Automatically set status, assignees, property values and more with automations",id:"database.viewSettings.automationTab.automationEmptyViewEditorPublic"},automationEmptyViewReadOnly:{defaultMessage:"You're a content viewer. Content viewers cannot create automations.",id:"database.viewSettings.automationTab.automationEmptyViewReadOnly"},automationEmptyViewContentOnly:{defaultMessage:"You're a content editor. Content editors can edit pages, but cannot create automations.",id:"database.viewSettings.automationTab.automationEmptyViewContentOnly"},automationSearchPlaceholder:{defaultMessage:"Search for an automation…",id:"database.viewSettings.automationTab.automationSearchPlaceholder"}});function Ao(e){window.__c={n:"CollectionSettingsAutomationsView"};const{collectionContextStore:t,collectionSettingsStore:o,tabSettings:i}=e,s=(0,l.useIntl)(),c=(0,Xt.D)(),{isMobile:u}=(0,r.Fy)(),[p,g]=(0,n.useState)(""),m=(0,a.VK)((()=>t.collectionStore()),[t]),S=(0,a.VK)((()=>t.collectionViewBlockStore()),[t]),y=(0,a.VK)((()=>m&&m.id),[m]),h=(0,a.VK)((()=>null==m?void 0:m.getSchema()),[m]),x=(0,a.VK)((()=>null==m?void 0:m.getFormat()),[m]),C=(0,a.VK)((()=>function(e){const{collectionStore:t,collectionViewBlockStore:o}=e;if(!t||!o)return[];const n=t.getAutomationStores(),i=[];for(const a of n){var r;const e=a.getModel();null!=e&&e.getAlive()&&((a.isTriggerType("event")||a.isTriggerType("notification_event"))&&(null!==(r=a.getProperties())&&void 0!==r&&r.is_assistant||i.push(a)))}return i}({collectionStore:m,collectionViewBlockStore:S})),[m,S]),w=(0,a.VK)((()=>function(e){const{automationStores:t,collectionSchema:o,intl:n}=e,i=new Map,r=[];for(const l of t){var a;if(!l.isDefined())continue;const e=[],t=l.getName();void 0!==t&&e.push(t);const c=null===(a=l.getOwnerStore())||void 0===a?void 0:a.getDisplayName(n);if(void 0!==c&&e.push(c),l.isTriggerType("event")||l.isTriggerType("notification_event")){const t=l.getEventConfiguration(),i=null==t?void 0:t.pagePropertiesEdited;if("some"===(null==i?void 0:i.type))for(const n of i.some){const t=null==o?void 0:o[n.property];t&&e.push(`${t.name} ${$t.SO[t.type]}`)}const r=l.getActionStores();for(const a of r){const t=a.getType();if(t){const o=(0,ze.z)(t);(0,Ue.Xp)(o)&&e.push(n.formatMessage(o.display.name))}if(a.isType("create_page")||a.isType("update_pages")){var s;const t=a.getConfig();null==t||null===(s=t.properties)||void 0===s||s.forEach((t=>{const n=null==o?void 0:o[t];n&&e.push(`${n.name} ${$t.SO[n.type]}`)}))}}}const d=e.join(" ");i.set(l.id,d),r.push(d)}return function(e){const o=new Set(He().filter(e,r).map((e=>{let{original:t}=e;return t})));return t.filter((0,z.AO)((e=>{if(!e.isTriggerType("event")&&!e.isTriggerType("notification_event"))return{false:e};const t=i.get(e.id);return t&&o.has(t)?{true:e}:{false:e}})))}}({automationStores:C,collectionSchema:h,intl:s})),[C,h,s]),b=(0,a.VK)((()=>w(p)),[w,p]),j=(0,a.VK)((()=>qt.Li({collectionStore:m})),[m]),M=(0,n.useCallback)((()=>{d.H4({collectionSettingsStore:o,item:{type:"automationCreateSettings"}})}),[o]),T=(0,n.useCallback)((e=>g(e.target.value)),[]),k=(0,n.useCallback)((()=>{c&&y&&Ne.qu(c,{collection_id:y})}),[c,y]);(0,n.useEffect)((()=>{if(!c||!y)return;const e="collection_table_header"===i.source?{property_type:i.propertyType,source:i.source}:{source:i.source};Ne.d(c,{...e,collection_id:y}),eo.default.logEvent("automation_list_view","true")}),[c,y,i]);const[V,P]=n.useState(!1),A=(0,a.VK)((()=>function(e){var t;const o=null===(t=Jt.default.state.currentUserStore)||void 0===t?void 0:t.pointer,n=[],i=[];for(const r of e){const e=r.getCreatedByPointer();o&&e&&kt.dr.isEqual(o,e)?n.push(r):i.push(r)}return n.sort(((e,t)=>t.getLastEditedTime()-e.getLastEditedTime())),i.sort(((e,t)=>t.getLastEditedTime()-e.getLastEditedTime())),{currentUserAutomations:n,otherUserAutomations:i}}(b)),[b]),F=(0,n.useMemo)((()=>{const{currentUserAutomations:e,otherUserAutomations:t}=A;return V?[...e,...t]:e.length>0?e:t}),[A,V]),I=b.length-F.length,D=!V&&I>0,K=F.length>0,O=!K&&!(""!==p),R=(0,f.yK)((e=>({buttonList:{display:"flex",flexDirection:"column",flexShrink:1,gap:12,overflow:"hidden auto",paddingBlockEnd:u?0:12,paddingBlockStart:u?12:0,paddingInline:12},emptyViewWrap:{paddingBlockEnd:42,paddingInline:12},menuScrollerStyle:{marginBlockStart:u?12:8},wrap:{display:"flex",flexDirection:"column"},showMoreButtonContainer:{marginLeft:12,marginBottom:12,marginRight:"auto"},showMoreButtonContent:{fontSize:12},noResultsTitle:{color:e.text.secondary,fontSize:12,margin:0}})),[u]);return m&&h&&x&&S?(0,v.jsx)(Z.ZP,{...e,header:!O&&(0,v.jsx)(ne.Z,{children:(0,v.jsx)(zt.ZP,{focusInitial:!u,onChange:T,placeholder:s.formatMessage(Po.automationSearchPlaceholder),showClearButton:!0,value:p})}),footer:(0,v.jsxs)(ne.Z,{topBorder:!0,children:[j&&(0,v.jsx)(B.Z,{icon:it.R,onClick:M,title:s.formatMessage(Po.automationNewAutomationTitle),isGray:!0}),(0,v.jsx)(J.Z,{href:"https://www.notion.so/help/database-automations",external:!0,onClick:k,children:(0,v.jsx)(B.Z,{icon:_.m,title:s.formatMessage(Po.automationLearnAutomationTitle),isGray:!0})})]}),menuScrollerStyle:R.menuScrollerStyle,title:K||p?s.formatMessage(Po.automationTabTitle):null,children:(0,v.jsx)("div",{style:R.wrap,children:O?(0,v.jsx)("div",{style:R.emptyViewWrap,children:(0,v.jsx)(Fo,{collectionStore:m})}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{style:R.buttonList,children:F.length>0?F.map(((e,n)=>(0,v.jsx)(Zo,{collectionContextStore:t,collectionStore:m,collectionSettingsStore:o,focused:!1,schema:h,automationStore:e},e.id))):(0,v.jsx)("p",{style:R.noResultsTitle,children:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"No results",id:"collectionSettings.automationsView.noResults"})})}),D&&(0,v.jsx)(Ut.Z,{style:R.showMoreButtonContainer,onClick:e=>{e.stopPropagation(),P(!0)},children:(0,v.jsx)("div",{style:R.showMoreButtonContent,children:(0,v.jsx)(l.FormattedMessage,{id:"collectionSettings.automationsView.showMore",defaultMessage:"Show {number} more",values:{number:I}})})})]})})}):null}function Fo(e){window.__c={n:"EmptyView"};const{collectionStore:t}=e,o=(0,r.O7)(),n=(0,f.yK)((e=>({wrap:{alignItems:"center",display:"flex",flexDirection:"column",gap:7.5,justifyContent:"center",minHeight:250,textAlign:"center"},icon:{fill:e.icon.yellow,height:24,width:24},title:{fontSize:17,fontWeight:A.Z.fontWeight.medium,margin:0},copy:{color:e.text.secondary,fontSize:14,margin:0,lineHeight:1.5}})),[]),i=(0,a.VK)((()=>t.getRole()),[t]);let s;return s=(0,a.VK)((()=>Boolean((0,Qt.IJ)(o,t))),[t,o])||!i||"editor"===i?Po.automationEmptyViewEditorPublic:"reader"===i||"comment_only"===i?Po.automationEmptyViewReadOnly:"content_only_editor"===i||"read_and_write"===i?Po.automationEmptyViewContentOnly:Po.automationEmptyViewEditorPublic,(0,v.jsxs)("div",{style:n.wrap,children:[(0,v.jsx)("div",{"aria-hidden":!0,children:(0,et.K)(n.icon)}),(0,v.jsx)("p",{style:n.title,children:(0,v.jsx)(l.FormattedMessage,{...Po.automationTabTitle})}),(0,v.jsx)("p",{style:n.copy,children:(0,v.jsx)(l.FormattedMessage,{...s})})]})}const Io={text:bt.p,number:ft.J,url:_t.O,file:ut.Z,date:ct.V,person:yt.O,email:dt.n,phone_number:ht.u,checkbox:at.r,select:Ct.w,multi_select:St.A,status:wt.T,relation:xt.v,rollup:vt.G,formula:pt.D,created_time:st.I,created_by:lt.H,title:jt.c,last_edited_time:st.I,last_edited_by:lt.H,last_visited_time:st.I,button:wt.T,auto_increment_id:gt.A,location:mt,verification:Tt.f,ai_summary:Je.Y,ai_custom_prompt:ot.y,ai_extract:St.A,ai_translate:Xe.Q,ai_keywords:tt.F};function Zo(e){window.__c={n:"AutomationSummaryCardWrapper"};const{automationStore:t,collectionContextStore:o,collectionStore:i,collectionSettingsStore:s,focused:c,schema:u}=e,p=(0,l.useIntl)(),g=(0,r.O7)(),m=(0,Wt.X)({automationStore:t,collectionStore:i}),S=(0,a.VK)((()=>!!(i&&t&&m)&&qt.qk({automationContextStore:m,automationStore:t,collectionStore:i})),[m,t,i]),f=(0,a.VK)((()=>t.getActionStores()),[t]),y=(0,a.VK)((()=>t.getTriggerStore().getValue()),[t]),h=(0,a.VK)((()=>t.getNameWithDefault(p)),[p,t]),x=(0,a.VK)((()=>"active"===t.getStatus()),[t]),C=(0,a.VK)((()=>o.aliveAutomationCount.state),[o]),w=(0,a.VK)((()=>qt.i1({actionStores:f,automationStore:t})),[f,t]),b=(0,a.VK)((()=>qt.qM({automationStore:t})),[t]),j=(0,n.useCallback)((async()=>{await to.SC({collectionStore:i,environment:g,existingAutomationStore:t,intl:p,triggerType:"event",onDelete:()=>{1===C&&d.wl({collectionSettingsStore:s,item:{type:"main"}})}})}),[p,g,i,s,t,C]),M=(0,n.useCallback)((()=>{to.j3({automationStore:t,collectionStore:i,environment:g})}),[i,g,t]),_=(0,n.useCallback)((()=>{d.H4({collectionSettingsStore:s,item:{type:"automationEditSettings",automationId:t.id}})}),[s,t]),T=(0,n.useCallback)((()=>{to.$K({automationStore:t,collectionStore:i,environment:g})}),[i,g,t]),k=(0,n.useMemo)((()=>y?function(e){const{schema:t,triggerConfig:o}=e;if("notification_event"!==o.type&&"event"!==o.type)return[];const n=[];o.event.pagesAdded&&n.push({color:"blue",icon:it.R,type:"page"});const i=o.event.pagePropertiesEdited;if("any"===i.type)n.push({color:"blue",icon:nt.R,type:"misc"});else if("some"===i.type)for(const r of i.some){const e=t[r.property],o=r.filter;if(!e)continue;if(!We.Ym[e.type]){n.push({color:"gray",icon:Lo(e.type),type:"property"});continue}const i=$e.gB(e),a=$e.cu(e);if("changes_to_any"===o.operator)n.push({color:i||a?"gray":"blue",icon:Lo(e.type),type:"property"});else if(i&&!Ge.mv(o)&&Ge.r2(o)){const t=Ge.wB(o);if(t.length>1)n.push({color:"gray",icon:Lo(e.type),type:"property"});else if(1===t.length){const o=t[0];if("is_group"===o.type){const t=(e.groups??[]).find((e=>e.name===o.value));t&&n.push({color:t.color??"gray",icon:Lo(e.type),type:"property"})}else{const t=(e.options??[]).find((e=>e.value===o.value));t&&n.push({color:t.color??"gray",icon:Lo(e.type),type:"property"})}}}else if(a&&!Ge.mv(o)&&(Ge.dx(o)||Ge.NU(o))){const t=Ge.dx(o)?Ge.mg(o):Ge.qC(o);if(1===t.length){const o=t[0],i=(e.options??[]).find((e=>e.value===o.value));i&&n.push({color:i.color??"gray",icon:Lo(e.type),type:"property"})}else t.length>1&&n.push({color:"gray",icon:Lo(e.type),type:"property"})}}return n}({schema:u,triggerConfig:y}):[]),[u,y]),V=(0,a.VK)((()=>function(e){const{actionStores:t,collectionStore:o,schema:n}=e,i=[];for(const c of t)if(c.isType("slack_notification"))i.push({icon:rt.P,type:"app"});else if(c.isType("update_pages")){const e=c.getConfig(),t=(null==e?void 0:e.properties)??[];if(1===t.length){var r,a;const l=t[0],c=n[l],d=null==e||null===(r=e.values)||void 0===r?void 0:r[l];if(!c||!d)continue;if(!We.SF(c)){i.push({color:"gray",icon:Lo(c.type),type:"property"});continue}const u=(0,Ye.A6)(null===(a=d.value)||void 0===a?void 0:a.value);if($e.gB(c)){const e=(c.options||[]).find((e=>e.value===u[0]));e&&i.push({color:e.color??"gray",icon:Lo(c.type),type:"property"})}else if($e.cu(c))if(1===u.length){const e=(c.options||[]).find((e=>e.value===u[0]));e&&i.push({color:e.color??"gray",icon:Lo(c.type),type:"property"})}else u.length>1&&i.push({color:"gray",icon:Lo(c.type),type:"property"});else if($e.KR(c)){var s;const e=(0,qe.DW)({textValue:null===(s=d.value)||void 0===s?void 0:s.value,propertySchema:c,blockCreatorPointer:void 0}).map((e=>(0,Le.Hl)({pointer:e,getRecordValue:o.getRecordValue})));1===e.length?i.push({actor:e[0],type:"person"}):i.push({color:"gray",icon:Lo(c.type),type:"property"})}else i.push({color:"gray",icon:Lo(c.type),type:"property"})}else t.length>1&&i.push({color:"gray",icon:nt.R,type:"misc"})}else if(c.isType("create_page")){var l;(null===(l=c.getConfig())||void 0===l?void 0:l.collection)&&i.push({color:"blue",icon:it.R,type:"page"})}return i}({actionStores:f,collectionStore:i,schema:u})),[u,i,f]),P=(0,a.VK)((()=>x?m&&function(e){const{environment:t,actionStores:o,automationContextStore:n,collectionStore:i,canUserManageAutomation:r,intl:a,schema:s,triggerConfig:c}=e;if(!c||"event"!==c.type&&"notification_event"!==c.type)return;const{event:d}=c,u=[];d.pagesAdded&&u.push(Nt.Mz(a));if("none"===d.pagePropertiesEdited.type);else if("any"===d.pagePropertiesEdited.type)u.push(Nt.c5(a));else if("some"===d.pagePropertiesEdited.type)for(const l of d.pagePropertiesEdited.some){const e=s[l.property];if(!e){u.push(Nt.nf(a));continue}if(!We.Ym[e.type]){u.push((0,Ot.K1)({propertySchema:e}));continue}const{filter:t}=l;if("changes_to_any"===t.operator)u.push(Nt.$G(a,{propertyName:e.name}));else if(We.bD(e))if("status"===e.type){if(!Ge.r2(t)||!Ge.vR(t))continue;const o=Ge.wB(t),n=(0,Lt.L)({intl:a,groupValues:o.map((e=>"is_group"===e.type?e.value:void 0)).filter(z.$K),isText:!0,optionValues:o.map((e=>"is_option"===e.type?e.value:void 0)).filter(z.$K),propertySchema:e,tokenFormat:Qe.lo.Small}),i=a.formatList(n,{style:"long",type:"disjunction"});u.push(Nt.VO(a,{propertyName:e.name,propertyValues:i}))}else if("select"===e.type||"multi_select"===e.type){if(Ge.mv(t)||!Ge.dx(t)&&!Ge.NU(t))continue;const o=Array.isArray(t.value)?t.value:[t.value],n=(0,Ht.z)({intl:a,isText:!0,optionValues:o.map((e=>e.value)).filter(z.$K),propertySchema:e,tokenFormat:Qe.lo.Small}),i=a.formatList(n,{style:"long",type:"disjunction"});u.push(Nt.XJ(a,{propertyName:e.name,propertyValues:i}))}else if("checkbox"===e.type){if(!Ge.XA(t))continue;u.push((0,Et.l4)({filter:t,propertySchema:e,intl:a}))}else(0,z.t1)(e)}const p=a.formatList(u,{style:"long",type:"disjunction"}),g=[];for(const f of o)if(f.isType("slack_notification")){const e=f.getConfigStore().getKeyStore("target").getValue();g.push((0,v.jsx)(l.FormattedMessage,{defaultMessage:"notify {channel}",id:"CollectionSettingsAutomationsView.summaryCard.slackAction",values:{channel:(0,v.jsx)(Vt.p,{channel:e,isAutomationOwner:r})}}))}else if(f.isType("update_pages")){const e=f.getConfig(),o=null==e?void 0:e.properties,r=null==e?void 0:e.values,c=null==e?void 0:e.target;if(!o||0===o.length||!c)continue;if("collection"===c.type)if((0,kt.qo)(c.collection,i.pointer))g.push((0,v.jsx)(l.FormattedMessage,{defaultMessage:"edit pages in this collection",id:"automation.summaryCard.updatePages.sameCollection"}));else{const e=$.NW.createChildStore(i,c.collection),o=(0,Yt.vU)({environment:t,intl:a,store:e});g.push((0,v.jsx)(l.FormattedMessage,{defaultMessage:"edit pages in {collectionTitle}",id:"automation.summaryCard.updatePages.differentCollection",values:{collectionTitle:o}}))}else if("variable"===c.type){const e=o[0],t=s[e],l=null==r?void 0:r[e];if(!t){g.push(Nt.aD(a));continue}if(!l)continue;if(We.SF(t))if("person"===t.type)g.push((0,v.jsx)(Bo,{collectionStore:i,propertyActionValue:l,propertySchema:t}));else if("status"===t.type){const e=(0,v.jsx)(Do,{propertyActionValue:l,propertySchema:t});e&&g.push(e)}else if("select"===t.type||"multi_select"===t.type)g.push((0,v.jsx)(Ko,{propertyActionValue:l,propertySchema:t}));else if("checkbox"===t.type)g.push((0,v.jsx)(Oo,{propertyActionValue:l,propertySchema:t}));else if("relation"===t.type)g.push((0,v.jsx)(Ro,{automationContextStore:n,collectionStore:i,propertyActionValue:l,propertySchema:t}));else if("date"===t.type){const o=(0,v.jsx)(Eo,{automationContextStore:n,collectionStore:i,propertyActionValue:l,propertyId:e,propertySchema:t});o&&g.push(o)}else"number"===t.type||"phone_number"===t.type||"text"===t.type||"title"===t.type||"email"===t.type||"url"===t.type?g.push((0,v.jsx)(Ho,{automationStore:n.context.automationStore,propertyActionValue:l,propertySchema:t})):(0,z.t1)(t);else g.push((0,Ot.K1)({propertySchema:t}))}}else if(f.isType("create_page")){var m;const e=null===(m=f.getConfig())||void 0===m?void 0:m.collection;if(!e)continue;e.id===i.pointer.id?g.push((0,v.jsx)(l.FormattedMessage,{defaultMessage:"create a page in this database",id:"automation.summaryCard.createPageThisDatabase"})):g.push((0,v.jsx)(l.FormattedMessage,{defaultMessage:"create a page in another database",id:"automation.summaryCard.createPageAnotherDatabase"}))}const S=a.formatList(g,{style:"long",type:"conjunction"});return a.formatMessage({defaultMessage:"When {triggers}, {actions}.",id:"automation.summaryCard.caption"},{actions:S,triggers:p})}({environment:g,actionStores:f,automationContextStore:m,canUserManageAutomation:w,collectionStore:i,intl:p,schema:u,triggerConfig:y}):p.formatMessage(Po.automationDisabledCaption)),[x,m,g,f,w,i,p,u,y]),A=(0,a.VK)((()=>{if(!t.isTriggerType("event")&&!t.isTriggerType("notification_event"))return!0;return!t.getTrigger()||qt.vM({automationStore:t,collectionStore:i})}),[t,i]),F=!x||A,I=(0,n.useCallback)((e=>(0,n.createElement)(Co,{...e,key:t.id,actions:V,caption:P,focused:c,hasWarning:F,onClick:_,onDelete:b?j:void 0,onDisable:x&&b&&S?M:void 0,onEdit:w?_:void 0,onEnable:!x&&b&&S?T:void 0,title:h,triggers:k})),[V,t.id,w,b,P,c,F,x,S,j,M,_,T,h,k]);return(0,v.jsx)(Rt.y,{caption:P,renderOrigin:I,title:h,tooltipAlignment:Gt.v2.Start,tooltipPlacement:Gt.ug.Bottom})}function Bo(e){window.__c={n:"PersonActionTitle"};const{collectionStore:t,propertyActionValue:o,propertySchema:n}=e,i=(0,l.useIntl)(),r=(0,a.VK)((()=>(0,It.UD)({getRecordModel:t.getRecordModel,propertySchema:n,value:o.value})),[t.getRecordModel,o.value,n]),s=(0,a.VK)((()=>(0,It.y3)({actors:r,intl:i,propertySchema:n})),[r,i,n]);return s||null}function Do(e){var t;window.__c={n:"StatusActionTitle"};const{propertyActionValue:o,propertySchema:n}=e,i=(0,Ye.A6)(null===(t=o.value)||void 0===t?void 0:t.value)[0],r=(0,l.useIntl)(),a=(0,Dt.LQ)({intl:r,propertySchema:n,value:i});return a||null}function Ko(e){var t,o;window.__c={n:"MultiSelectActionTitle"};const{propertyActionValue:n,propertySchema:i}=e,r=(0,l.useIntl)(),s=null!==(t=n.value)&&void 0!==t&&t.value?(0,Ye.A6)(null===(o=n.value)||void 0===o?void 0:o.value):[],c=Nt.oJ({limit:Ft.H,propertySchema:i,optionValues:s.map((e=>"string"==typeof e?e:void 0)).filter(z.$K)});return(0,a.VK)((()=>(0,Bt.I7)({intl:r,propertySchema:i,values:c})),[r,c,i])}function Oo(e){const{propertyActionValue:t,propertySchema:o}=e;return(0,Pt.G7)({propertySchema:o,value:t.value})}function Ro(e){window.__c={n:"RelationActionTitle"};const{automationContextStore:t,collectionStore:o,propertyActionValue:n,propertySchema:i}=e,s=(0,l.useIntl)(),c=(0,r.O7)(),d=n.value,u=(0,a.VK)((()=>t.getAllContextValues()),[t]);return(0,a.VK)((()=>(0,Zt.wr)({automationContextValues:u,collectionStore:o,environment:c,intl:s,propertySchema:i,value:d})),[u,o,c,s,i,d])}function Eo(e){window.__c={n:"DateActionTitle"};const{automationContextStore:t,collectionStore:o,propertyActionValue:i,propertyId:r,propertySchema:s}=e,c=(0,l.useIntl)(),d=i.value,u=(0,n.useMemo)((()=>({type:"collection",collectionStore:o,property:r})),[o,r]),p=(0,a.VK)((()=>(0,At.kD)({automationContextStore:t,intl:c,propertySchema:s,value:d,valueContext:u})),[t,c,s,d,u]);return p||null}function Ho(e){window.__c={n:"TextActionTitle"};const{automationStore:t,propertyActionValue:o,propertySchema:n}=e,i=(0,r.O7)(),s=(0,f.Fg)(),l=(0,a.VK)((()=>(0,Kt.lG)({automationStore:t,environment:i,propertySchema:n,theme:s,value:o.value})),[t,i,o.value,n,s]);return l||null}function Lo(e){return(0,z.$K)(e)?Io[e]??Mt.S:Mt.S}var No=o(91537),Wo=o(24039),zo=o(12534),Uo=o(34859),Go=o(58421),$o=o(36857),qo=(o(52262),o(24506),o(1302)),Qo=o(39132),Yo=o(61061),Xo=o(44495),Jo=o(95371),en=o(16956),tn=o(30188),on=o(51592),nn=o(10906),rn=o(61519),an=o(64369),sn=o(66890),ln=o(97978),cn=o(97004);var dn=o(77181),un=o(81166),pn=o(29376),gn=o(5971),mn=o(18533),Sn=o(84242),fn=o(8505),yn=o(5210);function hn(e){window.__c={n:"CollectionSettingsSubitemsPreviews"};const{propertyName:t,newDesign:o,subitemsDisplayMode:n,inversePropertyName:i}=e,r=(0,f.yK)((e=>({togglePreviewParentIcon:{color:e.regularIconColor},togglePreviewChildIcon:{color:e.mediumIconColor,marginLeft:"24px"},togglePreviewRowWithDivider:{padding:"4px",margin:"0px 12px",display:"flex",fontSize:14,alignItems:"center",borderBottom:`1px solid ${e.regularDividerColor}`},togglePreviewRow:{padding:"4px",margin:"0px 12px",display:"flex",fontSize:14,alignItems:"center"},togglePreviewOutsideBorder:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:"4px",alignItems:"center",...o?{fontWeight:A.Z.fontWeight.medium,backgroundColor:e.accentColors.gray[30],padding:"9px 0"}:{}},parentItemIcon:{color:e.mediumIconColor,width:14,height:14,marginRight:4},parentWrapper:{paddingLeft:8,display:"inline-flex",alignItems:"center"},parentTitle:{textOverflow:"ellipsis",overflow:"hidden",color:e.lightTextColor,fontWeight:A.Z.fontWeight.medium,fontSize:A.Z.fontSize.UISmall.desktop,whiteSpace:"nowrap"},subItemIcon:{color:e.mediumIconColor,width:14,height:14,marginRight:4},subItemWrapper:{display:"inline-flex",alignItems:"center",paddingLeft:8,paddingRight:4,verticalAlign:"text-top"},numSubitemsSpan:{color:e.lightTextColor,fontWeight:A.Z.fontWeight.medium,fontSize:A.Z.fontSize.UISmall.desktop}})),[o]),a=(0,v.jsx)("span",{children:"🐔"}),s=(0,v.jsx)("span",{children:"🐣"}),l={show:[a,s,s],hidden:[a,(0,v.jsx)("span",{children:"🐮"}),(0,v.jsx)("span",{children:"🐷"})],flattened:[a,s,s]},c={show:[i,t,t],hidden:[i,i,i],flattened:[i,t,t]};function d(e){return(0,v.jsxs)("span",{style:r.subItemWrapper,children:[(0,fn.S)(r.subItemIcon),(0,v.jsx)("span",{style:r.numSubitemsSpan,children:e})]})}function u(){return(0,v.jsxs)("span",{style:r.parentWrapper,children:[(0,Sn.v)(r.parentItemIcon),(0,v.jsx)("span",{style:r.parentTitle,children:i})]})}function p(e,t,o){return(0,v.jsxs)("div",{style:2===t?{...r.togglePreviewRow}:{...r.togglePreviewRowWithDivider},children:["show"===e&&(0,v.jsx)(yn.Z,{isSidebar:!1,open:!1,fill:!0,onClick:()=>{},style:0===t?r.togglePreviewParentIcon:r.togglePreviewChildIcon,disabled:!0}),(n=c[e][t],i=l[e][t],(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("span",{style:{marginRight:"5px"},children:[" ",i]}),n]})),o]});var n,i}function g(e){return"flattened"===e?(0,v.jsxs)(v.Fragment,{children:[p(e,0),p(e,1,u()),p(e,2,u())]}):"hidden"===e?(0,v.jsxs)(v.Fragment,{children:[p(e,0,d(2)),p(e,1),p(e,2,d(1))]}):(0,v.jsxs)(v.Fragment,{children:[p("show",0),p("show",1),p("show",2)]})}return m=n,(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(ne.Z,{disableMobileBorders:!0,children:(0,v.jsx)("div",{style:r.togglePreviewOutsideBorder,children:g(m)})})});var m}var xn=o(22491),vn=o(72126),Cn=o(43350),wn=o(65742);o(21703);class bn{constructor(){this.stiffness=50,this.damping=10,this.precision=.001,this.currentValue=0,this.endValue=0,this.velocity=0}isAtRest(){return Math.abs(this.endValue-this.currentValue)<=this.precision}setEndValue(e){this.endValue=e;const t=this.isAtRest();return t&&this.setAtRest(),t}jumpToEnd(){this.currentValue=this.endValue}step(e){let t=e;do{let e;t>bn.timestep?(t-=bn.timestep,e=bn.timestep):(e=t,t=0);const[o,n]=this.rk4(this.currentValue,this.velocity,e);this.velocity=n,this.currentValue=o}while(t>0);const o=this.isAtRest();return o&&this.setAtRest(),o}setAtRest(){this.currentValue=this.endValue,this.velocity=0}rk4(e,t,o){var n=e,i=t,r=this.computeAccel(n,i,0),a=e+.5*i*o,s=t+.5*r*o,l=this.computeAccel(a,s,o/2),c=e+.5*s*o,d=t+.5*l*o,u=this.computeAccel(c,d,o/2),p=e+d*o,g=t+u*o;return[e+o/6*(i+2*s+2*d+g),t+o/6*(r+2*l+2*u+this.computeAccel(p,g,o))]}computeAccel(e,t,o){return this.stiffness*bn.stiffnessMultiplier*(this.endValue-e)-this.damping*bn.dampingMultiplier*t}}bn.stiffnessMultiplier=1e-5,bn.dampingMultiplier=.005,bn.timestep=1e3/60;const jn=bn;function*Mn(e,t){const o=new jn;for(o.currentValue=e,o.endValue=t,o.stiffness=35;;){const e=yield o.currentValue;if(o.step(e)){yield o.currentValue;break}}}function*_n(e,t,o){let n=0;for(;n<o;){n+=(yield e+n/o*(t-e))}}function*Tn(e){for(const[t,o]of vn.$R(e,e.slice(1)))(0,z.$K)(t)&&(0,z.$K)(o)&&(yield*Mn(t,o))}function*kn(e,t){let o=0;for(;!(0,z.$K)(t)||o<t;){o+=(yield e)}}function*Vn(e){let t=0;for(;;){const o={};for(const n of(0,z.Yd)(e)){const i=e[n].next(t);if(i.done)return;o[n]=i.value}t=yield o}}var Pn=o(28267);const An="inactive-task-filter",Fn="active-task-filter",In="mouse-cursor-filter",Zn=80,Bn=24,Dn=8,Kn=10,On=264,Rn=110,En=Zn/2;function*Hn(e){yield*Vn({x:e,opacity:kn(1)})}function Ln(e){window.__c={n:"DateShiftingPreview"};const{mode:t}=e,o=(0,f.yK)((e=>({wrap:{margin:"0px 10px",border:`1px solid ${e.regularDividerColor}`,borderRadius:4,alignItems:"center",position:"relative",height:Rn+2}})),[1]),i=(0,n.useRef)(null),r=(0,Pn.X)(i),a=r?r.width-2:On;return(0,v.jsx)("div",{style:o.wrap,ref:i,children:(0,v.jsx)(Nn,{mode:t,sceneWidth:a})})}function Nn(e){window.__c={n:"DateShiftingPreviewAnimation"};const{mode:t,sceneWidth:o}=e,i=(0,f.yK)((e=>({svgArrowTheme:{stroke:e.collectionValidDependencyArrow,strokeWidth:wn.lf},invalidArrow:{stroke:e.collectionInvalidDependencyArrow},svgContainer:{position:"absolute",width:"100%",height:"100%",backgroundColor:e.accentColors.gray[30]}})),[]),r=(0,n.useMemo)((()=>({none:function*(){for(;;)yield*Hn(Tn([o/2,o/2+Zn/2+Zn/4,o/2-Zn/2-Zn/4,o/2]))},preserve_gap:function*(){for(;;)yield*Hn(Tn([o/2,o/2+Zn/2,o/2-Zn/2,o/2]))},consume_gap:function*(){for(;;){yield*Hn(Tn([o/2,o/2-Zn/2,o/2+Zn/2,o/2+Zn]));const e=500;yield*Vn({x:kn(o/2+Zn),opacity:_n(1,0,e)}),yield*Vn({x:kn(o/2),opacity:_n(0,1,e)})}}})),[o]),{x:a,opacity:s}=function(e){const t=(0,n.useMemo)((()=>e()),[e]),[o,i]=(0,n.useState)((()=>{const e=t.next(0);if(e.done)throw new Error("Generator must provide at least one result");return e.value}));return(0,n.useEffect)((()=>{const e=t.next(0);e.done||i(e.value);let o=Date.now(),n=0;return n=requestAnimationFrame((function e(){n=requestAnimationFrame(e);const r=Date.now(),a=r-o;o=r;const s=t.next(a);s.done||i(s.value)})),()=>cancelAnimationFrame(n)}),[t]),o}(r[t??"none"]),l={x:o/2-2*Zn,y:Kn},c={x:a-Zn/2,y:Kn+Bn+Dn},d={x:o/2+Zn,y:Kn+2*(Bn+Dn)},u={x:c.x+Zn/2,y:c.y+Bn/2};return(0,z.$K)(t)&&("consume_gap"===t?(l.x=Math.min(l.x,c.x-Zn),d.x=Math.max(d.x,c.x+Zn)):"preserve_gap"===t?(l.x=l.x+a-o/2,d.x=d.x+a-o/2):(0,z.t1)(t)),(0,v.jsxs)("svg",{style:i.svgContainer,children:[vn.w6(o/2-2*Zn,o,En).map(((e,t)=>(0,v.jsx)(zn,{startPoint:{x:e,y:0},endPoint:{x:e,y:Rn}},t))),(0,v.jsx)(Cn.Z,{startPoint:{x:c.x+Zn,y:c.y+Bn/2},endPoint:{x:d.x-2,y:d.y+Bn/2},...(0,xn.iv)(i.svgArrowTheme,c.x+Zn>d.x?i.invalidArrow:void 0,{opacity:s}),showArrowHead:!0}),(0,v.jsx)(Cn.Z,{startPoint:{x:l.x+Zn,y:l.y+Bn/2},endPoint:{x:c.x-2,y:c.y+Bn/2},...(0,xn.iv)(i.svgArrowTheme,c.x<l.x+Zn?i.invalidArrow:void 0,{opacity:s}),showArrowHead:!0}),(0,v.jsx)(Wn,{point:l,opacity:s}),(0,v.jsx)(Wn,{point:c,active:!0,opacity:s}),(0,v.jsx)(Wn,{point:d,opacity:s}),(0,v.jsx)(Un,{point:u,opacity:s}),(0,v.jsx)(Gn,{})]})}function Wn(e){window.__c={n:"SvgTaskBox"};const{point:t,active:o,opacity:n}=e,i=(0,f.Fg)(),r=o?"dark"===i.mode?"#28456C":"#E7F3F8":i.buttonBackground;return(0,v.jsx)("g",{transform:`translate(${t.x-4},${t.y-2})`,opacity:n,children:(0,v.jsx)("rect",{filter:`url(#${o?Fn:An})`,width:Zn,height:Bn,x:"4",y:"2",fill:r,rx:"3"})})}function zn(e){window.__c={n:"SvgDashedLine"};const{startPoint:t,endPoint:o}=e,n=(0,f.Fg)(),i="dark"===n.mode?n.accentColors.gray[300]:"#E3E2E0";return(0,v.jsx)("line",{x1:t.x,y1:t.y,x2:o.x,y2:o.y,stroke:i,strokeDasharray:"3 4"})}function Un(e){const{point:t,opacity:o}=e;return(0,v.jsxs)("g",{filter:`url(#${In})`,transform:`translate(${t.x},${t.y})`,opacity:o,children:[(0,v.jsx)("path",{fill:"#32302C",d:"M14 12.25h-3.334l2.193 5.294-2.309.956-2.194-5.294L6 15.563l-.75-.75V3.94l1.06-.44L14 11.19v1.06z"}),(0,v.jsx)("path",{stroke:"#fff",fill:"#32302C",strokeWidth:"0.5",d:"M14 12.5h.25v-1.413l-.073-.073-7.69-7.69-.12-.12-.154.065-1.059.44L5 3.775v11.142l.073.073.75.75.177.177.177-.177 2.092-2.091 2.05 4.948.096.23.23-.095 2.31-.956.231-.096-.096-.231-2.05-4.948H14z"})]})}function Gn(){return(0,v.jsxs)("defs",{children:[(0,v.jsxs)("filter",{id:An,width:Zn+8,height:Bn+8,x:"0",y:"0",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,v.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,v.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,v.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_637_7659"}),(0,v.jsx)("feOffset",{}),(0,v.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,v.jsx)("feColorMatrix",{values:"0 0 0 0 0.0707 0 0 0 0 0.0693 0 0 0 0 0.0693 0 0 0 0.1 0"}),(0,v.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_637_7659"}),(0,v.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,v.jsx)("feOffset",{dy:"2"}),(0,v.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,v.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,v.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,v.jsx)("feBlend",{in2:"effect1_dropShadow_637_7659",result:"effect2_dropShadow_637_7659"}),(0,v.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_637_7659",result:"shape"})]}),(0,v.jsxs)("filter",{id:Fn,width:Zn+8,height:Bn+8,x:"0",y:"0",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,v.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,v.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,v.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_637_5084"}),(0,v.jsx)("feOffset",{}),(0,v.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,v.jsx)("feColorMatrix",{values:"0 0 0 0 0.2 0 0 0 0 0.494118 0 0 0 0 0.662745 0 0 0 0.2 0"}),(0,v.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_637_5084"}),(0,v.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,v.jsx)("feOffset",{dy:"2"}),(0,v.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,v.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,v.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,v.jsx)("feBlend",{in2:"effect1_dropShadow_637_5084",result:"effect2_dropShadow_637_5084"}),(0,v.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_637_5084",result:"shape"})]}),(0,v.jsxs)("filter",{id:In,width:"17.75",height:"24.244",x:"0.75",y:"0.91",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,v.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,v.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,v.jsx)("feOffset",{dy:"2"}),(0,v.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,v.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,v.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.2 0"}),(0,v.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_637_4925"}),(0,v.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_637_4925",result:"shape"})]})]})}var $n=o(52936),qn=o(18442),Qn=o(71644),Yn=o(8406),Xn=o(9953),Jn=o(75330),ei=o(87279),ti=o(6695),oi=o(73657),ni=o(69872),ii=o(33929),ri=o(29798);const ai=2,si=(0,l.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a property…",id:"database.viewSettings.propertySelect.inputPlaceholder"}});function li(e){window.__c={n:"CollectionSettingsGroupedPropertySelectMenu"};const{currentProperty:t,getGroupedProperties:o,onAccept:i,renderProperty:s,inputPlaceholder:c,schema:d,format:u,defaultShowPropertyGroupCount:p}=e,g=(0,r.Fy)(),m=(0,a.qz)(void 0,ri.Z),S=(0,a.VK)((()=>o()),[o]),[y,h]=(0,n.useState)(!1),[x,C]=(0,n.useState)(""),w=(0,ti.iB)(u,d,void 0,ti.j5.Page).collection_page_properties||[],b=(0,n.useCallback)((e=>{C(e.target.value),m.setState({...m.state,focus:{section:0,indexLocal:0,indexGlobal:0}}),h(!1)}),[m]),j=(0,f.yK)((e=>({dotsIcon:{width:16,fill:e.mediumTextColor,marginLeft:4,marginRight:2},showMoreButton:{color:e.mediumTextColor}})),[]),M=vn.MR(S,(e=>Math.min(...e.map((e=>w.findIndex((t=>t.property===e))))))),_=[{key:"input",comp:(0,v.jsx)(ne.Z,{children:(0,v.jsx)(zt.ZP,{focusInitial:!g.isMobile||void 0,focus:!g.isMobile||void 0,value:x,onChange:b,placeholder:c||ii.default.formatMessage(si.inputPlaceholder)})})}];if(x){const e=M.map((e=>e.filter((e=>{const t=d[e],o=t?`${t.name} ${$t.SO[t.type]}`:"";return Boolean(He().match(x,o))})))).filter((e=>e.length>0));if(0===e.length)_.push({key:"noResults",comp:(0,v.jsx)(oi.Z,{caption:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"No results",id:"database.viewSettings.propertySelect.noResultsTitle"})})});else{const o=[{key:"results",render:e=>(0,v.jsx)(ne.Z,{...e}),items:e.flat().map((e=>di({onAccept:i,property:e,schema:d,currentProperty:t,renderProperty:s}))).filter(z.$K)}];_.push(ci({sections:o,menuListStore:m}))}}else{const e=p||ai;let o,n;if(!y&&M.length>e){o=M.slice(0,e);const t=vn.Sm(M.slice(e).map((e=>e.length)));n={key:"show_more",render:e=>(0,v.jsx)(Y.Z,{...e,icon:(0,co.o)(j.dotsIcon),style:j.showMoreButton,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"{moreCount} more",id:"database.viewSettings.propertySelect.showMoreTitle",values:{moreCount:t}})}),action:()=>{h(!0)}}}else o=M;const r=o.map(((e,r)=>({key:e.join("-"),render:e=>(0,v.jsx)(ne.Z,{...e,topBorder:0!==r}),items:e.map((e=>di({onAccept:i,property:e,schema:d,currentProperty:t,renderProperty:s}))).concat(r===o.length-1?[n]:[]).filter(z.$K)})));_.push(ci({sections:r,menuListStore:m}))}return(0,v.jsx)(v.Fragment,{children:_.map((e=>{let{key:t,comp:o}=e;return(0,v.jsx)(n.Fragment,{children:o},t)}))})}function ci(e){const{menuListStore:t,sections:o}=e;return{key:"properties",comp:(0,v.jsx)(te.Z,{type:te.i.Vertical,initialFocus:0,sections:o,store:t})}}function di(e){const{schema:t,currentProperty:o,onAccept:n,renderProperty:i,property:r}=e,a=t[r];if(!a)return;return{key:r,render:e=>{const t=r===o;return i?i(e,r,t,a):(0,v.jsx)(ni.Z,{...e,propertySchema:a,format:ni.L.Name,checkState:t})},action:()=>{n(r)}}}var ui=o(57410),pi=o(98519);function gi(e){window.__c={n:"CollectionSettingsViewDefaultPropertyPopup"};const{menuProps:t,property:o,defaultProperty:n,checkState:i,propertySchema:s,collectionContextStore:l,handleDefaultPropertySelect:c,handlePropertySelect:d,...u}=e,p=(0,r.MO)(),g=(0,a.VK)((()=>l.permissionScopes.state),[l]);return(0,a.VK)((()=>eo.default.checkGate("collection_level_subitems_setting")),[])?(0,v.jsx)(ni.Z,{...t,disabled:!g.canConfigureBlock,propertySchema:s,format:ni.L.Name,onClick:()=>c(o),right:(0,v.jsx)(mi,{property:o,checkState:o===n,collectionContextStore:l,defaultProperty:void 0})}):(0,v.jsx)(X.ZP,{popupType:p?X.Z4.SlideUp:X.Z4.Popup,alignmentToOrigin:X.vR.End,placementToOrigin:X.pO.Bottom,originGap:0,renderOrigin:e=>(0,v.jsx)(ni.Z,{...t,...e,disabled:!g.canConfigureBlock,propertySchema:s,format:ni.L.Name,right:(0,v.jsx)(mi,{property:o,defaultProperty:n,checkState:i,collectionContextStore:l})}),render:e=>(0,v.jsx)(Si,{...u,parent:e,property:o,collectionContextStore:l,handleDefaultPropertySelect:c,handlePropertySelect:d})})}function mi(e){window.__c={n:"DefaultCheck"};const{property:t,defaultProperty:o,checkState:n,collectionContextStore:i}=e,s=(0,r.MO)(),c=(0,a.VK)((()=>{var e;return null===(e=i.collectionStore())||void 0===e||null===(e=e.getName())||void 0===e?void 0:e.toString()}),[i]),d=(0,f.yK)((e=>({defaultText:{color:e.mediumTextColor,fontSize:12,fontWeight:500,textTransform:"uppercase",marginRight:4}})),[]);return(0,v.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,v.jsx)("div",{style:{...d.defaultText},children:t===o&&(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Default",id:"database.viewSettings.setViewPropertyDefault.defaultProperty.tag",values:{databaseName:c}})}),n&&(0,v.jsx)("div",{style:{...s?{marginLeft:"auto",marginRight:20,minWidth:0,flexShrink:0}:{marginLeft:"auto",marginRight:12,minWidth:0,flexShrink:0},width:s?16:14,flexShrink:0},children:(0,pi.k)()})]})}function Si(e){window.__c={n:"PropertySelectPopup"};const{parent:t,property:o,collectionContextStore:n,handleDefaultPropertySelect:i,handlePropertySelect:s,...c}=e,d=(0,r.MO)(),u=(0,a.VK)((()=>n.permissionScopes.state),[n]),p=(0,a.VK)((()=>n.databaseType),[n]),g=(0,a.VK)((()=>{var e;return null===(e=n.collectionStore())||void 0===e||null===(e=e.getName())||void 0===e?void 0:e.toString()}),[n]);let m;m=d?{menuType:ei.og.ActionSheet}:{menuType:ei.og.Popup,width:300};const S=u.canConfigureCollection;let f;if("v1"===e.version)f=(0,v.jsxs)(ne.Z,{topBorder:!0,children:[S&&(0,v.jsx)(B.Z,{isGray:!0,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Set on all new {databaseName} views",id:"database.viewSettings.setViewPropertyDefault.allDefaultButton.title",values:{databaseName:g}}),onClick:()=>{i(o),t.close()}}),(0,v.jsx)(B.Z,{title:(0,v.jsx)(l.FormattedMessage,{id:"database.viewSettings.setViewPropertyDefault.setProperty.title",defaultMessage:"Set on this view"}),isGray:!0,onClick:()=>{s(o),t.close()}})]});else if("v2"===e.version){const n=(0,un.K9)({feature:e.feature,databaseType:p});f=(0,v.jsxs)(v.Fragment,{children:[S&&(0,v.jsx)(ne.Z,{children:(0,v.jsx)(B.Z,{title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Set as default",id:"database.viewSettings.relationFeatures.setViewPropertyDefault.allDefaultButton.title",values:{databaseName:g}}),caption:(0,v.jsx)(l.FormattedMessage,{...n}),shouldWrapCaption:!0,onClick:()=>{i(o),t.close()}})}),(0,v.jsx)(ne.Z,{topBorder:S,children:(0,v.jsx)(B.Z,{title:(0,v.jsx)(l.FormattedMessage,{id:"database.viewSettings.relationFeatures.setViewPropertyDefault.setProperty.title",defaultMessage:"Set on this view only"}),onClick:()=>{s(o),t.close()}})})]})}else(0,z.t1)(e);return(0,v.jsx)(ee.Z,{...m,children:f})}var fi=o(31869),yi=o(54281);function hi(e){const{collectionContextStore:t,feature:o}=e,n=(0,l.useIntl)();return{initialPropertyName:(0,a.VK)((()=>{const e=t.collectionStore();if(null!=e&&e.isDefined()){const i=t.normalizedSchemaStore.state;return pn.m8(n,{targetCollectionStore:e,isSelfRelation:!0,sourceSchema:i,createUnique:!0,from:o})}return n.formatMessage({id:"database.viewSettings.relationsPropertyTab.initialPropertyName.placeholder",defaultMessage:"Related to target"})}),[t,n,o])}}function xi(e){const{feature:t,collectionContextStore:o,collectionSettingsStore:i,onPropertySelect:s}=e,c=(0,r.O7)(),g=(0,l.useIntl)(),{initialPropertyName:m}=hi({collectionContextStore:o,feature:t}),S=(0,n.useCallback)((e=>{const{collectionViewStore:o,newProperty:n,transaction:i}=e;"subitem"===t?tn.dR({collectionViewStore:o,propertyId:n,transaction:i}):"timeline_arrows_by"===t?yi.tF({collectionViewStore:o,newProperty:n,transaction:i}):(0,z.t1)(t)}),[t]),f=(0,a.VK)((()=>o.normalizedSchemaStore.state),[o]),y=(0,n.useCallback)((()=>pn.ND(o,f)),[o,f]),h=(0,n.useCallback)((e=>{const{relationPropertyId:n,transaction:i}=e;"subitem"===t?tn.jA({environment:c,collectionContextStore:o,relationPropertyId:n,transaction:i}):"timeline_arrows_by"===t?yi._p({collectionContextStore:o,relationPropertyId:n,transaction:i}):(0,z.t1)(t)}),[o,c,t]),x=(0,n.useCallback)((e=>{const{featureType:t}=e,n=o.collectionStore(),r=n,a=o.collectionViewStore();n&&r&&(p.createAndCommit({userAction:"CollectionSettingsSetupRelation.handleAddRelation",environment:c,perform:i=>{const s=en.G3({environment:c,collectionStore:n,collectionViewArgs:a?{collectionViewStore:a,format:a.getFormat(),formatKey:"collection_page_properties"}:void 0,propertyType:"relation",transaction:i});return fi.n7({environment:c,collectionContextStore:o,collectionStore:n,property:s,propertyName:m,targetCollectionStore:r,hasInverseRelation:!0,inverseName:void 0,autoRelate:{enabled:!1},propertyLimit:"no_limit",intl:g,transaction:i,from:t}),a&&(S({collectionViewStore:a,newProperty:s,transaction:i}),h({relationPropertyId:s,transaction:i})),"timeline_arrows_by"===t&&Bi({environment:c,intl:g,collectionStore:n,transaction:i,newConfig:e.dateShiftingConfig}),s}}),d.wl({collectionSettingsStore:i,item:{type:"main"}}),Yn._H({environment:c,collectionContextStore:o,from:t,property_type:"relation"}))}),[o,i,c,m,g,h,S]),v=(0,n.useCallback)((e=>{const n=o.collectionViewStore();if(!n)return;let i;p.createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handleDefaultPropertySelect",environment:c,perform:t=>{S({collectionViewStore:n,newProperty:e,transaction:t}),h({relationPropertyId:e,transaction:t})}}),s(e),"subitem"===t?i="update_default_subitem":"timeline_arrows_by"===t?i="update_default_timeline_arrows_by":(0,z.t1)(t),Yn.wd({action:i,original_view_type:void 0,property_type:e?"relation":void 0,environment:c,collectionContextStore:o})}),[o,c,s,t,S,h]);return{handlePropertySelect:(0,n.useCallback)((e=>{const n=o.collectionViewStore();if(!n)return;let i;p.createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handlePropertySelect",environment:c,perform:t=>{S({collectionViewStore:n,newProperty:e,transaction:t})}}),s(e),"subitem"===t?i="update_subitem":"timeline_arrows_by"===t?i="update_timeline_arrows_by":(0,z.t1)(t),Yn.wd({action:i,original_view_type:void 0,property_type:e?"relation":void 0,environment:c,collectionContextStore:o})}),[o,c,s,t,S]),handleDefaultPropertySelect:v,handleAddRelation:x,getProperties:y,clearCollectionViewSubitemDisplayMode:(0,n.useCallback)((()=>{const e=o.collectionViewStore();e&&p.createAndCommit({userAction:"actionRegistry.clearCollectionViewSubitemDisplayMode",environment:c,perform:t=>{u.FH({stores:[e],update:{subitem_display_mode:void 0},transaction:t})}})}),[o,c])}}function vi(e){const{feature:t,collectionContextStore:o}=e;let n,i;const r=eo.default.checkGate("collection_level_subitems_setting");var a,s,l,c;if("subitem"===t)r?(i=null===(a=o.collectionStore())||void 0===a?void 0:a.getFormatStore().getKeyStore("subitem_property").getValue(),n="flattened"===(null===(s=o.collectionViewStore())||void 0===s?void 0:s.getFormat().subitem_display_mode)?void 0:i):(n=null===(l=o.currentSubitemFormatStoreForUiDisplay.state)||void 0===l?void 0:l.property,i=null===(c=o.collectionStore())||void 0===c?void 0:c.getFormatStore().getKeyStore("collection_default_subitem").getValue());else if("timeline_arrows_by"===t){var d;n=o.currentArrowsByFormatStore.state,i=null===(d=o.collectionStore())||void 0===d?void 0:d.getFormatStore().getKeyStore("collection_default_arrows_by").getValue()}else(0,z.t1)(t);const u=o.normalizedSchemaStore.state,p=pn.NA(o,u);(0,z.$K)(n)&&!p.includes(n)&&(n=void 0),(0,z.$K)(i)&&!p.includes(i)&&(i=void 0);const g=n??i;if(g){var m;const e=Boolean(n),r=eo.default.checkGate("collection_subitem_new_show_hide_options"),a="hidden"!==(null===(m=o.collectionViewStore())||void 0===m?void 0:m.getFormat().subitem_display_mode),s="subitem"===t?!e:e;return{property:g,isDefault:g===i,enabledOnView:e,enabledOnCollection:Boolean(i),supportedInView:Di({feature:t,viewType:o.getViewType()}),isVisibleInView:r?a:s}}}function Ci(e){const{feature:t,collectionContextStore:o}=e;return(0,a.VK)((()=>vi({feature:t,collectionContextStore:o})),[o,t])}function wi(e){window.__c={n:"RelationPropertyPicker"};const{currentPropertyId:t,feature:o,collectionContextStore:n,collectionSettingsStore:i,permissionScopes:r,onPropertySelect:s,buttonPopupStore:c,disabled:d}=e,u=(0,l.useIntl)(),p=(0,a.VK)((()=>{var e,t;return"subitem"===o?null===(e=n.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.collection_default_subitem:"timeline_arrows_by"===o?null===(t=n.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.collection_default_arrows_by:void(0,z.t1)(o)}),[o,n]),g=(0,a.VK)((()=>n.databaseType),[n]),{handleDefaultPropertySelect:m,handlePropertySelect:S,getProperties:f}=xi({collectionContextStore:n,collectionSettingsStore:i,feature:o,onPropertySelect:s}),y=(0,un.g3)({feature:o,databaseType:g});return(0,v.jsx)(ji,{intl:u,icon:xt.v,caption:(0,v.jsx)(l.FormattedMessage,{...y}),collectionContextStore:n,buttonPopupStore:c,shouldGroupProperties:!0,getGroupedProperties:f,currentProperty:t,disabled:d,onAccept:r.canConfigureBlock&&r.canConfigureCollection?S:()=>{},renderProperty:(e,t,i,r)=>(0,v.jsx)(gi,{version:"v2",feature:o,menuProps:e,property:t,defaultProperty:p,checkState:i,propertySchema:r,collectionContextStore:n,handleDefaultPropertySelect:m,handlePropertySelect:S})})}function bi(e){window.__c={n:"DatePropertyPicker"};const{currentPropertyId:t,collectionContextStore:o,onPropertyChanged:i,disabled:r,title:s}=e,c=(0,l.useIntl)(),d=(0,a.qz)(void 0,go.Z),u=(0,a.VK)((()=>o.normalizedSchemaStore.state),[o]),p=(0,n.useCallback)((()=>Object.keys(u).filter((e=>{const t=u[e];return"date"===(null==t?void 0:t.type)})).filter(z.$K)),[u]);return(0,v.jsx)(ji,{intl:c,buttonPopupStore:d,title:s,collectionContextStore:o,shouldGroupProperties:!1,getProperties:p,currentProperty:t,disabled:r,onAccept:e=>{e&&i(e),d.setState({open:!1})}})}function ji(e){window.__c={n:"PopupPropertyPicker"};const{currentProperty:t,icon:o,caption:n,buttonPopupStore:i,collectionContextStore:s,disabled:c,title:d,shouldGroupProperties:u}=e,p=(0,r.Fy)(),g=(0,a.VK)((()=>{var e;return(null===(e=s.collectionStore())||void 0===e?void 0:e.getFormat())??{}}),[s]),m=(0,a.VK)((()=>s.normalizedSchemaStore.state),[s]),S=(0,f.yK)((e=>({caption:{fontSize:p.isMobile?A.Z.fontSize.UISmall.mobile:A.Z.fontSize.UISmall.desktop,color:e.mediumTextColor,margin:"0 12px 12px 14px"}})),[p]),y=(0,a.VK)((()=>i.state.open),[i]),h=(0,a.VK)((()=>p.isPhone?{menuType:ei.og.ActionSheet}:{menuType:ei.og.Popup,width:300}),[p.isPhone]);return(0,v.jsxs)(v.Fragment,{children:[n&&(0,v.jsx)("div",{style:S.caption,children:n}),(0,v.jsx)(X.ZP,{popupType:p.isPhone?oe.kQ.SlideUp:oe.kQ.Popup,alignmentToOrigin:X.vR.End,placementToOrigin:X.pO.Bottom,disabled:c,originGap:0,renderOrigin:e=>{var n;return(0,v.jsx)(B.Z,{title:d??(0,v.jsx)(l.FormattedMessage,{id:"database.viewSettings.relationFeatures.propertyPicker.default.title",defaultMessage:"Property"}),showChevron:!0,right:t?(0,v.jsx)("span",{style:A.Z.textOverflowStyle,children:null===(n=m[t])||void 0===n?void 0:n.name}):void 0,rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0},rotateChevron:y,disabled:c,icon:o,...e})},render:t=>(0,v.jsx)(ee.Z,{...h,children:u?(0,v.jsx)(li,{...e,getGroupedProperties:e.getGroupedProperties,format:g,schema:m}):(0,v.jsx)(ui.Z,{getProperties:e.getProperties,currentProperty:e.currentProperty,onAccept:e.onAccept,format:g,schema:m})}),buttonPopupStore:i})]})}const Mi="consume_gap",_i=!0;function Ti(e){var t;window.__c={n:"DateShiftingConfigSection"};const{currentConfig:o,onConfigChange:i,disabled:s,collectionContextStore:c}=e,d=(0,a.VK)((()=>c.databaseType),[c]),u=(0,r.O7)(),p=null===(t=o.configWithoutDates)||void 0===t?void 0:t.mode,[g,m]=(0,n.useState)((0,z.$K)(o.configWithoutDates)?Boolean(o.configWithoutDates.avoid_weekends):_i),S=(0,z.$K)(o.configWithoutDates)?Boolean(o.configWithoutDates.avoid_weekends):g;(0,n.useEffect)((()=>{if((0,z.$K)(o.configWithoutDates)){const e=Boolean(o.configWithoutDates.avoid_weekends);e!==g&&m(e)}}),[o,g]);const y=(0,f.yK)((()=>({dateShiftContainer:{marginLeft:4},previewContainer:{marginLeft:4},previewTitle:{paddingLeft:10}})),[]),h=(0,n.useCallback)((e=>{(0,z.$K)(o.configWithoutDates)&&(i({...o,configWithoutDates:{...o.configWithoutDates,avoid_weekends:e}}),Yn.wd({environment:u,collectionContextStore:c,action:"update_dependency_date_shift_avoid_weekends",new_avoid_weekends:e}))}),[c,o,u,i]),x=(0,n.useCallback)((e=>{(0,z.$K)(e)?i({...o,configWithoutDates:{...o.configWithoutDates,mode:e,avoid_weekends:g}}):i({...o,configWithoutDates:void 0}),Yn.wd({environment:u,collectionContextStore:c,action:"update_dependency_date_shift_mode",new_date_shift_mode:e??"none"})}),[c,o,u,g,i]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(ne.Z,{title:(0,v.jsx)(l.FormattedMessage,{...un.dH.dateShiftingSectionCaption}),disableMobileBorders:!0,style:y.previewContainer,desktopTitleStyle:y.previewTitle,children:(0,v.jsx)(Ln,{mode:p})}),(0,v.jsx)(ne.Z,{disableMobileBorders:!0,style:y.dateShiftContainer,children:(0,v.jsx)(Ii,{currentMode:p,onModeChange:x,databaseType:d,disabled:s})}),(0,v.jsxs)(ne.Z,{children:[(0,v.jsx)(Fi,{currentValue:S,databaseType:d,onChange:h,disabled:s||!(0,z.$K)(o.configWithoutDates)}),(0,v.jsx)(ki,{...e})]})]})}function ki(e){window.__c={n:"DatePropertiesConfigSection"};const{collectionContextStore:t,currentConfig:o,onConfigChange:i,disabled:r}=e,s=(0,a.VK)((()=>{const e=t.normalizedSchemaStore.state;return Object.keys(e).filter((t=>{const o=e[t];return o&&(0,$e.Lt)(o)}))}),[t]),c=s.length,d=o.datePropertyId?s.find((e=>e!==o.datePropertyId)):void 0,u="string"==typeof o.datePropertyId&&(0,z.$K)(o.endDatePropertyId),p=(0,n.useCallback)(((e,t)=>{const n={[e]:t};if(u&&(0,z.$K)(o.datePropertyId)){const i="datePropertyId"===e?"endDatePropertyId":"datePropertyId";o[i]===t&&(n[i]=s.find((e=>e!==t)))}i({...o,...n})}),[o,s,i,u]);return!(0,z.$K)(o.configWithoutDates)||c<=1?null:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(bi,{collectionContextStore:t,currentPropertyId:o.datePropertyId,title:u?(0,v.jsx)(l.FormattedMessage,{...un.dH.startDate}):(0,v.jsx)(l.FormattedMessage,{...un.dH.datePropertyPickerTitle}),onPropertyChanged:e=>p("datePropertyId",e),disabled:r}),(0,z.$K)(d)&&"string"==typeof o.datePropertyId&&(0,v.jsxs)(v.Fragment,{children:[(0,z.$K)(o.endDatePropertyId)&&(0,v.jsx)(bi,{collectionContextStore:t,currentPropertyId:o.endDatePropertyId,title:(0,v.jsx)(l.FormattedMessage,{...un.dH.endDate}),onPropertyChanged:e=>p("endDatePropertyId",e),disabled:r}),(0,v.jsx)(ie.Z,{title:(0,v.jsx)(l.FormattedMessage,{id:"database.viewSettings.relationFeatures.datePropertyPicker.separateStartEnd",defaultMessage:"Separate start and end dates"}),focused:!1,on:u,disabled:r,disabledFeedback:!0,onClick:()=>{i({...o,endDatePropertyId:u?void 0:d})}})]})]})}function Vi(e){const{collectionSettingsStore:t,feature:o,permissionScopes:n}=e,i=!n.canConfigureCollection&&!n.canConfigureBlock;return(0,v.jsx)(B.Z,{icon:qn.H,showChevron:!0,disabled:i,title:(0,v.jsx)(l.FormattedMessage,{...un.dH.advancedSettings}),onClick:()=>{d.H4({collectionSettingsStore:t,item:{type:"relationFeaturesAdvancedSettings",feature:o}})}})}function Pi(e){window.__c={n:"TurnOnFeatureButton"};const{feature:t,handleAddRelation:o,databaseType:n,permissionScopes:i}=e,r=(0,f.yK)((e=>({button:{width:"100%"},buttonWrap:{margin:"0px 12px"}})),[]);if(!i.canConfigureBlock||!i.canConfigureCollection)return null;const a=(0,un.Tq)({feature:t,databaseType:n});return(0,v.jsx)(ne.Z,{disableMobileBorders:!0,children:(0,v.jsx)("div",{style:r.buttonWrap,children:(0,v.jsx)(Q.Z,{style:r.button,onClick:o,isLarge:!0,children:(0,v.jsx)(l.FormattedMessage,{...a})})})})}function Ai(e){window.__c={n:"TurnOffFeatureMenuItem"};const{feature:t,permissionScopes:o,propertyName:n,relationPropertyId:i,inversePropertyName:s,collectionContextStore:c,collectionSettingsStore:u,handleDefaultPropertySelect:g,databaseType:m,clearCollectionViewSubitemDisplayMode:S}=e,y=(0,r.O7)(),h=(0,f.yK)((e=>({modalTitle:{fontWeight:A.Z.fontWeight.semibold,fontSize:18},modalInnerStyle:{textAlign:"center"},modalPropertyName:{color:e.darkTextColor,fontWeight:A.Z.fontWeight.semibold}})),[]),x=(0,a.VK)((()=>c.currentSubitemFormatStoreForCollection.state),[c]),C=(0,a.VK)((()=>(0,wn._e)(c)),[c]);if(!(o.canConfigureCollection&&o.canConfigureBlock&&n&&s))return null;const w=(0,un.nB)({feature:t,databaseType:m}),b=(0,un.OH)({feature:t,databaseType:m}),j=(null==x?void 0:x.inverse)===i||(null==x?void 0:x.property)===i,M=(null==C?void 0:C.inverse)===i||(null==C?void 0:C.property)===i,_=j&&M,T={label:(0,v.jsx)(l.FormattedMessage,{...un.dH.turnOffAndDelete}),color:"red",onAccept:async()=>{i&&(await async function(e){const{environment:t,collectionContextStore:o,propertyId:n,feature:i}=e,r=o.normalizedSchemaStore.state,a=o.collectionStore();if(!a)return;await p.createAndCommitAsync({environment:t,userAction:"CollectionSettingsViewRelationFeatures.handleTurnOffFeatureAndDeleteAccept",waitForServerCommit:!1,perform:e=>en.yV({environment:t,collectionStore:a,schema:r,property:n,transaction:e})});const s=r[n];s&&Yn.y9({environment:t,collectionContextStore:o,property_type:s.type,from:i,property:n})}({environment:y,propertyId:i,collectionContextStore:c,feature:t}),g(void 0),null==S||S(),d.wl({collectionSettingsStore:u,item:{type:"main"}}))}},k={label:(0,v.jsx)(l.FormattedMessage,{...un.dH.turnOffFeature}),color:"red",onAccept:()=>{i&&(g(void 0),null==S||S(),d.wl({collectionSettingsStore:u,item:{type:"main"}}))}};return(0,v.jsx)(B.Z,{icon:P.y,title:(0,v.jsx)(l.FormattedMessage,{...w}),isRed:!0,onClick:()=>{F.showDialog({description:(0,v.jsx)(l.FormattedMessage,{...un.dH.turnOffFeatureDeletedProperties,values:{span:e=>(0,v.jsx)("span",{style:h.modalPropertyName,children:e}),propertyName:n,inversePropertyName:s}}),message:(0,v.jsx)("div",{style:h.modalTitle,children:(0,v.jsx)(l.FormattedMessage,{...b})}),innerStyle:h.modalInnerStyle,showCancel:!0,keepFocus:!0,items:_?[T,k]:[T]})}})}function Fi(e){const{currentValue:t,onChange:o,disabled:n,databaseType:i}=e;return(0,v.jsx)(ie.Z,{title:(0,v.jsx)(l.FormattedMessage,{...un.dH.avoidWeekendsSwitcherTitle}),caption:(0,v.jsx)(l.FormattedMessage,{...(0,un.Bq)(i)}),shouldWrapCaption:!0,shouldWrapTitle:!0,focused:!1,on:t,disabled:n,disabledFeedback:!0,onClick:()=>o(!t)})}function Ii(e){window.__c={n:"DateShiftModeSelect"};const{currentMode:t,onModeChange:o,disabled:n,databaseType:i}=e,r=(0,f.yK)((e=>({wrap:{display:"flex",flexDirection:"column",rowGap:8,marginLeft:12,marginRight:12}})),[]);return(0,v.jsx)("div",{style:r.wrap,children:[...$n.Bp,void 0].map((e=>(0,v.jsx)(Zi,{dateShiftingMode:e,databaseType:i,onClick:()=>o(e),active:e===t,disabled:n},e??"none")))})}function Zi(e){window.__c={n:"DateShiftButton"};const{dateShiftingMode:t,onClick:o,active:n,disabled:i,databaseType:a}=e,s=(0,r.Fy)(),c=(0,f.yK)((e=>({buttonStyles:{fontSize:s.isMobile?A.Z.fontSize.UISmall.mobile:A.Z.fontSize.UISmall.desktop,fontWeight:A.Z.fontWeight.medium,borderRadius:4,width:"100%",padding:"8px 8px",boxShadow:`0 0 0 1px ${e.regularDividerColor}`,color:e.darkTextColor,fill:e.mediumTextColor,...n&&{boxShadow:`0 0 0 2px ${e.blueColor}`,color:e.blueColor,fill:e.blueColor},...i&&{opacity:.65}},icon:{width:20,height:20,marginRight:6},buttonContentWrap:{display:"flex",alignItems:"center"}})),[n,s,i]),d=(0,un.W3)({dateShiftingMode:t,databaseType:a}),u=(0,un.l7)(t);return(0,v.jsx)(K.Z,{style:c.buttonStyles,onClick:o,disabled:i,children:(0,v.jsxs)("div",{style:c.buttonContentWrap,children:[(0,v.jsx)("div",{children:u(c.icon)}),(0,v.jsx)("div",{children:(0,v.jsx)(l.FormattedMessage,{...d})})]})})}function Bi(e){const{environment:t,newConfig:o,collectionStore:n,transaction:i,intl:r}=e;let a;if((0,z.$K)(o.configWithoutDates))if(o.datePropertyId)a={...o.configWithoutDates,date_property:o.datePropertyId,end_date_property:o.endDatePropertyId};else{const e=(0,Qn.ZP)(),s={name:r.formatMessage(un.dH.newDateProperty),type:"date"};Jn.xO({environment:t,collectionStore:n,update:{[e]:s},transaction:i}),a={...o.configWithoutDates,date_property:e,end_date_property:void 0}}Xn.sW({store:n.getFormatStore(),data:{dependency_date_shifting_config:a??null},transaction:i})}function Di(e){const{viewType:t,feature:o}=e;return"timeline_arrows_by"===o?"timeline"===t:"subitem"===o||void(0,z.t1)(o)}function Ki(e){window.__c={n:"CollectionSettingsViewRelationFeatures"};const{collectionContextStore:t,collectionSettingsStore:o,feature:i}=e,s=(0,l.useIntl)(),c=(0,r.Fy)(),d=(0,a.VK)((()=>t.normalizedSchemaStore.state),[t]),u=(0,a.VK)((()=>t.databaseType),[t]),p=(0,a.VK)((()=>t.collectionStore()),[t]),g=Ci({collectionContextStore:t,feature:i}),m=null==g?void 0:g.property,S=(0,n.useMemo)((()=>nn.HI(d)),[d]),y=(0,a.VK)((()=>t.permissionScopes.state),[t]),h=(0,a.VK)((()=>{var e;return m&&(null===(e=d[m])||void 0===e?void 0:e.name)}),[d,m]),x=(0,a.VK)((()=>t.collectionViewStore()),[t]),C=(0,a.VK)((()=>null==x?void 0:x.getFormat()),[x]),w=(null==C?void 0:C.subitem_display_mode)??"show",b=(0,a.VK)((()=>{const e=m&&d[m];if(e&&"relation"===e.type){var t;const o=e.property;return o?null===(t=d[o])||void 0===t?void 0:t.name:void 0}}),[m,d]),j=(0,a.VK)((()=>{const e=t.collectionStore();return null!=e&&e.isDefined()?pn.aI(s,{sourceCollection:e.getModel(),isSelfRelation:!0,targetCollectionStore:e,createUnique:!0,from:i}):s.formatMessage({id:"database.viewSettings.relationsPropertyTab.inverseName.placeholder",defaultMessage:"Related to this database"})}),[t,s,i]),M=(0,a.VK)((()=>Boolean(p&&function(e){const{collectionContextStore:t,collectionStore:o}=e,n=o.getFormat().collection_default_arrows_by,i=t.currentArrowsByFormatStore.state;return!(0,z.$K)(i)||i===n}({collectionContextStore:t,collectionStore:p}))),[t,p]),_=(0,a.qz)(void 0,go.Z),T=(0,n.useCallback)((e=>{e&&_.setState({open:!1})}),[_]),{initialPropertyName:k}=hi({collectionContextStore:t,feature:i}),V=xi({collectionContextStore:t,collectionSettingsStore:o,onPropertySelect:T,feature:i}),{handleAddRelation:P,handleDefaultPropertySelect:F,clearCollectionViewSubitemDisplayMode:I}=V,B=(0,gn.E)("collection_level_subitems_setting"),D=(0,f.yK)((e=>({container:{marginLeft:12,marginRight:12},captionText:{fontSize:c.isMobile?A.Z.fontSize.UISmall.mobile:A.Z.fontSize.UISmall.desktop,color:e.mediumTextColor,fontWeight:A.Z.fontWeight.regular,marginLeft:14},subitemsPreviewContainer:{marginBottom:6,marginLeft:2}})),[c]);if(!p)return null;let K;if("subitem"===i)if(g)K=(0,v.jsxs)(ne.Z,{disableMobileBorders:!0,children:[(0,v.jsx)("div",{style:D.subitemsPreviewContainer,children:(0,v.jsx)(hn,{propertyName:h||k,inversePropertyName:b||j,newDesign:!0,subitemsDisplayMode:w})}),B?(0,v.jsx)(zi,{databaseType:u,permissionScopes:y}):(0,v.jsx)(Hi,{feature:i,databaseType:u,featuredRelationProperty:g,actions:V,permissionScopes:y}),(0,v.jsx)(rn.Z,{size:12,style:{marginTop:4,marginBottom:4}}),(0,v.jsx)(Vi,{collectionSettingsStore:o,feature:i,permissionScopes:y}),(0,v.jsx)(Ai,{feature:i,databaseType:u,permissionScopes:y,propertyName:h,relationPropertyId:m,collectionContextStore:t,collectionSettingsStore:o,handleDefaultPropertySelect:F,inversePropertyName:b,clearCollectionViewSubitemDisplayMode:I})]});else{const e=()=>{P({featureType:"subitem"}),B&&qo.default.afterNextFlush((()=>{const e=t.subitemTreeStore.getState(),o=t.resultsInViewOrder(1).at(0),n=(0,Jo.DY)(e.children,(e=>e.value.store===o));if(n){const e=n.map((e=>e.value.store.pointer)),o=(0,dn.Af)(e);tn.rT({collectionContextStore:t,pathKey:o})}}))};K=(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(hn,{propertyName:h||k,inversePropertyName:b||j,newDesign:!0,subitemsDisplayMode:w}),(0,v.jsx)(Pi,{feature:i,permissionScopes:y,databaseType:u,handleAddRelation:e})]})}else"timeline_arrows_by"===i?K=g?(0,v.jsxs)(v.Fragment,{children:[M?(0,v.jsx)(Ri,{collectionContextStore:t,firstDatePropertyId:S,permissionScopes:y}):(0,v.jsx)(Oi,{collectionContextStore:t,databaseType:u}),(0,v.jsxs)(ne.Z,{topBorder:!0,children:[(0,v.jsx)(Vi,{collectionSettingsStore:o,feature:i,permissionScopes:y}),(0,v.jsx)(Hi,{feature:i,databaseType:u,featuredRelationProperty:g,actions:V,permissionScopes:y}),(0,v.jsx)(Ai,{feature:i,databaseType:u,permissionScopes:y,relationPropertyId:m,propertyName:h,inversePropertyName:b,collectionContextStore:t,collectionSettingsStore:o,handleDefaultPropertySelect:F})]})]}):(0,v.jsx)(Ei,{databaseType:u,collectionContextStore:t,firstDatePropertyId:S,handleAddRelation:P,permissionScopes:y}):(0,z.t1)(i);const O=(0,un.Gt)({feature:i,databaseType:u}),R=(0,un.qi)({feature:i,databaseType:u});return(0,v.jsxs)(Z.ZP,{...e,title:(0,v.jsx)(l.FormattedMessage,{...O}),children:[(0,v.jsx)(ne.Z,{disableMobileBorders:!0,children:(0,v.jsx)("div",{style:{...D.container,...D.captionText},children:(0,v.jsx)(l.FormattedMessage,{...R})})}),K]})}function Oi(e){window.__c={n:"DateShiftingNotApplicableToThisViewMessage"};const{collectionContextStore:t,databaseType:o}=e,n=(0,r.MO)(),i=(0,f.yK)((e=>({wrap:{boxShadow:e.plainButtonBoxShadow,...n?{backgroundColor:e.sidebarBackground,margin:void 0,borderRadius:void 0}:{background:"rgba(196, 196, 196, 0.13)",marginTop:14,marginBottom:20}},iconWithMessage:{display:"flex",gap:8},icon:{width:14,height:14,position:"relative",top:1,color:e.mediumTextColor}})),[n]),s=(0,a.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getNormalizedDependencyDateShiftingConfig()}),[t]),c=(0,un.uM)({currentDateShiftConfig:s,databaseType:o});return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(ne.Z,{title:(0,v.jsx)(l.FormattedMessage,{...un.dH.dateShiftingSectionCaption}),children:(0,v.jsx)(Ln,{mode:null==s?void 0:s.mode})}),(0,v.jsx)(O,{style:i.wrap,showCloseButton:!1,children:(0,v.jsxs)("div",{style:i.iconWithMessage,children:[(0,Xo.D)(i.icon),(0,v.jsx)(an.Z,{isSmall:!0,isMultiline:!0,children:(0,v.jsx)(l.FormattedMessage,{...c})})]})})]})}function Ri(e){window.__c={n:"FeatureEnabledDependenciesSection"};const{collectionContextStore:t,firstDatePropertyId:o,permissionScopes:i}=e,s=(0,r.O7)(),c=(0,l.useIntl)(),d=(0,a.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getNormalizedDependencyDateShiftingConfig()}),[t]),u=(0,n.useCallback)((e=>{const o=t.collectionStore();o&&p.createAndCommit({userAction:"FeatureEnabledDependenciesSection.handleConfigChange",environment:s,perform:t=>{Bi({collectionStore:o,environment:s,intl:c,newConfig:e,transaction:t})}})}),[t,s,c]),g=(0,n.useMemo)((()=>({configWithoutDates:d,...d?{datePropertyId:d.date_property,endDatePropertyId:d.end_date_property}:{datePropertyId:o}})),[d,o]);return(0,v.jsx)(Ti,{collectionContextStore:t,currentConfig:g,disabled:!i.canConfigureBlock||!i.canConfigureCollection,onConfigChange:u})}function Ei(e){window.__c={n:"FeatureDisabledDependenciesSection"};const{collectionContextStore:t,handleAddRelation:o,firstDatePropertyId:i,permissionScopes:r,databaseType:a}=e,[s,l]=(0,n.useState)({datePropertyId:i,configWithoutDates:{mode:Mi,avoid_weekends:_i}});return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(Ti,{collectionContextStore:t,currentConfig:s,disabled:!r.canConfigureBlock||!r.canConfigureCollection,onConfigChange:l}),(0,v.jsx)(Pi,{feature:"timeline_arrows_by",permissionScopes:r,databaseType:a,handleAddRelation:()=>{o({featureType:"timeline_arrows_by",dateShiftingConfig:s})}})]})}function Hi(e){window.__c={n:"ToggleViewVisibilityMenuItem"};const{feature:t,featuredRelationProperty:o,actions:n,permissionScopes:i,databaseType:a}=e,s=(0,gn.E)("collection_level_subitems_setting"),c=(0,r.Fy)(),d=(0,f.yK)((()=>({eyeHideIcon:{width:20,height:c.isMobile?24:12,marginLeft:3}})),[c]);if(!o.supportedInView)return null;const u=o.enabledOnView,p=o.isVisibleInView,g=p?{icon:Yo.B,iconStyle:d.eyeHideIcon}:{icon:Qo.c};return(0,v.jsx)(B.Z,{...g,onClick:()=>{n.handlePropertySelect(u?void 0:o.property)},title:(0,v.jsx)(l.FormattedMessage,{...(0,un.cn)({feature:t,isOn:p,databaseType:a,isCollectionLevelSubitemSetting:s})}),disabled:!i.canConfigureBlock})}function Li(e){const{subitemDisplayMode:t,collectionViewType:o,intl:n,databaseType:i}=e;if("show"===t)switch(o){case"board":case"calendar":case"gallery":return n.formatMessage({id:"getTitleForSubitemDisplayModeMenuItem.onCard",defaultMessage:"On card"});case"table":case"list":case"timeline":case"page":return n.formatMessage({id:"getTitleForSubitemDisplayModeMenuItem.nestedInToggle",defaultMessage:"Nested in toggle"})}else{if("hidden"===t)return n.formatMessage({id:"subitemDisplayModeMenuItemTitle.hideSubitems",defaultMessage:"Hide sub-{items}"},{items:(0,on.Q_)(i,!0)});if("flattened"===t)return n.formatMessage({id:"subitemDisplayModeMenuItemTitle.flattenedList",defaultMessage:"Flattened list"});(0,z.t1)(t)}}const Ni=["show","hidden","flattened"];function Wi(e){const{intl:t,collectionViewType:o,databaseType:n}=e;return Ni.map((e=>({key:e,title:Li({intl:t,collectionViewType:o,subitemDisplayMode:e,databaseType:n})})))}function zi(e){window.__c={n:"SubitemDisplayModeMenuItem"};const{databaseType:t,permissionScopes:o}=e,i=(0,gn.E)("collection_subitem_new_show_hide_options"),s=(0,gn.E)("collection_level_subitems_setting"),c=(0,l.useIntl)(),d=(0,sn.Y$)(),g=(0,a.VK)((()=>d.collectionViewStore()),[d]),m=(0,a.VK)((()=>null==g?void 0:g.getFormat()),[g]),S=(null==m?void 0:m.subitem_display_mode)??"show",y="show"===S,h=(0,r.Fy)(),x=(0,r.O7)(),C=(0,f.yK)((()=>({eyeHideIcon:{width:20,height:h.isMobile?24:12,marginLeft:3}})),[h]),w=n.useCallback((()=>{g&&p.createAndCommit({userAction:"actionRegistry.updateCollectionViewSubitemDisplayMode",environment:x,perform:e=>{u.FH({stores:[g],update:{subitem_display_mode:y?"flattened":"show",collection_view_subitem:y?void 0:(0,dn.wf)(d)},transaction:e})}})}),[y,d,g,x]),b=n.useCallback((e=>{const t=d.getPropertyFormatKey(),o=(0,dn.wf)(d),n=null==o?void 0:o.property,i=null==o?void 0:o.inverse;g&&t&&n&&i&&e&&e!==S&&p.createAndCommit({userAction:"actionRegistry.updateCollectionViewSubitemDisplayMode",environment:x,perform:o=>{const r=g.getType(),a="board"===r||"gallery"===r||"calendar"===r;if(en.er({formatStore:g,formatKey:t,property:n,update:{visible:a&&"show"===e},transaction:o}),"hidden"===S){var s;const e=null==m||null===(s=m.property_filters)||void 0===s?void 0:s.filter((e=>e.id!==cn.OC));u.FH({stores:[g],update:{property_filters:e},transaction:o})}if("hidden"===e){const e={property:i,filter:{operator:"is_empty"}},t=(null==m?void 0:m.property_filters)||[];u.FH({stores:[g],update:{property_filters:[...t,{id:cn.OC,filter:e}]},transaction:o})}u.FH({stores:[g],update:{subitem_display_mode:e},transaction:o})}})}),[d,g,x,m,S]);(0,n.useEffect)((()=>{ln.j(x,"configure_subitem_display_mode",{userAction:y?"CollectionSettingsViewRelationFeatures.configureSubitemDisplayMode.flattened":"CollectionSettingsViewRelationFeatures.configureSubitemDisplayMode.show"})}),[y,x]);const j=y?{icon:Qo.c}:{icon:Yo.B,iconStyle:C.eyeHideIcon},M=(0,a.VK)((()=>(null==g?void 0:g.getType())??"table"),[g]);return"chart"===M?(0,v.jsx)(v.Fragment,{}):i?(0,v.jsx)(mn.Z,{title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Show",id:"SubitemDisplayModeMenuItem.menuItemTitle"}),collectionContextStore:d,selectedKey:S,options:Wi({collectionViewType:M,intl:c,databaseType:t}),onChange:e=>b(e),disabled:!o.canConfigureBlock}):(0,v.jsx)(B.Z,{...j,onClick:w,title:(0,v.jsx)(l.FormattedMessage,{...(0,un.cn)({feature:"subitem",isOn:y,databaseType:t,isCollectionLevelSubitemSetting:s})}),disabled:!o.canConfigureBlock})}var Ui=o(91),Gi=o(80402),$i=o(24006),qi=o(60442);function Qi(e){const{render:t,showImage:o,caption:i,tooltipImage:r}=e,a=e.tooltipImageScale||1,[s,l]=n.useState(!1),[c,d]=n.useState({width:0,height:0});return n.useEffect((()=>{if(r){const e=new Image;e.src=r,e.onload=()=>{d({width:e.width*a,height:e.height*a}),l(!0)}}}),[r,a]),(0,v.jsx)(Gt.ZP,{placement:Gt.ug.Left,disableTooltip:void 0===i,style:{whiteSpace:"break-spaces"},render:t,renderTooltip:()=>r&&s&&o?(0,v.jsx)(qi.Z,{caption:i,imageURL:r,imageWidth:c.width,imageHeight:c.height}):(0,v.jsx)("div",{children:i})})}const Yi="box1-filter",Xi="box2-filter";function Ji(e){window.__c={n:"CollectionSettingsViewDependenciesPreview2"};const{propertyName:t,inversePropertyName:o}=e,n=(0,f.Fg)(),i=(0,f.yK)((e=>({svgWrap:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:4,alignItems:"center",position:"relative",height:112,backgroundColor:e.accentColors.gray[30],display:"flex",justifyContent:"center"}})),[]);return(0,v.jsx)(ne.Z,{disableMobileBorders:!0,children:(0,v.jsx)("div",{style:i.svgWrap,children:(0,v.jsxs)("svg",{width:"266",height:"116",fill:"none",children:[(0,v.jsx)("path",{stroke:"#DFAF49",strokeWidth:"2",d:"M124 20h.426c7.703 0 17.307-.002 25.029 1.93 3.979.994 8.078 2.638 11.248 5.575C164.082 30.635 166 34.868 166 40c0 8.001-6.095 12.917-11.524 15.932-5.553 3.086-12.74 5.481-19.23 7.644l-.349.116c-6.919 2.307-13.074 4.381-17.546 6.866C112.655 73.166 112 75 112 76c0 1.868.582 2.885 1.453 3.692 1.08 1.001 2.981 1.982 6.002 2.737C125.59 83.963 132.773 84 141 84"}),(0,v.jsx)("path",{stroke:"#E3E2E0",strokeWidth:"2",d:"M125 32c8.227 0 15.41.037 21.545 1.57 3.021.756 4.922 1.737 6.002 2.738.871.807 1.453 1.824 1.453 3.692 0 .999-.655 2.834-5.351 5.443-4.472 2.484-10.627 4.558-17.546 6.865l-.349.116c-6.49 2.163-13.677 4.558-19.23 7.644C106.095 63.084 100 67.998 100 76c0 5.132 1.918 9.365 5.297 12.495 3.17 2.937 7.269 4.581 11.248 5.576C124.267 96 133.871 96 141.574 96H142"}),(0,v.jsx)("path",{fill:n.accentColors.gray[30],d:"M157 27h16v18h-16zM92 70h16v18H92z"}),(0,v.jsx)("path",{stroke:"#DFAF49",strokeWidth:"2",d:"M136 88l5-4-5-4"}),(0,v.jsx)("path",{stroke:"#E3E2E0",strokeWidth:"2",d:"M130 36l-5-4 5-4"}),(0,v.jsxs)("g",{filter:`url(#${Yi})`,children:[(0,v.jsx)("rect",{width:"100",height:"28",x:"24",y:"12",fill:n.buttonBackground,rx:"3"}),(0,v.jsx)("text",{x:"67",y:"31",fill:"#000",children:"🌱"})]}),(0,v.jsxs)("g",{filter:`url(#${Xi})`,children:[(0,v.jsx)("rect",{width:"100",height:"28",x:"142",y:"76",fill:n.buttonBackground,rx:"3"}),(0,v.jsx)("text",{x:"185",y:"95",fill:"#000",children:"🌳"})]}),(0,v.jsx)(er,{x:"161",y:"26",width:"100",height:"16",textStyles:{fontSize:12,fontWeight:590,color:n.regularTextColor},children:t}),(0,v.jsx)(er,{x:"15",y:"69",width:"90",height:"16",textStyles:{color:n.lightTextColor,fontSize:12,fontWeight:500,textAlign:"right"},children:o}),(0,v.jsxs)("defs",{children:[(0,v.jsxs)("filter",{id:Yi,width:"108",height:"36",x:"20",y:"10",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,v.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,v.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,v.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_1034_52436"}),(0,v.jsx)("feOffset",{}),(0,v.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,v.jsx)("feColorMatrix",{values:"0 0 0 0 0.0707 0 0 0 0 0.0693 0 0 0 0 0.0693 0 0 0 0.1 0"}),(0,v.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1034_52436"}),(0,v.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,v.jsx)("feOffset",{dy:"2"}),(0,v.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,v.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,v.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,v.jsx)("feBlend",{in2:"effect1_dropShadow_1034_52436",result:"effect2_dropShadow_1034_52436"}),(0,v.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_1034_52436",result:"shape"})]}),(0,v.jsxs)("filter",{id:Xi,width:"108",height:"36",x:"138",y:"74",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,v.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,v.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,v.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_1034_52436"}),(0,v.jsx)("feOffset",{}),(0,v.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,v.jsx)("feColorMatrix",{values:"0 0 0 0 0.0707 0 0 0 0 0.0693 0 0 0 0 0.0693 0 0 0 0.1 0"}),(0,v.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1034_52436"}),(0,v.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,v.jsx)("feOffset",{dy:"2"}),(0,v.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,v.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,v.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,v.jsx)("feBlend",{in2:"effect1_dropShadow_1034_52436",result:"effect2_dropShadow_1034_52436"}),(0,v.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_1034_52436",result:"shape"})]})]})]})})})}function er(e){const{children:t,textStyles:o,...n}=e;return(0,v.jsx)("foreignObject",{...n,children:(0,v.jsx)("div",{style:{...A.Z.textOverflowStyle,...n.width?{width:Number(n.width)}:{},...o},children:t})})}function tr(e){var t;window.__c={n:"CollectionSettingsDependenciesAdvancedSettings"};const{collectionContextStore:o,collectionSettingsStore:i,feature:r}=e,s=(0,l.useIntl)(),c=(0,gn.E)("collection_level_subitems_setting"),d=(0,a.VK)((()=>o.collectionStore()),[o]),u=(0,a.VK)((()=>o.normalizedSchemaStore.state),[o]),p=(0,a.VK)((()=>o.permissionScopes.state),[o]),g=null===(t=Ci({collectionContextStore:o,feature:r}))||void 0===t?void 0:t.property,m=(0,a.VK)((()=>{var e;return g&&(null===(e=u[g])||void 0===e?void 0:e.name)}),[g,u]),S=(0,a.VK)((()=>{var e;return"table"===(null===(e=o.collectionViewStore())||void 0===e?void 0:e.getType())}),[o]),y=(0,a.VK)((()=>{const e=g&&u[g];if(e&&"relation"===e.type){var t;const o=e.property;return o?null===(t=u[o])||void 0===t?void 0:t.name:void 0}}),[g,u]),h=(0,a.VK)((()=>{const e=o.collectionStore();return null!=e&&e.isDefined()?pn.aI(s,{sourceCollection:e.getModel(),isSelfRelation:!0,targetCollectionStore:e,createUnique:!0,from:r}):s.formatMessage({id:"database.viewSettings.relationsPropertyTab.inverseName.placeholder",defaultMessage:"Related to this database"})}),[o,s,r]),x=(0,a.qz)(void 0,go.Z),{initialPropertyName:C}=hi({collectionContextStore:o,feature:r}),w=(0,n.useCallback)((e=>{e&&x.setState({open:!1})}),[x]),b=(0,f.yK)((()=>({previewContainer:{marginLeft:2}})),[]);if(!d)return null;let j;return"subitem"===r?j=(0,v.jsx)(hn,{propertyName:m||C,inversePropertyName:y||h,newDesign:!0,subitemsDisplayMode:"show"}):"timeline_arrows_by"===r?j=(0,v.jsx)(Ji,{propertyName:m||C,inversePropertyName:y||h}):(0,z.t1)(r),(0,v.jsxs)(Z.ZP,{...e,title:(0,v.jsx)(l.FormattedMessage,{...un.dH.advancedSettings}),children:[(0,v.jsx)("div",{style:b.previewContainer,children:j}),(0,v.jsxs)(ne.Z,{disableMobileBorders:!0,children:[(0,v.jsx)(wi,{currentPropertyId:g,feature:r,onPropertySelect:w,buttonPopupStore:x,collectionContextStore:o,collectionSettingsStore:i,permissionScopes:p,disabled:c&&!p.canConfigureCollection}),"subitem"===r&&S&&(0,v.jsx)(or,{collectionContextStore:o,permissionScopes:p})]})]})}function or(e){window.__c={n:"ToggleNestingOnTitleMenuItem"};const{collectionContextStore:t,permissionScopes:o}=e,i=(0,l.useIntl)(),s=(0,r.O7)(),c=(0,a.VK)((()=>"title"===t.normalizedFormatStore.state.table_subitem_toggle_column),[t]),d=!o.canConfigureBlock,u=(0,n.useCallback)((()=>{const e=t.collectionViewStore();e&&(Gi.d1({environment:s,collectionViewStore:e,currentValue:t.normalizedFormatStore.state.table_subitem_toggle_column}),Yn.wd({environment:s,collectionContextStore:t,action:"toggle_table_subitem_toggle_on_title"}))}),[t,s]);return(0,v.jsx)(Qi,{showImage:o.canConfigureBlock,caption:i.formatMessage(un.dH.toggleNestingOnTitleMenuItemTooltip),tooltipImage:y.Z.images.tooltips.collectionSettings.subitemsToggleOnTitlePng,tooltipImageScale:.3,render:e=>(0,v.jsx)(B.Z,{...e,icon:e=>(0,Ui.L)({width:11,height:11,marginRight:5,marginLeft:6,transform:"rotateZ(180deg)"}),onClick:u,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Show nesting toggle on title",id:"database.viewSettings.layoutTab.tableSubitemToggleOnTitle"}),right:(0,v.jsx)($i.Z,{disallowTabbing:!0,on:c,disabled:d,onClick:u}),disabled:d})})}var nr=o(89475),ir=o(98742),rr=o(30874);function ar(e){window.__c={n:"CollectionSettingsAccountPicker"};const{integration:t,collectionSettingsStore:o,collectionContextStore:n,onAccountSelect:i}=e,s=(0,f.yK)((()=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px 16px 16px 8px"}})),[]),c=(0,r.O7)(),u=(0,a.VK)((()=>{var e;return null===(e=n.collectionStore())||void 0===e?void 0:e.getSpaceId()}),[n]),p=(0,a.VK)((()=>{const e=rr.Z.state;return e.loaded?e.externalAuthentications.filter((e=>e.integration_id===t.id)):[]}),[t]);return t&&u?(0,v.jsx)(Z.ZP,{...e,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Choose an account",id:"collectionSettingsAccountPicker.title"}),footer:sr({environment:c,integration:t,spaceId:u}),children:(0,v.jsx)("div",{style:s.settingsMenu,children:(0,v.jsx)(te.Z,{type:te.i.Vertical,initialFocus:0,sections:[{key:"externalAuthentications",items:p.map((e=>{const n={key:e.id,render:o=>(0,v.jsx)(Gt.ZP,{renderTooltip:()=>(0,v.jsx)("span",{children:e.account_name}),placement:Gt.ug.Left,textWrap:!0,render:n=>(0,v.jsx)(Y.Z,{...(0,ir.Z)(n||{},o),title:e.account_name,icon:(0,v.jsx)("img",{style:{width:18},src:t.info.icon}),focused:o.focused})}),action:()=>{d.z$({collectionSettingsStore:o}),i(e)}};return n})),render:e=>(0,v.jsx)(ne.Z,{...e})}]})})}):null}function sr(e){const t=e.environment.device.isMobileBrowser;return(0,v.jsx)(ne.Z,{topBorder:!0,children:t?void 0:lr(e)})}function lr(e){return(0,v.jsx)(B.Z,{...e,icon:it.R,title:(0,v.jsx)(l.FormattedMessage,{id:"collectionSettingsAccountPicker.addAccount",defaultMessage:"Connect another account"}),isGray:!0,onClick:async()=>{await nr.hM({...e,from:"source_picker_connect_another_account"})}})}var cr=o(8848),dr=o(58573),ur=o(20270),pr=o(35840),gr=o(64002),mr=o(57549),Sr=o(893),fr=o(12170),yr=o(45257),hr=o(68785),xr=o(53336),vr=o(70764),Cr=o(75079);function wr(e){window.__c={n:"CollectionSettingsAccountSelectionIndicator"};const{onClick:t,integration:o,accountName:n}=e,i=(0,f.yK)((e=>({accountSelection:{padding:"8px",borderTop:`1px solid ${e.regularDividerColor}`,cursor:"pointer"},accountSelectionLabel:{fontWeight:A.Z.fontWeight.medium,paddingLeft:4,paddingTop:4}})),[]);return(0,v.jsx)("div",{style:i.accountSelection,children:(0,v.jsxs)("div",{onClick:t,children:[(0,v.jsx)(an.Z,{isSecondaryColor:!0,isSmall:!0,style:i.accountSelectionLabel,children:(0,v.jsx)(l.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.currentAccountSection.label",defaultMessage:"Connected to {integration}",values:{integration:o.name}})}),(0,v.jsx)(Gt.ZP,{renderTooltip:()=>(0,v.jsx)("span",{children:n}),placement:Gt.ug.Left,textWrap:!0,render:t=>(0,v.jsx)(Y.Z,{showExtensionArrow:!0,focused:!1,...(0,ir.Z)(t||{},e),title:n,icon:(0,v.jsx)("img",{style:{width:18},src:o.info.icon})})})]})})}var br=o(29109),jr=o(89728),Mr=o(31278),_r=o(1634);function Tr(e){window.__c={n:"CollectionSettingsExternalAuthentication"};const{collectionContextStore:t,integration:o}=e,n=(0,f.Fg)(),i=(0,a.VK)((()=>t.collectionStore()),[t]),s=(0,a.VK)((()=>null==i?void 0:i.getIcon()),[i]),c=(0,r.O7)(),d=(0,a.VK)((()=>{var e;return null===(e=Jt.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),u=(0,f.yK)((e=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px 16px 16px 8px"},authenticationBody:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",padding:"0px 16px 16px 16px",textAlign:"center"},settingsMenuSubHeading:{display:"inline",fontSize:14,margin:"4px 20px 20px 20px",color:e.mediumTextColor,textAlign:"center"},settingsMenuAuthenticationButton:{fontSize:14,height:32,color:e.regularInvertedTextColor}})),[]),{background:p,hoveredBackground:g,pressedBackground:m}=(0,br.d)(o,n.mode);return(0,v.jsx)(Z.ZP,{...e,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Connect to {integration}",id:"collectionSettingsCreateExternalViewPicker.authenticateHeader.title",values:{integration:o.name}}),children:(0,v.jsx)("div",{style:u.settingsMenu,children:(0,v.jsxs)("div",{style:u.authenticationBody,children:[(0,v.jsx)(Mr.Z,{disabled:!0,bucket:"secure",store:i,icon:s,size:40,isEmptyPage:!1,style:{marginBottom:6}}),(0,v.jsx)("div",{style:u.settingsMenuSubHeading,children:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Link your {integration} account for richer content previews and seamless imports.",id:"collectionSettingsCreateExternalViewPicker.authenticateBody.title",values:{integration:o.name}})}),(0,v.jsx)(jr.Z,{onClick:()=>{d&&(nr.hM({environment:c,integration:o,spaceId:d,from:"placeholder_root_external_collection_view_block"}),_r.Z.reset())},style:{background:p,...u.settingsMenuAuthenticationButton},hoveredStyle:{background:g},pressedStyle:{background:m},children:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Connect to {integration}",id:"collectionSettingsCreateExternalViewPicker.authenticateButton.title",values:{integration:o.name}})})]})})})}function kr(e){window.__c={n:"CollectionSettingsCreateExternalViewPicker"};const{collectionSettingsStore:t,collectionContextStore:o,externalAuthentication:n}=e,i=(0,a.VK)((()=>o.collectionStore()),[o]),r=(0,a.VK)((()=>{if(!i)return;const e=i.getFormat().integration_id;return rr.Z.integrations.state.find((t=>t.id===e))}),[i]),s=(0,a.VK)((()=>!!r&&(0,vr.NP)(r.id).length>0),[r]),l=(0,a.VK)((()=>{var e;return null===(e=Jt.default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit()}),[]);return i&&l&&r?(0,v.jsx)(v.Fragment,{children:s?(0,v.jsx)(Ar,{...e,collectionContextStore:o,collectionSettingsStore:t,integration:r,externalAuthentication:n}):(0,v.jsx)(Tr,{...e,collectionContextStore:o,collectionSettingsStore:t,integration:r})}):null}const Vr=e=>{var t;return null===(t=e.integration.info)||void 0===t||null===(t=t.original_url_patterns)||void 0===t?void 0:t.filter((e=>{var t;return null===(t=e.additional_types)||void 0===t?void 0:t.collection})).find((t=>{let{regex:o}=t;return new RegExp(o).test(e.url)}))},Pr=(0,l.defineMessages)({all:{id:"collectionSettingsCreateExternalViewPicker.filters.all",defaultMessage:"All"},issues:{id:"collectionSettingsCreateExternalViewPicker.filters.issues",defaultMessage:"Issues"},pull_requests:{id:"collectionSettingsCreateExternalViewPicker.filters.pullRequests",defaultMessage:"Pull Requests"},board:{id:"collectionSettingsCreateExternalViewPicker.filters.boards",defaultMessage:"Boards"},project:{id:"collectionSettingsCreateExternalViewPicker.filters.projects",defaultMessage:"Projects"},Releases:{id:"collectionSettingsCreateExternalViewPicker.filters.releases",defaultMessage:"Releases"},"Pull Request":{id:"collectionSettingsCreateExternalViewPicker.filters.PullRequests",defaultMessage:"Pull Requests"},Issues:{id:"collectionSettingsCreateExternalViewPicker.filters.Issues",defaultMessage:"Issues"}});function Ar(e){window.__c={n:"CollectionSettingsSourceSelection"};const{integration:t,collectionContextStore:o,collectionSettingsStore:i,externalAuthentication:s}=e,[c,u]=(0,n.useState)(""),p=(0,a.VK)((()=>{const e=rr.Z.state;return e.loaded?e.externalAuthentications.filter((e=>e.integration_id===t.id)):[]}),[t]),g=(0,a.VK)((()=>s||(p.length?p[0]:null)),[p,s]),[m,S]=(0,n.useState)(!1),[y,x]=(0,n.useState)(null),C=(0,f.yK)((e=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px"},settingsMenuSearchBox:{background:e.contentBackground,marginBottom:10},syncSourceButton:{width:"100%",display:"flex",justifyContent:"center"},noResults:{width:"100%",paddingBottom:10,display:"flex",justifyContent:"center",fontSize:14,color:e.mediumTextColor},suggestionBox:{display:"flex",alignItems:"center",fontSize:12,color:cr.ZP.white,background:cr.ZP.blue,borderRadius:6,padding:10,boxShadow:e.largeLightBoxShadow,alignSelf:"center",maxWidth:"80%"},errorMessage:{alignSelf:"center",padding:10,fontSize:14,color:e.errorText},syncingData:{width:"100%",paddingBottom:10,display:"flex",justifyContent:"center",fontSize:14,color:e.mediumTextColor},filterContainer:{position:"relative",flexGrow:0,overflow:"hidden"},filterContainerScroller:{display:"flex",alignItems:"center",padding:"8px 12px"}})),[]),w=(0,a.VK)((()=>o.collectionStore()),[o]),b=(0,a.VK)((()=>o.collectionViewBlockStore()),[o]),j=(0,r.O7)(),[{value:M,status:_}]=(0,h.r5)((async()=>{if(!g)return;const e=g.parent_id;return se.listExternalCollections(j,{bot_id:e})}),[j,g]),T="success"===(null==M?void 0:M.type)&&"data"in M.data?M.data.data:[],k="success"===(null==M?void 0:M.type)&&"error"in M.data?M.data.error:null,V=T.filter((e=>!y||e.type===y)),P=V.length?(0,dr.ZP)(c,V,(e=>e.title)):[],A=Array.from(new Set(T.map((e=>e.type)))),I=Vr({integration:t,url:c}),B=async e=>{if(S(!0),!w||!b)return;const n=e||c,r=Vr({integration:t,url:n});if(!r)return S(!1),void F.showDialog({items:[{label:(0,v.jsx)(l.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.copyDebuggingInformation",defaultMessage:"Copy debugging information"}),color:"blue",onAccept:()=>{Sr.RD({environment:j,stringValue:JSON.stringify({botId:null==g?void 0:g.parent_id,url:n},null,2),copiedMessage:Sr.tq.copiedToClipboard})}},{label:(0,v.jsx)(l.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.closeButton",defaultMessage:"Close"}),onAccept:()=>{}}],showCancel:!1,keepFocus:!1,message:(0,v.jsx)(l.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.title",defaultMessage:"This source is currently not supported. Please try a different source."})});const a=(0,vr.NP)(t.id);await fr.UY({environment:j,url:n,botIds:a.map((e=>e.id)),externalCollectionStore:w,externalCollectionViewBlockStore:b});const{host:s}=(0,gr.Qc)(n);mr.Mp(j,{...(0,Cr.Pn)(o),integrationId:t.id,type:"collection",entity:r.name,domain:s||"",from:"external_picker_settings"}),d.wl({collectionSettingsStore:i,item:{type:"shareSyncedView",integrationName:t.name,integrationIcon:t.info.icon}}),S(!1)};if(!w||!b)return null;const D=A.length>1?(0,v.jsx)("div",{style:C.filterContainer,children:(0,v.jsxs)(xr.Z,{type:Uo.Z.X,style:C.filterContainerScroller,showLeftRightOverlay:!1,children:[(0,v.jsx)(yr.Z,{title:(0,v.jsx)("span",{children:ii.default.formatMessage(Pr.all)}),on:!(0,z.K0)(y),hideChevron:!0,onClick:e=>{(0,zo.ZP)({event:e,context:zo.Af.CollectionSettingsClick,callback:()=>{x(null)}})}},"all"),A.map((e=>(0,v.jsx)(yr.Z,{title:(0,v.jsx)("span",{children:ii.default.formatMessage(Pr[e])}),on:y===e,hideChevron:!0,onClick:t=>{(0,zo.ZP)({event:t,context:zo.Af.CollectionSettingsClick,callback:()=>{x((t=>t===e?null:e))}})}},e)))]})}):null,K=I?(0,v.jsx)("div",{style:C.syncSourceButton,children:(0,v.jsx)(Q.Z,{isLarge:!0,onClick:e=>{(0,zo.ZP)({event:e,context:zo.Af.CollectionSettingsClick,callback:()=>{B()}})},disabled:!1,children:(0,v.jsx)(l.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.syncSourceButton.label",defaultMessage:"Sync Source"})})}):null,O=I||T.length&&P.length?null:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{style:C.noResults,children:(0,v.jsx)(l.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.noResults.text",defaultMessage:"No results"})}),(0,v.jsxs)("div",{style:C.suggestionBox,children:[(0,Xo.D)({marginRight:8,width:14,height:14}),(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Try different search or paste any {integration} URL",id:"collectionSettingsCreateExternalViewPicker.noResults.help",values:{integration:t.name}})]})]}),R=T.length&&P.length?(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(te.Z,{type:te.i.Vertical,initialFocus:0,sections:[{key:"collections",items:P.map((e=>{const t={key:e.url,render:t=>(0,v.jsx)(Gt.ZP,{renderTooltip:()=>(0,v.jsx)("span",{children:e.title}),placement:Gt.ug.Left,textWrap:!0,render:o=>(0,v.jsx)(Y.Z,{...(0,ir.Z)(o||{},t),title:e.title,icon:(0,v.jsx)("img",{style:{width:18},src:e.icon}),caption:e.parent.title})}),action:t=>{"stopPropagation"in t.event&&t.event.stopPropagation(),B(e.url)}};return t})),render:e=>(0,v.jsx)(ne.Z,{...e,disableMobilePadding:!0})}]})}):null,E="pending"===_||"idle"===_||m;if(!g||k&&(k.status===ur.mQ.UNAUTHORIZED||k.status===ur.mQ.FORBIDDEN))return(0,v.jsx)(Tr,{collectionContextStore:o,collectionSettingsStore:i,integration:t});const H="rejected"===_||"failed"===(null==M?void 0:M.type)||k,L=(0,v.jsx)(wr,{onClick:()=>{d.H4({collectionSettingsStore:i,item:{type:"selectAccountForExternalSource",integration:t,onAccountSelect:e=>{d.H4({collectionSettingsStore:i,item:{type:"createSyncedViewSource",externalAuthentication:e}})}}})},integration:t,accountName:g.account_name});return(0,v.jsx)(Z.ZP,{...e,footer:K||m?null:L,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Select from {integration}",id:"collectionSettingsCreateExternalViewPicker.title",values:{integration:t.name}}),header:!E&&"resolved"===_&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(zt.ZP,{inputLeft:(0,v.jsx)(zt.f_,{icon:pr.R}),onSubmit:()=>{I&&B()},style:C.settingsMenuSearchBox,focusInitial:!0,value:c,onChange:e=>{u(e.target.value)},placeholder:"Search source or paste a link..."}),I?null:D]}),children:(0,v.jsxs)("div",{style:C.settingsMenu,children:[H&&(0,v.jsx)("div",{style:C.errorMessage,children:(0,v.jsx)(l.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.error.unknown",defaultMessage:"Something went wrong.",values:{integration:t.name}})}),E&&(m?(0,v.jsxs)("div",{style:C.syncingData,children:[(0,v.jsx)("span",{children:(0,v.jsx)(l.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.settingUpSync",defaultMessage:"Setting up sync..."})}),(0,v.jsx)(hr.Z,{style:{alignSelf:"center"}})]}):(0,v.jsxs)("div",{style:C.syncingData,children:[(0,v.jsx)("span",{children:(0,v.jsx)(l.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.loadingData",defaultMessage:"Loading available sources..."})}),(0,v.jsx)(hr.Z,{style:{alignSelf:"center"}})]})),!E&&"resolved"===_&&(0,v.jsxs)(v.Fragment,{children:[K,O,R]})]})})}var Fr=o(26263),Ir=o(49085),Zr=o(93108),Br=o(38715),Dr=o(71214);const Kr=6,Or=6;function Rr(e){window.__c={n:"CollectionSettingsCreateTypedDB"};const t=(0,f.Fg)(),o=(0,r.O7)(),i=o.device,[s,c]=(0,n.useState)(R.br),[u,g]=(0,n.useState)(),m=(0,n.useMemo)((()=>Ir.default.createValue("")),[]),S=(0,n.useMemo)((()=>new Fr.Z({name:"CollectionSettingsCreateTypedDB"})),[]),y=(0,a.VK)((()=>{const t=e.collectionContextStore.collectionStore();if(t)return t.clone(S).getIcon()}),[e.collectionContextStore,S]);(0,n.useEffect)((()=>{var t;void 0===u&&g(null===(t=e.collectionContextStore.collectionViewStore())||void 0===t?void 0:t.getType())}),[e.collectionContextStore,u]),(0,n.useEffect)((()=>{const e=o.defaultRecordCache.inMemoryRecordCache;return e.addCacheOverride(S),()=>{e.removeCacheOverride(S)}}),[o,S]);const h=(0,n.useCallback)((e=>{m.setState(e)}),[m]),x=(0,n.useCallback)(((t,n)=>{const{collectionContextStore:i}=e,r=i.collectionViewStore(),a=i.collectionViewBlockStore();r&&a&&d.nr({environment:o,baseViewType:u,selectedDBType:n,collectionName:m.state,collectionContextStore:i,collectionViewBlockStore:a,collectionViewStore:r,useTemporaryRecordCache:t,temporaryRecordCache:S})}),[e,u,o,m,S]);(0,n.useEffect)((()=>{x(!0,R.br)}),[x]);const C=(0,n.useCallback)((t=>{const{collectionContextStore:o}=e;c(t),x(!0,t),Jn.Ip({collectionContextStore:o})}),[e,x]);const w=(0,n.useCallback)((t=>{var n;const i=null===(n=e.collectionContextStore.collectionStore())||void 0===n?void 0:n.getIconStore().clone(S);i&&p.createAndCommit({userAction:"SpacePermissionGroup.handleIconChange",environment:o,perform:e=>{Xn.sO({store:i,value:t,transaction:e})}})}),[e.collectionContextStore,o,S]),b=(0,n.useCallback)((t=>{(0,zo.ZP)({event:t,context:zo.Af.CollectionSettingsClick,callback:()=>{const{collectionSettingsStore:t}=e;F.showDialog({message:(0,v.jsx)("span",{children:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Would you like to continue creating this database?",id:"collectionSettingsNewDatabase.confirmDialog.prompt"})}),showCancel:!1,keepFocus:!1,items:[{label:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Yes create {selectedType, select, untyped {an {type}} other {a {type}}} database",values:{selectedType:s,type:s===R.br?"empty":(0,on.Mn)(s)},id:"collectionSettingsNewDatabase.confirmDialog.affirmativeButton.label"}),color:"red",onAccept:()=>{x(!1,s),d.E3({collectionSettingsStore:t})}},{label:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Cancel",id:"collectionSettingsNewDatabase.confirmDialog.cancel.label"}),color:"blue",onAccept:()=>{}}]})}})}),[e,s,x]),j=(0,n.useCallback)((()=>{o.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(S);const{collectionContextStore:t,collectionSettingsStore:n}=e,i=t.collectionViewBlockStore(),r=t.collectionViewStore();void 0!==i&&void 0!==r&&(t.setContext({type:"collectionView",collectionViewBlockStore:i,collectionStore:void 0,collectionViewStore:r}),d.H4({collectionSettingsStore:n,item:{type:"createViewSource"}}))}),[o,e,S]);return(0,v.jsxs)(Z.ZP,{...e,handleClose:b,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"New database",id:"database.viewSettings.createTypedDBTab.title"}),footer:(0,v.jsxs)(ne.Z,{topBorder:!0,children:[(0,v.jsx)(B.Z,{icon:Zr.p,isGray:!0,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"View an existing database",id:"database.viewSettings.createTypedDBTab.viewExistingDatabaseButton"}),onClick:j}),(0,v.jsx)(B.Z,{icon:Br.N,isGray:!0,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Import or sync from",id:"database.viewSettings.createTypedDB.importDatabaseButton"})})]}),children:[(0,v.jsx)(ne.Z,{children:(0,v.jsx)(Dr.I,{initialValue:"",placeholder:(0,on.Mn)(s),inputStore:m,onBlur:h,onSubmit:h,iconButton:{icon:e=>(0,v.jsx)(Mr.Z,{isEmptyPage:!0,disabled:!0,defaultIcon:(0,R.T)(s)({width:16,height:16,backfaceVisibility:void 0}),icon:y,size:16,style:{marginRight:6}}),onSubmit:w,includeEmojiTab:!0}})}),(0,v.jsxs)("div",{style:{...!i.isMobile&&{width:"100%",paddingLeft:8,paddingRight:8},...i.isMobile&&{background:t.contentBackground,width:"100%",paddingTop:12,paddingBottom:12}},children:[(0,v.jsx)("div",{style:{display:"flex",flexFlow:"wrap",justifyContent:"center"},children:R.Cr[R.TM].map((function(e){return(0,v.jsx)(Er,{dbType:e,isCurrentType:s===e,onClick:()=>C(e)})}))}),(0,v.jsx)(Q.Z,{style:{display:"flex",margin:"14px",height:32},onClick:function(){const{collectionSettingsStore:t}=e;x(!1,s),d.E3({collectionSettingsStore:t})},children:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Create database",id:"database.viewSettings.createTypedDB.createDatabase"})})]})]})}function Er(e){window.__c={n:"CollectionSettingsTypedDBButton"};const{dbType:t,onClick:o,isCurrentType:n}=e,i=(0,f.Fg)();return(0,v.jsxs)(K.Z,{style:{display:"flex",width:"95%",height:45,flexGrow:0,flexShrink:0,fontSize:11,borderRadius:4,margin:Kr,padding:Or,boxShadow:`0 0 0 1px ${i.regularDividerColor}`,color:i.mediumTextColor,fill:i.mediumTextColor,...n&&{boxShadow:`0 0 0 2px ${i.blueColor}`,color:i.blueColor,fill:i.blueColor,fontWeight:500}},disabled:n,onClick:o,children:[(0,v.jsx)("div",{children:(0,R.T)(t)({...n&&{fill:i.blueColor,color:i.blueColor},width:17,height:17,marginBottom:4,marginTop:4,marginLeft:4})}),(0,v.jsxs)("div",{style:{position:"relative",width:"100%",marginLeft:12},children:[(0,v.jsx)("span",{style:{position:"absolute",fontSize:13,fontWeight:500},children:(0,on.Mn)(t)}),(0,v.jsx)("span",{style:{position:"absolute",top:15,fontSize:12,marginTop:1},children:(0,v.jsx)(l.FormattedMessage,{...R.LI[t].caption})})]})]})}var Hr=o(79362),Lr=o(20616),Nr=o(33732),Wr=o(92165),zr=o(80881),Ur=o(44643),Gr=o(89036);const $r=(0,x.I)("groupByHorizontal",{viewBox:"0 0 16 16",svg:(0,v.jsx)("path",{d:"M2.1416 14.4492H13.8516C15.3281 14.4492 16.0938 13.6904 16.0938 12.2344V3.9082C16.0938 2.45215 15.3281 1.69336 13.8516 1.69336H2.1416C0.665039 1.69336 -0.100586 2.44531 -0.100586 3.9082V12.2344C-0.100586 13.6904 0.665039 14.4492 2.1416 14.4492ZM2.22363 13.1094C1.58789 13.1094 1.23926 12.7812 1.23926 12.1182V4.02441C1.23926 3.36133 1.58789 3.02637 2.22363 3.02637H4.86914V13.1094H2.22363ZM6.18164 13.1094V3.02637H9.81152V13.1094H6.18164ZM13.7695 3.02637C14.3984 3.02637 14.7539 3.36133 14.7539 4.02441V12.1182C14.7539 12.7812 14.3984 13.1094 13.7695 13.1094H11.124V3.02637H13.7695Z"})}),qr=(0,x.I)("groupByVertical",{viewBox:"0 0 16 16",svg:(0,v.jsx)("path",{d:"M0.952148 1.83008H15.041C15.3691 1.83008 15.5879 1.59082 15.5879 1.24219C15.5879 0.893555 15.3691 0.647461 15.041 0.647461H0.952148C0.624023 0.647461 0.405273 0.886719 0.405273 1.24219C0.405273 1.59082 0.624023 1.83008 0.952148 1.83008ZM1.875 7.44238H3.2832C4.26758 7.44238 4.75293 6.95703 4.75293 5.94531V4.58496C4.75293 3.57324 4.26758 3.09473 3.2832 3.09473H1.875C0.890625 3.09473 0.405273 3.57324 0.405273 4.58496V5.94531C0.405273 6.95703 0.890625 7.44238 1.875 7.44238ZM7.28906 7.44238H8.69727C9.68164 7.44238 10.167 6.95703 10.167 5.94531V4.58496C10.167 3.57324 9.68164 3.09473 8.69727 3.09473H7.28906C6.30469 3.09473 5.81934 3.57324 5.81934 4.58496V5.94531C5.81934 6.95703 6.30469 7.44238 7.28906 7.44238ZM12.71 7.44238H14.1182C15.1025 7.44238 15.5879 6.95703 15.5879 5.94531V4.58496C15.5879 3.57324 15.1025 3.09473 14.1182 3.09473H12.71C11.7188 3.09473 11.2402 3.57324 11.2402 4.58496V5.94531C11.2402 6.95703 11.7188 7.44238 12.71 7.44238ZM1.88184 6.31445C1.64258 6.31445 1.52637 6.19824 1.52637 5.94531V4.57812C1.52637 4.33887 1.64258 4.21582 1.88184 4.21582H3.26953C3.50879 4.21582 3.625 4.33887 3.625 4.57812V5.94531C3.625 6.19824 3.50879 6.31445 3.26953 6.31445H1.88184ZM7.30273 6.31445C7.05664 6.31445 6.94727 6.19824 6.94727 5.94531V4.57812C6.94727 4.33887 7.05664 4.21582 7.30273 4.21582H8.69043C8.92969 4.21582 9.0459 4.33887 9.0459 4.57812V5.94531C9.0459 6.19824 8.92969 6.31445 8.69043 6.31445H7.30273ZM12.7168 6.31445C12.4775 6.31445 12.3613 6.19824 12.3613 5.94531V4.57812C12.3613 4.33887 12.4775 4.21582 12.7168 4.21582H14.1045C14.3438 4.21582 14.46 4.33887 14.46 4.57812V5.94531C14.46 6.19824 14.3438 6.31445 14.1045 6.31445H12.7168ZM0.952148 9.82812H15.041C15.3691 9.82812 15.5879 9.58887 15.5879 9.24023C15.5879 8.8916 15.3691 8.64551 15.041 8.64551H0.952148C0.624023 8.64551 0.405273 8.88477 0.405273 9.24023C0.405273 9.5957 0.624023 9.82812 0.952148 9.82812ZM1.88184 15.4404H3.29004C4.27441 15.4404 4.75977 14.9619 4.75977 13.9434V12.583C4.75977 11.5713 4.27441 11.0928 3.29004 11.0928H1.88184C0.897461 11.0928 0.412109 11.5713 0.412109 12.583V13.9434C0.412109 14.9619 0.897461 15.4404 1.88184 15.4404ZM7.2959 15.4404H8.7041C9.68848 15.4404 10.1738 14.9619 10.1738 13.9434V12.583C10.1738 11.5713 9.68848 11.0928 8.7041 11.0928H7.2959C6.31152 11.0928 5.82617 11.5713 5.82617 12.583V13.9434C5.82617 14.9619 6.31152 15.4404 7.2959 15.4404ZM12.7168 15.4404H14.1182C15.1094 15.4404 15.5879 14.9619 15.5879 13.9434V12.583C15.5879 11.5713 15.1094 11.0928 14.1182 11.0928H12.7168C11.7256 11.0928 11.2471 11.5713 11.2471 12.583V13.9434C11.2471 14.9619 11.7256 15.4404 12.7168 15.4404ZM1.88867 14.3125C1.64941 14.3125 1.5332 14.1963 1.5332 13.9502V12.583C1.5332 12.3369 1.64941 12.2139 1.88867 12.2139H3.27637C3.51562 12.2139 3.63184 12.3369 3.63184 12.583V13.9502C3.63184 14.1963 3.51562 14.3125 3.27637 14.3125H1.88867ZM7.30957 14.3125C7.06348 14.3125 6.9541 14.1963 6.9541 13.9502V12.583C6.9541 12.3369 7.06348 12.2139 7.30957 12.2139H8.69727C8.93652 12.2139 9.05273 12.3369 9.05273 12.583V13.9502C9.05273 14.1963 8.93652 14.3125 8.69727 14.3125H7.30957ZM12.7236 14.3125C12.4844 14.3125 12.3682 14.1963 12.3682 13.9502V12.583C12.3682 12.3369 12.4844 12.2139 12.7236 12.2139H14.1113C14.3506 12.2139 14.4668 12.3369 14.4668 12.583V13.9502C14.4668 14.1963 14.3506 14.3125 14.1113 14.3125H12.7236Z"})}),Qr=(0,x.I)("layoutPadded",{viewBox:"0 0 24 24",svg:(0,v.jsx)("path",{d:"M3.94727 11.832H10.2295C11.3574 11.832 11.9248 11.2715 11.9248 10.1504V7.30664C11.9248 6.18555 11.3574 5.625 10.2295 5.625H3.94727C2.81934 5.625 2.25195 6.18555 2.25195 7.30664V10.1504C2.25195 11.2715 2.81934 11.832 3.94727 11.832ZM15.6572 17.5811H20.0459C21.1738 17.5811 21.7412 17.0273 21.7412 15.8994V8.33203C21.7412 7.21094 21.1738 6.65723 20.0459 6.65723H15.6572C14.5361 6.65723 13.9688 7.21094 13.9688 8.33203V15.8994C13.9688 17.0273 14.5361 17.5811 15.6572 17.5811ZM4.11133 10.5469C3.73535 10.5469 3.53711 10.3486 3.53711 9.95898V7.49805C3.53711 7.10156 3.73535 6.91016 4.11133 6.91016H10.0586C10.4414 6.91016 10.6396 7.10156 10.6396 7.49805V9.95898C10.6396 10.3486 10.4414 10.5469 10.0586 10.5469H4.11133ZM15.8213 16.3027C15.4521 16.3027 15.2471 16.1045 15.2471 15.7148V8.52344C15.2471 8.12695 15.4521 7.93555 15.8213 7.93555H19.875C20.2578 7.93555 20.4561 8.12695 20.4561 8.52344V15.7148C20.4561 16.1045 20.2578 16.3027 19.875 16.3027H15.8213ZM5.66309 18.4629H10.9951C12.1162 18.4629 12.6904 17.9092 12.6904 16.7812V14.8535C12.6904 13.7324 12.1162 13.1787 10.9951 13.1787H5.66309C4.53516 13.1787 3.96777 13.7324 3.96777 14.8535V16.7812C3.96777 17.9092 4.53516 18.4629 5.66309 18.4629ZM5.82715 17.1846C5.45117 17.1846 5.25293 16.9863 5.25293 16.5967V15.0449C5.25293 14.6553 5.45117 14.4639 5.82715 14.4639H10.8242C11.2002 14.4639 11.4053 14.6553 11.4053 15.0449V16.5967C11.4053 16.9863 11.2002 17.1846 10.8242 17.1846H5.82715Z"})});var Yr=o(90199),Xr=o(62208);const Jr=(0,x.I)("nest",{viewBox:"0 0 16 16",svg:(0,v.jsxs)("g",{children:[(0,v.jsx)("path",{d:"M5.59375 4.52344H14.3984C14.7607 4.52344 15.0479 4.23633 15.0479 3.87402C15.0479 3.51172 14.7607 3.22461 14.3984 3.22461H5.59375C5.23145 3.22461 4.94434 3.51172 4.94434 3.87402C4.94434 4.23633 5.22461 4.52344 5.59375 4.52344ZM8 8.7207H14.3984C14.7607 8.7207 15.0479 8.43359 15.0479 8.07129C15.0479 7.70898 14.7607 7.42188 14.3984 7.42188H8C7.6377 7.42188 7.35059 7.70898 7.35059 8.07129C7.35059 8.43359 7.63086 8.7207 8 8.7207ZM10 12.918H14.3984C14.7607 12.918 15.0479 12.6309 15.0479 12.2686C15.0479 11.9062 14.7607 11.6191 14.3984 11.6191H10C9.6377 11.6191 9.35059 11.9062 9.35059 12.2686C9.35059 12.6309 9.63086 12.918 10 12.918Z"}),(0,v.jsx)("path",{d:"M1.66386 4.7627L0.898238 3.46387C0.713668 3.14941 0.829878 2.80762 1.19218 2.80762H2.85332C3.22929 2.80762 3.33867 3.14258 3.14726 3.46387L2.36113 4.7627C2.21074 5.01562 1.82109 5.02246 1.66386 4.7627Z"}),(0,v.jsx)("path",{d:"M3.85358 8.94885L3.08795 7.65002C2.90338 7.33557 3.01275 6.99377 3.3819 6.99377H5.03619C5.41217 6.99377 5.52838 7.32874 5.33014 7.65002L4.55084 8.94885C4.40045 9.20178 4.0108 9.20862 3.85358 8.94885Z"}),(0,v.jsx)("path",{d:"M6.90723 12.6377L5.6084 13.4033C5.29395 13.5878 4.95215 13.4716 4.95215 13.1093V11.4482C4.95215 11.0722 5.28711 10.9628 5.6084 11.1543L6.90723 11.9404C7.16016 12.0908 7.16699 12.4804 6.90723 12.6377Z"})]})});var ea=o(84199),ta=o(94110),oa=o(37888),na=o(58188),ia=o(72711);function ra(e){window.__c={n:"CollectionContentOnlyEditorEducationPill"};const{style:t}=e,o=(0,f.Fg)(),n=(0,r.MO)(),i=(0,v.jsx)("div",{style:{marginTop:1},children:(0,Yr.b)({width:14,marginRight:8,height:void 0})}),a=(0,v.jsx)(an.Z,{style:{color:o.regularTextColor,lineHeight:A.Z.lineHeight.UISmall.desktop},isSmall:!0,children:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"You're a content editor",id:"database.viewSettings.mainTab.contentOnlyEditorPill.title"})});return(0,v.jsx)(O,{icon:i,title:a,style:n?{backgroundColor:o.sidebarBackground,boxShadow:o.plainButtonBoxShadow,margin:void 0,borderRadius:void 0,...t}:{background:"rgba(196, 196, 196, 0.13)",margin:"8px 14px",...t},showCloseButton:!1,children:(0,v.jsx)(an.Z,{style:{marginLeft:22},isSmall:!0,isMultiline:!0,children:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Content editors can edit pages, but cannot change view and database settings.",id:"database.viewSettings.mainTab.contentOnlyEditorPill.subtitle"})})})}var aa=o(57420),sa=o(13148),la=o(59960),ca=o(25888),da=o(12714),ua=o(91851),pa=o(94841),ga=o(83182);const ma=(0,l.defineMessages)({learn:{id:"CollectionTaskTypeBadge.MoreMenu.LearnMore.title",defaultMessage:"Learn more"}});function Sa(e){window.__c={n:"CollectionTaskTypeBadge"};const t=(0,r.MO)(),o=(0,f.yK)((e=>({homeIcon:{width:13,marginRight:8,...t?{width:16,marginRight:12}:{}},badgeTitle:{color:e.regularTextColor,lineHeight:A.Z.lineHeight.UISmall.desktop,marginRight:5,...t?{fontSize:16}:{}},badgeStyle:{background:"rgba(196, 196, 196, 0.13)",margin:"8px 14px",padding:"12px 14px"}})),[t]),{collectionContextStore:n}=e,i=(0,la.w)(o.homeIcon),s=(0,a.VK)((()=>n.permissionScopes.state.canConfigureCollection),[n]),c=(0,v.jsx)(an.Z,{style:o.badgeTitle,isSmall:!0,children:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"This is a task database",id:"CollectionTaskTypeBadge.title"})});return(0,v.jsx)(O,{icon:i,title:c,showCloseButton:!1,right:s?(0,v.jsx)(ya,{collectionContextStore:n}):(0,v.jsx)(fa,{}),style:o.badgeStyle,children:(0,v.jsx)(an.Z,{style:{marginLeft:t?28:22},isSmall:!0,isMultiline:!0,children:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"See your assigned tasks in Home.",id:"CollectionTaskTypeBadge.description"})})})}function fa(){window.__c={n:"LearnMore"};const e=(0,l.useIntl)(),t=(0,r.O7)();return(0,v.jsx)(po.Z,{icon:_.m,ariaLabel:e.formatMessage(ma.learn),onClick:()=>{ca.Fs(t,{from:"view_settings_task_type_badge"}),da.D({environment:t,url:pa.h5})}})}function ya(e){window.__c={n:"MoreMenu"};const t=(0,r.O7)(),o=(0,r.MO)(),i=(0,l.useIntl)(),{collectionContextStore:a}=e,s=(0,f.yK)((e=>({buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:3,height:24,width:24},threeDotIcon:{width:o?16:12,height:o?16:12,fill:e.mediumIconColor},hideButtonIcon:{height:17,width:17},confirmationModalTitle:{fontWeight:500},confirmationModalDescription:{fontSize:12,display:"flex",textAlign:"center"}})),[o]),c=(0,n.useCallback)((()=>{p.createAndCommit({environment:t,userAction:"CollectionTaskTypeBadge.untypeDatabase",perform:e=>{ua.RQ({environment:t,collectionContextStore:a,transaction:e})}})}),[t,a]),d=(0,v.jsx)("span",{style:s.confirmationModalDescription,children:(0,v.jsx)(l.FormattedMessage,{id:"CollectionTaskTypeBadge.MoreMenu.RemoveFromHome.description",defaultMessage:"Tasks assigned from this database will no longer appear in Home or work with Sprints."})}),u=e=>[{key:"removeFromHome",render:e=>(0,v.jsx)(Y.Z,{...e,icon:(0,sa.U)(s.hideButtonIcon),title:(0,v.jsx)(l.FormattedMessage,{id:"CollectionTaskTypeBadge.MoreMenu.RemoveFromHome.title",defaultMessage:"Undo task database"})}),action:()=>{const t=[{label:(0,v.jsx)(l.FormattedMessage,{id:"CollectionTaskTypeBadge.UntypeDatabase.modal.confirm",defaultMessage:"Remove"}),color:"red",onAccept:c}];F.showDialog({message:(0,v.jsx)("div",{style:{textAlign:"center"},children:(0,v.jsx)("span",{style:s.confirmationModalTitle,children:(0,v.jsx)(l.FormattedMessage,{id:"CollectionTaskTypeBadge.UntypeDatabase.modal.title",defaultMessage:"Undo Task Database?"})})}),description:d,showCancel:!0,keepFocus:!0,items:t}),e.close()}}],g=(0,v.jsx)(ne.Z,{topBorder:!0,children:(0,v.jsx)(ga.Z,{href:pa.h5,title:i.formatMessage(ma.learn),analyticsFrom:"view_settings_task_type_badge"})});return(0,v.jsx)(X.ZP,{popupType:o?X.Z4.SlideUp:X.Z4.Popup,alignmentToOrigin:X.vR.Center,originGap:2,renderOrigin:e=>(0,v.jsx)(K.Z,{style:s.buttonStyle,...e,children:(0,co.o)(s.threeDotIcon)}),render:e=>{const t=[{key:"all",render:e=>(0,v.jsx)(ne.Z,{...e}),items:u(e)}];return(0,v.jsxs)(ee.Z,{menuType:o?ei.og.ActionSheet:ei.og.Popup,width:200,children:[(0,v.jsx)(te.Z,{type:te.i.Vertical,sections:t,initialFocus:void 0}),g]})}})}var ha=o(74420),xa=o(76798),va=o(32662),Ca=o(28020),wa=o(95697),ba=o(30806),ja=o(5933),Ma=o(52489),_a=o(30772),Ta=o(27871),ka=o(40745);const Va=function(e){let{collectionContextStore:t}=e;window.__c={n:"CollectionSettingsFirstLoadLimit"};const o=(0,r.O7)(),n=(0,a.VK)((()=>t.normalizedFormatStore.state),[t]),i=(0,a.VK)((()=>t.isFullScreen.state),[t]),s=(0,a.VK)((()=>function(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}(t)),[t]),c=(0,a.VK)((()=>function(e){const t=e.normalizedFormatStore.state;return(0,ti.rx)(t.inline_collection_first_load_limit,Boolean(t.collection_group_by))}(t)),[t]),d=(0,a.VK)((()=>t.permissionScopes.state),[t]);return n.collection_group_by||!i&&"calendar"!==s?(0,v.jsx)(mn.Z,{title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Load limit",id:"database.viewSettings.layoutTab.firstLoadLimitSetting"}),selectedKey:c,popupStyle:{minWidth:190},options:ti.jk.map((e=>({key:e,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"{limit} pages",values:{limit:e.limit},id:"database.viewSettings.layoutTab.limitPagesTitle"})}))),onChange:e=>function(e,t,o){const n=o.collectionViewStore();if(!n)return;p.createAndCommit({userAction:"CollectionSettingsFirstLoadLimit.handleFirstLoadLimitChange",environment:t,perform:t=>{u.FH({stores:[n],update:{inline_collection_first_load_limit:e},transaction:t})}}),o.groupsStore.resetAllLimits(),Yn.wd({environment:t,collectionContextStore:o,action:"set_first_load_limit"})}(e,o,t),disabled:!d.canConfigureBlock,icon:ka.M}):null};var Pa=o(12347),Aa=o(26827),Fa=o(54405),Ia=o(52120),Za=o(47567);const Ba=(0,l.defineMessages)({viewNamePlaceholderMessage:{defaultMessage:"View name",id:"database.viewSettings.mainTab.viewNamePlaceholder.title"},addDescriptionTooltip:{defaultMessage:"Add view description",id:"database.viewSettings.mainTab.addDescriptionTooltip.title"},editDescriptionTooltip:{defaultMessage:"Edit view description",id:"database.viewSettings.mainTab.editDescriptionTooltip.title"}});class Da extends i.Z{constructor(){super(...arguments),this.storeTypes={showViewDescriptionStore:Ir.default.createClass(!1)},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleViewDescriptionSubmit=e=>function(e,t,o,n){const i=null==n?void 0:n.getFormat().description;if(!n||e===i)return;p.createAndCommit({userAction:"CollectionSettingsViewMain.handleDescriptionChange",environment:t,perform:t=>{Jn.iG({collectionViewStore:n,update:{format:{...n.getFormat(),description:e}},transaction:t})}}),Yn.wd({environment:t,collectionContextStore:o,action:"set_description"})}(e,this.environment,this.props.collectionContextStore,this.props.collectionViewStore),this.shouldRenderTurnIntoTaskStore=this.createComputedStore((()=>{const{collectionContextStore:e}=this.props,t=e.collectionStore(),o=e.collectionViewBlockStore(),n=e.collectionViewStore();if(!t||!o||!n)return!1;if(!eo.default.checkGate("sidebar_home_gate"))return!1;if(t.isSyncedCollection())return!1;const i=o.getCollectionViewSourceCollectionStore();return!!e.permissionScopes.state.canConfigureBlock&&((null==i||!i.isTypedCollection())&&void 0!==i)})),this.shouldRenderSourceStore=this.createComputedStore((()=>{const{collectionContextStore:e}=this.props,t=e.collectionStore(),o=e.collectionViewBlockStore(),n=e.collectionViewStore();if(!t||!o||!n)return!1;if(t.isSyncedCollection())return!0;return void 0===o.getCollectionViewSourceCollectionStore()})),this.isMyTasks=this.createComputedStore((()=>{var e;const t=null===(e=this.props.collectionContextStore.collectionViewBlockStore())||void 0===e?void 0:e.id;return!!t&&(0,Ca.qG)(t)})),this.isInHomeWidget=this.createComputedStore((()=>(0,Ca.YO)(this.props.collectionContextStore.isInPeekRenderer.state)))}renderComponent(){const{device:e}=this.environment,{collectionContextStore:t,collectionViewStore:o,selectViewNameInitial:n}=this.props,i=t.collectionViewBlockStore();if(!o.isDefined()||!i)return;const r=t.permissionScopes.state,a=o.getFormat().collection_view_icon,s=o.getType(),c=o.getAppConfigUri(),d=c&&(0,le.xB)(c),u=!this.isMyTasks.state&&!d,g=o.getFormat().description,m=this.stores.showViewDescriptionStore.state,S=(0,v.jsx)(ne.Z,{title:e.isMobile&&(0,v.jsx)(l.FormattedMessage,{defaultMessage:"View name",id:"database.viewSettings.mainTab.viewNameSection.title"}),children:(0,v.jsx)(Dr.I,{initialValue:o.getName()||"",placeholder:ii.default.formatMessage(Ba.viewNamePlaceholderMessage),onBlur:e=>rs(e,this.environment,this.props.collectionContextStore,o),onSubmit:e=>rs(e,this.environment,this.props.collectionContextStore,o),focusInitial:n,selectAll:n,disabled:!r.canConfigureBlock||!u,iconButton:{icon:e=>(0,v.jsx)(Lr.F,{color:"gray",viewIcon:a,viewType:s,style:{marginRight:6}}),iconStyle:{fill:Hr.Lr[this.theme.mode].gray},enforceIconColor:"gray",onSubmit:e=>function(e,t,o){const n=t.collectionViewStore();if(!n||!n.isDefined())return;p.createAndCommit({userAction:"CollectionSettingsViewMain.handleViewIconSubmit",environment:e,perform:e=>{Jn.Uy({collectionViewBlockStore:n,icon:o,transaction:e})}}),Yn.wd({environment:e,collectionContextStore:t,action:"change_icon",icon:o})}(this.environment,this.props.collectionContextStore,e)},inputRightButton:this.isMyTasks.state?null:(0,v.jsx)(_a.l,{description:g,showTooltip:!m,onClick:()=>this.stores.showViewDescriptionStore.setState(!m),addDescriptionText:this.props.intl.formatMessage(Ba.addDescriptionTooltip),editDescriptionText:this.props.intl.formatMessage(Ba.editDescriptionTooltip)})})});if("page"===o.getType())return(0,v.jsx)(Z.ZP,{...this.props,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"View options",id:"database.viewSettings.mainTab.title"}),children:S});if(this.isInHomeWidget.state&&t.isCompactView.state){const e=eo.default.checkGate("home_compact_view");return(0,v.jsxs)(v.Fragment,{children:[t.isEmptyStore.state?null:(0,v.jsxs)(v.Fragment,{children:[e&&(0,v.jsx)(ne.Z,{children:(0,v.jsx)(Xa,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore})}),(0,v.jsxs)(ne.Z,{topBorder:e,children:[(0,v.jsx)(Ja,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,v.jsx)(Za.Z,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,v.jsx)(es,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),e&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)($a,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,v.jsx)(qa,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore})]})]})]}),this.isMyTasks.state&&(0,v.jsxs)(ne.Z,{topBorder:!0,children:[(0,v.jsx)(B.Z,{icon:Ur.L,isPadded:!0,title:(0,v.jsx)(l.FormattedMessage,{id:"PersonalHomePanel.moreDropdown.hide.title",defaultMessage:"Hide from home"}),showChevron:!1,onClick:()=>{Jt.default.state.currentSpaceViewStore&&na.aG({environment:this.environment,currentSpaceViewStore:Jt.default.state.currentSpaceViewStore,feature:"tasks",from:"tasks_more_menu"})}}),(0,v.jsx)(is,{collectionContextStore:this.props.collectionContextStore})]})]})}return(0,v.jsxs)(Z.ZP,{...this.props,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"View options",id:"database.viewSettings.mainTab.title"}),children:[(0,v.jsx)(La,{collectionContextStore:this.props.collectionContextStore}),S,m&&(0,v.jsx)(Ta.i,{initialDescription:g,handleSaveDescription:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleViewDescriptionSubmit}),"chart"===s?this.renderChartSettingsMain():this.renderDefaultSettingsMain()]})}renderSource(){const{collectionContextStore:e,collectionSettingsStore:t}=this.props,o=e.collectionStore(),n=e.collectionViewBlockStore();if(!o||!n)return;if(!this.shouldRenderSourceStore.state)return;const i=o.getIcon();return(0,v.jsx)(B.Z,{icon:Gr.v,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Source",id:"database.viewSettings.mainTab.sourceButton.title"}),showChevron:!0,right:(0,v.jsxs)(v.Fragment,{children:[i&&(0,v.jsx)(Mr.Z,{icon:i,isEmptyPage:!1,size:20,disabled:!0,style:{marginRight:4,opacity:.6}}),(0,v.jsx)(xa.Z,{store:o})]}),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0},onClick:()=>{Yn.wd({environment:this.environment,collectionContextStore:e,action:"click_source"}),d.H4({collectionSettingsStore:t,item:{type:"source"}})}})}renderTurnIntoTask(){const{collectionContextStore:e}=this.props,t=this.environment.device.isPhone;if(e.collectionStore()&&this.shouldRenderTurnIntoTaskStore.state)return(0,v.jsx)(ne.Z,{topBorder:!0,style:{marginLeft:4},children:(0,v.jsx)(B.Z,{icon:()=>(0,Xr.z)({width:t?16:14,marginLeft:t?4:void 0}),title:(0,v.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:4},children:[(0,v.jsx)("div",{style:A.Z.textOverflowStyle,children:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Turn into task database",id:"database.viewSettings.mainTab.turnIntoTask.title"})}),(0,v.jsx)(ha.Z,{})]}),caption:(0,v.jsx)("div",{children:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"See your assigned tasks in Home, manage tasks in sprints, and more.",id:"database.viewSettings.mainTab.turnIntoTask.caption"})}),shouldWrapCaption:!0,showChevron:!1,onClick:()=>{Ma.Z.setState({isModalOpen:!0,databaseType:R.iS,collectionContextStore:e}),Yn.gd({environment:this.environment,database_type:R.iS,collectionContextStore:e})}})})}renderChartSettingsMain(){return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(ne.Z,{children:[this.renderSource(),(0,v.jsx)(Xa,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore})]}),(0,v.jsx)(ce.LazyChartSettingsMain,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore,intl:this.props.intl})]})}renderDefaultSettingsMain(){const{collectionContextStore:e}=this.props,{device:t}=this.environment;return(0,v.jsxs)(v.Fragment,{children:[t.isMobile?(0,v.jsxs)(ne.Z,{topBorder:!0,children:[this.renderSource(),(0,v.jsx)(Xa,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,v.jsx)(Ja,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,v.jsx)(Za.Z,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,v.jsx)(es,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,v.jsx)($a,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,v.jsx)(qa,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,v.jsx)(ns,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,v.jsx)(Ua,{collectionSettingsStore:this.props.collectionSettingsStore,collectionContextStore:this.props.collectionContextStore}),(0,v.jsx)(Va,{collectionContextStore:e}),(0,v.jsx)(za,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(ne.Z,{children:[this.renderSource(),(0,v.jsx)(Xa,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore})]}),(0,v.jsxs)(ne.Z,{topBorder:!0,children:[(0,v.jsx)(Ja,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,v.jsx)(Za.Z,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,v.jsx)(es,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,v.jsx)($a,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,v.jsx)(qa,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,v.jsx)(ns,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,v.jsx)(Ua,{collectionSettingsStore:this.props.collectionSettingsStore,collectionContextStore:this.props.collectionContextStore}),(0,v.jsx)(Va,{collectionContextStore:e}),(0,v.jsx)(za,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore})]})]}),(0,wa.QI)("dev_or_beta")||(0,le.rm)()?this.renderTurnIntoTask():void 0,(0,v.jsxs)(ne.Z,{topBorder:!0,mobileStyle:(0,wa.QI)("dev_or_beta")||(0,le.rm)()?{paddingTop:2}:{},children:[(0,wa.QI)("dev_or_beta")||(0,le.rm)()?(0,v.jsx)(Ga,{collectionContextStore:this.props.collectionContextStore}):void 0,(0,v.jsx)(ss,{collectionContextStore:this.props.collectionContextStore}),(0,v.jsx)(Aa.Z,{collectionContextStore:this.props.collectionContextStore}),(0,v.jsx)(Ia.Z,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,v.jsx)(Fa.Z,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),this.isMyTasks.state&&(0,v.jsx)(is,{collectionContextStore:this.props.collectionContextStore})]})]})}}Da.displayName="CollectionSettingsViewMain";const Ka=(0,l.injectIntl)(Da);function Oa(e,t,o){return t?o?(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Unlock wiki",id:"action.unlockWikiName.name"}):(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Lock wiki",id:"action.lockWikiName.name"}):e?o?(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Unlock database",id:"database.viewSettings.mainTab.unlockDatabase.title"}):(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Lock database",id:"database.viewSettings.mainTab.lockDatabase.title"}):o?(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Unlock views",id:"database.viewSettings.mainTab.unlockViews.title"}):(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Lock views",id:"database.viewSettings.mainTab.lockViews.title"})}function Ra(e){let t;return t=e?e.supportedInView&&e.isVisibleInView?un.dH.relationFeatureShownMessage:un.dH.relationFeatureHiddenMessage:un.dH.relationFeatureOffMessage,ii.default.formatMessage(t)}function Ea(e,t){const o=t.permissionScopes.state,n=(0,z.$K)(e),i=o.canConfigureBlock;return n||i}function Ha(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}function La(e){let{collectionContextStore:t}=e;window.__c={n:"ContentOnlyEditorEducationPill"};return(0,a.VK)((()=>{const e=t.collectionViewBlockStore();return e&&"content_only_editor"!==e.getRole()}),[t])?null:(0,v.jsx)(ra,{})}function Na(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;window.__c={n:"SubitemV2"};const n=(0,a.VK)((()=>o.currentSubitemFormatStoreForCollection.state),[o]),i=(0,a.VK)((()=>o.databaseType),[o]),r=(0,a.VK)((()=>vi({feature:"subitem",collectionContextStore:o})),[o]),s=(0,a.VK)((()=>Ea(n,o)),[o,n]);return(0,v.jsx)(B.Z,{icon:Jr,title:(0,v.jsx)(l.FormattedMessage,{...(0,un.Gt)({feature:"subitem",databaseType:i})}),showChevron:!0,right:Ra(r),onClick:()=>{d.H4({collectionSettingsStore:t,item:{type:"subitemV2"}})},disabled:!s})}function Wa(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;window.__c={n:"ArrowsByV2"};const n=(0,a.VK)((()=>o.currentArrowsByFormatStore.state),[o]),i=(0,a.VK)((()=>o.databaseType),[o]),r=(0,a.VK)((()=>vi({feature:"timeline_arrows_by",collectionContextStore:o})),[o]),s=(0,a.VK)((()=>Ea(n,o)),[o,n]);return(0,v.jsx)(B.Z,{title:(0,v.jsx)(l.FormattedMessage,{...(0,un.Gt)({feature:"timeline_arrows_by",databaseType:i})}),showChevron:!0,icon:zr.I,right:Ra(r),onClick:()=>{d.H4({collectionSettingsStore:t,item:{type:"dependencies"}})},disabled:!s})}function za(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"AutomationAction"};const n=(0,a.VK)((()=>(0,qt.cB)(t)),[t]),i=(0,a.VK)((()=>t.aliveAutomationCount.state),[t]),r=(0,a.VK)((()=>(0,qt.Li)({collectionStore:t.collectionStore()})),[t]);return n?(0,v.jsx)(B.Z,{icon:so,onClick:()=>{!r||i>0?d.H4({collectionSettingsStore:o,item:{source:"collection_view_settings",type:"automationSettings"}}):(d.H4({collectionSettingsStore:o,item:{source:"collection_view_settings",type:"automationSettings"}}),d.H4({collectionSettingsStore:o,item:{type:"automationCreateSettings"}}))},right:i>0?i:(0,v.jsx)(l.FormattedMessage,{id:"database.viewSettings.mainTab.automations.none",defaultMessage:"None"}),showChevron:!0,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Automations",id:"database.viewSettings.mainTab.automations.title"})}):null}function Ua(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;window.__c={n:"SprintSettings"};const n=(0,a.VK)((()=>eo.default.checkGate("recurring_sprints")),[]),i=(0,a.VK)((()=>{const e=o.databaseType;return n&&(e===R.iS||e===R.p$)}),[o,n]),{sprintSettingsPermissionsContext:r,automaticSprintCompletionEnabled:s}=q({collectionSettingsStore:t,collectionContextStore:o});let c;if(null!=r&&r.canEdit){c=r.sprintsEnabled?s?(0,v.jsx)(l.FormattedMessage,{...me.automatic}):(0,v.jsx)(l.FormattedMessage,{...me.manual}):(0,v.jsx)(l.FormattedMessage,{...me.off})}return i&&c?(0,v.jsx)(B.Z,{icon:V.L,right:c,showChevron:!0,title:(0,v.jsx)(l.FormattedMessage,{...me.sprintsMenuTitle}),onClick:()=>{d.H4({collectionSettingsStore:t,item:{type:"sprintSettings"}})}}):null}function Ga(e){let{collectionContextStore:t}=e;window.__c={n:"TaskTypeBadgeComponent"};const o=(0,a.VK)((()=>t.collectionViewBlockStore()),[t]),n=(0,a.VK)((()=>null==o?void 0:o.getRole()),[o]);return(0,a.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getDatabaseType()}),[t])!==R.iS?null:o&&"content_only_editor"!==n?(0,v.jsx)(Sa,{collectionContextStore:t}):null}function $a(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"GroupComponent"};const n=(0,r.O7)(),i=(0,a.VK)((()=>Ha(t)),[t]),s="board"===i?{groupByKey:"board_columns_by",groupsFormatKey:"board_columns"}:{groupByKey:"collection_group_by",groupsFormatKey:"collection_groups"},c=(0,a.VK)((()=>t.normalizedSchemaStore.state),[t]),u=(0,a.VK)((()=>t.normalizedFormatStore.state),[t])[s.groupByKey],p=(0,a.VK)((()=>t.permissionScopes.state),[t]);return"calendar"!==i?(0,v.jsx)(B.Z,{icon:"board"===i?$r:qr,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Group",id:"database.viewSettings.mainTab.groupButton.title"}),showChevron:!0,right:(0,Pa.bc)(u?c[u.property]:void 0),onClick:()=>{var e;Yn.wd({environment:n,collectionContextStore:t,action:"click_group",original_view_type:i,property_type:u?null===(e=c[u.property])||void 0===e?void 0:e.type:void 0}),t.isLoading.state||t.loadingDetails.setState({type:"load_groups_menu"}),d.H4({collectionSettingsStore:o,item:u?{type:"group",...s}:{type:"groupByProperty",...s}})},disabled:!u&&!p.canConfigureBlock}):null}function qa(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"SubGroupComponent"};const n=(0,r.O7)(),i=(0,a.VK)((()=>Ha(t)),[t]),s=(0,a.VK)((()=>t.normalizedSchemaStore.state),[t]),c=(0,a.VK)((()=>t.normalizedFormatStore.state),[t]).collection_group_by,u={groupByKey:"collection_group_by",groupsFormatKey:"collection_groups"},p=(0,a.VK)((()=>t.permissionScopes.state),[t]);return"board"===i?(0,v.jsx)(B.Z,{icon:qr,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Sub-group",id:"database.viewSettings.mainTab.subGroupButton.title"}),showChevron:!0,right:(0,Pa.bc)(c?s[c.property]:void 0),onClick:()=>{var e;Yn.wd({environment:n,collectionContextStore:t,action:"click_subgroup",original_view_type:i,property_type:c?null===(e=s[c.property])||void 0===e?void 0:e.type:void 0}),t.isLoading.state||t.loadingDetails.setState({type:"load_groups_menu"}),d.H4({collectionSettingsStore:o,item:c?{type:"group",...u}:{type:"groupByProperty",...u}})},disabled:!c&&!p.canConfigureBlock}):null}function Qa(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"SubitemV1Component"};const n=(0,r.O7)(),i=(0,a.VK)((()=>t.normalizedSchemaStore.state),[t]),s=(0,a.VK)((()=>t.currentSubitemFormatStoreForUiDisplay.state),[t]),c=s?i[s.property]:void 0,u=(0,a.VK)((()=>t.permissionScopes.state),[t]),p=(0,a.VK)((()=>t.databaseType),[t]);return(0,v.jsx)(B.Z,{icon:Jr,title:(0,v.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[(0,v.jsx)(l.FormattedMessage,{...(0,un.Gt)({feature:"subitem",databaseType:p})}),(0,v.jsx)(va.Z,{size:2})]}),showChevron:!0,right:(0,v.jsx)("span",{style:{...A.Z.textOverflowStyle},children:(null==c?void 0:c.name)??(0,v.jsx)(l.FormattedMessage,{defaultMessage:"None",id:"database.viewSettings.subitemTab.none"})}),onClick:()=>{Yn.wd({environment:n,collectionContextStore:t,action:"click_subitem"}),d.H4({collectionSettingsStore:o,item:{type:"subitem"}})},disabled:!s&&!u.canConfigureBlock})}function Ya(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"ArrowsByV1Component"};const n=(0,r.O7)(),i=(0,a.VK)((()=>t.normalizedSchemaStore.state),[t]),s=(0,a.VK)((()=>t.currentArrowsByFormatStore.state),[t]),c=s?i[s]:void 0,u=(0,a.VK)((()=>t.permissionScopes.state),[t]);return(0,v.jsx)(B.Z,{icon:Wr.Z,title:(0,v.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Dependencies",id:"database.viewSettings.mainTab.dependencies.title"}),(0,v.jsx)(va.Z,{size:2})]}),showChevron:!0,right:(0,v.jsx)("span",{style:{...A.Z.textOverflowStyle},children:(null==c?void 0:c.name)??(0,v.jsx)(l.FormattedMessage,{defaultMessage:"None",id:"database.viewSettings.arrowsByTab.none"})}),onClick:()=>{Yn.wd({environment:n,collectionContextStore:t,action:"click_timeline_arrows_by"}),d.H4({collectionSettingsStore:o,item:{type:"arrowsBy"}})},disabled:!s&&!u.canConfigureBlock})}function Xa(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"LayoutComponent"};const n=(0,r.O7)(),i=(0,a.VK)((()=>t.collectionViewStore()),[t]),s=(0,a.VK)((()=>null==i?void 0:i.getType()),[i]);return i&&s?(0,v.jsx)(B.Z,{icon:Qr,isPadded:!0,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Layout",id:"database.viewSettings.mainTab.layoutButton.title"}),showChevron:!0,right:$t.Bh[s],onClick:()=>{Yn.wd({environment:n,collectionContextStore:t,action:"click_layout"}),d.H4({collectionSettingsStore:o,item:{type:"layout"}})}}):null}function Ja(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"PropertiesComponent"};const n=(0,r.O7)(),i=(0,a.VK)((()=>t.normalizedFormatStore.state),[t]),s=(0,a.VK)((()=>Ha(t)),[t]),c=(0,a.VK)((()=>(0,ti.oz)(s)),[s]);if("chart"===s)return(0,v.jsx)(v.Fragment,{});const u=((c?i[c]:void 0)||[]).filter((e=>Boolean(e.visible))).length;return(0,v.jsx)(B.Z,{icon:ea.N,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Properties",id:"database.viewSettings.mainTab.propertiesButton.title"}),showChevron:!0,right:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"{propertiesShown} shown",id:"database.viewSettings.mainTab.propertiesButton.propertiesShown.title",values:{propertiesShown:u}}),onClick:()=>{Yn.wd({environment:n,collectionContextStore:t,action:"click_properties"}),d.H4({collectionSettingsStore:o,item:{type:"properties",timelineViewTab:"timeline"}})}})}function es(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"SortComponent"};const n=(0,r.O7)(),i=(0,a.VK)((()=>t.currentSortsStore.state.length),[t]);return(0,v.jsx)(B.Z,{icon:ta.j,isPadded:!0,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Sort",id:"database.viewSettings.mainTab.sortButton.title"}),showChevron:!0,right:i>0?(0,v.jsx)(l.FormattedMessage,{defaultMessage:"{numberOfSorts, plural, one {{numberOfSorts} sort} other {{numberOfSorts} sorts}}",values:{numberOfSorts:i},id:"database.viewSettings.mainTab.sortButton.oneOrMoreSorts.title"}):(0,v.jsx)(l.FormattedMessage,{defaultMessage:"None",id:"database.viewSettings.mainTab.sortButton.noSorts.title"}),onClick:()=>{Yn.wd({environment:n,collectionContextStore:t,action:"click_sort"}),0===i?d.H4({collectionSettingsStore:o,item:{type:"createSort"}}):d.H4({collectionSettingsStore:o,item:{type:"sort"}})}})}function ts(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;window.__c={n:"SubitemComponent"};return(0,a.VK)((()=>eo.default.checkGate("dependency_date_shifting_by_space")),[])?(0,v.jsx)(Na,{collectionSettingsStore:t,collectionContextStore:o}):(0,v.jsx)(Qa,{collectionContextStore:o,collectionSettingsStore:t})}function os(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;window.__c={n:"ArrowsByComponent"};const n=(0,a.VK)((()=>eo.default.checkGate("dependency_date_shifting_by_space")),[]),i=(0,a.VK)((()=>Di({feature:"timeline_arrows_by",viewType:Ha(o)})),[o]);return n?(0,v.jsx)(Wa,{collectionSettingsStore:t,collectionContextStore:o}):i?(0,v.jsx)(Ya,{collectionContextStore:o,collectionSettingsStore:t}):null}function ns(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"RelationFeaturesComponent"};const i=(0,a.VK)((()=>t.collectionStore()),[t]),r=(0,a.VK)((()=>null==i?void 0:i.isSyncedCollection()),[i]),s=(0,a.VK)((()=>t.contextType),[t]);return r||"collectionTypedView"===s?null:(0,v.jsxs)(n.Fragment,{children:[(0,v.jsx)(ts,{collectionSettingsStore:o,collectionContextStore:t}),(0,v.jsx)(os,{collectionSettingsStore:o,collectionContextStore:t})]})}function is(e){window.__c={n:"TaskMigrationInfoMenuItem"};const t=(0,r.O7)(),o=(0,a.VK)((()=>{const e=Jt.default.state.mainEditorCurrentBlockStore;return Boolean(e&&(0,Ca.qG)(e.id))}),[]),n=(0,a.VK)((()=>{if(!eo.default.checkGate("sidebar_home_gate"))return!1;const t=e.collectionContextStore.collectionViewBlockStore();return!(!t||!(0,Ca.qG)(t.id))}),[e.collectionContextStore]),i=(0,f.yK)((e=>({icon:as(e).iconStyles,title:as(e).menuItemStyles})),[]);if(!n)return null;const s=o?"home_tasks":"home_tile_tasks";return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(aa.default,{from:s}),(0,v.jsx)(B.Z,{showChevron:!1,icon:_.m,iconStyle:i.icon,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Don't see your tasks?",id:"tasksEmptyState.noDatabases.title"}),textWrapperStyle:i.title,onClick:()=>{ja.Z.setState(!0),(0,ba.Aq)({environment:t,from:s})}})]})}function rs(e,t,o,n){n&&n.isDefined()&&(n.getName()!==e&&p.createAndCommit({userAction:"CollectionSettingsViewMain.handleViewNameSubmit",environment:t,perform:t=>{Jn.iG({collectionViewStore:n,update:{name:e},transaction:t})}}),Yn.wd({environment:t,collectionContextStore:o,action:"rename",original_view_type:n.getType()}))}function as(e){return{menuItemStyles:{color:e.lightTextColor},iconStyles:{width:16,marginLeft:4,marginRight:2,fill:e.lightIconColor}}}function ss(e){let{collectionContextStore:t}=e;window.__c={n:"LockActionComponent"};const o=(0,r.O7)(),n=(0,a.VK)((()=>t.collectionViewBlockStore()),[t]),i=(0,a.VK)((()=>null==n?void 0:n.getCollectionViewSourceCollectionStore()),[n]),s=(0,a.VK)((()=>null==n?void 0:n.isLocked()),[n]),l=(0,a.VK)((()=>i?i.canEditCollection():null==n?void 0:n.canEditCollection()),[n,i]),c=(0,a.VK)((()=>null==n?void 0:n.isCollectionViewPageWithContent()),[n]);return n&&l?(0,v.jsx)(B.Z,{icon:s?oa.U:Yr.b,title:Oa(i,c,s),onClick:()=>function(e,t){const o=t.collectionViewBlockStore();o&&(ia.bo({environment:e,store:o,lock:!o.isLocked()}),Yn.wd({environment:e,collectionContextStore:t,action:"click_toggle_lock"}))}(o,t)}):null}const ls=function(e){window.__c={n:"CollectionSettingsCreateView"};const{collectionContextStore:t,collectionSettingsStore:o}=e,n=(0,l.useIntl)(),i=(0,f.Fg)(),s=(0,r.O7)(),{device:c}=s,u=(0,a.VK)((()=>t.collectionViewStore()),[t]),g=(0,a.VK)((()=>null==u?void 0:u.isDefined()),[u]),m=(0,a.VK)((()=>null==u?void 0:u.getFormat().collection_view_icon),[u]),S=(0,a.VK)((()=>null==u?void 0:u.getType()),[u]);return u&&g?(0,v.jsxs)(Z.ZP,{...e,collectionSettingsStore:o,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"New view",id:"database.viewSettings.createViewTab.title"}),desktopWidth:290,children:[(0,v.jsx)(ne.Z,{children:(0,v.jsx)(Dr.I,{initialValue:"",placeholder:n.formatMessage(Ba.viewNamePlaceholderMessage),focusInitial:!c.isMobile||void 0,onBlur:e=>cs(e,s,t),iconButton:{icon:e=>(0,v.jsx)(Lr.F,{color:"gray",viewIcon:m,viewType:S,style:{marginRight:6}}),iconStyle:{fill:Hr.Lr[i.mode].gray},enforceIconColor:"gray",onSubmit:e=>function(e,t,o){const n=t.collectionViewStore();if(!n||!n.isDefined())return;p.createAndCommit({userAction:"CollectionSettingsCreateView.handleViewIconSubmit",environment:e,perform:e=>{Jn.Uy({collectionViewBlockStore:n,icon:o,transaction:e})}}),Yn.wd({environment:e,collectionContextStore:t,action:"change_icon",icon:o})}(s,t,e)},onSubmit:e=>function(e,t,o,n){cs(e,t,n),d.wl({collectionSettingsStore:o,item:{type:"main"}}),Yn.wd({environment:t,collectionContextStore:n,action:"rename"})}(e,s,o,t)})}),(0,v.jsx)(Nr.Z,{collectionContextStore:t,collectionSettingsStore:o,showDoneButton:!c.isMobile})]}):null};function cs(e,t,o){const n=o.collectionViewStore();n&&n.isDefined()&&n.getName()!==e&&p.createAndCommit({userAction:"CollectionSettingsCreateView.handleViewNameBlur",environment:t,perform:t=>{Jn.iG({collectionViewStore:n,update:{name:e},transaction:t})}})}var ds=o(34464),us=o(12396),ps=o(55863),gs=o(62965),ms=o(28992),Ss=o(68641);const fs=(0,l.defineMessages)({delete:{defaultMessage:"Delete",id:"database.deletedProperties.delete"},undo:{defaultMessage:"Undo",id:"database.deletedProperties.undo"}});function ys(e){let{collectionSettingsStore:t,collectionContextStore:o,timelineViewTab:i}=e;window.__c={n:"CollectionSettingsDeletedProperties"};const s=(0,r.O7)(),c=(0,f.Fg)(),u=(0,a.VK)((()=>o.normalizedDeletedSchemaStore.state),[o]),g=(0,n.useCallback)((()=>{const e=Object.entries(u).map((e=>{let[t,o]=e;if(o)return{propertyId:t,propertySchema:o}})).filter(z.$K);return 0===e.length?(0,v.jsx)(ne.Z,{children:(0,v.jsx)(ms.Z,{title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"No results",id:"database.viewSettings.deletedPropertiesTab.noResults"})})}):(0,v.jsx)(ne.Z,{children:e.map((e=>{let{propertyId:n,propertySchema:r}=e;return(0,v.jsx)(ms.Z,{title:(0,v.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,v.jsx)(us.ZP,{type:r.type,icon:r.icon,size:16,theme:c,style:{fill:c.regularIconColor}}),(0,v.jsx)("span",{style:{marginLeft:6,maxWidth:200,...A.Z.textOverflowStyle},children:r.name})]}),right:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(po.Z,{icon:ps.s,iconStyle:{marginRight:2},ariaLabel:ii.default.formatMessage(fs.undo),onClick:()=>{!function(e,t,o,n,i){const r=o.collectionStore(),a=(0,Ss.jI)({timelineViewTab:n,collectionContextStore:o});if(r){const o=nn.D8({deletedSchema:r.getDeletedSchema(),property:e});if(o){var s;if("verification"===(null===(s=r.getDeletedSchema()[e])||void 0===s?void 0:s.type)){const e=r.getSchema(),t=Object.keys(e).some((t=>{var o;return"verification"===(null===(o=e[t])||void 0===o?void 0:o.type)}));if(t)return void F.showDialog({message:(0,v.jsx)(l.FormattedMessage,{id:"database.deletedPropertiesTab.cannotRestoreDuplicateProperty.modal.verification",defaultMessage:"You can only have one verification property."}),showCancel:!1,keepFocus:!0,items:[{label:(0,v.jsx)(l.FormattedMessage,{id:"database.deletedPropertiesTab.cannotRestoreDuplicateProperty.modal.dismissButton",defaultMessage:"Dismiss"}),onAccept:()=>{}}]})}p.createAndCommit({userAction:"CollectionSettingsDeletedProperties.handleRestoreDeletedPropertyClick",environment:i,perform:e=>{Jn.xO({environment:i,collectionStore:r,update:o.updateSchema,transaction:e}),Jn.$N({collectionStore:r,update:o.updateDeletedSchema,transaction:e})}}),d.z$({collectionSettingsStore:t}),d.H4({collectionSettingsStore:t,item:{type:"property",property:e,formatKey:a}})}}}(n,t,o,i,s)}}),(0,v.jsx)(po.Z,{icon:P.y,ariaLabel:ii.default.formatMessage(fs.delete),onClick:()=>{!function(e,t,o){F.showDialog({message:(0,v.jsx)(l.FormattedMessage,{id:"database.viewSettings.deletedPropertiesTab.permanentlyDeleteProperty.modal.prompt",defaultMessage:"Are you sure you want to delete this property?"}),showCancel:!0,keepFocus:!0,items:[{label:(0,v.jsx)(l.FormattedMessage,{id:"database.viewSettings.propertyTab.deleteProperty.modal.confirmButton",defaultMessage:"Delete"}),color:"red",onAccept:()=>{const n=t.collectionStore();n&&p.createAndCommit({userAction:"CollectionSettingsDeletedProperties.handlePermanentlyDeleteDeletedPropertyClick",environment:o,perform:t=>{Jn.$N({collectionStore:n,update:{[e]:null},transaction:t})}})}}]})}(n,o,s)}})]})},n)}))})}),[o,t,u,s,c,i]);return(0,v.jsx)(Z.ZP,{collectionSettingsStore:t,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Deleted properties",id:"database.viewSettings.propertyTab.deletedTitle"}),children:g()})}const hs=n.memo(ys,gs.Z);var xs=o(43696),vs=o(59862),Cs=o(74817),ws=o(28410),bs=o(3791),js=o(10910),Ms=o(79474),_s=o(52423),Ts=o(44866),ks=o(30905),Vs=o(73420),Ps=o(91839),As=o(19124),Fs=o(18514),Is=o(83212),Zs=o(88280),Bs=o(73590),Ds=o(91965);const Ks=(0,l.defineMessages)({autoUpdateExplanationMessage:{defaultMessage:"Keep values updated with the latest edits to pages",id:"database.CollectionSettingsPropertyAiAutofill.autoUpdateExplanationMessage"},onlyWithAiAddOnMessage:{defaultMessage:"Only with Notion AI add-on",id:"database.CollectionSettingsPropertyAiAutofill.onlyWithAiAddOnMessage"},updateOnPageEdits:{defaultMessage:"Auto-update on page edits",id:"database.viewSettings.propertyTab.aiAutofill.updateOnPageEdits"}});function Os(e){let{collectionContextStore:t,environment:o,setAiInference:i,aiInference:r,doesUserHaveAIAddOn:a}=e;window.__c={n:"CollectionSettingsAiAutofillAutoUpdateToggle"};const c=(0,n.useRef)((0,s.ZP)()),d=(0,n.useCallback)((()=>{if(!t.collectionStore())return;if(!r)return;if(!(a||null!=r&&r.auto_update_on_edit))return void Ts.triggerAiAutofillUpsell({environment:o,from:"ai_autofill_on_page_edit"});const e={...r,auto_update_on_edit:!r.auto_update_on_edit};i(e)}),[t,r,a,i,o]);return r?(0,v.jsx)(Gt.ZP,{renderTooltip:()=>(0,v.jsxs)("div",{style:{width:159},children:[(0,v.jsx)("div",{style:{color:"white",fontWeight:500,wordWrap:"break-word",whiteSpace:"pre-wrap"},children:(0,v.jsx)(l.FormattedMessage,{...Ks.autoUpdateExplanationMessage})}),!a&&(0,v.jsx)("div",{style:{color:"#ACABA9",fontWeight:500},children:(0,v.jsx)(l.FormattedMessage,{...Ks.onlyWithAiAddOnMessage})})]}),render:e=>(0,v.jsx)(B.Z,{title:(0,v.jsx)(l.FormattedMessage,{...Ks.updateOnPageEdits}),showChevron:!1,right:(0,v.jsx)($i.Z,{inputId:c.current,on:!!r.auto_update_on_edit,onClick:d,disabled:!1,noColor:!1}),onClick:d,disabled:!1,textWrapperStyle:{minWidth:"auto"},...e})}):null}var Rs=o(1743);const Es=(0,l.defineMessages)({optionsSectionTitle:{defaultMessage:"Options",id:"database.viewSettings.propertyTab.aiAutofill.optionsSectionTitle"},extractPromptSectionTitle:{defaultMessage:"What key info to extract?",id:"database.viewSettings.propertyTab.aiAutofill.extractPromptSectionTitle"},customPromptSectionTitle:{defaultMessage:"What to generate?",id:"database.viewSettings.propertyTab.aiAutofill.customPromptSectionTitle"},extractPromptInputPlaceholder:{defaultMessage:"e.g. “Key topics in bullets” or “People mentioned on the page”",id:"database.viewSettings.propertyTab.aiAutofill.extractPromptInputPlaceholder"},customPromptInputPlaceholder:{defaultMessage:"Tell AI what to generate from page content and properties…",id:"database.viewSettings.propertyTab.aiAutofill.customPromptInputPlaceholder"}});function Hs(e){var t;let{environment:o,aiInference:i,setAiInference:r,collectionContextStore:s,isAutofillSetupEnabled:c,shouldShowUserPromptIsInvalidError:d,setShouldShowUserPromptIsInvalidError:u}=e;window.__c={n:"CollectionSettingsAiAutofillPromptInput"};const p=function(e){if(!e)return;switch(e.type){case"summarize":case"translate":return;case"extract":return{aiInferenceType:e.type,sectionTitle:Es.extractPromptSectionTitle,inputPlaceholder:Es.extractPromptInputPlaceholder,value:e.prompt};case"custom":case"select":case"multi_select":return{aiInferenceType:e.type,sectionTitle:Es.customPromptSectionTitle,inputPlaceholder:Es.customPromptInputPlaceholder,value:e.prompt};default:(0,z.t1)(e)}}(i),g=(0,a.VK)((()=>(0,$t.k4)()),[]),m=(0,n.useCallback)((e=>{if(s.collectionStore()&&p)switch(e.target.value&&e.target.value.length<=ws.Th?u(!1):e.target.value.length>ws.Th&&u(!0),p.aiInferenceType){case"extract":case"custom":r({type:p.aiInferenceType,prompt:e.target.value,auto_update_on_edit:(null==i?void 0:i.auto_update_on_edit)??g});break;case"select":case"multi_select":r({type:p.aiInferenceType,prompt:e.target.value,auto_update_on_edit:(null==i?void 0:i.auto_update_on_edit)??g,add_options:((null==i?void 0:i.type)===p.aiInferenceType&&(null==i?void 0:i.add_options))??!1});break;case"summarize":case"translate":return;default:(0,z.t1)(p.aiInferenceType)}}),[i,s,g,p,r,u]);return p?(0,v.jsxs)(ne.Z,{title:ii.default.formatMessage(p.sectionTitle),isInput:!0,style:{marginTop:-4},children:[(0,v.jsx)(Rs.Z,{debugName:"CollectionSettingsAiAutofillPromptInput",capture:!0,allowEsc:!0,children:(0,v.jsx)(zt.ZP,{inputOuterStyle:{margin:o.device.isMobile?"8px 0":0,border:d?"1px solid red":void 0},type:"text",value:p.value||"",onChange:m,placeholder:ii.default.formatMessage(p.inputPlaceholder),textarea:!0,disabled:!c,autosize:!0,autosizeMinHeight:100,autosizeMaxHeight:600},p.aiInferenceType)}),d&&(0,v.jsxs)("div",{style:{display:"flex",alignItems:"center",paddingLeft:12,fontSize:12},children:[(0,ro.t)({width:12,height:12,fill:"#D34F43"}),(0,v.jsx)("div",{style:{color:"#D34F43",paddingLeft:4},children:((null===(t=p.value)||void 0===t?void 0:t.length)??0)>ws.Th?(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Instruction is too long",id:"CollectionSettings.propertyTab.aiAutofill.promptInput.exceedsMaxLength"}):(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Required",id:"CollectionSettings.propertyTab.aiAutofill.promptInput.required"})})]})]}):null}function Ls(e){const{collectionContextStore:t,isAutofillSetupEnabled:o,draftAiInference:n,setDraftAiInference:i,environment:r,shouldShowUserPromptIsInvalidError:a,setShouldShowUserPromptIsInvalidError:s,doesUserHaveAIAddOn:l}=e;return n?"select"!==n.type&&"multi_select"!==n.type?null:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(ne.Z,{style:{marginBottom:10},children:[(0,v.jsx)(Os,{collectionContextStore:t,environment:r,setAiInference:i,aiInference:n,doesUserHaveAIAddOn:l}),(0,v.jsx)(Ds.Z,{setAiInference:i,aiInference:n})]}),n&&(0,v.jsx)(ne.Z,{topBorder:!0,children:(0,v.jsx)(Hs,{environment:r,aiInference:n,setAiInference:i,collectionContextStore:t,isAutofillSetupEnabled:o,shouldShowUserPromptIsInvalidError:a,setShouldShowUserPromptIsInvalidError:s})})]}):null}o(30541);var Ns=o(87205),Ws=o(5257),zs=o(60458),Us=o(43765),Gs=o(99417);const $s=new go.Z,qs=(0,l.defineMessages)({optionsSectionTitle:{defaultMessage:"Options",id:"database.viewSettings.propertyTab.aiAutofill.optionsSectionTitle"},whatToTranslate:{defaultMessage:"What to translate?",id:"CollectionSettingsPropertyAiAutofill.translateProperty.propertySelector"},translateTo:{defaultMessage:"Translate to",id:"CollectionSettingsPropertyAiAutofill.translateProperty.languageSelector"},selectorSearchPlaceholder:{defaultMessage:"Search",id:"CollectionSettingsPropertyAiAutofill.selectorOption.searchbar.placeholder"},allProperties:{defaultMessage:"All properties",id:"CollectionSettingsPropertyAiAutofill.selectorOption.allProperties.checkbox"},noAiAutofillSelected:{defaultMessage:"Select an option",id:"database.CollectionSettingsPropertyAiAutofill.noAiAutofillSelected"}});function Qs(e){window.__c={n:"CollectionSettingsTextPropertyAiAutofill"};const{collectionContextStore:t,propertySchema:o,previousPromptByAiInferenceType:i,isAutofillSetupEnabled:r,draftAiInference:a,setDraftAiInference:s,environment:l,propertyId:c,collectionSchema:d,shouldShowUserPromptIsInvalidError:u,setShouldShowUserPromptIsInvalidError:p,doesUserHaveAIAddOn:g}=e,m=(0,f.Fg)(),S=(0,n.useMemo)((()=>[new go.Z,new go.Z]),[]),y=(0,n.useMemo)((()=>function(e){var t;let{environment:o,aiInference:n,collectionSchema:i,setAiInference:r,property:a,theme:s,optionsButtonPopupStores:l}=e;if(!n||!(0,$e.MD)(n.type))return[];switch(n.type){case"summarize":case"extract":case"custom":return[];case"translate":const e=vn.oA((0,z.Yd)(i).map((e=>{if(e===a)return;const t=i[e];if(t&&(0,Ns.K9)(t)){var o;if("text"===t.type&&"translate"===(null===(o=t.ai_inference)||void 0===o?void 0:o.type))return;return{id:e,option:t.name,icon:(0,v.jsx)(us.ZP,{icon:t.icon,type:t.type,theme:s,size:16})}}}))),o=e.findIndex((e=>"title"===e.id));if(o&&o>0){const t=e[o];e.splice(o,1),e.unshift(t)}for(;l.length<2;)l.push(new go.Z);return[{type:"multi",options:e,selectedIds:(null===(t=n.targetProperties)||void 0===t?void 0:t.length)>0?n.targetProperties:["title"],setSelectedIds:e=>{r({...n,targetProperties:e})},selectorTitle:qs.whatToTranslate,selectAllTitle:qs.allProperties,buttonPopupStore:l[0]},{type:"single",options:Ns.nI.map((e=>{let{key:t,name:o}=e;return{id:t,option:ii.default.formatMessage(o)}})),selectedId:n.toLanguage,onSelect:e=>{r({...n,toLanguage:e})},selectorTitle:qs.translateTo,buttonPopupStore:l[1]}];default:(0,z.t1)(n)}}({environment:l,aiInference:a,collectionSchema:d,setAiInference:s,property:c,theme:m,optionsButtonPopupStores:S})),[l,a,d,s,c,m,S]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(ne.Z,{style:{marginBottom:10},children:[(0,v.jsx)(Ys,{propertySchema:o,previousPromptByAiInferenceType:i,draftAiInference:a,setDraftAiInference:s,environment:l}),(0,$e.by)(a,"text")&&(0,v.jsx)(Os,{collectionContextStore:t,environment:l,setAiInference:s,aiInference:a,doesUserHaveAIAddOn:g})]}),(0,$e.by)(a,"text")&&(0,v.jsxs)(ne.Z,{topBorder:!0,children:[(0,v.jsx)(Hs,{environment:l,aiInference:a,setAiInference:s,collectionContextStore:t,isAutofillSetupEnabled:r,shouldShowUserPromptIsInvalidError:u,setShouldShowUserPromptIsInvalidError:p}),(0,v.jsx)(Js,{environment:l,optionProps:y})]})]})}function Ys(e){let{propertySchema:t,previousPromptByAiInferenceType:o,draftAiInference:i,setDraftAiInference:r,environment:s}=e;window.__c={n:"AiPromptTypeSelectorSections"};const c=(0,a.VK)((()=>(0,$t.k4)()),[]),d=(0,n.useCallback)((e=>{var n,i,a,s,l,d,u,p;if(!t||!(0,$e.qQ)(t)||!e)return;let g;switch(e){case"summarize":g={type:e,auto_update_on_edit:c};break;case"translate":g={type:e,auto_update_on_edit:c,targetProperties:(null===(n=t.ai_inference)||void 0===n?void 0:n.type)===e?null===(i=t.ai_inference)||void 0===i?void 0:i.targetProperties:["title"],toLanguage:(null===(a=t.ai_inference)||void 0===a?void 0:a.type)===e?null===(s=t.ai_inference)||void 0===s?void 0:s.toLanguage:"english"};break;case"extract":g={type:e,prompt:(null===(l=t.ai_inference)||void 0===l?void 0:l.type)===e?null===(d=t.ai_inference)||void 0===d?void 0:d.prompt:o[e]??"",auto_update_on_edit:c};break;case"custom":g={type:e,prompt:(null===(u=t.ai_inference)||void 0===u?void 0:u.type)===e?null===(p=t.ai_inference)||void 0===p?void 0:p.prompt:o[e]??"",auto_update_on_edit:c};break;default:(0,z.t1)(e)}r(g)}),[c,o,t,r]),u=(0,f.Fg)();return t&&(0,$e.qQ)(t)?(0,v.jsx)(X.ZP,{popupType:s.device.isMobile?X.Z4.SlideUp:X.Z4.Popup,buttonPopupStore:$s,render:e=>{const t={key:"section",render:e=>(0,v.jsx)(ne.Z,{...e}),items:vn.oA(Object.keys(Gs.OE.text).map((t=>{if((0,$e.MD)(t))return{key:t,render:e=>{const o=Gs.OE.text[t];return(0,v.jsx)(Y.Z,{focused:!1,onClick:e.onClick,icon:o.svg({height:20,width:24,fill:u.aiPurpleColor}),title:ii.default.formatMessage(o.name),checkState:(null==i?void 0:i.type)===t})},action:()=>{e.close(),d(t)}}})))};return(0,v.jsx)(ee.Z,{menuType:ei.og.Popup,minWidth:260,maxWidth:"100vw",children:(0,v.jsx)(te.Z,{type:te.i.Vertical,initialFocus:void 0,sections:[t]})})},renderOrigin:e=>{let{onClick:t}=e;return(0,v.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:14,marginLeft:4,marginRight:4,marginTop:8,paddingLeft:12,paddingRight:12,cursor:"pointer",height:28},onClick:t,children:[(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Fill with",id:"CollectionSettingsPropertyAiAutofill.ClosedSelector.Title"}),(0,v.jsx)(Xs,{aiActionType:null==i?void 0:i.type})]})}}):null}function Xs(e){let{aiActionType:t}=e;window.__c={n:"AiActionRenderer"};const o=(0,f.Fg)(),n=t&&(0,$e.MD)(t)?Gs.OE.text[t]:{name:qs.noAiAutofillSelected,svg:()=>null};return(0,v.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer",fontSize:14,paddingLeft:15,paddingBottom:0},children:[(0,v.jsx)("div",{style:{color:o.lightIconColor},children:n.svg({height:16,width:16,marginRight:2})}),(0,v.jsx)("div",{style:{color:o.lightTextColor,paddingLeft:4},children:(0,v.jsx)(l.FormattedMessage,{...n.name})}),(0,v.jsx)("div",{style:{color:o.lightIconColor,paddingLeft:4},children:(0,Ws.o)({height:12,width:12})})]})}function Js(e){let{environment:t,optionProps:o}=e;return o&&o.length>0?(0,v.jsx)(ne.Z,{title:ii.default.formatMessage(qs.optionsSectionTitle),isInput:!0,style:{marginTop:-4},children:o.map(((e,o)=>"multi"===e.type?(0,v.jsx)(el,{environment:t,options:e.options,selectedIds:e.selectedIds,setSelectedIds:e.setSelectedIds,selectorTitle:e.selectorTitle,selectAllTitle:e.selectAllTitle,buttonPopupStore:e.buttonPopupStore},o):(0,v.jsx)(tl,{environment:t,options:e.options,selectedId:e.selectedId,onSelect:e.onSelect,selectorTitle:e.selectorTitle,buttonPopupStore:e.buttonPopupStore},o)))}):null}function el(e){let{environment:t,options:o,selectedIds:i,setSelectedIds:r,selectorTitle:s,selectAllTitle:c,buttonPopupStore:d}=e;window.__c={n:"CheckSelectorOption"};const[u,p]=(0,n.useState)(""),g=(0,f.Fg)(),m=o.filter((e=>i.includes(e.id))),S=(0,a.VK)((()=>vn.jj(vn.MR(o.map((e=>e.id)))).join(",")===vn.jj(vn.MR(i)).join(",")),[o,i]),y=e=>{i.includes(e)?r(i.filter((t=>t!==e))):r(vn.jj([...i,e]))},h=()=>{i.length<o.length?r(o.map((e=>e.id))):r(["title"])},x=(0,v.jsx)(ne.Z,{desktopStyle:{paddingTop:12,paddingBottom:4},children:(0,v.jsx)(zt.ZP,{focusInitial:!t.device.isMobile||void 0,focus:!t.device.isMobile||void 0,value:u,onChange:e=>{p(e.target.value)},placeholder:ii.default.formatMessage(qs.selectorSearchPlaceholder)})});return(0,v.jsx)(X.ZP,{popupType:t.device.isMobile?X.Z4.SlideUp:X.Z4.Popup,buttonPopupStore:d,render:e=>{const t=o.filter((e=>{var t;const o=null===(t=e.option)||void 0===t?void 0:t.toLowerCase();return-1!==(null==o?void 0:o.indexOf(u.toLowerCase()))})).map((e=>{let{id:t,option:o,icon:n}=e;return{key:t,render:e=>(0,v.jsx)(Y.Z,{focused:!1,onClick:e.onClick,left:(0,v.jsx)(zs.Z,{checked:i.includes(t),size:14,checkSize:8,onClick:e=>{y(t)}}),icon:n,title:o}),action:()=>{y(t)}}})),n={key:"section",render:e=>(0,v.jsx)(ne.Z,{...e,topBorder:!0}),items:t},r={key:"all-items",render:e=>(0,v.jsx)(ne.Z,{...e}),items:[{key:"all-items",render:e=>(0,v.jsx)(Y.Z,{focused:!1,onClick:()=>{h()},left:(0,v.jsx)(zs.Z,{checked:S,size:14,checkSize:8,onClick:()=>{h()}}),title:ii.default.formatMessage(c)}),action:()=>{h()}}]};return(0,v.jsxs)(ee.Z,{menuType:ei.og.Popup,minWidth:260,maxWidth:"100vw",children:[x,0===t.length?(0,v.jsx)(ne.Z,{children:(0,v.jsx)(Us.Z,{title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"No results",id:"CollectionSettingsPropertyAiAutofill.searchBar.noResults.label"})})}):(0,v.jsx)(te.Z,{type:te.i.Vertical,initialFocus:void 0,sections:[r,n]})]})},renderOrigin:e=>(0,v.jsx)(B.Z,{title:ii.default.formatMessage(s),showChevron:!0,right:(0,v.jsx)("div",{style:{color:g.lightTextColor,paddingLeft:4,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"90%"},children:vn.oA(m.map((e=>{let{id:t,option:o,icon:n}=e;return o}))).join(", ")}),rightStyle:{flexShrink:1},rotateChevron:d.state.open,disabled:!1,textWrapperStyle:{minWidth:"auto"},...e})})}function tl(e){let{environment:t,options:o,selectedId:i,onSelect:r,selectorTitle:a,buttonPopupStore:s}=e;window.__c={n:"SelectorOption"};const[c,d]=(0,n.useState)(""),u=o.find((e=>e.id===i)),p=(0,f.Fg)(),g=(0,v.jsx)(ne.Z,{desktopStyle:{paddingTop:12,paddingBottom:4},children:(0,v.jsx)(zt.ZP,{focusInitial:!t.device.isMobile||void 0,focus:!t.device.isMobile||void 0,value:c,onChange:e=>{d(e.target.value)},placeholder:ii.default.formatMessage(qs.selectorSearchPlaceholder)})});return(0,v.jsx)(X.ZP,{popupType:t.device.isMobile?X.Z4.SlideUp:X.Z4.Popup,buttonPopupStore:s,render:e=>{const t=o.filter((e=>{var t;return-1!==(null===(t=e.option)||void 0===t?void 0:t.toLowerCase().indexOf(c.toLowerCase()))})).map((t=>{let{id:o,option:n,icon:a}=t;return{key:o,render:e=>(0,v.jsx)(Y.Z,{focused:!1,onClick:e.onClick,icon:a,title:n,checkState:o===i}),action:()=>{e.close(),r(o)}}})),n={key:"section",render:e=>(0,v.jsx)(ne.Z,{...e}),items:t};return(0,v.jsxs)(ee.Z,{menuType:ei.og.Popup,minWidth:260,maxWidth:"100vw",children:[g,0===t.length?(0,v.jsx)(ne.Z,{children:(0,v.jsx)(Us.Z,{title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"No results",id:"CollectionSettingsPropertyAiAutofill.searchBar.noResults.label"})})}):(0,v.jsx)(te.Z,{type:te.i.Vertical,initialFocus:void 0,sections:[n]})]})},renderOrigin:e=>(0,v.jsx)(B.Z,{title:ii.default.formatMessage(a),showChevron:!0,right:u&&(0,v.jsxs)(v.Fragment,{children:[u.icon,(0,v.jsx)("div",{style:{color:p.lightTextColor,paddingLeft:4,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"90%"},children:u.option})]}),rightStyle:{flexShrink:1},rotateChevron:s.state.open,disabled:!1,textWrapperStyle:{minWidth:"auto"},...e})})}const ol=(0,l.defineMessages)({optionsSectionTitle:{defaultMessage:"Options",id:"database.viewSettings.propertyTab.aiAutofill.optionsSectionTitle"},removeAutofillButton:{defaultMessage:"Turn off AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.removeAutofillButton"},toggleFillWithAiSectionLabel:{defaultMessage:"Actions",id:"database.viewSettings.propertyTab.aiAutofill.actionsSectionLabel"},confirmOverwriteExistingPropertyValues:{defaultMessage:"Filling “{propertyName}” with AI will overwrite any existing values of the property. Are you sure you want to continue?",id:"database.viewSettings.propertyTab.aiAutofill.confirmOverwriteModal"},noAiAutofillSelected:{defaultMessage:"Select an option",id:"database.CollectionSettingsPropertyAiAutofill.noAiAutofillSelected"}});function nl(e){window.__c={n:"CollectionSettingsPropertyAiAutofill"};const{property:t,collectionContextStore:o,collectionSettingsStore:i}=e,s=(0,a.VK)((()=>o.normalizedSchemaStore.state[t]),[t,o.normalizedSchemaStore]),c=(0,a.VK)((()=>o.collectionStore()),[o]),u=(0,a.VK)((()=>o.normalizedSchemaStore.getState()),[o]),g=s&&(0,$e.qQ)(s)?(0,$e.q3)(s):void 0,S=(0,r.O7)(),f=rl(),y=(0,a.VK)((()=>{const e=o.collectionStore();return e&&(0,As.mX)(S,Is.Z.getMode(S,e),e)}),[S,o]),h=Ir.default.createValue({stage:"not_started"});(0,n.useEffect)((()=>{var e,n;if("page"===o.getViewType())return;if(!1!==(null===(e=o.getPropertyFormat(t))||void 0===e?void 0:e.visible))return;const i=new Fr.Z({name:"CollectionSettingsPropertyAiAutofill"});S.defaultRecordCache.inMemoryRecordCache.addCacheOverride(i);const r=null===(n=o.formatStore())||void 0===n?void 0:n.clone(i),a=o.getPropertyFormatKey();return r&&a&&p.createAndCommit({userAction:"CollectionSettingsPropertyAiAutofill.open",environment:S,perform:e=>{en.er({formatStore:r,formatKey:a,property:t,update:{visible:!0},transaction:e})}}),()=>{S.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(i)}}),[o,S,t]);const x=(0,n.useRef)({}),C=(0,a.VK)((()=>(0,$t.k4)()),[]),[w,b]=(0,n.useState)(s&&Ts.getDefaultAiInference(s,C)),[j,M]=(0,n.useState)(!1),_=(0,n.useCallback)((()=>{const e=o.collectionStore();if(!e||!s||!(0,$e.qQ)(s))return;const n=(0,$e.q3)(s);n&&"prompt"in n&&(x.current={...x.current,[n.type]:n.prompt}),Ts.saveOrRemovePropertyAiInference({environment:S,propertySchema:s,collectionStore:e,property:t,draftAiInference:w})}),[o,s,w,t,S]),T=(0,a.VK)((()=>{var e;return(null===(e=o.collectionStore())||void 0===e||null===(e=e.getName())||void 0===e?void 0:e.toString())||""}),[o]),k=(0,n.useCallback)((async()=>{if(s&&(0,$e.qQ)(s)&&vn.Xy(w,(0,$e.q3)(s)))d.E3({collectionSettingsStore:i});else if(w){var e;if("prompt"in w)if((0,$e.DS)(w)&&0===(null===(e=w.prompt)||void 0===e?void 0:e.length)||(0,z.$K)(w.prompt)&&w.prompt.length>ws.Th)return void M(!0);(null==g||!g.auto_update_on_edit)&&null!=w&&w.auto_update_on_edit&&C&&s?await Ms.r({sourceAction:"auto_update",propertyName:s.name,collectionName:T})&&_():_()}}),[T,i,g,w,_,C,s]),V=(0,n.useCallback)((()=>{const e=o.collectionStore();e&&g&&s&&(Ts.saveOrRemovePropertyAiInference({environment:S,propertySchema:s,collectionStore:e,property:t,draftAiInference:null}),d.z$({collectionSettingsStore:i}))}),[o,g,S,s,t,i]),A=s&&(0,$e.qQ)(s)&&vn.Xy(w,(0,$e.q3)(s)),I=(0,n.useCallback)((async()=>new Promise((e=>{F.showDialog({showCancel:!1,keepFocus:!1,message:(0,v.jsxs)(Vs.sg,{alignItems:"center",gap:8,children:[(0,ot.y)(f.confirmDiscardChangesDialogIconStyle),(0,v.jsx)("div",{style:f.confirmDiscardChangesDialogMessageStyle,children:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Do you want to discard changes for AI autofill?",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.message"})})]}),items:[{label:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Discard",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.acceptLabel"}),color:"red",onAccept:()=>e(!0)},{label:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Continue editing",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.cancelLabel"}),onAccept:()=>e(!1)}]})}))),[f]),D=(0,n.useCallback)((async()=>{(A||await I())&&d.z$({collectionSettingsStore:i})}),[A,i,I]),K=(0,n.useCallback)((async()=>{(A||await I())&&d.E3({collectionSettingsStore:i})}),[A,i,I]),O=(0,a.VK)((()=>{var e;const t=(null===(e=Zs.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,bs.de)(t)}),[]);return s&&(0,$e.qQ)(s)&&c?(0,v.jsx)(m.Z,{debugName:"CollectionSettingsPropertyAiAutofill",capture:!0,onEsc:K,children:(0,v.jsxs)(Z.ZP,{...e,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Fill “{propertyName}” with AI",id:"database.viewSettings.propertyTab.aiAutofill.title",values:{propertyName:s.name}}),handleBackArrowClick:D,handleClose:K,children:[!y&&(0,v.jsx)(ne.Z,{style:f.menuItemStyle,children:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"You don't have permission to set up AI autofill on this database.",id:"database.viewSettings.propertyTab.aiAutofill.noSetupPermission"})}),"text"===s.type&&(0,v.jsx)(Qs,{collectionContextStore:o,propertySchema:s,previousPromptByAiInferenceType:x.current,isAutofillSetupEnabled:Boolean(y),draftAiInference:w,setDraftAiInference:b,environment:S,propertyId:t,collectionSchema:u,shouldShowUserPromptIsInvalidError:j,setShouldShowUserPromptIsInvalidError:M,doesUserHaveAIAddOn:O}),(0,$e.cu)(s)&&(0,v.jsx)(Ls,{collectionContextStore:o,isAutofillSetupEnabled:Boolean(y),draftAiInference:w,setDraftAiInference:b,environment:S,shouldShowUserPromptIsInvalidError:j,setShouldShowUserPromptIsInvalidError:M,doesUserHaveAIAddOn:O}),(0,$e.by)(w,s.type)&&(0,v.jsxs)(ne.Z,{children:[(0,v.jsx)(il,{environment:S,isAutofillSetupEnabled:y,collectionContextStore:o,tryAutofillStore:h,propertySchema:s,property:t,aiInference:w}),(0,v.jsx)(Q.Z,{style:{...f.buttonStyle,margin:"8px 12px 12px 12px",display:A?"none":"flex"},onClick:k,disabled:!y,children:A?(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Done",id:"database.viewSettings.propertyTab.aiAutofill.saveButtonAllSaved"}):(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Save changes",id:"database.viewSettings.propertyTab.aiAutofill.saveButtonWithChanges"})})]}),(0,v.jsxs)(ne.Z,{topBorder:!0,title:S.device.isMobile&&ii.default.formatMessage(ol.toggleFillWithAiSectionLabel),children:[(0,$e.by)(g,s.type)&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(ks.TB,{environment:S,collectionContextStore:o,collectionStore:c,property:t,propertySchema:s,doesUserHaveAIAddOn:O,isAutofillSetupEnabled:Boolean(y)}),(0,v.jsx)(B.Z,{icon:P.y,isRed:!0,focused:!1,title:ii.default.formatMessage(ol.removeAutofillButton),onClick:V,disabled:!y})]}),(0,v.jsx)(Bs.Z,{href:(0,Fs.UY)("guides.aiAutofill"),title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Learn about AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.learnMoreLink"}),analyticsFrom:"collection_ai_autofill_menu"})]})]})}):null}function il(e){let{environment:t,isAutofillSetupEnabled:o,collectionContextStore:i,tryAutofillStore:r,propertySchema:c,property:d,aiInference:u}=e;window.__c={n:"TryOnThisViewActionSection"};const[p,g]=(0,n.useState)((0,s.ZP)()),m=(0,n.useRef)((0,s.ZP)()),S=(0,a.VK)((()=>r.state.stage),[r]),f=(0,a.VK)((()=>{const e=i.contextType;if("collectionPage"===e)return{type:"page",candidateBlockStores:vn.oA([(0,Ca.np)()])};if("collectionTypedView"===e||"collectionView"===e)return{type:"collection",candidateBlockStores:i.resultsInViewOrder(5)};throw new Error(`Unexpected context type: ${e}`)}),[i]),y=(0,n.useCallback)((()=>{var e;js.qG(t,{ai_inference_type:u.type,type:"undo_from_collection_settings",inference_id:p,collection_id:null===(e=i.collectionStore())||void 0===e?void 0:e.id,session_id:m.current}),"not_started"!==S&&(_s.Yw(t,!1),r.setState({stage:"not_started"}))}),[t,u,p,i,S,r]),h=(0,z.Of)(f.candidateBlockStores),x=rl({isTryAutofillEnabled:o&&h});if(t.device.isMobile)return null;let C;return C=h?"collection"===f.type?(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Updates the first {maxPages} pages. You can undo changes anytime.",id:"database.viewSettings.propertyTab.aiAutofill.tryOnCollectionDescription",values:{maxPages:5}}):(0,v.jsx)(l.FormattedMessage,{defaultMessage:'Updates "{propertyName}" on this page. You can undo changes anytime.',id:"database.viewSettings.propertyTab.aiAutofill.tryOnPageDescription",values:{propertyName:c.name}}):(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Add more pages or remove filters to try AI on this view.",id:"database.viewSettings.propertyTab.tryAutofillDisabledDescription"}),(0,v.jsx)(n.Fragment,{children:(0,v.jsx)("div",{style:{margin:"8px 12px"},children:(0,v.jsxs)(Vs.X2,{gap:8,children:[(0,v.jsx)(jr.Z,{disabled:!o||!h,style:{...x.buttonStyle,...x.undoButtonStyle,..."not_started"===S&&{display:"none"}},onClick:y,children:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Undo",id:"database.viewSettings.propertyTab.aiAutofill.undoButton"})}),(0,v.jsx)(Gt.ZP,{renderTooltip:()=>(0,v.jsx)("div",{children:C}),render:e=>(0,v.jsx)(jr.Z,{...e,disabled:!o||!h,style:{...x.buttonStyle,...x.tryButtonStyle},hoveredStyle:x.tryButtonHoveredStyle,pressedStyle:x.tryButtonPressedStyle,onClick:async()=>{if((0,z.Of)(f.candidateBlockStores)){const e=(0,s.ZP)();g(e),r.setState({stage:"in_progress"}),await Ts.autofillPropertyForBlocks({environment:t,stores:f.candidateBlockStores,property:d,propertySchema:c,aiInferenceOverride:u,userEventForAnalytics:"generate_from_try_on_view_button",sessionIdForAnalytics:m.current,collectionContextStore:i,from:"ai_autofill_settings"}),r.setState({stage:"complete"})}},children:"in_progress"===S?(0,v.jsx)(Ps.Z,{}):(0,v.jsxs)(v.Fragment,{children:[(0,ot.y)({width:16,..."not_started"!==S&&{display:"none"}}),"not_started"!==S?(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Try again",id:"database.viewSettings.propertyTab.aiAutofill.tryAgain"}):"collection"===f.type?(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Try on this view",id:"database.viewSettings.propertyTab.aiAutofill.tryOnCollection"}):(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Try on this page",id:"database.viewSettings.propertyTab.aiAutofill.tryOnPage"})]})})})]})})})}function rl(e){const t=(0,f.Fg)();return(0,f.yK)((()=>({buttonStyle:{flexGrow:1,display:"flex",alignItems:"center",justifyContent:"center",gap:8},menuItemStyle:{fontSize:13,borderRadius:6,background:t.accentColors.purple[50],color:t.accentColors.purple[500],margin:"8px 12px",padding:"8px 12px"},undoButtonStyle:{border:`1px solid ${t.accentColors.gray[100]}`,flex:1},tryButtonStyle:{fontWeight:500,flex:1,background:null!=e&&e.isTryAutofillEnabled?"light"===t.mode?t.accentColors.purple[50]:t.accentColors.purple[200]:t.accentColors.gray[50],color:null!=e&&e.isTryAutofillEnabled?t.aiPurpleColor:t.accentColors.gray[400]},fillAllPagesWandIconStyle:{fill:t.aiPurpleColor},tryButtonHoveredStyle:{background:t.accentColors.purple[100]},tryButtonPressedStyle:{background:t.accentColors.purple[200]},confirmDiscardChangesDialogIconStyle:{width:32,height:32,fill:t.aiPurpleColor,paddingTop:8},confirmDiscardChangesDialogMessageStyle:{textAlign:"center",fontWeight:500}})),[t,null==e?void 0:e.isTryAutofillEnabled])}var al=o(42853),sl=o(36596),ll=o(90559),cl=o(10070),dl=o(77657),ul=o(87085),pl=o(34517),gl=o(16732),ml=o(54119),Sl=o(15560),fl=o(14871),yl=o(49117),hl=o(14976),xl=o(4850),vl=o(32363);var Cl=o(33954),wl=o(12205);const bl=(0,l.defineMessages)({duplicateGithubPropertyTooltip:{defaultMessage:"A database can only have one GitHub Pull Requests property",id:"database.viewSettings.propertyTab.duplicateGithubProperty.tooltip"},wikiGithubPropertyTooltip:{defaultMessage:"A wiki cannot have a GitHub Pull Requests property",id:"database.viewSettings.propertyTab.wikiGithubProperty.tooltip"},syncedDatabaseGithubPropertyTooltip:{defaultMessage:"A synced database cannot have a GitHub Pull Requests property",id:"database.viewSettings.propertyTab.syncedDatabaseGithubProperty.tooltip"},nonMeetingsCronPropertyTooltip:{defaultMessage:"The Cron Calendar property can only be added to a Meetings database",id:"database.viewSettings.propertyTab.nonMeetingsCronProperty.tooltip"},duplicateCronEventPropertyTooltip:{defaultMessage:"A database can only have one Cron Calendar event property",id:"database.viewSettings.propertyTab.duplicateCronEventProperty.tooltip"},newPill:{defaultMessage:"New",id:"database.viewSettings.newHighlightedFeature"}}),jl=(0,l.defineMessages)({text:{defaultMessage:"Add text that can be formatted. Great for summaries, notes, or descriptions.",id:"database.viewSettings.propertyTab.textProperty.tooltip"},number:{defaultMessage:"Accepts numbers. These can also be formatted as currency or progress bars. Useful for tracking counts, prices, and completion.",id:"database.viewSettings.propertyTab.numberProperty.tooltip"},select:{defaultMessage:"Select one option from a list of tags. Useful for categorization.",id:"database.viewSettings.propertyTab.selectProperty.tooltip"},multi_select:{defaultMessage:"Select one or more options from a list of tags. Useful for tagging items across multiple categories.",id:"database.viewSettings.propertyTab.multiSelectProperty.tooltip"},date:{defaultMessage:"Accepts a date or a date range (time optional). Useful for deadlines, especially with calendar and timeline views.",id:"database.viewSettings.propertyTab.dateProperty.tooltip"},formula:{defaultMessage:"Perform calculations based on other properties using Notion’s formula language.",id:"database.viewSettings.propertyTab.formulaProperty.tooltip"},relation:{defaultMessage:"Connect databases and mention database pages. Useful for connecting items across your workspace.",id:"database.viewSettings.propertyTab.relationProperty.tooltip"},rollup:{defaultMessage:"View and aggregate information about properties from relation properties. Useful for summarizing interconnected data.",id:"database.viewSettings.propertyTab.rollupProperty.tooltip"},person:{defaultMessage:"Tag anyone in your Notion workspace. Useful for assigning tasks or referencing relevant team members.",id:"database.viewSettings.propertyTab.personProperty.tooltip"},file:{defaultMessage:"Upload files and images for easy retrieval. Useful for storing documents and photos.",id:"database.viewSettings.propertyTab.filesProperty.tooltip"},checkbox:{defaultMessage:"Use a checkbox to indicate whether a condition is true or false. Useful for lightweight task tracking.",id:"database.viewSettings.propertyTab.checkboxProperty.tooltip"},url:{defaultMessage:"Accepts a link to a website and opens the link in a new tab when clicked.",id:"database.viewSettings.propertyTab.urlProperty.tooltip"},email:{defaultMessage:"Accepts an email address and launches your mail client when clicked.",id:"database.viewSettings.propertyTab.emailProperty.tooltip"},phone_number:{defaultMessage:"Accepts a phone number and prompts your device to call it when clicked.",id:"database.viewSettings.propertyTab.phoneNumberProperty.tooltip"},created_time:{defaultMessage:"Records the timestamp of an item's creation. Auto-generated and not editable.",id:"database.viewSettings.propertyTab.createdTimeProperty.tooltip"},created_by:{defaultMessage:"Automatically records the person who created the item. Auto-generated and not editable.",id:"database.viewSettings.propertyTab.createdByProperty.tooltip"},last_edited_time:{defaultMessage:"Records the timestamp of an item's last edit. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastEditedTimeProperty.tooltip"},last_edited_by:{defaultMessage:"Records the person who edited the item last. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastEditedByProperty.tooltip"},auto_increment_id:{defaultMessage:"Automatically creates a numerical ID for each item. IDs are unique and cannot be manually changed.",id:"database.viewSettings.propertyTab.uniqueIdProperty.tooltip"},status:{defaultMessage:"Track this item’s progress using status tags categorized by To-do, In progress, and Complete.",id:"database.viewSettings.propertyTab.statusProperty.tooltip"},verification:{defaultMessage:"Indicate whether a page has been verified by the page owner, with the option to set an expiration date.",id:"database.viewSettings.propertyTab.verificationProperty.tooltip"},button:{defaultMessage:"Trigger actions based on the item properties.",id:"database.viewSettings.propertyTab.buttonProperty.tooltip"},ai_summary:{defaultMessage:"Text property with AI summary set up for you. Generates a summary based on page content and properties.",id:"database.viewSettings.propertyTab.aiSummaryProperty.tooltip"},ai_translate:{defaultMessage:"Text property with AI translate set up for you. Translate a property to another language using AI. ",id:"database.viewSettings.propertyTab.aiTranslateProperty.tooltip"},ai_category:{defaultMessage:"Select property that automatically adds tags based on the page content and properties.",id:"database.viewSettings.propertyTab.aiCategoryProperty.tooltip"},ai_keywords:{defaultMessage:"Multi-select property that automatically adds tags based on the page content and properties.",id:"database.viewSettings.propertyTab.aiKeywordsProperty.tooltip"},ai_custom_prompt:{defaultMessage:"Text property with a custom AI prompt. Generate content based on the page content and properties.",id:"database.viewSettings.propertyTab.aiCustomPromptProperty.tooltip"},ai_extract:{defaultMessage:"Text property with a custom AI prompt. Extract key info based on the page content and properties.",id:"database.viewSettings.propertyTab.aiExtractProperty.tooltip"},title:{defaultMessage:"Add a title for your database item. This determines the page's title.",id:"database.viewSettings.propertyTab.titleProperty.tooltip"},location:{defaultMessage:"Display the location of which database this item belongs to.",id:"database.viewSettings.propertyTab.locationProperty.tooltip"},last_visited_time:{defaultMessage:"Records the timestamp of the last time you visited this page. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastVisitedTimeProperty.tooltip"}});function Ml(e){let{collectionContextStore:t,propertySchema:o}=e;const i=(0,r.O7)(),s=(0,f.Fg)(),c=(0,a.VK)((()=>eo.default.checkGate("recurring_sprints")),[]),d=(0,a.VK)((()=>t.collectionStore()),[t]),u=(0,a.VK)((()=>{if(!d)return;return d.getParentBlockStore()}),[d]),p=(0,a.VK)((()=>rr.Z.bots.state),[]),g=(0,a.VK)((()=>{var e;if(!d)return;const t=null===(e=d.getFormat())||void 0===e?void 0:e.app_config_uri;return t?(0,le.YB)((0,pl.appConfigs)(),t):void 0}),[d]),m=(0,a.VK)((()=>{if(!d||!u||!g)return;if(void 0!==o)return;const e=d.isDefined()?function(e,t,o){const n=t=>{var n,i;const r=null===(n=o.format)||void 0===n?void 0:n.app_config_uri,a=cl.aQ.deriveTypeUris(o.schema??{},null===(i=o.format)||void 0===i?void 0:i.app_uri_map);if(t.collectionUri!==r)return!1;const s=Jt.default.state.mainEditorCurrentBlockStore,l=s&&Is.Z.getMode(e,s),c=(0,As.GD)(l);let d=!0;return t.uri===(0,gl.GT)().uri&&a.has(R.Es.GithubPrsRelation)&&(d=!1),t.dependencies.some((e=>"property"===e.type&&e.collectionUri===r&&(0,R.jP)(e.uri)&&!a.has(e.uri)))&&(!t.isAi||c)&&d},i={};t.allFeatures.forEach((e=>{(0,le.FW)(e)&&e.variants.every((e=>Boolean(t.allFeatures.find((t=>t.uri===e&&(0,le.oX)(t)&&n(t))))))&&(i[e.uri]=e.variants)}));const r=Object.values(i).flat();return t.allFeatures.filter((e=>(0,le.oX)(e)&&!r.find((t=>t===e.uri))?n(e):!!(0,le.FW)(e)&&Boolean(i[e.uri]))).sort(((e,t)=>(0,le.FW)(e)?-1:(0,le.FW)(t)?1:e.dependencies.length-t.dependencies.length))}(i,g,{format:d.getFormat(),space_id:d.getSpaceId(),schema:d.getSchema()}):void 0;return e&&c?e.filter((e=>e.uri!==(0,gl.eu)().uri)):e}),[d,u,g,o,i,c]),S=(0,a.VK)((()=>(null==d?void 0:d.getSchema())??{}),[d]),y=(0,a.VK)((()=>Boolean(null==d?void 0:d.isPageTreeCollection())),[d]),h=(0,a.VK)((()=>t.databaseType),[t]),x=(0,a.VK)((()=>Boolean(null==d?void 0:d.isSyncedCollection())),[d]),C=(0,wl.J)(),w=(0,l.useIntl)();return{suggestedProperties:m,renderSuggestedProperty:n.useCallback((e=>{const{isDisabled:o,propertyDisabledTooltip:n}=e.integrationId?Al({propertyConfig:e,bots:p,isSpaceAdmin:C,environment:i,isWikiCollection:y,databaseType:h,isSyncedCollection:x,schema:S,intl:w,isMobile:i.device.isMobile}):{isDisabled:!1,propertyDisabledTooltip:void 0},r=(e,t,n,i)=>{const r=cl.aQ.deriveTypeUris((null==d?void 0:d.getSchema())??{},null==d?void 0:d.getPropertyMapping()),a=n.dependencies.find((e=>{var t;return"property"===e.type&&e.collectionUri===(null==d||null===(t=d.getFormat())||void 0===t?void 0:t.app_config_uri)&&(0,R.jP)(e.uri)&&!r.has(e.uri)})),l=n.dependencies.find((e=>"property"===e.type&&(0,$e.qQ)(e.propertySchema)&&(0,$e.q3)(e.propertySchema)));if(a)return(0,v.jsx)(Y.Z,{...e,disabled:o,disabledFeedback:o,title:(0,v.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[t,l?(0,v.jsx)(ml.Z,{}):null,n.isNew?"notion://projects/tasks_with_sprints_feature"===n.uri&&(0,v.jsx)(Sl.Z,{}):null]}),icon:(0,v.jsx)(us.ZP,{type:a.propertySchema.type,theme:s,icon:i,size:16,style:{fill:s.regularIconColor}})})};return{key:e.name,render:o=>{var a,s;return(0,v.jsx)(Qi,{showImage:!n,caption:n??e.description,tooltipImage:n||null===(a=e.tooltipImage)||void 0===a?void 0:a.img,tooltipImageScale:null===(s=e.tooltipImage)||void 0===s?void 0:s.scale,render:n=>{if((0,le.oX)(e))return r({...(0,ir.Z)(o,n)},e.name,e,e.icon);{const a=vn.oA(e.variants.map((e=>{const t=null==g?void 0:g.allFeatures.find((t=>t.uri===e));if(t&&(0,le.oX)(t))return t})));return(0,v.jsx)(fl.Z,{items:a,getKey:e=>e.name,onSelect:async e=>{await ul.G0({environment:i,feature:e,collectionContextStore:t})},selectedItem:void 0,renderOrigin:t=>r({...o,...(0,ir.Z)(n,t)},e.name,a[0],e.icon),renderItem:e=>(0,v.jsx)(Y.Z,{...e,title:e.value.name,shouldWrapCaption:!0,shouldWrapTitle:!0})})}}})},action:async()=>{await ul.G0({environment:i,feature:e,collectionContextStore:t})}}}),[p,C,i,y,h,x,S,w,d,s,null==g?void 0:g.allFeatures,t])}}function _l(e){let{collectionContextStore:t,onAccept:o,fetchAiSuggestions:i}=e;const s=(0,f.Fg)(),l=(0,r.O7)(),c=n.useCallback((e=>({key:e.name,render:t=>(0,v.jsx)(Y.Z,{...t,title:(0,v.jsx)("div",{style:{display:"inline-flex",alignItems:"center"},children:e.name}),icon:(0,v.jsx)(us.ZP,{type:e.type,icon:void 0,size:16,theme:s,style:{fill:s.aiPurpleColor}})}),action:()=>{o(e.type,!0,e.name,e.options)}})),[s,o]),[d,g]=(0,n.useState)({aiSuggestedProperties:void 0,renderAiSuggestedProperty:c}),m=(0,a.VK)((()=>{var e;const o=null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema();return o&&Object.keys(o).length>$e.ci}),[t]);return(0,n.useEffect)((()=>{!m&&!d.aiSuggestedProperties&&i&&(0,As.kL)()&&(g({aiSuggestedProperties:"loading",renderAiSuggestedProperty:c}),(async()=>{const e=t.collectionStore(),o=null==e?void 0:e.getSchema(),n=o?vn.oA(Object.values(o).map((e=>null==e?void 0:e.name.toLocaleLowerCase()))):[],i=null==e?void 0:e.getFormat(),r=null==e?void 0:e.getSpaceId(),a=null==e?void 0:e.id,s=[];if(null!=i&&i.ai_suggested_properties&&(null==i?void 0:i.ai_suggested_properties.length)>0&&(null==i||i.ai_suggested_properties.forEach((e=>{n.includes(e.name.toLocaleLowerCase())||s.push(e)}))),0===s.length&&r&&a&&e.getName()){const t=await se.getAiSuggestedProperties(l,{spaceId:null==e?void 0:e.getSpaceId(),collectionId:null==e?void 0:e.id,schema:vn.oA(Object.values(e.getSchema())),collectionName:(0,hl.Xh)(e.getName(),e),numSuggestion:5});if("success"===t.type){const o=t.data.properties.filter((e=>!n.includes(e.name.toLocaleLowerCase())));s.push(...o),p.createAndCommit({environment:l,perform:t=>{u.FH({stores:[e],update:{ai_suggested_properties:o},transaction:t})},userAction:"propertyType.generateAiSuggestion"})}}g({aiSuggestedProperties:s,renderAiSuggestedProperty:c})})())}),[t,l,c,d.aiSuggestedProperties,i,m]),d}function Tl(e){let{collectionContextStore:t,propertyTypes:o,onAccept:i,propertySchema:r}=e;const s=(0,f.Fg)(),c=(0,l.useIntl)(),d=(0,a.VK)((()=>{var e;return(null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema())??{}}),[t]),u=(0,a.VK)((()=>t.collectionViewBlockStore()),[t]),p=n.useCallback((()=>{for(const t in d){var e;const o=d[t];if("text"===(null==o?void 0:o.type)&&"summarize"===(null===(e=o.ai_inference)||void 0===e?void 0:e.type))return!1}return!0}),[d]),g=(0,a.VK)((()=>o.filter((e=>"button"===e?(0,yl.PN)():"verification"===e?(null==u?void 0:u.isCollectionViewPageWithContent())&&d&&!function(e,t){for(const n in e){var o;if((null===(o=e[n])||void 0===o?void 0:o.type)===t)return!0}return!1}(d,"verification"):"ai_summary"===e?p():"ai_keywords"===e?(0,As.KZ)():"ai_extract"!==e||!(0,As.KZ)()))),[o,u,d,p]),m=n.useCallback(((e,o,n)=>{const a={key:e,render:i=>{const a=(null==r?void 0:r.type)===e,l=function(e,t,o){if("auto_increment_id"===t){var n;const t=e.collectionStore(),i=null==t?void 0:t.isPageTreeCollection(),r=Boolean(null==t?void 0:t.isSyncedCollection());if(i)return ii.default.formatMessage(Cl.zU.wiki_forbidden_auto_increment_id_property);if(r)return ii.default.formatMessage(Cl.zU.synced_database_forbidden_auto_increment_id_property);if(null!=o&&o.type)return ii.default.formatMessage(Cl.zU.convert_to_auto_increment_id_property);const a=t&&t.id,s=t&&t.getFormat(),l=t&&(null===(n=t.getSpaceStore())||void 0===n?void 0:n.id),c=t&&t.getSchema(),d=t&&t.getDeletedSchema();if(!(a&&s&&l&&c&&d))return;if(t&&(0,ll.cj)({id:a,format:s,space_id:l,schema:c,deleted_schema:d}))return ii.default.formatMessage(Cl.zU.duplicate_auto_increment_id_property)}}(t,e,r),d=void 0!==l,u=!n&&jl.hasOwnProperty(e)&&"on"===eo.default.getEligibleGroup({experimentId:"property_creation_tooltips_exp",defaultGroup:"control"})?c.formatMessage(jl[e]):void 0,p=(0,v.jsx)(Y.Z,{...i,checkState:a,title:(0,v.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[o??$t.SO[e],"button"===e&&(0,v.jsx)(ha.Z,{})]}),icon:(0,v.jsx)(us.ZP,{type:e,icon:void 0,size:16,theme:s,style:{fill:(0,$e.XU)(e)?s.aiPurpleColor:s.regularIconColor}}),disabled:d,disabledFeedback:d});return Boolean(l||u)?(0,v.jsx)(Gt.ZP,{placement:Gt.ug.Left,render:e=>(0,v.jsx)("div",{...e,children:p}),renderTooltip:()=>l??u,style:{whiteSpace:"break-spaces"}}):p},action:()=>{i(e,(0,$e.XU)(e),o)}};return a}),[r,t,c,s,i]);return{standardAndDerivedPropertyTypes:g,renderStandardOrDerivedProperty:m}}const kl=new Set;function Vl(e,t){const o=(0,r.O7)(),i=(0,l.useIntl)(),s=(0,a.VK)((()=>rr.Z.bots.state),[]),c=(0,a.VK)((()=>e.collectionStore()),[e]),d=(0,a.VK)((()=>(null==c?void 0:c.getSchema())??{}),[c]),u=(0,a.VK)((()=>!(null==c||!c.isPageTreeCollection())),[c]),p=(0,a.VK)((()=>e.databaseType),[e]),g=(0,a.VK)((()=>{var e;return null===(e=Jt.default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit()}),[]),m=(0,a.VK)((()=>{if(void 0===t)return function(e,t){if(!e)return[];const o=eo.default.checkGate("google_drive_connected_relation"),n=eo.default.checkGate("figma_connected_relation"),i=eo.default.checkGate("zendesk_connected_relation"),r=eo.default.checkGate("cron_connected_relation"),a=eo.default.checkGate("connected_relation"),s=e.getDatabaseType()===R.iS,l=rr.Z.state;if(!l.loaded)return[];const c=l.integrations,d={};if(!s){const e=c.find((e=>e.id===dl.U9)),t=(0,gl.GT)();var u;e&&(d[t.name]={name:t.name,pattern:xl.x,integration:e,tooltipImage:{img:y.Z.images.tooltips.properties.githubSyncPullStatusPng,scale:.5},description:t.description,canOnlyAdminAuth:{disabledPropertyTooltipMessage:null===(u=t.canOnlyAdminAuth)||void 0===u?void 0:u.disabledPropertyTooltipMessage}})}const p=[];if(t&&(o&&p.push(dl.f3),n&&p.push(dl.mQ),i&&p.push(dl.Nw)),r&&p.push(dl.Dv),p.forEach((e=>{const t=c.find((t=>t.id===e));if(null!=t&&t.info.original_url_patterns)for(const n of t.info.original_url_patterns){var o;null!==(o=n.additional_types)&&void 0!==o&&o.connectedRelation&&(d[n.name]||(d[n.name]={name:(0,vl.ni)({pattern:n,integration:t}),pattern:n,integration:t}))}})),!a)return Object.values(d);for(const m of c)if(m.info.original_url_patterns&&t&&![dl.U9,dl.f3,dl.mQ,dl.Dv,dl.Nw,dl.Ff].includes(m.id))for(const e of m.info.original_url_patterns){var g;null!==(g=e.additional_types)&&void 0!==g&&g.connectedRelation&&(d[e.name]||(d[e.name]={name:(0,vl.ni)({pattern:e,integration:m}),pattern:e,integration:m}))}return Object.values(d)}(c,g)}),[c,t,g]),S=(0,a.VK)((()=>Boolean(null==c?void 0:c.isSyncedCollection())),[c]),f=(0,wl.J)();return{connectedRelationProperties:m,renderConnectedRelationProperty:n.useCallback((t=>{const{isDisabled:n,propertyDisabledTooltip:r}=Al({propertyConfig:t,bots:s,isSpaceAdmin:f,environment:o,isWikiCollection:u,databaseType:p,isSyncedCollection:S,schema:d,intl:i,isMobile:o.device.isMobile});return{key:t.name,render:e=>{var o,i;return(0,v.jsx)(Qi,{showImage:!n,caption:r??t.description,tooltipImage:r||null===(o=t.tooltipImage)||void 0===o?void 0:o.img,tooltipImageScale:null===(i=t.tooltipImage)||void 0===i?void 0:i.scale,render:o=>(0,v.jsx)(Y.Z,{...(0,ir.Z)(e,o),checkState:!1,title:(0,v.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[t.name,kl.has(t.integration.id)?(0,v.jsx)(ha.Z,{}):null]}),icon:(0,v.jsx)("img",{src:t.integration.info.icon,alt:t.name,style:{width:16,height:16}}),disabled:n,disabledFeedback:n})})},action:async()=>{await ul.Jw({environment:o,connectedRelationProperty:t,collectionContextStore:e,intl:i})}}}),[s,e,p,o,i,f,S,u,d])}}function Pl(e,t){for(const n in e){var o;const i=e[n];if(i&&"connectedRelation"in i&&(null===(o=i.connectedRelation)||void 0===o?void 0:o.integration_id)===t)return!0}return!1}function Al(e){let{propertyConfig:t,databaseType:o,bots:n,isSpaceAdmin:i,isMobile:r,isWikiCollection:a,isSyncedCollection:s,schema:l,intl:c}=e;const d="integration"in t?t.integration.id:t.integrationId;if(!d)return{isDisabled:!1};var u;if((0,qe.gi)({isAuthed:Boolean(n.find((e=>e.integration_id===d))),isSpaceAdmin:i,isPropertyAdminAuthOnly:Boolean(t.canOnlyAdminAuth),isMobile:r}))return{isDisabled:!0,propertyDisabledTooltip:null===(u=t.canOnlyAdminAuth)||void 0===u?void 0:u.disabledPropertyTooltipMessage};if(d===dl.U9){if(Pl(l,dl.U9))return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(bl.duplicateGithubPropertyTooltip)};if(a)return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(bl.wikiGithubPropertyTooltip)};if(s)return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(bl.syncedDatabaseGithubPropertyTooltip)}}else if(d===dl.Dv){if(Pl(l,dl.Dv),o!==R.Fi)return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(bl.nonMeetingsCronPropertyTooltip)};if(Pl(l,dl.Dv))return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(bl.duplicateCronEventPropertyTooltip)}}return{isDisabled:!1}}const Fl=(0,l.defineMessages)({searchPlaceholder:{defaultMessage:"Search or add new property",id:"database.viewSettings.propertyTypeSelect.searchPlaceholder"},suggestedSectionTitle:{defaultMessage:"Suggested",id:"database.viewSettings.propertyTypeSection.suggested"},aiSuggestedSectionTitle:{defaultMessage:"Suggested by AI",id:"database.viewSettings.propertyTypeSection.aiSuggested"},connectedRelationSectionTitle:{defaultMessage:"Connections",id:"database.viewSettings.propertyTypeSection.connected"},typesSectionTitle:{defaultMessage:"Type",id:"database.viewSettings.propertyTab.propertyType"},newProperty:{defaultMessage:"New property",id:"database.viewSettings.newProperty"},newPropertyWithDatabaseName:{defaultMessage:"New property on {databaseName}",id:"database.viewSettings.newPropertyOnDatabase"},selectToAddNewProperty:{defaultMessage:"Select to add",id:"database.viewSettings.selectToAdd"}});function Il(e){window.__c={n:"CollectionSettingsPropertyType"};const t=(0,r.Fy)(),[o,i]=n.useState(""),{collectionContextStore:s,propertyTypes:c,onAccept:u,propertySchema:p,moreSuggestion:g,noSuggestion:m}=e,S=(0,a.VK)((()=>{var e;return null==s||null===(e=s.collectionStore())||void 0===e||null===(e=e.getName())||void 0===e?void 0:e.toString()}),[s]),{connectedRelationProperties:y,renderConnectedRelationProperty:h}=Vl(e.collectionContextStore,e.propertySchema),{standardAndDerivedPropertyTypes:x,renderStandardOrDerivedProperty:C}=Tl({collectionContextStore:s,propertyTypes:c,onAccept:u,propertySchema:p}),{suggestedProperties:w,renderSuggestedProperty:b}=Ml({collectionContextStore:e.collectionContextStore,propertySchema:e.propertySchema}),j=(0,a.VK)((()=>{var e;const t=null===(e=s.collectionStore())||void 0===e?void 0:e.getName(),o=w&&w.length>0;return Boolean(!o&&(null==t?void 0:t.length))}),[s,w]),{aiSuggestedProperties:M,renderAiSuggestedProperty:_}=_l({collectionContextStore:e.collectionContextStore,onAccept:u,fetchAiSuggestions:j}),{derivedPropertyTypesInSuggestedSection:T}=(0,n.useMemo)((()=>{const e=new Set;for(const t of x)(0,$e.XU)(t)&&"suggested"===(0,$t.to)(t)&&e.add(t);return{derivedPropertyTypesInSuggestedSection:e}}),[x]),k=(0,f.yK)((e=>({skeletonRect:{height:10,borderRadius:4,margin:"12px 14px",backgroundColor:e.lightDividerColor},moreSuggestions:{display:"flex",alignItems:"center",lineHeight:1.2,color:e.mediumTextColor,fontSize:12}})),[]),V=(0,n.useMemo)((()=>new Map(x.map((e=>[$t.SO[e].toLowerCase(),e])))),[x]),P=(0,n.useMemo)((()=>({key:"more-suggestions",render:e=>(0,v.jsx)(ne.Z,{children:(0,v.jsx)(Y.Z,{...e,title:(0,v.jsxs)("div",{style:k.moreSuggestions,children:[(0,v.jsx)(l.FormattedMessage,{id:"database.collectionsettings.propertySuggestions.more",defaultMessage:"More"}),(0,al.i)({fill:cr.ZP.uiGray,width:12,height:12,marginLeft:4})]})})}),action:t=>{d.FK({collectionSettingsStore:e.collectionSettingsStore,item:{type:"propertyType",propertySchema:p,propertyTypes:c,onAccept:u,moreSuggestion:!0}})}})),[u,p,c,e.collectionSettingsStore,k.moreSuggestions]);let A=[];if(""!==o){const e={};if(M&&"loading"!==M)for(const o of M)e[o.name]=_(o);else{for(const t of w??[])e[t.name]=b(t);for(const t of T)e[$t.SO[t]]=C(t)}const t=(null==y?void 0:y.reduce(((e,t)=>(h&&(e[t.name]=h(t)),e)),{}))||{},n=He().filter(o,Object.keys(e)).flatMap((t=>e[t.original])),i=He().filter(o,Array.from(V.keys())).flatMap((e=>{const t=V.get(e.original);return!t||T.has(t)?[]:C(t)})),r=He().filter(o,Object.keys(t)).flatMap((e=>t[e.original]));!m&&n.length?A.push({key:"suggested",render:e=>(0,v.jsx)(ne.Z,{...e,title:ii.default.formatMessage(M?Fl.aiSuggestedSectionTitle:Fl.suggestedSectionTitle)}),items:n}):A.push({key:"suggested",render:()=>(0,v.jsx)(v.Fragment,{}),items:[]}),i.length?A.push({key:"search",render:e=>(0,v.jsx)(ne.Z,{title:ii.default.formatMessage(Fl.typesSectionTitle),...e}),items:i}):A.push({key:"search",render:()=>(0,v.jsx)(v.Fragment,{}),items:[]}),r.length?A.push({key:"connected",render:e=>(0,v.jsx)(ne.Z,{...e,title:ii.default.formatMessage(Fl.connectedRelationSectionTitle)}),items:r}):A.push({key:"connected",render:()=>(0,v.jsx)(v.Fragment,{}),items:[]}),o.length>0&&!e.hasOwnProperty(o.toLowerCase())&&!V.has(o.toLowerCase())?A.push({key:"custom",render:e=>(0,v.jsx)(ne.Z,{...e,title:ii.default.formatMessage(Fl.selectToAddNewProperty)}),items:[C("text",o,!0)]}):A.push({key:"custom",render:()=>(0,v.jsx)(v.Fragment,{}),items:[]})}else{const e=[];if(M&&"loading"!==M)M.forEach((t=>e.push(_(t))));else{for(const t of w??[])e.push(b(t));for(const t of T)e.push(C(t))}const t=x.map((e=>T.has(e)?void 0:C(e))).filter(z.$K),o=(null==y?void 0:y.map((e=>h&&h(e))).filter(z.$K))??[];let n;n="loading"===M?{key:"suggested",render:e=>(0,v.jsxs)(ne.Z,{...e,title:ii.default.formatMessage(Fl.aiSuggestedSectionTitle),children:[(0,v.jsx)(sl.Z,{style:{width:"80%",...k.skeletonRect,marginTop:0}}),(0,v.jsx)(sl.Z,{style:{width:"50%",...k.skeletonRect}}),(0,v.jsx)(sl.Z,{style:{width:"60%",...k.skeletonRect}}),(0,v.jsx)(sl.Z,{style:{width:"50%",...k.skeletonRect}})]}),items:[]}:0===e.length?{key:"suggested",render:()=>(0,v.jsx)(v.Fragment,{}),items:[]}:{key:"suggested",render:e=>(0,v.jsx)(ne.Z,{...e,title:ii.default.formatMessage(Fl.aiSuggestedSectionTitle)}),items:g||e.length<=5?e:[...e.slice(0,5),P]};const i=M?n:e.length>0?{key:"suggested",render:e=>(0,v.jsx)(ne.Z,{...e,title:ii.default.formatMessage(Fl.suggestedSectionTitle)}),items:e}:void 0;A=vn.oA([!m&&i,t.length&&{key:"properties",render:e=>(0,v.jsx)(ne.Z,{...e,title:ii.default.formatMessage(Fl.typesSectionTitle)}),items:t},o.length&&{key:"connected",render:e=>(0,v.jsx)(ne.Z,{...e,title:ii.default.formatMessage(Fl.connectedRelationSectionTitle)}),items:o}])}const F=(0,v.jsx)(ne.Z,{desktopStyle:{paddingTop:12,paddingBottom:4},children:(0,v.jsx)(zt.ZP,{focusInitial:!t.isMobile||void 0,focus:!t.isMobile||void 0,value:o,onChange:e=>{i(e.target.value)},placeholder:ii.default.formatMessage(Fl.searchPlaceholder)})});return(0,v.jsxs)(Z.ZP,{...e,title:t.isDesktop&&S?ii.default.formatMessage(Fl.newPropertyWithDatabaseName,{databaseName:S}):ii.default.formatMessage(Fl.newProperty),children:[F,(0,v.jsx)(te.Z,{disableInitialScroll:!0,type:te.i.Vertical,initialFocus:0,sections:A})]})}var Zl=o(34296),Bl=o(32628);function Dl(e){window.__c={n:"CollectionSettingsSelectRelationSource"};const{collectionContextStore:t,collectionSettingsStore:o,property:i,formatKey:c}=e,u=(0,r.O7)(),p=(0,n.useMemo)((()=>Ir.default.createValue("")),[]),g=(0,n.useMemo)((()=>(0,s.ZP)()),[]),m=(0,a.VK)((()=>t.collectionViewBlockStore()),[t]);return m?(0,v.jsx)(Z.ZP,{...e,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Related to",id:"database.viewSettings.selectNewRelationSourceTab.title"}),handleClose:()=>{Yn.tW({environment:u,eventName:"abandoned_search",queryLength:p.state.length,sessionId:g,source:Zl.S.Relation}),d.E3({collectionSettingsStore:o})},children:(0,v.jsx)(Bl.Z,{collectionContextStore:t,onAccept:e=>function(e,t,o,n,i,r){const a=o.collectionStore();if(!a)return;Yn.wd({environment:t,collectionContextStore:o,action:"select_relation_source"});const{stack:s}=n.state,l=s[s.length-2];l&&"setupRelation"===l.type&&d.z$({collectionSettingsStore:n});d.FK({collectionSettingsStore:n,item:{type:"setupRelation",property:i,formatKey:r,targetCollectionPointer:e.pointer}})}(e,u,t,o,i,c),parentStore:m,context:Zl.S.Relation,searchSessionId:g,inputStore:p})}):null}Dl.displayName="CollectionSettingsSelectRelationSource";var Kl=o(57842),Ol=o(71268),Rl=o(34532);function El(e){window.__c={n:"CollectionSettingsSetupRelation"};const{collectionContextStore:t,collectionSettingsStore:o,property:i,formatKey:s,targetCollectionPointer:c,from:g}=e,m=(0,a.VK)((()=>t.collectionStore()),[t]),S=(0,a.VK)((()=>{const e=t.collectionViewBlockStore();return function(e){const{targetCollectionPointer:t,collectionStore:o,collectionViewBlockStore:n}=e;if(!t)return;if(o&&o.pointer===t)return o;return n?$.NW.createChildStore(n,t):void 0}({targetCollectionPointer:c,collectionStore:m,collectionViewBlockStore:e})}),[t,m,c]),f=(0,a.VK)((()=>i?pn.KV(t,i):void 0),[t,i]),y=Boolean(m&&S&&m.id===S.id),h=Boolean("relation"===(null==f?void 0:f.type)&&f.connectedRelation),x=Boolean("subitem"===g),C=Boolean("timeline_arrows_by"===g),w=(0,a.VK)((()=>t.contextType),[t]),b=(0,r.O7)(),j=(0,l.useIntl)(),M=(0,a.VK)((()=>{const e=null==m?void 0:m.getSchema();return void 0===(null==f?void 0:f.name)&&S&&e?pn.m8(j,{targetCollectionStore:S,isSelfRelation:y,sourceSchema:e,createUnique:!0,from:g}):(null==f?void 0:f.name)||""}),[m,null==f?void 0:f.name,S,j,y,g]),[_,T]=(0,n.useState)(M),[k,V]=(0,n.useState)("no_limit"),[P,A]=(0,n.useState)(x||C?{hasInverseRelation:!0,inverseName:void 0,autoRelate:{enabled:!1}}:{hasInverseRelation:!1,inverseName:void 0,autoRelate:{enabled:!1}}),F=_===M,I=(0,n.useCallback)((()=>{d.H4({collectionSettingsStore:o,item:{type:"selectRelationSource",property:i,formatKey:s}})}),[o,i,s]),B=(0,n.useCallback)((()=>{if(!P)return;const{hasInverseRelation:e,inverseName:n,autoRelate:r}=P,a=t.collectionStore(),l=t.collectionViewStore();if(!a||!S)return;const{performResult:c}=p.createAndCommit({userAction:"CollectionSettingsSetupRelation.handleAddRelation",environment:b,perform:o=>{const c=i??en.G3({environment:b,collectionStore:a,collectionViewArgs:l&&s?{collectionViewStore:l,format:l.getFormat(),formatKey:s}:void 0,propertyType:"relation",transaction:o});if(fi.n7({environment:b,collectionContextStore:t,collectionStore:a,property:c,propertyName:_,targetCollectionStore:S,hasInverseRelation:e,inverseName:n,autoRelate:r,propertyLimit:k,intl:j,transaction:o,from:g}),l){var d;const e=(null===(d=l.getFormat().table_properties)||void 0===d?void 0:d.find((e=>e.property===c)))??{property:c,visible:!0};u.FH({stores:[l],update:{table_properties:[...l.getFormat().table_properties??[],e]},transaction:o})}return"subitem"===g&&l?(tn.dR({collectionViewStore:l,propertyId:c,transaction:o}),tn.jA({environment:b,collectionContextStore:t,relationPropertyId:c,transaction:o})):"timeline_arrows_by"===g&&l&&(yi.tF({collectionViewStore:l,newProperty:c,transaction:o}),yi._p({collectionContextStore:t,relationPropertyId:c,transaction:o})),c}});"subitem"===g||"timeline_arrows_by"===g?(d.z$({collectionSettingsStore:o}),d.H4({collectionSettingsStore:o,item:{type:"main"}})):d.qU({collectionSettingsStore:o,property:c,formatKey:s}),Yn._H({environment:b,collectionContextStore:t,from:"collectionPage"===w?"page_properties":"view_settings",property_type:"relation"})}),[P,t,S,b,o,i,s,w,_,k,j,g]);return(0,v.jsxs)(Z.ZP,{...e,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"New relation",id:"database.viewSettings.setupRelationTab.title"}),children:[(0,v.jsx)(ne.Z,{children:(0,v.jsx)(zt.ZP,{value:_||"",placeholder:"Property name",onChange:e=>T(e.target.value),onBlur:()=>{},onSubmit:()=>{},focusInitial:!0,selectAll:!1})}),(0,v.jsx)(Rl.Z,{isSelfRelation:y,collectionStore:S,showAs:"chevron",onClick:I,disabled:x}),!g&&(0,v.jsx)(Ol.U,{selectedKey:k,propertyType:"relation",onChange:e=>V(e)}),S&&!h&&(0,v.jsx)(Kl.Z,{collectionContextStore:t,targetCollectionStore:S,property:i,propertyName:_,buttonContents:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Add relation",id:"database.viewSettings.setupRelationTab.addButton.title"}),temporaryInverseState:P,setTemporaryInverseState:A,isInitialPropertyName:F,onSubmit:B,from:g}),(0,v.jsx)(ne.Z,{children:(0,v.jsx)(Bs.Z,{href:(0,Fs.UY)("guides.relations"),title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Learn about relations",id:"database.viewSettings.propertyTab.relations.learnMoreButton.title"}),analyticsFrom:"view_settings_property_relation"})})]})}var Hl=o(72141),Ll=o(63143),Nl=o(76464),Wl=o(29551),zl=o(46978),Ul=o(88893);function Gl(e){let{collectionSettingsStore:t,collectionContextStore:o,integrationName:i,integrationIcon:s,fullHeight:u}=e;window.__c={n:"CollectionSettingsSyncedContentShare"};const g=(0,r.O7)(),m=(0,f.yK)((e=>({promptTitle:ql(e)})),[]),[S,y]=(0,n.useState)(!1),h=(0,a.VK)((()=>o.collectionViewBlockStore()),[o]),{numberOfGuests:x,numberOfUsers:C,isPublic:w}=(0,a.VK)((()=>{const e=Zs.subscriptionDataStoreInstance.state?Ul.CM(Zs.subscriptionDataStoreInstance.state):[],t=(0,Ll.m8)(vn.oA(e.map((e=>[e.userId,e.role]))));if(!h)return{numberOfGuests:void 0,numberOfUsers:void 0,isPublic:void 0};const o=(0,Qt.YO)(h).map((e=>e.permissionItem));let n=!1,i=!1;for(const l of o)Hl.$D(l)?n=!0:Hl.ix(l)&&!Hl.Wi(l.role)&&(i=!0);const r=vn.jj(vn.oA([...o.map((e=>"user_permission"===e.type?e.user_id:void 0)),...i?Object.keys(t):[]])),a=r.filter((e=>"none"!==t[e])).length,s=r.filter((e=>{const n=t[e],i=Boolean(o.filter(Hl.jg).find((t=>t.user_id===e)));return Boolean(n&&i&&!Hl.YX(n))})).length;return{numberOfGuests:s,numberOfUsers:a+s,isPublic:n}}),[h]);(0,n.useEffect)((()=>{w||1!==C||d.E3({collectionSettingsStore:t})}),[t,w,C]);const b=(0,n.useCallback)((()=>{h&&(S&&function(e){const{environment:t,store:o}=e,n=t.currentUser.id;if(!n)return;p.createAndCommit({userAction:"CollectionSettingsSyncedContentShare.restrictAccessToSyncedContent",environment:t,perform:e=>{Nl.Pk({environment:t,store:o,shouldInherit:!1,transaction:e,permissionItem:{type:"user_permission",user_id:n,role:"editor"}})}})}({environment:g,store:h}),c.KI(g,{type:S?"restrict":"share"}),d.E3({collectionSettingsStore:t}))}),[t,h,g,S]);if(!h)return null;const j=(0,v.jsx)("div",{style:m.promptTitle,children:(0,v.jsx)(l.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.header",defaultMessage:"Share synced content with"})}),M=(0,v.jsxs)(v.Fragment,{children:[0!==x?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(l.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.caption.usersWithGuests",defaultMessage:"{numberOfUsers} people (including you {numberOfGuests, plural, one {and {numberOfGuests} guest} other {and {numberOfGuests} guests}})",values:{numberOfUsers:C,numberOfGuests:x}})," "]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(l.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.caption.usersWithoutGuests",defaultMessage:"{numberOfUsers} people (including you)",values:{numberOfUsers:C}})," "]}),w&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(l.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.caption.sharedWithPublic",defaultMessage:"and those with the link"})," "]}),(0,v.jsx)(l.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.caption.accessToIntegration",defaultMessage:"will get access to content synced from {integrationName}",values:{integrationName:i}})]}),_=(0,v.jsx)(Wl.gq,{style:{marginTop:10},children:(0,v.jsx)(Q.Z,{style:{flex:"0 0 100%"},isLarge:!0,onClick:b,children:(0,v.jsx)(l.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.continueButton",defaultMessage:"Continue"})})}),T=(0,v.jsx)(Wl.gq,{style:{paddingBottom:24},alignItems:"center",justifyContent:"center",children:(0,v.jsx)("img",{style:{width:40},src:s})}),k=(0,v.jsx)(te.Z,{type:te.i.Vertical,initialFocus:void 0,sections:[{key:"grant_permissions",items:[{key:"allow",action:()=>null,render:e=>(0,v.jsx)(Y.Z,{...e,textWrapperStyle:{textAlign:"left"},title:(0,v.jsx)(l.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.title",defaultMessage:"Anyone on this page"}),shouldWrapCaption:!0,caption:M,icon:(0,v.jsx)(zl.Z,{isSelected:!S}),onClick:()=>{y(!1)}})},{key:"restrict",action:()=>null,render:e=>(0,v.jsx)(Y.Z,{...e,textWrapperStyle:{textAlign:"left"},title:(0,v.jsx)(l.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.restrict.title",defaultMessage:"Only you"}),shouldWrapCaption:!0,caption:(0,v.jsx)(l.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.restrict.caption",defaultMessage:"You'll need to share with others using the share menu"}),icon:(0,v.jsx)(zl.Z,{isSelected:S}),onClick:()=>{y(!0)}})}],render:e=>(0,v.jsx)(ne.Z,{...e})}]});return(0,v.jsx)(Z.ZP,{collectionSettingsStore:t,fullHeight:u,children:(0,v.jsxs)(Wl.gq,{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0px 16px 16px 16px"},flexDirection:"column",children:[T,(0,v.jsxs)("div",{children:[j,k]}),_]})})}const $l=n.memo(Gl,gs.Z);function ql(e){return{color:e.regularTextColor,fontWeight:A.Z.fontWeight.semibold,fontSize:14}}var Ql=o(21197),Yl=o(34993);const Xl=(0,l.defineMessages)({inputPlaceholder:{defaultMessage:"Filter by…",id:"database.viewSettings.createFilterTab.inputPlaceholder"}});function Jl(e){var t;window.__c={n:"CollectionSettingsViewCreateFilter"};const{context:o,collectionSettingsStore:i,collectionContextStore:c}=e,u=(0,r.O7)(),p=(0,a.VK)((()=>c.normalizedSchemaStore.state),[c]),g=(0,a.VK)((()=>c.normalizedFormatStore.state),[c]),m=(0,a.VK)((()=>c.permissionScopes.state),[c]),S=(0,a.VK)((()=>function(e){return e.currentCombinatorFilterStore.state}(c)),[c]),f=(0,a.VK)((()=>{const e=c.collectionViewStore();return e?(0,cn.qd)({schema:p,filters:nc(c),getRecordModel:e.getRecordModel}):[]}),[c,p]),y=(0,n.useCallback)((e=>{if(!e)return;const t=c.collectionViewStore(),n=f.find((t=>t.property===e));if(!n||!t)return;const r={id:(0,s.ZP)(),filter:n};Yl.iU({environment:u,collectionContextStore:c,temporaryState:{...c.temporaryState.state,propertyFilters:{value:[...nc(c),r]}}}),function(e,t,o,n,i){if(Yn.wd({environment:i,collectionContextStore:t,action:"create_property_filter"}),o===Ss.HV.FilterBar||o===Ss.HV.TopbarFilterPopup){tc(t,n);const o=t.getFilterBarItemSettingsStore(e);d.wl({collectionSettingsStore:o,item:{type:"filter"}})}else if(o===Ss.HV.ViewSettings){oc(n);const o=t.getFilterOptionsItemSettingsStore(e);d.wl({collectionSettingsStore:o,item:{type:"filter"}})}}(r,c,o,i,u)}),[c,i,o,u,f]),h=(0,n.useCallback)((()=>{c.collectionViewStore()&&(S||Yl.iU({environment:u,collectionContextStore:c,temporaryState:{...c.temporaryState.state,combinatorFilter:{value:Ge.TI}}}),ic(c,o,i,u))}),[c,i,S,o,u]);return(0,v.jsx)(Z.ZP,{...e,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Add filter",id:"database.viewSettings.createFilterTab.title"}),footer:m.canConfigureBlock&&(0,v.jsx)(ne.Z,{topBorder:!0,children:(0,v.jsx)(B.Z,{icon:S?Ql.Q:it.R,isGray:!0,title:S?(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Advanced filter",id:"database.viewSettings.createFilterTab.advancedFilter.title"}):(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Add advanced filter",id:"database.viewSettings.createFilterTab.addAdvancedFilter.title"}),right:S&&(0,v.jsx)(l.FormattedMessage,{defaultMessage:"{ruleCount, plural, one {{ruleCount} rule} other {{ruleCount} rules}}",id:"database.viewSettings.createFilterTab.advancedFilterRulesCount.title",values:{ruleCount:(null===(t=S.filters)||void 0===t?void 0:t.length)||1}}),onClick:h})}),children:(0,v.jsx)(ui.Z,{schema:p,format:g,getProperties:()=>f.map((e=>e.property)),onAccept:y,inputPlaceholder:ii.default.formatMessage(Xl.inputPlaceholder)})})}const ec=n.memo(Jl,gs.Z);function tc(e,t){e.filtersBarOpen.setState(!0),d.z$({collectionSettingsStore:t})}function oc(e){d.wl({collectionSettingsStore:e,item:{type:"main"}}),d.H4({collectionSettingsStore:e,item:{type:"filters"}})}function nc(e){return e.currentPropertyFiltersStore.state}function ic(e,t,o,n){Yn.wd({environment:n,collectionContextStore:e,action:"create_combinator_filter"}),t===Ss.HV.FilterBar||t===Ss.HV.TopbarFilterPopup?(tc(e,o),d.wl({collectionSettingsStore:e.filterBarCombinatorFilterSettingsStore,item:{type:"filter"}})):t===Ss.HV.ViewSettings&&(oc(o),d.wl({collectionSettingsStore:e.filterOptionsCombinatorFilterSettingsStore,item:{type:"filter"}}))}const rc=(0,l.defineMessages)({inputPlaceholder:{defaultMessage:"Sort by…",id:"database.viewSettings.createSortTab.inputPlaceholder"}});const ac=function(e){window.__c={n:"CollectionSettingsViewCreateSort"};const{context:t,collectionContextStore:o,collectionSettingsStore:n}=e,i=(0,r.O7)(),s=(0,l.useIntl)(),c=(0,a.VK)((()=>o.normalizedSchemaStore.state),[o]),u=(0,a.VK)((()=>o.normalizedFormatStore.state),[o]),p=(0,a.VK)((()=>sc(o)),[o]);return(0,v.jsx)(Z.ZP,{...e,collectionSettingsStore:n,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"New sort",id:"database.viewSettings.createSortTab.title"}),children:(0,v.jsx)(ui.Z,{schema:c,format:u,getProperties:()=>Object.entries(c).filter((e=>{let[t,o]=e;return!p.find((e=>e.property===t))&&(0,qe.bA)(o)})).map((e=>{let[t]=e;return t})),onAccept:e=>function(e,t,o,n,i){var r;if(!e)return;const a=o.collectionViewStore(),s=o.normalizedSchemaStore.state;if(!a||!s)return;const l=null===(r=s[e])||void 0===r?void 0:r.type;Yn.wd({environment:t,collectionContextStore:o,action:"create_sort_accept",original_view_type:a.getType(),property_type:l});const c={property:e,direction:"ascending"},u=[...sc(o),c];if(Yl.iU({environment:t,collectionContextStore:o,temporaryState:{...o.temporaryState.state,sorts:{value:u}}}),n===Ss.HV.TopbarSortPopup||n===Ss.HV.FilterBar){o.filtersBarOpen.setState(!0),d.z$({collectionSettingsStore:i});const{filterBarSortSettingsStore:e}=o;d.wl({collectionSettingsStore:e,item:{type:"sort"}})}else n===Ss.HV.ViewSettings&&(d.wl({collectionSettingsStore:i,item:{type:"main"}}),d.H4({collectionSettingsStore:i,item:{type:"sort"}}))}(e,i,o,t,n),inputPlaceholder:s.formatMessage(rc.inputPlaceholder)})})};function sc(e){return e.currentSortsStore.state}var lc=o(6758),cc=o(8982),dc=o(18245);const uc=function(e){window.__c={n:"CollectionSettingsViewFilter"};const{collectionContextStore:t,context:o,collectionSettingsStore:n}=e,i=(0,r.O7)(),s=(0,a.VK)((()=>t.collectionViewStore()),[t]),c=(0,a.VK)((()=>t.normalizedSchemaStore.state),[t]),u=(0,a.VK)((()=>function(e){return e.currentCombinatorFilterStore.state}(t)),[t]),p=(0,a.VK)((()=>null==s?void 0:s.getType()),[s]);return s&&u&&p?(0,v.jsxs)(Z.ZP,{...e,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Advanced filter",id:"database.viewSettings.filterTab.title"}),unconstrainedWidth:!0,children:[(0,v.jsx)(cc.D,{children:(0,v.jsx)(lc.Pq,{index:0,level:0,combinatorFilter:u,schema:c,onChange:(e,o)=>function(e,t,o,n){var i;const r=null===(i=n.remoteResult.state)||void 0===i?void 0:i.sizeHint,a=dc.default.mark("collections.update_filter_lag");dc.default.measureAfterNextFlush(a,{environment:o,getData:()=>Cr.Y5({from:"combinator_filter",collectionContextStore:n,sizeHintAtStart:r})}),Yl.iU({environment:o,collectionContextStore:n,temporaryState:{...n.temporaryState.state,combinatorFilter:{value:t}}}),Yn.wd({environment:o,collectionContextStore:n,action:"update_combinator_filter"})}(0,o,i,t),collectionViewType:p,collectionViewId:s.id,parentStore:s})}),(0,v.jsx)(ne.Z,{topBorder:!0,children:(0,v.jsx)(B.Z,{title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Delete filter",id:"database.viewSettings.filterTab.deleteFilterButton.title"}),onClick:()=>function(e,t,o,n){Yl.iU({environment:e,collectionContextStore:t,temporaryState:{...t.temporaryState.state,combinatorFilter:{value:void 0}}}),o===Ss.HV.FilterBar&&d.E3({collectionSettingsStore:n});Yn.wd({environment:e,collectionContextStore:t,action:"delete_combinator_filter"})}(i,t,o,n)})})]}):null};var pc=o(57820),gc=o(1456),mc=o(52387),Sc=o(79131),fc=o(5145),yc=o(86650);function hc(e){window.__c={n:"CollectionSettingsViewFilters"};const{collectionSettingsStore:t,collectionContextStore:o}=e,i=(0,r.O7)(),[s,c,u,p]=(0,a.VK)((()=>[o.currentPropertyFiltersStore.state,o.currentPropertyFiltersStore.state.map((e=>e.id)),o.permissionScopes.state,(0,cn.yU)(o)]),[o]),g=(0,a.VK)((()=>u.canConfigureBlock?o.currentCombinatorFilterStore.state:void 0),[o,u]),m=(0,n.useCallback)((()=>{d.E3({collectionSettingsStore:o.filterOptionsCombinatorFilterSettingsStore}),s.forEach((e=>{const t=o.getFilterOptionsItemSettingsStore(e);d.E3({collectionSettingsStore:t})}))}),[o,s]),S=(0,f.yK)((e=>({menuItem:{color:e.mediumTextColor},menuItemIcon:{width:14,marginLeft:4,marginRight:4,fill:e.mediumIconColor},mobile:{paddingTop:8,background:e.contentBackground}})),[]);return(0,v.jsx)("div",{onClick:e=>{(0,zo.ZP)({event:e,context:zo.Af.CollectionSettingsClick,callback:m})},children:(0,v.jsx)(Z.ZP,{...e,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Filters",id:"database.viewSettings.filtersTab.title"}),footer:p&&(0,v.jsx)(ne.Z,{topBorder:!0,children:(0,v.jsx)(vc,{collectionContextStore:o})}),unconstrainedWidth:!0,children:(0,v.jsxs)(ne.Z,{children:[(c.length>0||g)&&(0,v.jsxs)("div",{style:i.device.isMobile?S.mobile:void 0,children:[g&&(0,v.jsx)(wc,{collectionContextStore:o}),Cc(i)?(0,v.jsx)(Sc.ZP,{direction:"vertical",keys:c,renderKey:e=>{const t=c.indexOf(e);return(0,v.jsx)(bc,{collectionContextStore:o,filter:s[t]})},onDrop:e=>function(e,t,o){const n=o.collectionViewBlockStore();if(!n)return;const i=o.currentPropertyFiltersStore.state,r=vn.oA(e.map((e=>i.find((t=>t.id===e)))));Yl.iU({environment:t,collectionContextStore:o,temporaryState:{...o.temporaryState.state,propertyFilters:{value:r}}}),Yn.wd({environment:t,collectionContextStore:o,action:"reorder_filters"})}(e,i,o),disabled:!u.canConfigureBlock}):c.map((e=>{const t=c.indexOf(e);return(0,v.jsx)(bc,{collectionContextStore:o,filter:s[t]},e)}))]}),(0,v.jsx)(Y.Z,{focused:!1,icon:(0,it.R)(S.menuItemIcon),style:S.menuItem,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Add filter",id:"database.viewSettings.filtersTab.newFilter.title"}),onClick:()=>{m(),function(e,t,o){Yn.wd({environment:e,collectionContextStore:o,action:"click_new_filter"}),d.H4({collectionSettingsStore:t,item:{type:"createFilter"}}),o.filtersBarOpen.setState(!0)}(i,t,o)}})]})})})}const xc=n.memo(hc,gs.Z);function vc(e){let{collectionContextStore:t}=e;return(0,v.jsx)(yc.ZP,{context:yc.R1.SettingsFilters,collectionContextStore:t})}function Cc(e){return!e.device.isMobile}function wc(e){let{collectionContextStore:t}=e;window.__c={n:"CombinatorFilter"};const o=(0,r.O7)();return(0,v.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 10px"},children:[Cc(o)&&(0,v.jsx)(fc.ZP,{iconSize:12,style:{marginLeft:6,marginRight:6,opacity:.4,cursor:void 0}}),(0,v.jsx)(gc.B,{context:pc.P.SettingsFilters,collectionContextStore:t,collectionSettingsStore:t.filterOptionsCombinatorFilterSettingsStore})]})}function bc(e){let{filter:t,collectionContextStore:o}=e;window.__c={n:"PropertyFilterComponent"};const n=(0,r.O7)(),i=(0,a.VK)((()=>o.getFilterOptionsItemSettingsStore(t)),[o,t]);return(0,v.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 10px"},children:[Cc(n)&&(0,v.jsx)(fc.ZP,{iconSize:12,style:{marginLeft:6,marginRight:6}}),(0,v.jsx)(mc.Z,{id:t.id,context:pc.P.SettingsFilters,collectionContextStore:o,collectionSettingsStore:i},t.id)]})}var jc=o(26055);const Mc=vn.Ds(((e,t)=>{void 0!==e&&t(e)}),300);function _c(e){let{value:t,onChange:o}=e;window.__c={n:"CollectionViewGroupMenuNumberInput"};const i=(0,f.yK)((e=>({input:{background:e.contentBackground}})),[]),[r,a]=(0,n.useState)("");return(0,n.useEffect)((()=>{a(t.toString())}),[t]),(0,v.jsx)(g.Z,{type:"number",value:r,inputClassName:"input-hide-arrows",style:i.input,onChange:e=>{const t=e.target.value,n=parseFloat(t);isNaN(n)?Mc(void 0,o):Mc(n,o),a(t)}})}const Tc=(0,l.injectIntl)((function(e){let{numberGroupBy:t,collectionContextStore:o,schema:n,onChange:i}=e;window.__c={n:"CollectionViewNumberGroupMenu"};const r=(0,f.Fg)(),s=n[t.property];return(0,a.VK)((()=>o.collectionStore()),[o])&&s?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(ne.Z,{topBorder:!1,disableMobileBorders:!0,title:(0,v.jsx)(l.FormattedMessage,{id:"database.groupMenu.numberGroupRange",defaultMessage:"Group range"}),isTitleUppercase:!1,children:(0,v.jsxs)("div",{style:{display:"flex",paddingLeft:14,paddingRight:14},children:[(0,v.jsx)(kc,{onChange:i,numberGroupBy:t,inputKey:"start"}),(0,v.jsx)("span",{style:{color:r.mediumTextColor,margin:"0 8px"},children:"–"}),(0,v.jsx)(kc,{onChange:i,numberGroupBy:t,inputKey:"end"})]})}),(0,v.jsx)(ne.Z,{topBorder:!1,disableMobileBorders:!0,title:(0,v.jsx)(l.FormattedMessage,{id:"database.groupMenu.numberGroupSize",defaultMessage:"Group every"}),isTitleUppercase:!1,children:(0,v.jsxs)("div",{style:{paddingLeft:14,paddingRight:14},children:[(0,v.jsx)(kc,{onChange:i,numberGroupBy:t,inputKey:"size"}),(0,v.jsxs)("span",{style:{color:r.mediumTextColor,fontSize:12},children:[(0,v.jsx)(jc.Z,{groupBy:t,groupFormat:{property:t.property,value:{type:"number",value:{type:"range",start:t.start,end:t.start+t.size}}},schema:n,currentGroups:[],disabled:!0,isHiddenGroup:!1,style:{display:"inline",paddingRight:0,paddingLeft:0},collectionContextStore:o}),", ",(0,v.jsx)(jc.Z,{groupBy:t,groupFormat:{property:t.property,value:{type:"number",value:{type:"range",start:t.start+t.size,end:t.start+2*t.size}}},schema:n,currentGroups:[],disabled:!0,isHiddenGroup:!1,style:{display:"inline",paddingRight:0,paddingLeft:0},collectionContextStore:o}),", ..."]})]})})]}):null}));function kc(e){let{numberGroupBy:t,inputKey:o,onChange:n}=e;return(0,v.jsx)(_c,{value:t[o],onChange:e=>{"size"===o&&e<=0&&(e=1),"start"===o&&e>t.end&&(e=t.end),"end"===o&&e<t.start&&(e=t.start),n({newNumberGroupBy:{...t,[o]:e}})}})}const Vc=(0,l.injectIntl)((function(e){return(0,v.jsx)(Z.ZP,{...e,title:(0,v.jsx)(Pc,{collectionSettingsStore:e.collectionSettingsStore,collectionContextStore:e.collectionContextStore}),children:(0,v.jsx)(Ac,{groupByKey:e.groupByKey,groupsFormatKey:e.groupsFormatKey,collectionContextStore:e.collectionContextStore})})}));function Pc(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;window.__c={n:"Title"};const n=(0,a.VK)((()=>(0,Go.n)(t)),[t]),i=(0,a.VK)((()=>o.normalizedSchemaStore.state),[o]),r=(0,a.VK)((()=>o.normalizedFormatStore.state),[o]);if(!n||"groupByNumber"!==n.type)return null;const s=r[n.groupByKey];return s?(0,Pa.cR)({groupBy:s,schema:i})??null:null}function Ac(e){let{groupByKey:t,groupsFormatKey:o,collectionContextStore:n}=e;window.__c={n:"Content"};const i=(0,r.O7)(),s=(0,a.VK)((()=>n.collectionViewStore()),[n]),l=(0,a.VK)((()=>n.normalizedSchemaStore.state),[n]),c=(0,a.VK)((()=>function(e,t){return e.normalizedFormatStore.state[t]}(n,t)),[n,t]);if(!c||!s)return null;const d=(0,Pa.H5)(c);return d?(0,v.jsx)(Tc,{numberGroupBy:d,disabled:!1,schema:l,onChange:e=>{if("number"===c.type)p.createAndCommit({userAction:"CollectionSettingsViewGroupByNumber.renderContent",environment:i,perform:n=>{u.FH({stores:[s],update:{[t]:e.newNumberGroupBy,[o]:void 0},transaction:n})}});else if("formula"===c.type){const n=vn.CE(e.newNumberGroupBy,"property"),r={...c,groupBy:n};p.createAndCommit({userAction:"CollectionSettingsViewGroupByNumber.renderContent",environment:i,perform:e=>{u.FH({stores:[s],update:{[t]:r,[o]:void 0},transaction:e})}})}Yn.wd({environment:i,collectionContextStore:n,action:"group_by_number_update",original_view_type:void 0,property_type:c.type})},collectionContextStore:n}):null}var Fc=o(14714),Ic=o(92918);const Zc=function(e){window.__c={n:"CollectionSettingsViewGroupByProperty"};const{collectionContextStore:t,collectionSettingsStore:o,groupByKey:n,groupsFormatKey:i}=e,s=(0,r.O7)(),l=(0,a.VK)((()=>(0,Go.n)(o)),[o]),c=(0,a.VK)((()=>t.collectionViewBlockStore()),[t]),g=(0,a.VK)((()=>t.collectionViewStore()),[t]),m=(0,a.VK)((()=>null==g?void 0:g.getType()),[g]),S=(0,a.VK)((()=>function(e,t){const o=e.normalizedFormatStore.state;return o[t]}(t,n)),[t,n]),f=(0,a.VK)((()=>t.normalizedSchemaStore.state),[t]),y=(0,a.VK)((()=>t.normalizedFormatStore.state),[t]),h=(0,a.VK)((()=>void 0!==m&&(0,Ic._1)({viewType:m,groupByKey:n})),[n,m]),x=(0,a.VK)((()=>function(e){const t=e.normalizedSchemaStore.state,o=Object.entries(t).sort(Bc).map((e=>e[0]));return o.filter((e=>{const o=t[e];return o&&(0,Fc.LG)(o)}))}(t)),[t]);return c&&g&&l&&m&&"groupByProperty"===l.type?(0,v.jsx)(Z.ZP,{...e,collectionSettingsStore:o,title:(0,Pa.cE)(l.groupByKey,m),children:(0,v.jsx)(ui.Z,{schema:f,format:y,currentProperty:null==S?void 0:S.property,showNoneOption:h,getProperties:()=>x,onAccept:e=>function(e,t,o,n,i,r){const a=o.collectionViewStore(),s=o.normalizedSchemaStore.state;if(!a)return;if(e){const n=s[e];if(!n||!(0,Fc.LG)(n))return;const l=(0,Fc.fw)(e,n,"collectionTypedView"===o.contextType);p.createAndCommit({userAction:"CollectionSettingsViewGroupByProperty.handlePropertyAccept",environment:t,perform:e=>{u.FH({stores:[a],update:{[i]:l,[r]:void 0},transaction:e})}}),Yn.wd({environment:t,collectionContextStore:o,action:"group_by_property_accept",original_view_type:void 0,property_type:n.type})}else p.createAndCommit({userAction:"CollectionSettingsViewGroupByProperty.handlePropertyAccept",environment:t,perform:e=>{u.FH({stores:[a],update:{[i]:void 0,[r]:void 0},transaction:e})}}),Yn.wd({environment:t,collectionContextStore:o,action:"group_by_property_accept"});d.wl({collectionSettingsStore:n,item:{type:"main"}}),d.H4({collectionSettingsStore:n,item:{type:"group",groupByKey:i,groupsFormatKey:r}})}(e,s,t,o,n,i)})}):null};function Bc(e,t){var o,n;const i=null==e||null===(o=e[1])||void 0===o?void 0:o.name,r=null==t||null===(n=t[1])||void 0===n?void 0:n.name;return i&&r?i.localeCompare(r,void 0,{sensitivity:"base"}):i?1:r?-1:0}const Dc=(0,l.injectIntl)((function(e){return(0,v.jsx)(Z.ZP,{...e,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Layout",id:"database.viewSettings.layoutTab.title"}),desktopWidth:290,children:(0,v.jsx)(Nr.Z,{...e})})}));var Kc=o(8306);const Oc=110,Rc=210,Ec=223,Hc=25,Lc=87;function Nc(e){window.__c={n:"CollectionSettingsViewDependenciesPreview"};const{propertyName:t}=e,o=(0,f.Fg)(),n=(0,f.yK)((e=>({dependenciesPreviewOutsideBorder:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:4,alignItems:"center",position:"relative",height:112,paddingLeft:19},svgContainer:{position:"absolute",width:"100%",height:"100%"},svgArrowTheme:{stroke:e.collectionValidDependencyArrow,strokeWidth:wn.lf},dependencyPropertyNamePreview:{fontSize:12,position:"absolute",background:e.buttonBackground,top:48,left:96},timelineItemPreview:{padding:4,margin:"0px 12px",display:"flex",fontSize:14,alignItems:"center",borderRadius:5,background:e.cardBackground,boxShadow:e.buttonBoxShadow,width:100,justifyContent:"center"}})),[]);return(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(ne.Z,{children:(0,v.jsxs)("div",{style:n.dependenciesPreviewOutsideBorder,children:[(0,v.jsxs)("svg",{style:n.svgContainer,children:[(0,v.jsx)(Cn.Z,{startPoint:{x:Oc,y:Hc},endPoint:{x:Oc,y:Lc},style:n.svgArrowTheme,showArrowHead:!0}),(0,v.jsx)(Cn.Z,{startPoint:{x:Rc,y:Lc},endPoint:{x:Ec,y:Lc},style:n.svgArrowTheme,showArrowHead:!1}),(0,v.jsx)("circle",{cx:Ec,cy:Lc,r:wn.Wk,style:n.svgArrowTheme,fill:o.white})]}),(0,v.jsx)("div",{style:n.dependencyPropertyNamePreview,children:t}),(0,v.jsx)("div",{style:{...n.timelineItemPreview,marginTop:10,marginLeft:10},children:(0,v.jsx)("span",{children:"🌱"})}),(0,v.jsx)("div",{style:{...n.timelineItemPreview,marginTop:34,marginLeft:111},children:(0,v.jsx)("span",{children:"🌳"})})]})})})}const Wc=(0,l.defineMessages)({subitemInputPlaceholder:{defaultMessage:"Sub-tasks…",id:"database.viewSettings.relationsPropertyTab.subitemInputPlaceholder"},timelineArrowsByInputPlaceholder:{defaultMessage:"Dependencies…",id:"database.viewSettings.relationsPropertyTab.timelineArrowsByInputPlaceholder"}});const zc=(0,l.injectIntl)((function(e,t){window.__c={n:"CollectionSettingsViewRelationsProperty"};const{collectionContextStore:o,collectionSettingsStore:i,formatSetting:s}=e,c=(0,r.Fy)(),g=(0,l.useIntl)(),m=(0,r.O7)(),S="collection_page_properties",[h]=(0,n.useState)("no_limit"),x="subitem"===s,C="timeline_arrows_by"===s,w=(0,a.VK)((()=>o.databaseType),[o]),b=(0,a.VK)((()=>o.normalizedSchemaStore.state),[o]),j=(0,a.VK)((()=>o.collectionStore()),[o]),M=(0,a.VK)((()=>(null==j?void 0:j.getFormat())??{}),[j]),_=(0,a.VK)((()=>o.collectionViewStore()),[o]),T=(0,a.VK)((()=>null==_?void 0:_.getFormat()),[_]),k=(null==T?void 0:T.subitem_display_mode)??"show",V=(0,a.VK)((()=>{var e;return x?null===(e=o.currentSubitemFormatStoreForCollection.state)||void 0===e?void 0:e.property:C?o.currentArrowsByFormatStore.state:void 0}),[o,x,C]),A=(0,a.VK)((()=>{var e,t;return x?null===(e=o.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.collection_default_subitem:C?null===(t=o.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.collection_default_arrows_by:void 0}),[o,x,C]),F=(0,a.VK)((()=>o.permissionScopes.state),[o]),I=(0,a.VK)((()=>pn.NA(o,b)),[o,b]),D=(0,a.VK)((()=>o.normalizedSchemaStore.state),[o]),K=(0,a.VK)((()=>{var e;const t=o.currentSubitemFormatStoreForCollection.state,n=o.currentArrowsByFormatStore.state;let i;return x?i=t?b[t.property]:void 0:C&&(i=n?b[n]:void 0),null===(e=i)||void 0===e?void 0:e.name}),[o,b,x,C]),O=(0,a.VK)((()=>{const e=o.collectionStore();return null!=e&&e.isDefined()?pn.m8(g,{targetCollectionStore:e,isSelfRelation:!0,sourceSchema:D,createUnique:!0,from:s}):g.formatMessage({id:"database.viewSettings.relationsPropertyTab.initialPropertyName.placeholder",defaultMessage:"Related to target"})}),[o,D,g,s]),[R,E]=(0,n.useState)(K||O),H=R===O,L=(0,a.VK)((()=>{const e=o.currentSubitemFormatStoreForCollection.state,t=o.currentArrowsByFormatStore.state;let n;if(x?n=e?b[e.property]:void 0:C&&(n=t?b[t]:void 0),n&&"relation"===n.type){var i;const e=n.property;return e?null===(i=b[e])||void 0===i?void 0:i.name:void 0}}),[o,b,x,C]),N=(0,a.VK)((()=>{const e=o.collectionStore();return null!=e&&e.isDefined()?pn.aI(g,{sourceCollection:e.getModel(),isSelfRelation:!0,targetCollectionStore:e,createUnique:!0,from:s}):g.formatMessage({id:"database.viewSettings.relationsPropertyTab.inverseName.placeholder",defaultMessage:"Related to this database"})}),[o,g,s]),W=(0,a.VK)((()=>"title"===o.normalizedFormatStore.state.table_subitem_toggle_column),[o]),[z,U]=(0,n.useState)({hasInverseRelation:!0,inverseName:L,autoRelate:{enabled:!1}}),[G,$]=(0,n.useState)(0===I.length),q=(0,a.qz)(void 0,go.Z),Q=(0,a.Kw)(q),Y=(0,n.useCallback)((()=>pn.NA(o,b)),[o,b]),J=(0,n.useCallback)((e=>{if(e){const t=b[e];if(t&&"relation"===t.type){const e=t.property;if(e){const t=b[e];if(t&&z){const e=t.name;U({hasInverseRelation:null==z?void 0:z.hasInverseRelation,inverseName:e,autoRelate:null==z?void 0:z.autoRelate})}}E(t.name)}}}),[b,z,E]),te=(0,n.useCallback)((e=>{const{collectionViewStore:t,newProperty:o,transaction:n}=e;x?(tn.dR({collectionViewStore:t,propertyId:o,transaction:n}),(0,vn.o8)(t.getFormat().table_subitem_toggle_column)&&u.FH({stores:[t],update:{table_subitem_toggle_column:"title"},transaction:n})):C&&yi.tF({collectionViewStore:t,newProperty:o,transaction:n})}),[x,C]),ie=(0,n.useCallback)((e=>{const{relationPropertyId:t,transaction:n}=e;x&&tn.jA({environment:m,collectionContextStore:o,relationPropertyId:t,transaction:n}),C&&yi._p({collectionContextStore:o,relationPropertyId:t,transaction:n})}),[x,C,m,o]),re=(0,n.useCallback)((e=>{const t=o.collectionViewStore();t&&(p.createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handleDefaultPropertySelect",environment:m,perform:o=>{te({collectionViewStore:t,newProperty:e,transaction:o}),ie({relationPropertyId:e,transaction:o})}}),J(e),$(!1),d.E3({collectionSettingsStore:i}),Yn.wd({action:x?"update_default_subitem":"update_default_timeline_arrows_by",original_view_type:void 0,property_type:e?"relation":void 0,environment:m,collectionContextStore:o}))}),[o,m,$,J,i,x,te,ie]),ae=(0,n.useCallback)((e=>{const t=o.collectionViewStore();t&&(p.createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handlePropertySelect",environment:m,perform:o=>{te({collectionViewStore:t,newProperty:e,transaction:o})}}),J(e),$(!1),d.E3({collectionSettingsStore:i}),Yn.wd({action:x?"update_subitem":"update_timeline_arrows_by",original_view_type:void 0,property_type:e?"relation":void 0,environment:m,collectionContextStore:o}))}),[o,m,J,i,x,te]),se=(0,n.useCallback)((()=>{qo.default.afterNextFlush((()=>{$(!0),U({hasInverseRelation:!0,inverseName:N,autoRelate:{enabled:!1}}),E(O)}))}),[N,O]),le=(0,n.useCallback)((()=>{if(!z)return;const{hasInverseRelation:e,inverseName:t,autoRelate:n}=z,r=o.collectionStore(),a=r,l=o.collectionViewStore();r&&a&&(p.createAndCommit({userAction:"CollectionSettingsSetupRelation.handleAddRelation",environment:m,perform:i=>{const c=en.G3({environment:m,collectionStore:r,collectionViewArgs:l&&S?{collectionViewStore:l,format:l.getFormat(),formatKey:S}:void 0,propertyType:"relation",transaction:i});return fi.n7({environment:m,collectionContextStore:o,collectionStore:r,property:c,propertyName:R,targetCollectionStore:a,hasInverseRelation:e,inverseName:t,autoRelate:n,propertyLimit:h,intl:g,transaction:i,from:s}),l&&(te({collectionViewStore:l,newProperty:c,transaction:i}),ie({relationPropertyId:c,transaction:i})),c}}),d.z$({collectionSettingsStore:i}),d.H4({collectionSettingsStore:i,item:{type:"main"}}),Yn._H({environment:m,collectionContextStore:o,from:s,property_type:"relation"}))}),[o,m,i,S,g,h,R,z,s,te,ie]),ce=(0,n.useCallback)((()=>{const e=o.collectionViewStore();e&&(Gi.d1({environment:m,collectionViewStore:e,currentValue:o.normalizedFormatStore.state.table_subitem_toggle_column}),Yn.wd({environment:m,collectionContextStore:o,action:"toggle_table_subitem_toggle_on_title"}))}),[o,m]),de=!F.canConfigureBlock,ue=(0,f.yK)((e=>({emptyStateText:{color:e.mediumTextColor,fontSize:14,margin:"0px 12px"},useExistingTitle:{fontSize:12,color:e.mediumTextColor,marginLeft:12,marginTop:12}})),[]);if(!j)return null;const pe=x&&F.canConfigureBlock&&K,ge=F.canConfigureCollection,me=(e,t,n,i)=>(0,v.jsx)(gi,{version:"v1",menuProps:e,property:t,defaultProperty:A,checkState:n,propertySchema:i,collectionContextStore:o,handleDefaultPropertySelect:re,handlePropertySelect:ae});return(0,v.jsxs)(Z.ZP,{...e,title:(0,v.jsx)(l.FormattedMessage,{...(0,un.Gt)({feature:s,databaseType:w})}),footer:(0,v.jsxs)(ne.Z,{topBorder:I.length>0&&!G,children:[pe&&!G&&(0,v.jsx)(Qi,{showImage:!de,caption:ii.default.formatMessage(un.dH.toggleNestingOnTitleMenuItemTooltip),tooltipImage:y.Z.images.tooltips.collectionSettings.subitemsToggleOnTitlePng,tooltipImageScale:.3,render:e=>(0,v.jsx)(B.Z,{...e,icon:e=>(0,Ui.L)({width:11,height:11,marginRight:5,marginLeft:6,transform:"rotateZ(180deg)"}),title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Show nesting toggle on title",id:"database.viewSettings.layoutTab.tableSubitemToggleOnTitle"}),right:(0,v.jsx)($i.Z,{disallowTabbing:!0,on:W,onClick:ce,disabled:de}),disabled:de,isGray:!0,onClick:ce})}),ge&&I.length>0&&!G&&(0,v.jsx)(B.Z,{icon:it.R,title:(0,v.jsx)(l.FormattedMessage,{id:"database.viewSettings.subitemTab.newRelation",defaultMessage:"Create new relation"}),isGray:!0,onClick:se}),!G&&(0,v.jsx)(v.Fragment,{children:F.canConfigureBlock&&!F.canConfigureCollection?(0,v.jsx)(B.Z,{title:(0,v.jsx)(l.FormattedMessage,{id:"database.viewSettings.relationsPropertyTab.removeSubitemRelation.removeSubitemButton.title",defaultMessage:"Turn off for this view"}),isRed:!0,onClick:()=>ae(void 0)}):F.canConfigureBlock&&(0,v.jsx)(X.ZP,{popupType:c.isPhone?oe.kQ.SlideUp:oe.kQ.Popup,alignmentToOrigin:X.vR.End,placementToOrigin:X.pO.Bottom,originGap:0,renderOrigin:e=>(0,v.jsx)(v.Fragment,{children:!(!F.canConfigureBlock||!V)&&(0,v.jsx)(B.Z,{isGray:!0,icon:P.y,title:(0,v.jsx)(l.FormattedMessage,{...(0,un.nB)({feature:s,databaseType:w})}),isRed:!0,...e})}),render:e=>{let t;return t=c.isPhone?{menuType:ei.og.ActionSheet}:{menuType:ei.og.Popup,width:300},(0,v.jsx)(ee.Z,{...t,footer:(0,v.jsxs)(ne.Z,{topBorder:!0,children:[F.canConfigureBlock&&(0,v.jsx)(B.Z,{title:(0,v.jsx)(l.FormattedMessage,{id:"database.viewSettings.relationsPropertyTab.removeRelation.removeRelationButton.title",defaultMessage:"Turn off for this view"}),isRed:!0,onClick:()=>ae(void 0)}),F.canConfigureCollection&&(0,v.jsx)(B.Z,{title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Turn off for all new views",id:"database.viewSettings.relationsPropertyTab.removeRelation.removeAllDefaultButton.title"}),isRed:!0,onClick:()=>{re(void 0)}})]})})}})})]}),children:[x&&(0,v.jsx)(hn,{propertyName:R||O,inversePropertyName:(null==z?void 0:z.inverseName)||N,newDesign:!1,subitemsDisplayMode:k}),C&&(0,v.jsx)(Nc,{propertyName:R||O}),!G&&(0,v.jsx)("div",{style:ue.useExistingTitle,children:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Use an existing relation",id:"database.viewSettings.relationsPropertyTab.useExistingRelation.title"})}),I.length>0&&!G?(0,v.jsx)("div",{style:{paddingBottom:"6px"},children:(0,v.jsx)(ne.Z,{children:(0,v.jsx)(X.ZP,{buttonPopupStore:q,render:e=>{let t;return t=c.isPhone?{menuType:ei.og.ActionSheet}:{menuType:ei.og.Popup,width:300},(0,v.jsx)(ee.Z,{...t,footer:(0,v.jsx)(ui.Z,{schema:b,format:M,getProperties:Y,onAccept:F.canConfigureBlock&&!F.canConfigureCollection?ae:()=>{},inputPlaceholder:ii.default.formatMessage(x?Wc.subitemInputPlaceholder:Wc.timelineArrowsByInputPlaceholder),currentProperty:V,defaultShowPropertyCount:5,renderProperty:F.canConfigureBlock&&!F.canConfigureCollection?void 0:me})})},renderOrigin:e=>{var t;return(0,v.jsx)(B.Z,{title:(0,v.jsx)(l.FormattedMessage,{id:"database.viewSettings.relationsPropertyTab.existingRelation",defaultMessage:"Property"}),showChevron:!0,right:V?null===(t=b[V])||void 0===t?void 0:t.name:void 0,rotateChevron:Q.open,disabled:!1,icon:xt.v,...e})},popupType:c.isPhone?oe.kQ.SlideUp:oe.kQ.Popup,alignmentToOrigin:X.vR.End,placementToOrigin:X.pO.Bottom,originGap:0})})}):ge&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(ne.Z,{children:(0,v.jsx)("div",{style:ue.emptyStateText,children:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Rename (optional)",id:"database.viewSettings.relationsPropertyTab.emptyStateDescription"})})}),(0,v.jsx)(ne.Z,{children:(0,v.jsx)(zt.ZP,{value:R,placeholder:R,onChange:e=>E(e.target.value),onBlur:()=>{},onSubmit:()=>{},focusInitial:!0,selectAll:!1})}),(0,v.jsx)(Kl.Z,{collectionContextStore:o,targetCollectionStore:j,property:void 0,buttonContents:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Create",id:"database.viewSettings.relationsPropertyTab.createButton.title"}),temporaryInverseState:z,setTemporaryInverseState:U,isInitialPropertyName:H,onSubmit:le,from:s}),I.length>0&&(0,v.jsx)("div",{style:{margin:"auto",textAlign:"center"},children:(0,v.jsx)(jr.Z,{onClick:()=>{qo.default.afterNextFlush((()=>{$(!1)}))},isGray:!0,style:{margin:"6px 12px 6px 12px",width:"auto"},children:(0,v.jsx)(l.FormattedMessage,{id:"database.viewSettings.relationsPropertyTab.newRelation",defaultMessage:"Use existing relation"})})})]})]})}));var Uc=o(12076);function Gc(e){let{context:t,collectionContextStore:o,collectionSettingsStore:n,fullHeight:i,hideDesktopHeader:s}=e;window.__c={n:"CollectionSettingsViewSort"};const c=(0,r.O7)(),[u,p,g,m,S,f]=(0,a.VK)((()=>[o.collectionViewStore(),(0,cn.Mj)(o),o.normalizedSchemaStore.state,o.normalizedFormatStore.state,o.permissionScopes.state,$c(o)]),[o]),y=t===Ss.HV.ViewSettings&&p;return u?(0,v.jsx)(Z.ZP,{collectionSettingsStore:n,fullHeight:i,hideDesktopHeader:s,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Sort",id:"database.viewSettings.sortTab.title"}),footer:y&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{style:{paddingTop:24}}),(0,v.jsx)(ne.Z,{topBorder:!0,children:(0,v.jsx)(qc,{collectionContextStore:o})})]}),unconstrainedWidth:!0,children:(0,v.jsx)(Uc.Z,{collectionContextStore:o,collectionViewStore:u,schema:g,format:m,sorts:f,disabled:!S.canConfigureBlock,parentStore:u,onChange:e=>function(e,t,o){!function(e,t,o){const n=t.collectionViewStore();if(!n)return;Yl.iU({environment:o,collectionContextStore:t,temporaryState:{...t.temporaryState.state,sorts:{value:e}}})}(e,o,t)}(e,c,o),showDeleteAll:!0,onDeleteAll:()=>function(e,t){t===Ss.HV.FilterBar&&d.E3({collectionSettingsStore:e})}(n,t)})}):null}function $c(e){return e.currentSortsStore.state}function qc(e){let{collectionContextStore:t}=e;return(0,v.jsx)(yc.ZP,{context:yc.R1.SettingsSort,collectionContextStore:t})}Gc.displayName="CollectionSettingsViewSort";var Qc=o(75553),Yc=o(1436),Xc=o(16011),Jc=o(95477);const ed=2e4,td=100;var od=o(59753),nd=o(47425);var id=o(38737),rd=o(75498);const ad={type:"aggregation",filter:void 0,aggregation:{aggregator:"count",property:"title"}};function sd(e){let{collectionContextStore:t}=e;window.__c={n:"CollectionSettingsViewSyncedSourceLimitMenu"};const o=(0,l.useIntl)(),{isMobile:i}=(0,r.Fy)(),s=(0,f.yK)((e=>({menuItem:{color:e.mediumTextColor,paddingLeft:i?4:8},warningIcon:{fill:(0,cr.fi)("orange",e).fill,marginRight:14,width:12,alignSelf:"center"}})),[i]),c=(0,a.VK)((()=>{var e;return"row_limit_exceeded"===(null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormatStore())||void 0===e?void 0:e.getKeyStore("sync_state").getKeyStore("syncing").getValue())}),[t]),d=(0,a.VK)((()=>Jt.default.state.currentSpaceStore),[]),u=(0,a.VK)((()=>function(e){if(!e)return ed;const t=od.kk.fromSpace(e),o=t.getSetting("database_sync_row_limit");return void 0!==o?o:(0,nd.QM)(t.getSubscriptionTier())?td:ed}(null==d?void 0:d.getModel())),[d]),p=(0,a.VK)((()=>(0,nd.QM)(null==d?void 0:d.getSubscriptionTier())),[d]),g=(0,n.useMemo)((()=>(0,v.jsx)(rd.Z,{id:"table:uncategorized:title:count",collectionContextStore:t,reducer:ad,render:e=>{const t=e.state;if(!t||"aggregation"!==t.type)return;if("number"!==t.aggregationResult.type)return;const n={...t.aggregationResult,value:t.aggregationResult.value&&Math.min(u,t.aggregationResult.value)};return(0,id.uf)(n.value,"number_with_commas",o)}})),[t,o,u]);return(0,v.jsx)(ms.Z,{title:(0,v.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[c&&d&&p&&(0,v.jsx)(Gt.ZP,{placement:Gt.ug.Left,alignment:Gt.v2.Center,renderTooltip:()=>(0,v.jsx)(l.FormattedMessage,{id:"database.viewSettings.syncedSourceTab.limitFree.toolTip",defaultMessage:"Free Plans are limited to 1 synced database with up to 100 rows."}),render:e=>(0,v.jsx)("div",{...e,children:(0,ro.t)(s.warningIcon)})}),(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Limit",id:"database.viewSettings.syncedSourceTab.limit"})]}),right:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"{value}/{limit} rows",id:"database.viewSettings.syncedSourceTab.limitRows",values:{value:g,limit:(0,id.uf)(u,"number_with_commas",o)}}),style:s.menuItem})}const ld=n.memo(sd,gs.Z);var cd=o(60291),dd=o(69619),ud=o(15157),pd=o(16402);function gd(e){let{collectionContextStore:t}=e;window.__c={n:"CollectionSettingsViewSyncedSourceSyncButton"};const o=(0,r.O7)(),{isMobile:i}=o.device,s=(0,f.yK)((e=>({menuItem:{color:e.mediumTextColor,paddingLeft:i?4:8},menuItemIcon:{height:16,width:16,marginRight:2}})),[i]),c=(0,a.VK)((()=>t.collectionStore()),[t]),[u,p]=(0,a.VK)((()=>{const e=null==c?void 0:c.getFormatStore();return[null==e?void 0:e.getKeyStore("uri").getValue(),null==e?void 0:e.getKeyStore("bot_id").getValue()]}),[c]),g=(0,a.VK)((()=>Jt.default.state.currentSpaceStore),[]),m=(0,a.VK)((()=>{var e;const o=t.numberChildrenUnfurled.state,n=t.numberChildrenReceived.state,r=o/n,a=!0===(null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat().sync_state)||void 0===e?void 0:e.syncing);return o&&n&&r<1&&!i||a&&i}),[t,i]),S=(0,a.VK)((()=>({defaultMessage:g&&(0,nd.QM)(g.getSubscriptionTier())?"Clear and sync database":"Sync database"})),[g]),[y,h]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{if(u&&p){const e=`${p}:${u}`,t=ud.Z.get({userId:o.currentUser.id,key:e});h(t)}}),[p,o,u]);const x=!y||y<Date.now();return u&&p?m?(0,v.jsx)(ms.Z,{title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Syncing",id:"database.viewSettings.syncedSourceTab.isSyncing"}),icon:(0,cd.b)(s.menuItemIcon,"sync-spinner"),style:s.menuItem}):x?(0,v.jsx)(B.Z,{isGray:!0,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"{message}",id:"database.viewSettings.syncedSourceTab.syncNow",values:{message:S.defaultMessage,description:S.description}}),icon:cd.b,onClick:async()=>{const e=null==c?void 0:c.id,t=!0===(null==c?void 0:c.getFormat().stale);e&&await d.R0({environment:o,uri:u,botId:p,collectionId:e,nextSync:y,setNextSync:h,isStale:t})}}):(0,v.jsx)(ms.Z,{title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Sync available in {timeToNextSync}",id:"database.viewSettings.syncedSourceTab.syncNow.disabled",values:{timeToNextSync:(0,pd.hH)(Date.now(),y)}}),icon:(0,dd.T)(s.menuItemIcon),style:s.menuItem}):null}const md=n.memo(gd,gs.Z);function Sd(e){var t;let{collectionContextStore:o}=e;window.__c={n:"CollectionSettingsViewSyncedSource"};const n=(0,r.O7)(),{isMobile:i}=n.device,s=(0,f.yK)((()=>({menuItemTitle:{paddingLeft:i?4:8},menuItemIcon:{height:16,width:16,marginRight:2}})),[i]),c=(0,a.VK)((()=>o.collectionStore()),[o]),[d,u,p]=(0,a.VK)((()=>{const e=null==c?void 0:c.getFormatStore();return[null==e?void 0:e.getKeyStore("uri").getValue(),null==e?void 0:e.getKeyStore("bot_id").getValue(),null==e?void 0:e.getKeyStore("original_url").getValue()]}),[c]),g=null==c||null===(t=c.pointer)||void 0===t?void 0:t.spaceId,m=(0,a.VK)((()=>(0,vl.wY)(p,g)),[g,p]),S=(0,a.VK)((()=>o.collectionViewBlockStore()),[o]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(ne.Z,{title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Source database",id:"database.viewSettings.syncedSourceTab.sourceDatabase"}),children:(0,v.jsx)(Gt.ZP,{placement:Gt.ug.Left,alignment:Gt.v2.Center,renderTooltip:()=>S&&(0,v.jsx)(Xc.Z,{store:S,compactFormat:!0}),render:e=>(0,v.jsx)(ms.Z,{...e,title:m,icon:(0,v.jsx)(Mr.Z,{disabled:!0,icon:null==c?void 0:c.getIcon(),isEmptyPage:!1,size:20,style:s.menuItemIcon}),style:s.menuItemTitle})}),style:{paddingBottom:0}}),(0,v.jsx)(ne.Z,{children:(0,v.jsx)(ld,{collectionContextStore:o})}),(0,v.jsxs)(ne.Z,{topBorder:!0,children:[(0,v.jsx)(md,{collectionContextStore:o}),(0,v.jsx)(B.Z,{isGray:!0,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Copy debugging information",id:"database.viewSettings.syncedSourceTab.copyDebugging"}),icon:Qc.U,onClick:()=>{const e={uri:d,botId:u,spaceId:g};Sr.RD({environment:n,stringValue:JSON.stringify(e,null,2),copiedMessage:Sr.tq.copiedToClipboard})}}),(0,v.jsx)(J.Z,{href:`${Jc.default.domainBaseUrl}?target=connected_apps`,children:(0,v.jsx)(B.Z,{icon:Yc.g,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Manage my connections",id:"database.viewSettings.syncedSourceTab.manageConnections"}),isGray:!0})}),(0,v.jsx)(Bs.Z,{href:(0,Fs.UY)("guides.syncedDatabases"),title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Learn about synced databases",id:"database.viewSettings.syncedSourceTab.learnMoreButton.title."}),analyticsFrom:"view_settings_source"})]})]})}const fd=n.memo(Sd,gs.Z);function yd(e){window.__c={n:"CollectionSettingsViewSource"};const{collectionContextStore:t,collectionSettingsStore:o}=e,i=(0,r.O7)(),c=(0,n.useRef)((0,s.ZP)()),[u,g]=(0,a.VK)((()=>{var e;return[t.collectionViewBlockStore(),Boolean(null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.getCollectionViewSourceCollectionStore())]}),[t]),m=(0,n.useMemo)((()=>Ir.default.createValue("")),[]);return u?(0,v.jsx)(Z.ZP,{...e,title:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Source",id:"database.viewSettings.sourceTab.title"}),handleClose:()=>{Yn.tW({environment:i,eventName:"abandoned_search",sessionId:c.current,source:Zl.S.Source,queryLength:m.state.length}),d.E3({collectionSettingsStore:o})},children:g?(0,v.jsx)(fd,{collectionContextStore:t}):(0,v.jsx)(Bl.Z,{collectionContextStore:t,parentStore:u,onAccept:e=>function(e,t,o,n){p.createAndCommit({userAction:"CollectionSettingsViewSource.handleSourcePickerAccept",environment:t,perform:n=>{Jn.yc({environment:t,collectionContextStore:o,collectionStore:e,transaction:n})}}),d.z$({collectionSettingsStore:n})}(e,i,t,o),context:Zl.S.Source,searchSessionId:c.current,inputStore:m})}):null}yd.displayName="CollectionSettingsViewSource";const hd=n.memo(yd);class xd extends i.Z{constructor(){super(...arguments),this.lastTab=void 0}didMountOrUpdate(){const{collectionSettingsStore:e,collectionContextStore:t}=this.props,o=(0,Go.n)(e),n=function(e){return e.getViewType()}(this.props.collectionContextStore);var i,r,a,s,l,d,u;o&&this.lastTab!==o&&("propertyType"===o.type?c.r5(this.environment,{view_type:n,menu:o.type,is_database_name_empty:!Boolean(null==t||null===(i=t.collectionStore())||void 0===i||null===(i=i.getName())||void 0===i?void 0:i.toString()),collection_id:null===(r=t.collectionStore())||void 0===r?void 0:r.id,collection_view_id:null===(a=t.collectionViewStore())||void 0===a?void 0:a.id,collection_view_block_id:null===(s=t.collectionViewBlockStore())||void 0===s?void 0:s.id}):c.r5(this.environment,{view_type:n,menu:o.type,collection_id:null===(l=t.collectionStore())||void 0===l?void 0:l.id,collection_view_id:null===(d=t.collectionViewStore())||void 0===d?void 0:d.id,collection_view_block_id:null===(u=t.collectionViewBlockStore())||void 0===u?void 0:u.id}));this.lastTab=o}renderComponent(){var e;const{collectionSettingsStore:t}=this.props,o=(0,Go.n)(t),n=(i=this.props,{main:e=>(0,v.jsx)(Cd,{tab:e,...i}),source:()=>(0,v.jsx)(hd,{...i}),createViewSource:()=>(0,v.jsx)(ds.m,{...i}),createSyncedViewSource:e=>(0,v.jsx)(bd,{tab:e,...i}),selectAccountForExternalSource:e=>(0,v.jsx)(jd,{tab:e,...i}),shareSyncedView:e=>(0,v.jsx)(Md,{tab:e,...i}),propertyType:e=>(0,v.jsx)(_d,{tab:e,...i}),propertyAiAutofill:e=>(0,v.jsx)(Td,{tab:e,...i}),createView:()=>(0,v.jsx)(ls,{...i}),duplicateExistingView:()=>(0,v.jsx)(xs.Z,{...i}),properties:e=>(0,v.jsx)(kd,{tab:e,...i}),property:e=>(0,v.jsx)(Vd,{tab:e,...i}),deletedProperties:e=>(0,v.jsx)(Pd,{tab:e,...i}),selectRelationSource:e=>(0,v.jsx)(Ad,{tab:e,...i}),setupRelation:e=>(0,v.jsx)(Fd,{tab:e,...i}),layout:()=>(0,v.jsx)(Dc,{...i}),group:e=>(0,v.jsx)(Id,{tab:e,...i}),groupByProperty:e=>(0,v.jsx)(Zd,{tab:e,...i}),subitem:e=>(0,v.jsx)(Dd,{tab:e,...i}),arrowsBy:e=>(0,v.jsx)(Od,{tab:e,...i}),githubConfig:e=>(0,v.jsx)(Hd,{tab:e,...i}),filters:()=>(0,v.jsx)(xc,{...i}),groupByNumber:e=>(0,v.jsx)(Bd,{tab:e,...i}),filter:e=>(0,v.jsx)(Ld,{tab:e,...i}),createFilter:()=>(0,v.jsx)(ec,{...i}),createSort:()=>(0,v.jsx)(ac,{...i}),sort:()=>(0,v.jsx)(Gc,{...i}),page:()=>(0,v.jsx)(wd,{...i}),createTypedDB:()=>(0,v.jsx)(Rr,{...i}),automationSettings:e=>(0,v.jsx)(Nd,{tab:e,...i}),automationCreateSettings:e=>(0,v.jsx)(Wd,{tab:e,...i}),automationEditSettings:e=>(0,v.jsx)(zd,{tab:e,...i}),dependencies:e=>(0,v.jsx)(Rd,{tab:e,...i}),relationFeaturesAdvancedSettings:e=>(0,v.jsx)(Ed,{tab:e,...i}),subitemV2:e=>(0,v.jsx)(Kd,{tab:e,...i}),sprintSettings:e=>(0,v.jsx)(Ud,{tab:e,...i})});var i;if(o)return(0,v.jsx)(Wo.Z,{capture:!0,preventType:Uo.Z.Y,children:(0,v.jsx)(m.Z,{debugName:"CollectionSettings",capture:!0,onEsc:e=>function(e,t){(0,zo.ZP)({event:e,context:zo.Af.CollectionSettingsClick,callback:()=>{d.E3({collectionSettingsStore:t})}})}(e,this.props.collectionSettingsStore),children:null===(e=n[o.type])||void 0===e?void 0:e.call(n,o)})})}}xd.displayName="CollectionSettings";const vd=(0,l.injectIntl)(xd);function Cd(e){window.__c={n:"MainTabComponent"};const{collectionContextStore:t,tab:o}=e,n=(0,a.VK)((()=>{var e;return null===(e=t.collectionViewStore())||void 0===e?void 0:e.id}),[t]),i=(0,a.VK)((()=>t.collectionViewStore()),[t]);return"main"===o.type&&i?(0,v.jsx)(Ka,{selectViewNameInitial:o.selectViewNameInitial,collectionViewStore:i,...e},n):null}function wd(e){window.__c={n:"PageViewTabComponent"};const{collectionContextStore:t}=e,o=(0,r.O7)(),n=(0,a.VK)((()=>t.collectionViewStore()),[t]);return n?(0,v.jsx)(Z.ZP,{...e,title:"Select page to display",children:(0,v.jsx)("div",{style:{margin:12},children:(0,v.jsx)(g.Z,{showClearButton:!0,placeholder:"Enter page ID",focusInitial:!0,onChange:e=>{$o.Z.setState({pageId:e.target.value})},onSubmit:e=>{const t=$o.Z.state.pageId;if(!t)return null;p.createAndCommit({userAction:"collectionSettings.pageView.selectPage",environment:o,perform:e=>{u.FH({stores:[n],update:{page_pointer:{id:(0,s.Mt)(t),spaceId:e.spaceId,table:"block"}},transaction:e})}})}})})}):null}function bd(e){const{tab:t}=e;return"createSyncedViewSource"!==t.type?null:(0,v.jsx)(kr,{...e,...t})}function jd(e){const{tab:t}=e;return"selectAccountForExternalSource"!==t.type?null:(0,v.jsx)(ar,{...e,...t})}function Md(e){const{tab:t}=e;return"shareSyncedView"!==t.type?null:(0,v.jsx)($l,{...e,...t})}function _d(e){const{tab:t}=e;return"propertyType"!==t.type?null:(0,v.jsx)(Il,{...e,...t})}function Td(e){const{tab:t}=e;return"propertyAiAutofill"!==t.type?null:(0,v.jsx)(nl,{...e,...t})}function kd(e){const{tab:t}=e;return"properties"!==t.type?null:(0,v.jsx)(Kc.Z,{...e,timelineViewTab:t.timelineViewTab})}function Vd(e){const{tab:t}=e;return"property"!==t.type?null:(0,v.jsx)(Cs.ZP,{...e,...t},t.property)}function Pd(e){const{tab:t}=e;return"deletedProperties"!==t.type?null:(0,v.jsx)(hs,{...t,...e})}function Ad(e){const{tab:t}=e;return"selectRelationSource"!==t.type?null:(0,v.jsx)(Dl,{...e,...t})}function Fd(e){const{tab:t}=e;return"setupRelation"!==t.type?null:(0,v.jsx)(El,{...e,...t})}function Id(e){const{tab:t}=e;return"group"!==t.type?null:(0,v.jsx)(Pa.ZP,{...e,...t})}function Zd(e){const{tab:t}=e;return"groupByProperty"!==t.type?null:(0,v.jsx)(Zc,{...e,...t})}function Bd(e){const{tab:t}=e;return"groupByNumber"!==t.type?null:(0,v.jsx)(Vc,{...e,...t})}function Dd(e){const{tab:t}=e;return"subitem"!==t.type?null:(0,v.jsx)(zc,{...e,...t,formatSetting:"subitem"})}function Kd(e){const{tab:t}=e;return"subitemV2"!==t.type?null:(0,v.jsx)(Ki,{...e,feature:"subitem"})}function Od(e){const{tab:t}=e;return"arrowsBy"!==t.type?null:(0,v.jsx)(zc,{...e,...t,formatSetting:"timeline_arrows_by"})}function Rd(e){const{tab:t}=e;return"dependencies"!==t.type?null:(0,v.jsx)(Ki,{...e,feature:"timeline_arrows_by"})}function Ed(e){const{tab:t}=e;return"relationFeaturesAdvancedSettings"!==t.type?null:(0,v.jsx)(tr,{...e,feature:t.feature})}function Hd(e){const{tab:t}=e;return"githubConfig"!==t.type?null:(0,v.jsx)(vs.Z,{...e,property:t.property})}function Ld(e){const{tab:t}=e;return"filter"!==t.type?null:(0,v.jsx)(uc,{...e})}function Nd(e){const{tab:t}=e;return"automationSettings"!==t.type?null:(0,v.jsx)(Ao,{...e,tabSettings:t})}function Wd(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"automationCreateSettings"!==t.type?null:(0,v.jsx)(No.Z,{collectionContextStore:o,collectionSettingsStore:n,mode:"create"})}function zd(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;if("automationEditSettings"!==t.type)return null;const{automationId:i}=t;return(0,v.jsx)(No.Z,{automationId:i,collectionContextStore:o,collectionSettingsStore:n,mode:"update"})}function Ud(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"sprintSettings"!==t.type?null:(0,v.jsx)(be,{collectionContextStore:o,collectionSettingsStore:n})}},12076:(e,t,o)=>{o.d(t,{Z:()=>H});var n=o(67294),i=o(480),r=o(86628),a=o(80951),s=o(8848),l=o(45238),c=o(85893);const d=(0,l.I)("collectionDeleteRule",{viewBox:"0 0 14 14",svg:(0,c.jsx)("path",{d:"M12 3.27273L10.7273 2L7 5.72727L3.27273 2L2 3.27273L5.72727 7L2 10.7273L3.27273 12L7 8.27273L10.7273 12L12 10.7273L8.27273 7L12 3.27273Z"})});var u=o(47453),p=o(37612),g=o(72126),m=o(9291),S=o(36610),f=o(8406),y=o(94166),h=o(57410),x=o(12534),v=o(33929),C=o(87279),w=o(31339),b=o(60246),j=o(52275),M=o(31945),_=o(14871),T=o(77498),k=o(62045),V=o(50542);const P=function(e){let{schema:t,sort:o,disabled:i,onChange:r,index:a,collectionViewType:s,collectionContextStore:l}=e;const d=t[o.property];return d?(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(F,{disabled:i,schema:t,sort:o,onChange:r,index:a,collectionViewType:s,collectionContextStore:l,propertySchema:d}),(0,c.jsx)(A,{sort:o,index:a,onChange:r,collectionViewType:s,collectionContextStore:l,disabled:i})]}):null};function A(e){let{sort:t,index:o,onChange:n,collectionViewType:r,collectionContextStore:a,disabled:s}=e;window.__c={n:"SortDirection"};const l=(0,i.O7)(),d=(0,m.useIntl)(),u=t.direction,p={ascending:(0,c.jsx)(m.FormattedMessage,{defaultMessage:"Ascending",id:"collectionSortMenuRow.sortDirectionSelectMenu.ascending"}),descending:(0,c.jsx)(m.FormattedMessage,{defaultMessage:"Descending",id:"collectionSortMenuRow.sortDirectionSelectMenu.descending"})},g={menuTitle:d.formatMessage({id:"collectionSortMenuRow.sortDirectionSelectMenu.title",defaultMessage:"Sort"}),items:[...b.C6],getKey:e=>e,selectedItem:u,disabled:s,onSelect:e=>{const i={...t,direction:e};n(o,i),a?f.wd({environment:l,action:"set_sort_direction",collectionContextStore:a}):r&&S.wd(l,{view_type:r,action:"set_sort_direction"})},renderItem:e=>(0,c.jsx)(j.Z,{title:p[e.value],...e}),renderOrigin:e=>(0,c.jsx)(k.Z,{...e,placeholder:d.formatMessage({id:"collectionSortMenuRow.sortDirectionSelectMenu.placeholder",defaultMessage:"Empty"}),title:u&&p[u],disabled:s,desktopStyle:{opacity:1}})};return(0,c.jsx)(_.Z,{...g,mobileActionSheet:!0},"direction")}function F(e){let{propertySchema:t,disabled:o,schema:n,sort:r,onChange:s,index:l,collectionViewType:d,collectionContextStore:u}=e;window.__c={n:"PropertyDropdownComponent"};const p=(0,i.O7)(),{device:g}=p;return(0,c.jsx)(M.ZP,{popupType:g.isMobile?M.Z4.SlideUp:M.Z4.Popup,renderOrigin:e=>(0,c.jsx)(V.Z,{...e,propertySchema:t,disabled:o,textWrapperStyle:{opacity:1}}),render:e=>(0,c.jsx)(T.Z,{isRelationProperty:!1,schema:n,onAccept:e=>function(e,t,o,n,i,r,a){n(i,{...o,property:e}),a?f.wd({environment:t,action:"set_sort_property",collectionContextStore:a}):r&&S.wd(t,{view_type:r,action:"set_sort_property"})}(e,p,r,s,l,d,u),onClose:e.close,allowProperty:a.bA}),disabled:o})}var I=o(79131),Z=o(73063),B=o(78140),D=o(28992),K=o(53437),O=o(72495),R=o(26388);const E=(0,m.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a property…",id:"database.viewSettings.collectionSortMenu.inputPlaceholder"},deleteButtonTooltip:{defaultMessage:"Remove sort rule",id:"database.sortMenu.deleteButtonTooltip"}});const H=function(e){let{schema:t,format:o,sorts:n,showDeleteAll:r,disabled:s,parentStore:l,collectionViewStore:d,collectionContextStore:g,onChange:x,onDeleteAll:w}=e;window.__c={n:"CollectionSortMenu"};const b=(0,i.O7)(),{device:j}=b,_=!!Object.keys(t).some((e=>!n.find((t=>t.property===e)))),T=r&&n.length>0;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)($,{sorts:n,schema:t,disabled:s,parentStore:l,collectionViewStore:d,collectionContextStore:g,onChange:x}),(_||T)&&(0,c.jsxs)(O.Z,{children:[_&&(0,c.jsx)(M.ZP,{popupType:j.isMobile?K.kQ.SlideUp:K.kQ.Popup,renderOrigin:e=>(0,c.jsx)(y.Z,{icon:u.R,isGray:!0,title:(0,c.jsx)(m.FormattedMessage,{id:"database.viewSettings.sortTab.newSort",defaultMessage:"Add sort"}),...e}),render:e=>{let i;return i=j.isMobile?{menuType:C.og.ActionSheet}:{menuType:C.og.Popup,width:280,height:287},(0,c.jsx)(B.Z,{...i,children:(0,c.jsx)(h.Z,{schema:t,format:o,getProperties:()=>Object.entries(t).filter((e=>{let[t,o]=e;return!n.find((e=>e.property===t))&&(0,a.bA)(o)})).map((e=>{let[t]=e;return t})),onAccept:o=>{!function(e,t,o,n,i,r,a){var s;if(!e)return;const l=null===(s=o[e])||void 0===s?void 0:s.type,c=[...n,{property:e,direction:"ascending"}];i(c),a&&f.wd({environment:t,action:"create_sort_accept",collectionContextStore:a,property_type:l});const d=L(r);d&&S.wd(t,{action:"create_sort_accept",view_type:d,property_type:l})}(o,b,t,n,x,d,g),e.close()},inputPlaceholder:v.default.formatMessage(E.inputPlaceholder)})})}}),T&&(0,c.jsx)(y.Z,{icon:p.y,isRed:!0,isGray:!0,title:(0,c.jsx)(m.FormattedMessage,{id:"database.viewSettings.sortTab.deleteAllSorts",defaultMessage:"Delete sort"}),onClick:()=>function(e,t,o,n,i){if(t([]),null==i||i(),n)return void f.wd({environment:e,action:"delete_all_sorts",collectionContextStore:n});const r=L(o);r&&S.wd(e,{action:"delete_all_sorts",view_type:r})}(b,x,d,g,w)})]})]})};function L(e){return null==e?void 0:e.getType()}function N(e,t,o,n,i,r,a){if(n(i.map(((o,n)=>n===e?t:o))),a)return void f.wd({environment:o,collectionContextStore:a,action:"update_sort"});const s=L(r);s&&S.wd(o,{action:"update_sort",view_type:s})}function W(e,t,o,n,i,r){if(o(n.filter(((t,o)=>o!==e))),r)return void f.wd({environment:t,action:"delete_sort",collectionContextStore:r});const a=L(i);a&&S.wd(t,{action:"delete_sort",view_type:a})}function z(e){let{index:t,onChange:o,sorts:n,collectionViewStore:r,collectionContextStore:a}=e;window.__c={n:"MobileDeleteButtonMenuItemComponent"};const l=(0,i.O7)();return(0,c.jsx)(j.Z,{title:(0,c.jsx)("div",{style:{color:s.ZP.red},children:(0,c.jsx)(m.FormattedMessage,{defaultMessage:"Delete",id:"database.viewSettings.sortTab.mobileDeleteButtonTitle"})}),icon:(0,c.jsx)(w.Z,{icon:p.y,styles:{color:s.ZP.red}}),onClick:()=>W(t,l,o,n,r,a),focused:!1})}function U(e){let{index:t,onChange:o,sorts:n,collectionViewStore:r,collectionContextStore:a}=e;window.__c={n:"DesktopDeleteButtonComponent"};const s=(0,m.useIntl)(),l=(0,i.O7)();return(0,c.jsx)(R.ZP,{render:e=>(0,c.jsx)(Z.Z,{ariaLabel:s.formatMessage(E.deleteButtonTooltip),icon:d,onClick:()=>W(t,l,o,n,r,a),style:{marginRight:-6},...e}),renderTooltip:()=>s.formatMessage(E.deleteButtonTooltip)})}function G(e){let{sort:t,index:o,schema:n,disabled:a,parentStore:s,collectionViewStore:l,collectionContextStore:d,onChange:u,sorts:p}=e;window.__c={n:"SortComponent"};const g=(0,i.O7)(),{device:m}=g,S=(0,r.VK)((()=>L(l)),[l]);return m.isMobile?(0,c.jsxs)(O.Z,{children:[(0,c.jsx)(P,{index:o,sort:t,schema:n,parentStore:s,collectionViewType:S,collectionContextStore:d,onChange:(e,t)=>N(e,t,g,u,p,l,d)}),!a&&(0,c.jsx)(z,{onChange:u,sorts:p,collectionViewStore:l,collectionContextStore:d,index:o})]}):(0,c.jsx)(O.Z,{extraTopPadding:!0,desktopStyle:{padding:"8px 0 0 8px",width:"100%"},children:(0,c.jsx)(D.Z,{showDragHandle:!m.isMobile&&!a,title:(0,c.jsx)("div",{style:{display:"flex",alignItems:"center",flexGrow:1,whiteSpace:"nowrap"},onMouseDown:x.$0,children:(0,c.jsx)(P,{index:o,sort:t,schema:n,parentStore:s,collectionViewType:S,collectionContextStore:d,onChange:(e,t)=>N(e,t,g,u,p,l,d)})}),right:!a&&(0,c.jsx)(U,{onChange:u,sorts:p,collectionViewStore:l,collectionContextStore:d,index:o})})})}function $(e){let{sorts:t,schema:o,disabled:n,parentStore:r,collectionViewStore:a,collectionContextStore:s,onChange:l}=e;window.__c={n:"SortsComponent"};const d=(0,i.O7)(),{device:u}=d;if(u.isMobile)return(0,c.jsx)(c.Fragment,{children:t.map(((e,i)=>(0,c.jsx)(G,{schema:o,disabled:n,parentStore:r,collectionViewStore:a,collectionContextStore:s,onChange:l,sorts:t,sort:e,index:i},i)))});{const e=t.map(((e,t)=>t.toString()));return e.length>0?(0,c.jsx)("div",{style:{marginBottom:2},children:(0,c.jsx)(I.ZP,{direction:"vertical",keys:e,renderKey:e=>(0,c.jsx)(G,{schema:o,disabled:n,parentStore:r,collectionViewStore:a,collectionContextStore:s,onChange:l,sorts:t,sort:t[parseInt(e)],index:parseInt(e)}),onDrop:e=>function(e,t,o,n,i,r){if(o(g.oA(e.map((e=>n[parseInt(e)])))),r)return void f.wd({environment:t,action:"reorder_sorts",collectionContextStore:r});const a=L(i);a&&S.wd(t,{action:"reorder_sorts",view_type:a})}(e,d,l,t,a,s)})}):null}}},46978:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(67294),i=o(24405),r=o(85893);function a(e,t){let{isSelected:o}=e;window.__c={n:"RadioButtonIcon"};const{radioButtonStyle:n,dotStyle:a}=(0,i.yK)((e=>({radioButtonStyle:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:16,height:16,borderRadius:16,marginRight:8,background:o?e.blueColor:e.whiteButtonBackground,border:o?"none":`1px solid ${e.radioButtonBorder}`,transition:"background 100ms ease-out"},dotStyle:{width:6,height:6,borderRadius:6,background:e.regularInvertedTextColor,transition:"opacity 100ms ease-out",opacity:o?1:0}})),[o]);return(0,r.jsx)("div",{ref:t,style:n,children:(0,r.jsx)("div",{style:a})})}const s=n.forwardRef(a)},90683:(e,t,o)=>{o.d(t,{a:()=>l});o(67294);var n=o(66897),i=o(97880),r=o(70301),a=o(45653),s=o(85893);function l(e){const{actor:t}=e,o={size:e.size??14,style:{marginRight:2,...e.style}};return(0,n.YU)(t)?(0,s.jsx)(r.Z,{botValue:t.asActor,...o}):(0,n.$S)(t)?(0,s.jsx)(a.Z,{userValue:t.asActor,...o}):(0,n.Iq)(t)?(0,s.jsx)(a.Z,{userValue:void 0,...o}):void(0,i.t1)(t)}},52489:(e,t,o)=>{o.d(t,{Z:()=>r});var n=o(49085);class i extends n.default{getInitialState(){return{isModalOpen:!1,collectionContextStore:void 0}}}const r=new i},28410:(e,t,o)=>{o.d(t,{Q4:()=>a,R8:()=>c,SQ:()=>g,Th:()=>i,jl:()=>s,v8:()=>u});o(57658);var n=o(97880);const i=12e3,r=["exploratory","wild_west"],a=(0,n.AO)((e=>(0,n.DE)(r,e)?{true:e}:{false:e})),s="Fine-tuning data generator",l={"ft:gpt-4-0613:makenotion:kenny-7k-ws-qna:8dT2udb5":{name:"Search QnA Model 7K",createdTime:Date.parse("2024-01-05T00:00:00-00:00"),description:"Model trained on 7K search-qa examples",variants:["exploratory"]},"ft:gpt-4-0613:makenotion:kenny-wspg-qna-11k:8gt1DTYZ":{name:"Page + Search QnA 11K",createdTime:Date.parse("2024-01-05T00:00:00-00:00"),description:"Page + Search QnA model trained on 11K examples",variants:["exploratory"]},"ft:gpt-4-0613:makenotion:modi-dbq:8feUtdSu":{name:"Modi DBQ 2.5k",createdTime:Date.parse("2024-01-10T17:55:00-05:00"),description:"Modi's DBQ model trained on 2.5k examples",variants:["exploratory"]},"ft:gpt-3.5-turbo-1106:makenotion::8W3ZKTGG":{name:"Assistant Fast Model",createdTime:Date.parse("2023-12-14T02:27:00-04:00"),description:"Linus's speedy assistant model",variants:["exploratory"]},"ft:gpt-4-0613:makenotion::8SDS0jPI":{name:"JavaScript Assistant",createdTime:Date.parse("2023-12-03T10:58:00-04:00"),description:"Simon's JavaScript assistant",variants:["wild_west"]},"finetuning-data-generator":{name:s,createdTime:Date.parse("2023-01-26T02:27:00-04:00"),description:"Calls the 'slow' API used to generate fine-tuning data",variants:["exploratory"]}},c={name:"Default model",description:"Default assistant model for this mode"},d=((0,n.qP)(l).reduce(((e,t)=>{let[o,{name:n}]=t;return e[n]=o,e}),{}),Object.values(l).map((e=>{let{name:t}=e;return t})));function u(e){return d.some((t=>t===e))}const p=function(){const e={};for(const o of Object.values(l))for(const t of o.variants)e[t]||(e[t]=[]),e[t].push(o);const t={};for(const[o,i]of(0,n.qP)(e))t[o]=i.sort(((e,t)=>e.createdTime-t.createdTime));return t}();function g(e){return(0,n.qg)(p,e)?p[e]:[]}const m=["openai-1.1","openai-2","openai-4","openai-5","openai-6","openai-7","openai-8","openai-9",...d];const S=["anthropic-1","anthropic-2","anthropic-qa-alpha","anthropic-3"]},92165:(e,t,o)=>{o.d(t,{Z:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.I)("arrowsDiverging",{viewBox:"0 0 12 12",svg:(0,i.jsx)("path",{d:"M6 11.2891C6.42188 11.2891 6.63281 11.0469 6.63281 10.5625V7.3457C6.63281 7.00586 6.71875 6.64062 6.89062 6.25C7.06641 5.85938 7.29492 5.47266 7.57617 5.08984C7.86133 4.70703 8.16992 4.35547 8.50195 4.03516C8.83789 3.71484 9.16406 3.45312 9.48047 3.25L9.95508 2.94531C10.1621 2.81641 10.2656 2.63281 10.2656 2.39453C10.2656 2.21875 10.2109 2.07227 10.1016 1.95508C9.99219 1.83789 9.8418 1.7793 9.65039 1.7793C9.4668 1.7793 9.29102 1.83398 9.12305 1.94336L8.81836 2.14844C8.51367 2.34766 8.20898 2.58984 7.9043 2.875C7.59961 3.15625 7.31641 3.45508 7.05469 3.77148C6.79297 4.08398 6.56836 4.39258 6.38086 4.69727C6.19727 4.99805 6.07227 5.26953 6.00586 5.51172H5.98828C5.91797 5.26953 5.79102 4.99805 5.60742 4.69727C5.42383 4.39258 5.19922 4.08398 4.93359 3.77148C4.67188 3.45508 4.38867 3.15625 4.08398 2.875C3.7832 2.58984 3.48047 2.34766 3.17578 2.14844L2.87109 1.94336C2.69922 1.83398 2.52344 1.7793 2.34375 1.7793C2.14844 1.7793 1.99609 1.83984 1.88672 1.96094C1.78125 2.08203 1.72852 2.22461 1.72852 2.38867C1.72852 2.62695 1.83203 2.8125 2.03906 2.94531L2.51367 3.25C2.83008 3.45312 3.1543 3.71484 3.48633 4.03516C3.81836 4.35547 4.12695 4.70703 4.41211 5.08984C4.69727 5.47266 4.92773 5.85938 5.10352 6.25C5.2793 6.64062 5.36719 7.00586 5.36719 7.3457V10.5625C5.36719 11.0469 5.57812 11.2891 6 11.2891ZM1.81641 3.9707L3.71484 1.52734C3.85547 1.33984 3.88281 1.17578 3.79688 1.03516C3.71484 0.890625 3.55469 0.814453 3.31641 0.806641L0.808594 0.712891C0.613281 0.705078 0.466797 0.763672 0.369141 0.888672C0.271484 1.00977 0.251953 1.16406 0.310547 1.35156L1.02539 3.75391C1.0918 3.98438 1.20312 4.125 1.35938 4.17578C1.51953 4.22656 1.67188 4.1582 1.81641 3.9707ZM10.0898 3.95898C10.2266 4.1543 10.375 4.23047 10.5352 4.1875C10.6992 4.14062 10.8164 4.00391 10.8867 3.77734L11.6777 1.39258C11.7402 1.20508 11.7246 1.04883 11.6309 0.923828C11.541 0.798828 11.3984 0.736328 11.2031 0.736328L8.68945 0.753906C8.45117 0.753906 8.28711 0.824219 8.19727 0.964844C8.10742 1.10156 8.13086 1.26562 8.26758 1.45703L10.0898 3.95898Z"})})},80881:(e,t,o)=>{o.d(t,{I:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.I)("collectionDependenciesArrowRight",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{transform:"translate(3,3)",d:"M1.34.302a.701.701 0 00-.383.095.708.708 0 00-.24.253 1.074 1.074 0 00-.109.322 3.26 3.26 0 00-.054.465c-.01.173-.014.36-.014.56 0 1.609.353 2.791 1.06 3.548.71.752 1.857 1.128 3.438 1.128h4.525l1.634-.089L9.16 8.423 7.643 9.968a.798.798 0 00-.164.239.785.785 0 00-.055.294c0 .205.068.376.205.513a.736.736 0 00.533.205c.196 0 .378-.082.547-.246l4.498-4.485a.78.78 0 00.246-.567.743.743 0 00-.246-.56L8.695.854A.76.76 0 008.162.63a.736.736 0 00-.533.205.696.696 0 00-.205.513c0 .104.018.202.055.294a.715.715 0 00.164.232L9.16 3.419l2.037 1.852-1.634-.102h-4.43c-.76 0-1.366-.11-1.818-.328a1.94 1.94 0 01-.963-1.04c-.196-.473-.294-1.09-.294-1.852 0-.191.002-.358.006-.499.01-.141.014-.278.014-.41a.721.721 0 00-.205-.533.721.721 0 00-.533-.205z"})})},93108:(e,t,o)=>{o.d(t,{p:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.I)("contentSearch",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M0.25293 5.82031C0.25293 8.88965 2.74805 11.3848 5.81738 11.3848C6.95898 11.3848 8.00488 11.0361 8.87988 10.4414L12.0244 13.5859C12.2158 13.7842 12.4824 13.873 12.749 13.873C13.3301 13.873 13.7471 13.4355 13.7471 12.8682C13.7471 12.5947 13.6514 12.3418 13.4668 12.1504L10.3428 9.01953C10.9922 8.12402 11.3818 7.0166 11.3818 5.82031C11.3818 2.75098 8.88672 0.255859 5.81738 0.255859C2.74805 0.255859 0.25293 2.75098 0.25293 5.82031ZM1.70215 5.82031C1.70215 3.55078 3.54102 1.70508 5.81738 1.70508C8.08691 1.70508 9.93262 3.55078 9.93262 5.82031C9.93262 8.08984 8.08691 9.93555 5.81738 9.93555C3.54102 9.93555 1.70215 8.08984 1.70215 5.82031Z"})})},89036:(e,t,o)=>{o.d(t,{v:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.I)("folder",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.4082 14.3672H13.7627C15.0684 14.3672 15.8271 13.6084 15.8271 12.1455V5.11816C15.8271 3.65527 15.0615 2.89648 13.585 2.89648H7.22754C6.73535 2.89648 6.44824 2.78027 6.07227 2.47266L5.67578 2.1582C5.19727 1.76172 4.8418 1.63184 4.13086 1.63184H2.19629C0.917969 1.63184 0.166016 2.37695 0.166016 3.8125V12.1455C0.166016 13.6084 0.931641 14.3672 2.4082 14.3672ZM1.50586 3.92871C1.50586 3.2998 1.84766 2.97168 2.46289 2.97168H3.77539C4.26074 2.97168 4.54102 3.08105 4.92383 3.39551L5.32031 3.7168C5.79199 4.10645 6.16113 4.23633 6.87207 4.23633H13.5098C14.1387 4.23633 14.4873 4.56445 14.4873 5.23438V5.63086H1.50586V3.92871ZM2.49023 13.0273C1.85449 13.0273 1.50586 12.6992 1.50586 12.0361V6.81348H14.4873V12.0361C14.4873 12.6992 14.1387 13.0273 13.5098 13.0273H2.49023Z"})})},84199:(e,t,o)=>{o.d(t,{N:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.I)("properties",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M1.91602 4.83789C2.44238 4.83789 2.87305 4.40723 2.87305 3.87402C2.87305 3.34766 2.44238 2.91699 1.91602 2.91699C1.38281 2.91699 0.952148 3.34766 0.952148 3.87402C0.952148 4.40723 1.38281 4.83789 1.91602 4.83789ZM5.1084 4.52344H14.3984C14.7607 4.52344 15.0479 4.23633 15.0479 3.87402C15.0479 3.51172 14.7607 3.22461 14.3984 3.22461H5.1084C4.74609 3.22461 4.45898 3.51172 4.45898 3.87402C4.45898 4.23633 4.74609 4.52344 5.1084 4.52344ZM1.91602 9.03516C2.44238 9.03516 2.87305 8.60449 2.87305 8.07129C2.87305 7.54492 2.44238 7.11426 1.91602 7.11426C1.38281 7.11426 0.952148 7.54492 0.952148 8.07129C0.952148 8.60449 1.38281 9.03516 1.91602 9.03516ZM5.1084 8.7207H14.3984C14.7607 8.7207 15.0479 8.43359 15.0479 8.07129C15.0479 7.70898 14.7607 7.42188 14.3984 7.42188H5.1084C4.74609 7.42188 4.45898 7.70898 4.45898 8.07129C4.45898 8.43359 4.74609 8.7207 5.1084 8.7207ZM1.91602 13.2324C2.44238 13.2324 2.87305 12.8018 2.87305 12.2686C2.87305 11.7422 2.44238 11.3115 1.91602 11.3115C1.38281 11.3115 0.952148 11.7422 0.952148 12.2686C0.952148 12.8018 1.38281 13.2324 1.91602 13.2324ZM5.1084 12.918H14.3984C14.7607 12.918 15.0479 12.6309 15.0479 12.2686C15.0479 11.9062 14.7607 11.6191 14.3984 11.6191H5.1084C4.74609 11.6191 4.45898 11.9062 4.45898 12.2686C4.45898 12.6309 4.74609 12.918 5.1084 12.918Z"})})},37888:(e,t,o)=>{o.d(t,{U:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.I)("unlocked",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.49023 14.7227H8.89551C9.94824 14.7227 10.4746 14.1963 10.4746 13.0479V8.20801C10.4746 7.22363 10.085 6.69727 9.29883 6.57422V4.83105C9.29883 3.22461 10.3174 2.35645 11.541 2.35645C12.7646 2.35645 13.79 3.22461 13.79 4.83105V6.28711C13.79 6.76562 14.0703 7.01855 14.4395 7.01855C14.8018 7.01855 15.082 6.7793 15.082 6.28711V4.96094C15.082 2.36328 13.3525 1.1123 11.541 1.1123C9.72949 1.1123 8 2.36328 8 4.96094V6.54004H2.49023C1.43066 6.54004 0.911133 7.06641 0.911133 8.20801V13.0479C0.911133 14.1963 1.43066 14.7227 2.49023 14.7227ZM2.68848 13.5059C2.3877 13.5059 2.2373 13.3623 2.2373 13V8.25586C2.2373 7.89355 2.3877 7.76367 2.68848 7.76367H8.7041C9.00488 7.76367 9.14844 7.89355 9.14844 8.25586V13C9.14844 13.3623 9.00488 13.5059 8.7041 13.5059H2.68848ZM7.99316 21.1123C6.5918 21.1123 5.2793 21.8779 4.75293 23.375L5.78516 24.4141C5.94922 23.0811 6.87891 22.3564 7.99316 22.3564C9.2168 22.3564 10.2422 23.2246 10.2422 24.8311V26.54H7.9248L9.1416 27.7637H11.0078C11.3086 27.7637 11.4521 27.8936 11.4521 28.2559V30.0742L12.7783 31.4072V28.208C12.7783 27.2031 12.3682 26.6768 11.541 26.5674V24.9609C11.541 22.3633 9.81152 21.1123 7.99316 21.1123ZM13.749 35.126C13.9609 35.3379 14.3164 35.3379 14.5215 35.126C14.7266 34.9072 14.7334 34.5723 14.5215 34.3535L2.46973 22.3154C2.25781 22.1035 1.90918 22.0967 1.69043 22.3154C1.48535 22.5205 1.48535 22.876 1.69043 23.0811L13.749 35.126ZM4.79395 34.7227H11.1992C11.5 34.7227 11.7598 34.6816 11.9785 34.5928L10.8711 33.4922C10.8096 33.499 10.7549 33.5059 10.6865 33.5059H4.99219C4.69141 33.5059 4.54102 33.3623 4.54102 33V28.2559C4.54102 27.9004 4.68457 27.7637 4.97852 27.7637H5.14258L4.04883 26.6631C3.48828 26.8818 3.21484 27.3809 3.21484 28.208V33.0479C3.21484 34.1963 3.73438 34.7227 4.79395 34.7227Z"})})},69619:(e,t,o)=>{o.d(t,{T:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.I)("unsync",{viewBox:"0 0 30 30",svg:(0,i.jsxs)("g",{children:[(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.768 23.295l1.353 1.351a11.298 11.298 0 01-6.118 1.81c-5.862 0-10.781-4.538-11.387-10.254h-1.55c-.809 0-1.011-.55-.573-1.168l2.516-3.572c.37-.527.91-.516 1.269 0l2.515 3.583c.427.606.225 1.157-.572 1.157H5.536a9.496 9.496 0 009.467 8.344c1.74 0 3.366-.454 4.765-1.251zM10.233 6.723l-1.361-1.36a11.26 11.26 0 016.131-1.818c5.851 0 10.782 4.548 11.388 10.265h1.539c.808 0 1.021.539.572 1.167l-2.504 3.572c-.37.528-.91.516-1.27 0l-2.515-3.583c-.427-.617-.224-1.156.573-1.156h1.673a9.503 9.503 0 00-9.456-8.356 9.55 9.55 0 00-4.77 1.27z"}),(0,i.jsx)("path",{d:"M27.067 28.551c.41.41 1.094.41 1.49 0 .41-.41.41-1.08 0-1.49L2.937 1.454a1.06 1.06 0 00-1.505 0c-.396.396-.396 1.08 0 1.49l25.635 25.607z"})]})})}}]);