(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[5906],{22974:(e,t,n)=>{"use strict";n.d(t,{VZ:()=>h,Y7:()=>p,LH:()=>m});var o=n(8848);const r="theme";var i=n(97880),s=n(30021),a=n(4926),l=n(47839);const d=10;function c(e,t){const{device:n,ThemeStore:i}=e,{mode:s,usingSystemTheme:c}=t,p={mode:s};i.setState(p),e.mobileNative&&e.mobileNative.setTheme(s,c),l.setTheme(function(e,t){const n=(0,o.gh)({theme:e});return{mode:e,usingSystemTheme:t,colors:{white:o.ZP.white,blue:o.ZP.blue},borderRadius:4,textColor:n.regularTextColor,popoverBackgroundColor:n.popoverBackground,popoverBoxShadow:n.mediumBoxShadow,inputBoxShadow:n.inputBoxShadow,inputBackgroundColor:n.inputBackground,dividerColor:n.darkDividerColor,shadowOpacity:n.shadowOpacity}}(s,c)),localStorage.setItem(r,JSON.stringify(p)),function(e,t){if(0===e.nativeScrollbarWidth)return;const n=document.getElementById("scroll-properties");n&&(n.innerHTML=`\n\t\t\t::-webkit-scrollbar {\n\t\t\t\twidth: ${d}px;\n\t\t\t\theight: ${d}px;\n\t\t\t}\n\t\t\t::-webkit-scrollbar {\n\t\t\t\tbackground: transparent;\n\t\t\t}\n\t\t\t::-webkit-scrollbar-track {\n\t\t\t\tbackground: ${u.scrollbarTrack[t]};\n\t\t\t}\n\t\t\t::-webkit-scrollbar-thumb {\n\t\t\t\tbackground:${u.scrollbarThumb[t]};\n\t\t\t}\n\t\t\t::-webkit-scrollbar-thumb:hover {\n\t\t\t\tbackground:${u.scrollbarThumbHover[t]};\n\t\t\t}\n\t\t`,a.Z.setState(d))}(n,s),"dark"===s?document.body.classList.add("dark"):document.body.classList.remove("dark")}const u={scrollbarTrack:{light:"#EDECE9",dark:"rgba(202, 204, 206, 0.04)"},scrollbarThumb:{light:"#D3D1CB",dark:"#474c50"},scrollbarThumbHover:{light:"#AEACA6",dark:"rgba(202, 204, 206, 0.3)"}};function p(e){s.Z.setState(e)}function m(e){const t=h(e);switch(t){case"dark":case"light":c(e,{mode:t,usingSystemTheme:!1});break;case"system":!async function(e){const{mobileNative:t}=e;let n="light";n=t&&t.api.getTheme?await t.api.getTheme():e.device.prefersDarkInterface?"dark":"light",c(e,{mode:n,usingSystemTheme:!0})}(e);break;default:(0,i.t1)(t)}}function h(e){const t=s.Z.state||"system";return"dark"===(n=t)||"light"===n||"system"===n?n:"system";var n}},16091:(e,t,n)=>{"use strict";n.d(t,{ND:()=>T,RD:()=>I,gc:()=>j,gl:()=>E,u7:()=>_});var o=n(67294),r=n(36769),i=n(480),s=n(86628),a=n(41432),l=n(9291),d=n(11969),c=n(82530),u=n(37181),p=n(81415),m=(n(95477),n(19124)),h=n(68056),g=n(89086),f=n(28685),v=n(80444),b=n(77080),S=n(83212),y=n(79797),w=n(24666),k=n(47449),x=n(89626),C=n(85893);const M=(0,l.defineMessages)({spaceForAiHeader:{id:"AiOnboardingTooltips.spaceForAi.header",defaultMessage:"Press ‘space’ for AI"},spaceForAiContent:{id:"AiOnboardingTooltips.spaceForAi.content",defaultMessage:"On a new line or page, press ‘space’ on your keyboard for AI to generate or edit the page. Try it now!"},askAiAnythingHeader:{id:"AiOnboardingTooltips.askAiAnything.header",defaultMessage:"Ask AI anything"},askAiAnythingContent:{id:"AiOnboardingTooltips.askAiAnything.content",defaultMessage:"Just tell AI what to do — the more details, the better. You can also start from an example in the menu."},refineAiResponseHeader:{id:"AiOnboardingTooltips.refineAiResponse.header",defaultMessage:"Tell AI what to do next"},refineAiResponseContent:{id:"AiOnboardingTooltips.refineAiResponse.content",defaultMessage:"How was it? Give AI further instructions to improve what it wrote, or hit ‘Done’ when finished."},showAssistantLocationHeader:{id:"AiOnboardingTooltips.showAssistantLocation.answersToYourQuestionHeader",defaultMessage:"Ask AI when searching"},showAssistantLocationContent:{id:"AiOnboardingTooltips.showAssistantLocation.askQuestionBody",defaultMessage:"AI can find pages and synthesize a quick, concise answer for you. Try it now."},showAssistantOriginElementLocationHeader:{id:"AiOnboardingTooltips.ShowAssistantOriginElementLocationTooltip.header",defaultMessage:"Start by asking a question"},showAssistantOriginElementLocationContent:{id:"AiOnboardingTooltips.ShowAssistantOriginElementLocationTooltip.content",defaultMessage:"Notion AI will find pages and compose a concise answer for you. Try it now."}});function _(){window.__c={n:"SpaceForAiOnboardingTooltip"};const e=(0,i.O7)(),t=function(){const e=(0,i.O7)(),t=(0,s.VK)((()=>{const t=v.default.state.mainEditorCurrentBlockStore;return t&&S.Z.getMode(e,t)}),[e]);return(0,s.VK)((()=>{if(e.device.isMobile)return;if(!b.default.checkGate("space_for_ai_tooltip_enabled"))return;const{currentUserSettingsStore:n,inAppCalloutStore:o}=v.default.state;if(!o.canShow("ai_onboarding_tooltip"))return;const r=null==n?void 0:n.getSettings();if(!r)return;if(r.signup_time&&r.signup_time>16770636e5)return;if("space_for_ai"!==(0,x.sy)())return;if(!(0,m.GD)(t))return;const i=w.default.state;if("editing"===i.mode){const e=(0,h.QY)(i.multiSelection);if(e&&(0,g.wd)(e.selection)){const t=e.store,n=f.E.findEditableWithStore(t);if(n){const e="block"===t.pointer.table?y.G.createChildStore(t,t.pointer):void 0,o=e&&e.getType(),r=Boolean(o&&(0,a.hD)(o)),i=t.getValue();if(r&&!i)return n}}}}),[e,t])}();return t?(0,C.jsx)(p.U,{origin:()=>t.getNode(),placementToOrigin:"bottom",header:(0,C.jsx)(l.FormattedMessage,{...M.spaceForAiHeader}),content:(0,C.jsx)(l.FormattedMessage,{...M.spaceForAiContent}),onCloseClick:()=>(0,x.h1)(e)}):null}function I(e){window.__c={n:"AskAIAnythingOnboardingTooltip"};const{originRef:t,openState:n}=e,o=(0,i.O7)(),r=(0,s.VK)((()=>(0,x.sy)()),[]);if(o.device.isMobile)return null;return"ask_ai_anything"===r&&"initialPrompt"===n.stage?(0,C.jsx)(p.U,{origin:t,placementToOrigin:"top",header:(0,C.jsx)(l.FormattedMessage,{...M.askAiAnythingHeader}),content:(0,C.jsx)(l.FormattedMessage,{...M.askAiAnythingContent}),onCloseClick:()=>(0,x.h1)(o)}):null}function E(e){window.__c={n:"RefineAIResponseOnboardingTooltip"};const{originRef:t,openState:n,isInputEmpty:o}=e,r=(0,i.O7)(),a=(0,s.VK)((()=>(0,x.sy)()),[]);if(r.device.isMobile)return null;const d="refine_ai_response"===a&&"results"===n.stage&&!n.loading&&"cursor"===n.context.type&&o;return(0,C.jsx)(p.U,{origin:d?t:void 0,placementToOrigin:"right",pointerOffset:-4,pointerLength:25,header:(0,C.jsx)(l.FormattedMessage,{...M.refineAiResponseHeader}),content:(0,C.jsx)(l.FormattedMessage,{...M.refineAiResponseContent}),onCloseClick:()=>(0,x.h1)(r)})}function T(e){window.__c={n:"ShowAssistantOriginElementLocationTooltip"};const{origin:t}=e,n=(0,i.O7)();(0,o.useEffect)((()=>{d.K(n,{from:"qna_button"})}),[n]);const r=(0,o.useCallback)((()=>{const{currentUserSettingsStore:e}=v.default.state;e&&(d.y(n,{from:"qna_button"}),(0,k.CX)(n,{phase:"complete",transactionUserAction:"AiQnaIntroModal.debug.clickTooltipComplete",userSettingsStore:e}))}),[n]);return(0,C.jsx)(p.U,{style:{width:250},pointerLength:25,pointerPosition:"94%",origin:t,placementToOrigin:"top",header:(0,C.jsx)(l.FormattedMessage,{...M.showAssistantOriginElementLocationHeader}),content:(0,C.jsx)(l.FormattedMessage,{...M.showAssistantOriginElementLocationContent}),onCloseClick:r})}function j(e){window.__c={n:"ShowAssistantLocationTooltip"};const{origin:t}=e,n=(0,i.O7)();(0,o.useEffect)((()=>{d.K(n,{from:"qna_search"})}),[n]);const r=(0,o.useCallback)((()=>{const{currentUserSettingsStore:e}=v.default.state;e&&(d.y(n,{from:"qna_search"}),(0,k.CX)(n,{phase:"complete",transactionUserAction:"AiQnaIntroModal.debug.clickTooltipComplete",userSettingsStore:e}))}),[n]);return(0,C.jsx)(p.U,{style:{width:250},pointerLength:25,pointerPosition:"5%",origin:t,placementToOrigin:"bottom",header:(0,C.jsx)(l.FormattedMessage,{...M.showAssistantLocationHeader}),content:(0,C.jsx)(l.FormattedMessage,{...M.showAssistantLocationContent}),onCloseClick:r})}(0,r.exposeDebugEnvironmentValue)("resetAIOnboarding",(e=>()=>{const{currentUserSettingsStore:t}=v.default.state;t&&c.createAndCommit({userAction:"AiIntroModal.debugging.resetAIOnboarding",environment:e,perform:e=>{u.d2({userSettingsStore:t,transaction:e,data:{ai_onboarding_phase:"space_for_ai"}})},userId:t.id})}))},47449:(e,t,n)=>{"use strict";n.d(t,{qC:()=>g,Up:()=>h,CX:()=>m});var o=n(4615),r=n(54642),i=n(82530),s=n(37181),a=n(49085),l=n(92595);class d extends a.default{getInitialState(){return{loadingState:"initial"}}}const c=new d,u=c;(0,l.exposeDebugValue)("AiSuggestedPageQnaStore",c);var p=n(21273);function m(e,t){const{phase:n,transactionUserAction:o,userSettingsStore:r}=t;i.createAndCommit({environment:e,userAction:o,perform:e=>{s.d2({userSettingsStore:r,transaction:e,data:{ai_qna_intro_onboarding_phase:n}})}})}function h(e,t){const{userSettingsStore:n}=t;i.createAndCommit({environment:e,userAction:"aiQnaActions.setLastExposedToQnaAtToCurrentTimestamp",perform:e=>{s.d2({userSettingsStore:n,transaction:e,data:{last_exposed_to_ai_qna_at:Date.now()}})}})}async function g(e){let{environment:t,blockStore:n,reminderNumber:i,spaceId:s}=e;const a=await async function(e){let{environment:t,blockStore:n,reminderNumber:i,spaceId:s}=e;if("initial"===u.state.loadingState||u.state.reminderNumber!==i){const e=r.getSuggestedPageQna(t,{blockPointer:{...n.pointer,spaceId:s},aiSessionId:(0,o.ZP)()}).then((e=>"success"!==e.type?(u.setState({loadingState:"error",reminderNumber:i}),[]):e.data.questions));u.setState({loadingState:"loading",reminderNumber:i});const a=await e;return u.setState({loadingState:"loaded",reminderNumber:i,questions:a}),a[0]}if("loading"===u.state.loadingState)return u.waitUntil((()=>"loaded"===u.state.loadingState)).then((()=>"loaded"===u.state.loadingState?u.state.questions[0]:void 0));if("loaded"===u.state.loadingState){return u.state.questions[0]}return}({environment:t,blockStore:n,reminderNumber:i,spaceId:s});if(a&&p.Z.isQnaPageSuggestedQuestionRemindersEnabledForUser())return a}},77207:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});n(67294);var o=n(480),r=n(86628),i=n(55367),s=n(80796),a=n(69784),l=n(85893);const d=function(e){window.__c={n:"CursorListener"};const t=(0,o.Fy)(),n=(0,r.VK)((()=>({initiator:s.Z.state.initiator,isDragging:i.ZP.state.isDragging})),[]),d=(0,r.VK)((()=>({active:a.default.state.isActive,moved:!!a.default.state.isActive&&a.default.state.moved})),[]),c=d.moved?"default":n.isDragging?"-webkit-grabbing":"text";let u="notion-cursor-listener";return"-webkit-grabbing"===c&&(u+=" notion-disable-local-cursor"),t.isIOS&&("touch"===n.initiator||n.isDragging||d.active?document.body.classList.add("notion-disable-webkit-user-select"):document.body.classList.remove("notion-disable-webkit-user-select")),(0,l.jsx)("div",{style:{...e.style,cursor:c},className:u,children:e.children})}},52418:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ll});var o=n(67294),r=n(34958),i=n(77907),s=n(83355),a=n(13991),l=n(79946),d=n(49271),c=n(8848),u=n(25278),p=n(71644),m=n(99405),h=n(89101),g=n(29369),f=n(32739),v=n(9852),b=n(12139),S=n(64002),y=n(9291),w=n(17224),k=n(47839),x=n(32603),C=n(91376),M=n(32953),_=n(8055),I=n(91100),E=n(73966),T=n(70782),j=n(39634),L=n(37181),P=n(95477);const A=(0,i.lazyComponent)(i.deps.CreatorProfile,(e=>e.CreatorProfile));var U=n(80444),R=n(77080),Z=n(79797);const O=(0,i.lazyComponent)(i.deps.StudentGroupSignup,(e=>e.default));var B=n(480),N=n(86628),V=n(24405),D=n(59054),F=n(49204),z=n(82990),W=n(42922),q=n(61519),K=n(63296),G=n(64369),H=n(74016),$=n(85893);const Q=function(e){window.__c={n:"TeamInviteLinkJoinPage"};const{teamStore:t}=e,n=(0,B.O7)(),{teamName:o}=(0,N.VK)((()=>({teamName:t.getName()})),[t]),r=(0,V.yK)((e=>({buttonContainer:{marginTop:15,display:"flex",justifyContent:"space-between"},container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},title:{fontWeight:z.Z.fontWeight.semibold,fontSize:20,margin:10},subtitle:{color:e.mediumTextColor,fontSize:18},divider:{maxWidth:280},rightButton:{fontWeight:z.Z.fontWeight.semibold,marginLeft:10}})),[]);return(0,$.jsxs)("div",{style:r.container,children:[(0,$.jsx)(H.p,{store:t,disabled:!0,size:55}),(0,$.jsx)("div",{style:r.title,children:(0,$.jsx)(y.FormattedMessage,{id:"teamInviteLinkJoinPage.page.title",defaultMessage:"You've been invited to join {teamName}",values:{teamName:o}})}),(0,$.jsx)("div",{style:r.subtitle,children:(0,$.jsx)(y.FormattedMessage,{id:"teamInviteLinkJoinPage.page.subtitle",defaultMessage:"You can access the content in the teamspace if you join the teamspace."})}),(0,$.jsxs)("div",{style:r.buttonContainer,children:[(0,$.jsx)(W.Z,{isLarge:!0,onClick:async()=>{const e=n.currentUser.id;if(!e)return;const o=[{type:"member",entity_type:"user",user_id:e}];await F.um({environment:n,userId:e,teamStore:t,user:o}),w.Ph(n,{store:t,selection:"yes"})},children:(0,$.jsx)(y.FormattedMessage,{id:"teamInviteLinkJoinPage.joinTeam.label",defaultMessage:"Join teamspace"})}),(0,$.jsx)(K.Z,{isLarge:!0,style:r.rightButton,onClick:async()=>{w.Ph(n,{store:t,selection:"no"}),await F.Id({environment:n})},children:(0,$.jsx)(y.FormattedMessage,{id:"teamInviteLinkJoinPage.backToMyContentButton.label",defaultMessage:"Back to my content"})})]}),(0,$.jsx)(q.Z,{size:48,innerStyle:r.divider}),(0,$.jsx)(G.Z,{isSmall:!0,children:(0,$.jsx)(y.FormattedMessage,{id:"teamInviteLinkJoinPage.contact.message",defaultMessage:"Please contact your workspace owner for any questions."})})]})};var Y=n(14889);function X(e){window.__c={n:"TeamInviteLinkRequestPageContent"};const{teamStore:t,teamName:n,onRequestClick:o}=e,r=(0,B.O7)(),i=(0,V.yK)((e=>({buttonContainer:{marginTop:15,display:"flex",justifyContent:"space-between"},container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},title:{fontWeight:z.Z.fontWeight.semibold,fontSize:20,margin:10},subtitle:{color:e.mediumTextColor,fontSize:18},divider:{maxWidth:280},rightButton:{fontWeight:z.Z.fontWeight.semibold,marginLeft:10}})),[]);return(0,$.jsxs)("div",{style:i.container,children:[(0,$.jsx)(H.p,{store:t,disabled:!0,size:55}),(0,$.jsx)("div",{style:i.title,children:(0,$.jsx)(y.FormattedMessage,{id:"teamInviteLinkRequestPage.requestAccess.title",defaultMessage:"Request access to {teamName}",values:{teamName:n??J()}})}),(0,$.jsx)("div",{style:i.subtitle,children:(0,$.jsx)(y.FormattedMessage,{id:"teamInviteLinkRequestPage.requestAccess.subtitle",defaultMessage:"You can access this teamspace if a teamspace owner approves your request."})}),(0,$.jsxs)("div",{style:i.buttonContainer,children:[(0,$.jsx)(W.Z,{isLarge:!0,onClick:o,children:(0,$.jsx)(y.FormattedMessage,{id:"teamInviteLinkRequestPage.requestAccess.label",defaultMessage:"Request access"})}),(0,$.jsx)(K.Z,{isLarge:!0,style:i.rightButton,onClick:async()=>{await F.Id({environment:r})},children:(0,$.jsx)(y.FormattedMessage,{id:"teamInviteLinkRequestPage.backToMyContentButton.label",defaultMessage:"Back to my content"})})]}),(0,$.jsx)(q.Z,{size:48,innerStyle:i.divider}),(0,$.jsx)(G.Z,{isSmall:!0,children:(0,$.jsx)(y.FormattedMessage,{id:"teamInviteLinkRequestPage.contact.message",defaultMessage:"Please contact your workspace owner for any questions."})})]})}function J(){return(0,$.jsx)(y.FormattedMessage,{id:"teamInviteLinkRequestPage.privateTeamspace.label",defaultMessage:"Private Teamspace"})}const ee=function(e){window.__c={n:"TeamInviteLinkRequestPage"};const{teamStore:t}=e,[n,r]=(0,o.useState)(!1),{teamName:i}=(0,N.VK)((()=>({teamName:t.getName()})),[t]);return(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(X,{teamStore:t,teamName:i,onRequestClick:()=>r(!0)}),(0,$.jsx)(Y.Z,{teamStore:t,teamName:i??J(),teamId:t.id,isModalOpen:n,onDismiss:()=>r(!1)})]})};function te(e){const{teamAccessLevel:t,teamStore:n}=e;switch(t){case"open":return(0,$.jsx)(Q,{teamStore:n});case"closed":case"private":return(0,$.jsx)(ee,{teamStore:n})}}const ne=function(e){window.__c={n:"TeamInviteLinkPage"};const{teamId:t}=e,n=(0,B.O7)(),{teamAccessLevel:r,teamStore:s}=(0,N.VK)((()=>{const e=new Z.zX(n,{table:g.e0,id:t});return{teamAccessLevel:e.getTeamAccessLevel(),teamStore:e}}),[n,t]),[{value:a}]=(0,D.r5)((async()=>await F.Ng({environment:n,teamId:t})),[n,t]);(0,o.useEffect)((()=>{!0===(null==a?void 0:a.isValidTeamRequest)&&null!=a&&a.isTeamMember&&(async()=>{var e;const t=null===(e=n.currentUser)||void 0===e?void 0:e.id;t&&s&&await F.t_({environment:n,userId:t,teamStore:s})})()}),[n,s,a]);const l=(0,V.yK)((()=>({container:{display:"flex",justifyContent:"center",height:"100%"}})),[]);return a?(0,$.jsx)("div",{style:l.container,children:a.isValidTeamRequest?(0,$.jsx)(te,{teamStore:s,teamAccessLevel:r}):"nonSpaceMember"===a.invalidRequestReason?(0,$.jsx)(i.LazyPageError,{route:{name:"teamsInvite",teamId:t},publicPageData:void 0}):(0,$.jsx)(i.LazyPageError,{route:{name:"notFound"},publicPageData:void 0})}):null},oe=(0,i.lazyComponent)(i.deps.Templates,(e=>e.TemplateSubmission));var re=n(84549),ie=n(6495),se=n(11342);function ae(e,t){const n=t.deviceType,o=t.mobileAppVersion;if(!(0,ie.wv)(e)||"local"===e||!t.isMobileNative||!o)return!1;const r=function(e){const{environmentName:t,deviceType:n,mobileAppVersion:o,androidVersions:r,iosVersions:i}=e,s=(0,se.parseMobileAppVersion)(o,"android"===n);if(!s)return!1;if("android"===n&&!r||"ios"===n&&!i)return!1;let a;if("android"===n){if(!r)return!1;a=(0,se.parseMobileAppVersion)(r[t],!0)}else{if(!i)return!1;a=(0,se.parseMobileAppVersion)(i[t],!1)}return!!a&&(0,se.isLessThanVersion)(s,a)}({environmentName:e,deviceType:n,mobileAppVersion:o,iosVersions:{staging:"0.1.1022",development:"0.5.1168",production:"0.4.1021"}});return r}var le=n(72141),de=n(3791),ce=n(51454),ue=n(50950),pe=n(65729),me=n(72899),he=n(16091),ge=n(81598),fe=n(69098),ve=n(30106),be=n(28020),Se=n(19124),ye=n(64286),we=n(46654);const ke=(0,i.lazyComponent)(i.deps.moveTo,(e=>e.MoveToMenuRenderer));var xe=n(48451),Ce=n(50770),Me=n(94841),_e=n(61931),Ie=n(52389),Ee=n(74948),Te=n(36596),je=n(38676);function Le(){window.__c={n:"SidebarLoadingSkeleton"};const e=(0,N.VK)((()=>je.sidebarExpandedStore.state),[]),t=(0,N.VK)((()=>e?je.sidebarWidthStore.state:0),[e]),n=(0,V.yK)((n=>{const o={width:22,height:22,borderRadius:4},r={height:10,minHeight:10,borderRadius:10};return{sidebar:{backgroundColor:n.sidebarBackground,boxShadow:n.sidebarBoxShadow,display:e?"flex":"none",minWidth:t,flexDirection:"column",padding:"12px 14px",overflow:"hidden"},heroSection:{marginBottom:19,display:"flex",alignItems:"center"},heroSectionIcon:{padding:"1px",...o},heroSectionTitle:{width:177,marginLeft:8,...r},toplevelMenu:{marginBottom:16,width:78,...r},toplevelMenuLast:{marginBottom:36,width:135,...r},sectionHeader:{marginBottom:12,width:56,...r},pageRow:{display:"flex",alignItems:"center",marginBottom:8},pageChevron:{width:12,height:12,display:"block",marginRight:4,fill:"dark"===n.mode?n.accentColors.gray[300]:n.accentColors.gray[100]},pageIcon:{...o},pageTitle:{marginLeft:6,...r}}}),[e,t]),r=(0,$.jsxs)("div",{style:n.heroSection,children:[(0,$.jsx)(Te.Z,{style:n.heroSectionIcon,emphasized:!0}),(0,$.jsx)(Te.Z,{style:n.heroSectionTitle,emphasized:!0})]}),i=(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(Te.Z,{style:n.toplevelMenu,emphasized:!0}),(0,$.jsx)(Te.Z,{style:n.toplevelMenu,emphasized:!0}),(0,$.jsx)(Te.Z,{style:n.toplevelMenuLast,emphasized:!0})]}),s=(0,$.jsx)(Te.Z,{style:n.sectionHeader,emphasized:!0}),a=(0,o.useMemo)((()=>Array(5).fill(null).map((()=>Array(4).fill(null).map((()=>Math.floor(4*Math.random())))))),[]).map(((e,t)=>e.map(((e,o)=>(0,$.jsxs)("div",{style:{...Pe(t),...n.pageRow},children:[(0,$.jsx)("svg",{viewBox:"0 0 30 30",style:n.pageChevron,children:(0,$.jsx)("polygon",{points:"17.4,15 7,25.2 9.8,28 23,15 9.8,2 7,4.8"})}),(0,$.jsx)(Te.Z,{style:n.pageIcon,emphasized:!0}),(0,$.jsx)(Te.Z,{style:{...n.pageTitle,width:80+20*e},emphasized:!0})]},`${t}-${o}`)))));return(0,$.jsxs)("div",{style:n.sidebar,children:[r,i,s,a]})}function Pe(e){return 0===e?{}:{animation:`1s ease-in ${e}s 1 normal both running fadein`}}var Ae=n(24646),Ue=n(5162),Re=n(80736),Ze=n(51),Oe=n(21273),Be=n(43604),Ne=n(27242),Ve=n(12309),De=n(33293);function Fe(){window.__c={n:"BillingModalContainer"};const e=(0,N.VK)((()=>Ve.Z.state.modalInfoById),[]);return(0,$.jsx)($.Fragment,{children:Object.entries(e).map((e=>{let[t,n]=e;const{content:o,dismissUsing:r,isOpen:i,modalStyle:s,onClosed:a,onDismiss:l}=n;return(0,$.jsx)(De.q,{dismissUsing:r,isOpen:i,onClosed:a,onDismiss:l,style:s,children:o},t)}))})}n(21703);var ze=n(30120),We=n(92595),qe=n(54642);async function Ke(e,t){const n=await qe.stripeGetTestClock(t,{spaceId:e});if("success"===n.type){if("advancing"===n.data.status)throw new Error("Test clock is advancing. Please try again in a few seconds.");return n.data.epochSeconds}}async function Ge(e){const{environment:t,spaceId:n,advanceTestClockArgument:o}=e;if(o)return"number"==typeof o?o:"function"==typeof o?await async function(e){const{environment:t,spaceId:n,callback:o}=e,r=await Ke(n,t);if(r)return o(r)}({environment:t,spaceId:n,callback:o}):"object"==typeof o?await async function(e){const{environment:t,spaceId:n,durationLike:o}=e,r=await Ke(n,t);if(!r)return;const i=ze.ou.fromSeconds(r),s=ze.nL.fromDurationLike(o);return i.plus(s).toSeconds()}({environment:t,spaceId:n,durationLike:o}):void 0}const He=function(){window.__c={n:"StripeTestClockSupport"};const e=["local","staging","development"].includes("production"),t=(0,B.O7)();return(0,o.useEffect)((()=>{e&&((0,We.exposeDebugValue)("refreshTestClock",(async()=>{var e;const n=null===(e=U.default.state.currentSpaceStore)||void 0===e?void 0:e.id;if(n){const e=await Ke(n,t);if(e){const t=ze.ou.fromSeconds(e);console.log(`Test clock time is ${t.toString()} (${e} seconds)`)}}})),(0,We.exposeDebugValue)("advanceTestClock",(async e=>{var n;if(!e)throw new Error("advanceTestClock requires an argument. You can pass an epoch timestamp in seconds, a relative DurationLike object like { months: 2 }, or a function that takes the current epoch seconds and returns the new epoch seconds.");const o=null===(n=U.default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(!o)return;const r=await Ge({environment:t,spaceId:o,advanceTestClockArgument:e});r&&await qe.stripeAdvanceTestClock(t,{spaceId:o,epochSeconds:r})})))}),[e,t]),null};var $e=n(1404),Qe=n(59260),Ye=n(62142),Xe=n(88280),Je=(n(57658),n(63143)),et=n(99334);const tt=!1,nt=(tt?1:10)*Je.C0,ot=5*nt;function rt(){tt&&console.log(...arguments)}function it(){return window.__c={n:"TabAnalyticsTracker"},(0,o.useEffect)((()=>{if(!window.BroadcastChannel)return;const e=(0,v.c$)(),t=new Map,n=new BroadcastChannel("notion_tab_tracker");n.onmessage=e=>{const n=e.data;"string"==typeof n&&t.set(n,Date.now())};const o=window.setInterval((()=>{(()=>{const e=[],n=Date.now();for(const[o,r]of t.entries())n-r>ot&&e.push(o);e.length&&rt("Removing tab ids:",e);for(const o of e)t.delete(o)})(),n.postMessage(e);const o=t.size+1;rt("Tab count is",o),(0,et.$)(o)}),nt);return()=>{n.close(),window.clearInterval(o)}}),[]),null}var st=n(22491),at=n(72126),lt=n(70203),dt=n(44805),ct=n(92120),ut=n(62740),pt=n(24229),mt=n(48588);function ht(e){const{discussionId:t,level:n}=e;return`\n\t\t.${(0,st.vE)({level:n})}.${(0,st.dk)({discussionId:t})}.${dt.kB} {\n\t\t\tbackground: ${(0,c.Hu)(e)} !important;\n\t\t\topacity: unset !important;\n\t\t\tborder-bottom: 2px solid ${c.mO};\n\t\t}\n\t`}function gt(){function e(){var e,t,n;const o=(null===(e=ct.Z.state)||void 0===e?void 0:e.discussionIds)||[],r=null!==(t=pt.Z.state)&&void 0!==t&&t.open&&(null===(n=pt.Z.state)||void 0===n?void 0:n.discussionIds)||[];return[...o.flatMap((e=>at.DZ(st.nB).map((t=>ht({discussionId:e,level:t+1,hovered:!0,selected:!1}))))),...r.flatMap((e=>at.DZ(st.nB).map((t=>ht({discussionId:e,level:t+1,hovered:!1,selected:!0})))))].join("\n")}function t(){var e,t;const n=null===(e=mt.Z.state)||void 0===e?void 0:e.store,o=null===(t=mt.Z.state)||void 0===t||null===(t=t.annotations)||void 0===t?void 0:t.find(lt.j0F);if(!o)return"";const r=(0,lt.zW$)(o);return"block"!==(null==n?void 0:n.table)?"":`\n\t\t\t.${(0,st.S$)({href:r,blockId:n.id})}.${dt.kB} {\n\t\t\t\ttransition: border-color 100ms ease-in, opacity 100ms ease-in;\n\t\t\t\tborder-color: currentColor !important;\n\t\t\t\topacity: 1 !important;\n\t\t\t}\n\t\t`}function n(){const e=ut.Z.getHoveredEdit();return e?`\n\t\t\t.${(0,st.EO)({type:"insert",editId:e.editId})} {\n\t\t\t\tbackground: ${c.ZP.diffBackgroundHover} !important;\n\t\t\t}\n\t\t\t.${(0,st.EO)({type:"remove",editId:e.editId})} {\n\t\t\t\topacity: 0.6 !important;\n\t\t\t}\n\t\t`:""}window.__c={n:"CSSOverrideStyle"};const o=(0,N.VK)((()=>[e(),t(),n()].filter(Boolean).join("\n")),[]);return o?(0,$.jsx)("style",{dangerouslySetInnerHTML:{__html:o}}):null}var ft=n(77207),vt=n(74055),bt=n(7339);function St(e){return(0,$.jsx)("div",{id:"test-customer-io",style:{width:334,height:200,position:"absolute",bottom:64,right:21,zIndex:1,display:e?void 0:"none"}})}const yt=function(){window.__c={n:"CustomerIoInAppCallout"};const e=(0,B.O7)(),{currentUser:t}=e,n=(0,N.VK)((()=>bt.C.state.ready),[]),r=(0,N.VK)((()=>t.isLoggedIn()&&n&&R.default.checkGate("customerio")),[t,n]),i=(0,N.VK)((()=>U.default.state.inAppCalloutStore),[]),s=(0,N.VK)((()=>"dark"!==e.ThemeStore.state.mode),[e]);(0,o.useEffect)((()=>{r&&(i.canShow("customer_io")?s?vt.Z.state.suppressReason===vt.V.IN_APP_CALLOUT_CONFLICT?vt.Z.setState({...vt.Z.state,isVisible:!0,suppressReason:void 0}):vt.Z.setState({...vt.Z.state,suppressReason:void 0}):vt.Z.setState({isVisible:!1,suppressReason:vt.V.DARK_MODE}):vt.Z.setState({isVisible:!1,suppressReason:vt.V.IN_APP_CALLOUT_CONFLICT}))}),[i,r,s]);const a=(0,N.VK)((()=>vt.Z.state.isVisible&&i.canShow("customer_io")),[i]);return(0,o.useEffect)((()=>{if(a)return i.updateCalloutStatus({calloutId:"customer_io",visible:!0}),()=>{i.updateCalloutStatus({calloutId:"customer_io",visible:!1})}}),[i,a]),r?St(!!a):null};var wt=n(41056);function kt(e){return window.__c={n:"DateTodayUpdater"},(0,o.useEffect)((()=>{const e=window.setInterval(wt.u,5e3);return()=>{window.clearInterval(e)}}),[]),null}var xt=n(41892),Ct=n(15095),Mt=n(43593),_t=n(17755),It=n(42875),Et=n(79362),Tt=n(22808),jt=n(82883),Lt=n(60682),Pt=n(24990),At=n(19037);async function Ut(e){const t=document.createElement("canvas");t.width=32,t.height=32;const n=t.getContext("2d"),o=document.createElement("img");return o.src=e,new Promise((e=>{o.onload=()=>{n.drawImage(o,0,0,32,32),e(t.toDataURL("image/png"))},o.onerror=()=>{e("")}}))}var Rt=n(84210),Zt=n(83055),Ot=n(33929),Bt=n(19034),Nt=n(80641),Vt=n(53730);class Dt extends s.Z{constructor(){super(...arguments),this.lastSetIconString=void 0,this.updateBrowserState=()=>{const{device:e}=this.environment,t=this.computedStore.state;if(!t)return;const{url:n,title:o,icon:r}=t;let s,a,l;r&&(0,Et.V2)(r.icon)?l=r.icon:r&&(0,Tt.Z)(r.icon)?s=r.icon:r&&Mt.F8(r.icon)&&(a=r);const{intl:d}=this.props,c=t.isNonverified&&!t.hasBypassedContentClassification&&!t.isMemberOfSpace;o&&document.title!==o&&(c?document.title=d.formatMessage({id:"pageTitle.flaggedContent",defaultMessage:"Flagged Content"}):e.isSafari&&s?document.title=`${s} ${o}`:document.title=o),n&&S.T1(n)!==S.T1(window.location.href)&&(window.history.replaceState(window.history.state,void 0,n),_.j7({environment:this.environment,url:window.location.href}));const u=document.querySelector("link[rel='shortcut icon']");if(u){const t=xt.Z.images.faviconIco;if(c)u.href=t,this.lastSetIconString=t;else if(s)s!==this.lastSetIconString&&(this.lastSetIconString=s,async function(e,t){const n=document.createElement("canvas");n.width=32,n.height=32;const o=n.getContext("2d");if(o.font="normal normal normal 32px/32px sans",o.textAlign="center",o.textBaseline="middle","raw"===t)return o.fillText(e,n.width/2,n.height/2+4),n;const r=await i.deps.emojiData.loader(),s=(0,Ct.yz)(e,r);if(!s)return;const a=document.createElement("img");a.src=(0,Ct.bk)(t);const l=(0,Ct.G0)(s);return new Promise((e=>{a.onload=()=>{o.drawImage(a,l.x,l.y,l.size,l.size,0,0,32,32),e(n)},a.onerror=()=>{e(void 0)}}))}(s,(0,Lt.e_)(this.environment)).then((async e=>{await Zt.aO(),u.href=(null==e?void 0:e.toDataURL("image/png"))||""})));else if(l){if(l!==this.lastSetIconString){this.lastSetIconString=l;const t=`${l}?mode=${this.theme.mode}`;e.isFirefox?u.href=t:Ut(t).then((e=>{u.href=e}))}}else if(a){const{icon:e,...t}=a,n=_t.EK({url:e,width:100,permissionRecord:t.pointer,baseUrl:P.default.domainBaseUrl,fullyQualified:!1,userId:this.environment.currentUser.id});n!==this.lastSetIconString&&(this.lastSetIconString=n,Vt.transactionQueue.awaitRecordTransaction(t.pointer).then((()=>Ut(n))).then((e=>{u.href=e})))}else t!==this.lastSetIconString&&(u.href=t,this.lastSetIconString=t)}k.electronApi&&k.electronApi.setWindowTitle&&o&&k.electronApi.setWindowTitle(o)},this.updateBrowserStateDebounced=at.Ds(this.updateBrowserState,500,{leading:!0}),this.computedStore=this.createComputedStore((()=>{var e;const{intl:t}=this.props,{RouterStore:n,device:o}=this.environment,r=n.state.route;if("chat"===r.name)return{title:"Ask AI"};const i=U.default.state.mainEditorCurrentBlockStore;if(!i||!i.isReady())return;const s="page"===r.name&&r.blockId===i.id,a="space"===r.name&&r.requestedOnPublicDomain&&(null===(e=i.getSpaceStore())||void 0===e?void 0:e.getPublicHomePage())===i.id;if(!s&&!a)return;const l=Bt.Z.getTotalUnreadMentionsCount(),d=i.getTitleStore();let c;const u=i.getModel(),p=i.getCollectionViewIds(),m=null==d?void 0:d.getRecordModel(d.pointer);if(d&&m){if(c=(0,jt.X)({intl:Ot.default.getIntl(),textValue:d.getValue(),userTimeZone:(0,It.r)(),getRecordModel:i.getRecordModel})||m.getEmptyTitlePlaceholder({getRecordModel:d.getRecordModel,userTimeZone:(0,It.r)(),intl:t}),"block"===d.table&&(0,Me.WE)(i)){const{currentSpaceStore:e}=U.default.state;if(e){c=`${e.getName()} - ${t.formatMessage({id:"DocumentTitleListener.personalHomeLabel",defaultMessage:"Home"})}`}}if("collection"===d.table&&u&&u.isCollectionView()&&p.length>1){const e=U.default.state.currentCollectionViewStore;e&&e.getName()&&(c=`${c} | ${e.getName()}`)}o.isElectron||(c=(0,Ct.db)(c.slice(0,100),Pt.Z.state)),we.IJ(this.environment,i)||this.environment.device.isElectron||this.environment.device.isMobileNative||(l>9?c=`(9+) ${c}`:l>0&&(c=`(${l}) ${c}`))}const h="page"===r.name?(0,Rt.ZP)({store:i,fullyQualified:!1,scrollToBlockId:null==r?void 0:r.scrollToBlockId,peekViewBlockId:r.peekViewBlockId,peekMode:r.peekMode,collectionViewId:r.collectionViewId,discussionId:r.discussionId,showMoveTo:r.showMoveTo,saveParent:r.saveParent,templateGalleryItem:r.templateGalleryItem,projectManagementLaunch:r.projectManagementLaunch,pageVisitSource:void 0}):(0,Rt.ZP)({store:i,fullyQualified:!1,pageVisitSource:void 0}),g=i.getIcon(),f=null==u?void 0:u.isNonverifiedContentClassification();return{title:c,url:h,icon:g,isNonverified:f,hasBypassedContentClassification:f&&u&&Nt.Z.bypassedPage(i.id),isMemberOfSpace:(0,At.I)({blocks:[i],environment:this.environment,publicEditMode:void 0})}}))}UNSAFE_willMount(){this.savedTitle=document.title,this.computedStore.addListener(this.updateBrowserStateDebounced)}willUnmount(){this.computedStore.removeListener(this.updateBrowserStateDebounced),document.title=this.savedTitle}}Dt.displayName="DocumentTitleListener";const Ft=(0,y.injectIntl)(Dt);function zt(){window.__c={n:"EasterEgg"};const e=(0,B.Fy)(),[t,n]=(0,o.useState)(!1);return(0,o.useEffect)((()=>{if(e.isDesktop){const e=function(e){var t={addEvent:function(e,t,n){e.addEventListener(t,n,!1)},removeEvent:function(e,t,n){e.removeEventListener(t,n)},input:"",pattern:"38384040373937396665",keydownHandler:function(n){t.input+=n.keyCode,t.input.length>t.pattern.length&&(t.input=t.input.substr(t.input.length-t.pattern.length)),t.input===t.pattern&&(e(),t.input="")},load:function(){this.addEvent(document,"keydown",this.keydownHandler)},unload:function(){this.removeEvent(document,"keydown",this.keydownHandler)}};return t.load(),t}((()=>{n(!0)}));return()=>{e.unload()}}}),[e.isDesktop]),t?(0,$.jsx)("img",{className:"nyan",style:{position:"fixed",top:"calc(50vh - 100px)",zIndex:1e3,left:"50%",animationName:"leftOrRight",animationDuration:"9s",animationIterationCount:"infinite",pointerEvents:"none",userSelect:"none"},src:xt.Z.images.nyancatGif}):null}var Wt=n(15944),qt=n(81415);const Kt=(0,y.defineMessages)({pressSlashHeader:{id:"EducationTooltips.pressSlash.header",defaultMessage:"Press {slashkey} for commands"}});function Gt(e){return(0,$.jsx)("div",{style:{background:c.ZP.whiteWithAlpha(.1),padding:3,paddingRight:8,paddingLeft:8,marginRight:6,marginLeft:6,borderRadius:4},children:e.char})}function Ht(){window.__c={n:"PressSlashTooltip"};const e=(0,B.O7)(),t=Wt.o();return(0,N.VK)((()=>{const{currentUserSettingsStore:e}=U.default.state;var t;return!e||!e.isReady()||Boolean(null===(t=e.getSettings())||void 0===t?void 0:t.pressed_slash_tooltip)}),[])||e.device.isMobile||!t?null:(0,$.jsx)(qt.U,{hideCloseButton:!0,origin:()=>t.getNode(),placementToOrigin:"bottom",header:(0,$.jsx)(y.FormattedMessage,{...Kt.pressSlashHeader,values:{slashkey:(0,$.jsx)(Gt,{char:"/"})}}),content:null,onCloseClick:()=>Wt.q(e)})}var $t=n(1302),Qt=n(41432),Yt=n(40745),Xt=n(8597),Jt=n(75e3),en=n(16275),tn=n(80503),nn=n(97880),on=n(61045),rn=n(3898),sn=n(49394),an=n(65598),ln=n(45010),dn=n(98180),cn=n(69316),un=n(24666),pn=n(23063),mn=n(73420),hn=n(1743),gn=n(74194),fn=n(3386),vn=n(58261),bn=n(26388),Sn=n(32302);function yn(e){window.__c={n:"FindAndReplace"};const t=(0,o.useCallback)((e=>{cn.Z.setState({...cn.Z.state,findQuery:e,currentFocusedResult:void 0,autoSelectFirstMatch:!1})}),[]),n=(0,N.VK)((()=>cn.Z.state),[]);return(0,$.jsx)("div",{children:n.open?(0,$.jsx)(wn,{...e,find:n.findQuery,setFind:t}):null})}function wn(e){window.__c={n:"FindAndReplaceComponent"};const{environment:t,pageStore:n,find:r,setFind:s}=e,{focused:a,autoSelectFirstMatch:l}=(0,N.VK)((()=>cn.Z.state),[]),[d,c]=(0,o.useState)(l?0:-1),u=(0,N.VK)((()=>(0,an.MI)({blockStore:n,traverseTransclusionReferences:!0})),[n]),p=(0,y.useIntl)(),m=(0,N.VK)((()=>function(e){const{find:t,childBlocks:n,intl:o}=e;if(!n||0===t.length)return[];const r=[];for(const i of n){const e=i.getType();if(!e)continue;if(!((0,Qt.XD)(e)||(0,Qt.W2)(e)||"table_row"===e))continue;const n=i.getProperties(),{title:s,caption:a,description:l}=n;if("table_row"===e){const e=at.oA((0,sn.Je)({block:i,find:t,intl:o})).map((e=>({...e,blockId:i.id,blockStore:i,propertyType:"title"})));e&&r.push(...e)}const d={title:s,caption:a,description:l};(0,nn.qP)(d).forEach((e=>{let[n,s]=e;if(!s)return;const a={blockId:i.id,propertyType:n,blockStore:i},l=(0,sn.ub)({textValue:s,find:t,intl:o}).map((e=>({...e,...a})));r.push(...l)}))}return r}({find:r,childBlocks:u,intl:p})),[r,u,p]);(0,o.useEffect)((()=>{"empty"!==un.default.state.mode&&un.default.setState({mode:"empty"})}),[r,m.length,n]),(0,o.useEffect)((()=>{const e=m[d]&&m[d].blockId;e?cn.Z.update((t=>({...t,currentFocusedResult:{id:e,selection:m[d].selection}}))):cn.Z.update((e=>({...e,currentFocusedResult:void 0})))}),[d,m]);const h=(0,N.VK)((()=>cn.Z.state),[]),{value:g}=(0,i.useDependency)(i.deps.assistant),f=(0,N.VK)((()=>Oe.Z.isInPageFindQnaOptionEnabledForUser()),[]),v=(0,o.useCallback)((async e=>{if(!g||!f)return;const o=await g.assistantActions.resetAndInitializeAssistantSession({environment:t,makeActiveSession:!0});if(!o)return;const i=dn.Z.getSessionContext(o.sessionId);i&&(i.assistantConfigurationStore.setSearchScope({pageId:n.id,type:"page"}),Sn.xv(),g.assistantMenuStore.setState({open:!0,currentView:"chat"}),e&&e.length>0&&await g.handleSubmitNewQuestion({currentSkill:void 0,newValue:(0,lt.TPx)(r),environment:t,shouldForceStartNewSession:!1,source:"in_page_find"}))}),[g,t,r,n.id,f]);(0,D.r5)((async()=>{if(-1===d)return;const e=m[d];await rn.Nz(n,[e.blockId]),await $t.default.afterNextFlush();const t=document.getElementsByClassName(en.qp).item(0);if(!t)return;const o=ln.Z.PageScroller;o&&on.bx({element:t,scrollers:{verticalScroller:o,horizontalScroller:void 0},vertical:{reveal:"closest"},horizontal:void 0,animate:!0})}),[d,m,n]);const b=(0,o.useCallback)((async e=>{const{action:t,shouldRouteToQnaIfNoResults:n}=e;if(!m||0===m.length)return void(n&&r.length>0&&await v(r));const o="next"===t?1:-1,i=m[d+o],[s,a]=[m[0],m[m.length-1]];if(s&&a)switch(t){case"next":c((e=>i?e+o:0));break;case"previous":c((e=>i?e+o:m.length-1))}}),[m,d,r,v]),S=(0,N.VK)((()=>be.tu.state),[])?0:(0,tn.R6)(t.device.isElectronMac),w=(0,V.yK)((e=>({container:{position:"absolute",top:0,right:0,zIndex:999,display:"flex",gap:10,padding:5,marginRight:"1rem",boxShadow:e.lightBoxShadow,backgroundColor:e.accentColors.gray[0],borderRadius:10,width:260,outline:a?`3px solid ${e.accentColors.uiBlue[200]}`:void 0},inputContainer:{backgroundColor:e.accentColors.gray[30],boxShadow:"none",border:"none",outline:"none",padding:"6px 10px",borderRadius:4,flexGrow:1}})),[a]);return(0,$.jsx)(pn.Z,{isVisible:h.open,enterAnimationStyle:{opacity:0,translateY:0},animationStyle:{opacity:1,translateY:S+10},animationConfig:{durationMS:150},render:()=>(0,$.jsx)("div",{style:w.container,children:(0,$.jsx)(hn.Z,{debugName:"FindAndReplace",capture:!0,allowSearch:!0,allowOpenLinkMenu:!0,children:(0,$.jsxs)(fn.Z,{debugName:"FindAndReplace",capture:!0,onShiftEnter:()=>b({action:"previous",shouldRouteToQnaIfNoResults:!1}),onUp:()=>a&&b({action:"previous",shouldRouteToQnaIfNoResults:!1}),onDown:()=>a&&b({action:"next",shouldRouteToQnaIfNoResults:!1}),onEsc:()=>{Sn.xv()},onCommandJ:()=>v(),onCommandEnter:()=>v(r),children:[(0,$.jsx)(gn.Z,{value:r,onChange:e=>{s(e.target.value),c(-1)},format:gn.B.Transparent,placeholder:"Find or ask...",right:(0,$.jsx)(Cn,{currentSelectionIndex:d,numberOfMatches:m.length}),focus:a,onFocus:()=>{Sn.Du(),un.default.setState({mode:"empty"})},onBlur:()=>cn.Z.update((e=>({...e,focused:!1}))),onSubmit:()=>b({action:"next",shouldRouteToQnaIfNoResults:!1}),inputStyle:{fontSize:"0.8rem"},style:w.inputContainer},"find-input-element"),m.length>0?(0,$.jsx)(xn,{jumpToBlockFn:b,numberOfMatches:m.length}):(0,$.jsx)(kn,{hasQuery:r.length>0,isQnaEnabled:f,onClick:()=>v(r)})]})})})})}function kn(e){window.__c={n:"AskButton"};const{hasQuery:t,isQnaEnabled:n,onClick:o}=e,r=(0,V.yK)((e=>({container:{fontSize:".8rem",display:"flex",borderRadius:5},icon:{width:12,height:12}})),[]);return t&&n?(0,$.jsx)(bn.ZP,{placement:bn.ug.Bottom,originGap:18,renderTooltip:()=>(0,$.jsx)(vn.Z,{name:"commandEnter"}),allowHover:!1,render:e=>(0,$.jsx)(W.Z,{style:r.container,...e,onClick:o,children:(0,$.jsxs)(mn.X2,{gap:4,alignItems:"center",children:[(0,$.jsx)(y.FormattedMessage,{id:"inPageFind.matchCount.ask",defaultMessage:"Ask"}),(0,Jt.U)(r.icon)]})})}):null}function xn(e){window.__c={n:"ArrowNavigation"};const{numberOfMatches:t,jumpToBlockFn:n}=e,o=(0,N.VK)((()=>t>0),[t]),r=(0,V.yK)((e=>({arrowIconContainer:{width:12,height:12,color:o?e.icon.secondary:e.icon.quaternary,cursor:o?"pointer":"not-allowed"}})),[o]);return(0,$.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:5},children:[(0,$.jsx)("span",{style:r.arrowIconContainer,onClick:()=>n({action:"previous",shouldRouteToQnaIfNoResults:!1}),children:(0,Xt.Z)()}),(0,$.jsx)("span",{style:r.arrowIconContainer,onClick:()=>n({action:"next",shouldRouteToQnaIfNoResults:!1}),children:(0,Yt.M)()})]})}function Cn(e){window.__c={n:"MatchCount"};const{numberOfMatches:t,currentSelectionIndex:n}=e,o=(0,V.yK)((e=>({container:{fontSize:".8rem",color:e.text.tertiary}})),[]);return 0===t?null:(0,$.jsx)("div",{style:o.container,children:(0,$.jsxs)(mn.X2,{gap:4,alignItems:"center",children:[(0,$.jsx)("span",{children:n+1}),(0,$.jsx)(y.FormattedMessage,{id:"inPageFind.matchCount.ofSpacer",defaultMessage:"of"}),(0,$.jsx)("span",{children:t})]})})}var Mn=n(21202),_n=n(81193),In=n(3297),En=n(32360),Tn=n(87279),jn=n(83941),Ln=n(68785),Pn=n(78140),An=n(32163),Un=n(50506),Rn=n(72495),Zn=n(26673);class On extends s.Z{constructor(){super(...arguments),this.didSingleWorkspaceFork=!1,this.mountedTime=Date.now(),this.readyToExperimentStatus=this.createComputedStore((()=>{if(this.environment.device.isMobile)return"not_eligible";if(this.mountedTime+3e3<=Date.now())return"not_eligible";if(!bt.C.state.ready)return"waiting";const{currentUserRootStore:e}=U.default.state;if(null==e||!e.isReady())return"waiting";const{total:t,loaded:n,editable:o}=En.o(e);return t<2?"not_eligible":o>2?"eligible":n===t?"not_eligible":"waiting"}))}didMountOrUpdate(){const e=(e,t,n,o)=>{this.didSingleWorkspaceFork=!0;return In.DK({environment:this.environment,store:e,spaceStore:t,spaceViewStore:n,isPrivate:o,context:"public_page_duplicate_single_workspace"})};if(!this.environment.currentUser.isLoggedIn()){const{environment:e}=this;return In.nM({currentUserId:void 0,blockId:this.props.blockId}),"public_page"!==this.props.from&&"notion_template_gallery"!==this.props.from||_n.HU(e,{from:this.props.from,is_paid:!1,template_block_id:this.props.blockId,public_page_device_id:this.props.tid}),void _.c4({environment:e,url:h._j.login})}const{currentUserRootStore:t}=U.default.state;if(t&&t&&!this.didSingleWorkspaceFork){const n=Z.G.createChildStore(t,{table:Mn.iU,id:this.props.blockId});if("eligible"===this.readyToExperimentStatus.state)return void function(e,t,n,o,r){const i=(0,jn.M)({disableExposureLogging:!1}),s=i?"on":"control",{total:a,loaded:l,editable:d}=En.o(t);_n.ar(n,{templateBlockId:o,from:r,numOfSpaceViews:a,numOfLoadedSpaceViews:l,numOfEditableSpaceViews:d,group:s}),i&&(ve.Z.setState({open:!0,blockStore:e,spaceStore:void 0,spaceViewStore:void 0,teamStore:void 0}),_n.JJ(n,{templateBlockId:o,from:r,numOfSpaceViews:a,numOfLoadedSpaceViews:l,numOfEditableSpaceViews:d,group:s}),_.c4({environment:n,url:h._j.root,redirect:!0}))}(n,t,this.environment,this.props.blockId,this.props.from);if("waiting"===this.readyToExperimentStatus.state)return;const o=be.o(t);if(1===o.length){const t=o[0],r=t.getSpaceStore();if(!r)return;e(n,r,t,!0)}else if(this.props.workspaceId&&o.length>1){const t=o.filter((e=>e.pointer.spaceId===this.props.workspaceId)),r=t[0],i=null==r?void 0:r.getSpaceStore();if(!i)return;e(n,i,r,!0)}}}renderComponent(){if("waiting"===this.readyToExperimentStatus.state)return(0,$.jsx)(Vn,{});const{device:e}=this.environment,{currentUserRootStore:t}=U.default.state;if(!t)return(0,$.jsx)(Vn,{});const{mainEditorCurrentBlockStore:n}=U.default.state;if(!n)return(0,$.jsx)(Vn,{});if(!n.isDefined())return(0,$.jsx)(Vn,{});const o=[{key:"spaces",render:t=>(0,$.jsx)(Rn.Z,{title:e.isMobile?void 0:(0,$.jsx)(y.FormattedMessage,{id:"forkPageScreen.chooseWorkspaceForDuplication.message",defaultMessage:"Choose a workspace to duplicate into"}),isTitleUppercase:!0,...t}),items:(0,Zn.getSpaceViewMenuItems)(this.environment,n,"eligible"===this.readyToExperimentStatus.state)}];let r;return r=e.isMobile?{menuType:Tn.og.Modal,title:(0,$.jsx)(y.FormattedMessage,{id:"forkPageScreen.chooseWorkspace.message",defaultMessage:"Choose a workspace"}),width:"100vw"}:{menuType:Tn.og.Popup,height:"auto"},(0,$.jsx)(Un.Z,{open:!0,disableAnimation:!0,render:()=>(0,$.jsx)("div",{style:Nn(this.environment),children:(0,$.jsx)(Pn.Z,{...r,children:(0,$.jsx)(An.Z,{type:An.i.Vertical,sections:o,initialFocus:1})})})})}}On.displayName="ForkPageScreen";const Bn=On;function Nn(e){const{device:t}=e;return{width:"100vw",height:"100vh",paddingLeft:t.isMobile?16:30,paddingRight:t.isMobile?16:30,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}}function Vn(){window.__c={n:"LoadingComponent"};const e=(0,B.O7)();return(0,$.jsx)(Un.Z,{open:!0,disableAnimation:!0,render:()=>(0,$.jsx)("div",{style:Nn(e),children:(0,$.jsx)(Ln.Z,{style:{width:20,height:20}})})})}var Dn=n(81059),Fn=n(30664),zn=n(36610),Wn=n(65556);function qn(){window.__c={n:"PageReloadConfirmationListener"};const e=(0,B.O7)();return(0,o.useEffect)((()=>{function t(t){zn.f7(e,{reason:t})}return Wn.showConfirmationDialogEventEmitter.addListener(t),()=>{Wn.showConfirmationDialogEventEmitter.removeListener(t)}}),[e]),null}var Kn=n(82540),Gn=n(15145),Hn=n(50475),$n=n(92973),Qn=n(99553),Yn=n(75754),Xn=n(10906),Jn=n(43250),eo=n(75079),to=n(85957),no=n(18245),oo=n(34859),ro=n(4926),io=n(42330),so=n(82136),ao=n(88923),lo=n(42057),co=n(83212),uo=n(27724),po=n(41464),mo=n(4827),ho=n(53336),go=n(26957),fo=n(88274),vo=n(31192),bo=n(78901),So=n(3553),yo=n(55064),wo=n(92996),ko=n(82855),xo=n(16880),Co=n(7525),Mo=n(26999),_o=n(34700);function Io(e){const{theme:t,isSidePeekOpen:n,borderRadius:o}=e;return{zIndex:n?ce.LI:ce.Bh,background:t.peekModalBackground,borderTopLeftRadius:o??5,borderTopRightRadius:o??5}}function Eo(e){const{environment:t,padding:n,height:o}=e,r=t.device.isMobile?4:n??12;return{height:o??tn.R6(t.device.isElectronMac)-1,display:"flex",justifyContent:"space-between",alignItems:"center",paddingLeft:r,paddingRight:r}}function To(e){return{...(0,_o.X)({noDrag:e.device.isElectronMac}),display:"grid",gridAutoFlow:"column",gridColumnGap:2,alignItems:"center"}}var jo=n(81170),Lo=n(91551);const Po=new(n(61766).Z);var Ao=n(98452),Uo=n(99332),Ro=n(24612),Zo=n(73063),Oo=n(58493),Bo=n(73935),No=n(42853),Vo=n(11302),Do=n(58239);var Fo=n(38755),zo=n(89728),Wo=n(31278),qo=n(76798),Ko=n(45653);const Go={display:"flex",alignItems:"center",fontSize:14,minWidth:0};class Ho extends s.Z{constructor(){super(...arguments),this.buttonEl=null,this.handleButtonMount=e=>{this.buttonEl=e},this.handleOpenPopup=e=>{if(e.preventDefault(),this.buttonEl){const e=Bo.findDOMNode(this.buttonEl);e&&Vo.bA({environment:this.environment,blocks:[this.props.store],originRect:e.getBoundingClientRect(),moveToContext:this.moveToContext.state,onAccept:e=>function(e,t,n,o){const{currentSpaceStore:r}=U.default.state;if(r&&t){let t;!function(e){const{pageType:t,spaceStore:n,currentUserId:o,result:r}=e;(0,Do.rq)({currentUserId:o,spaceId:n.id,value:r}),t&&(0,Do.ZT)({currentUserId:o,spaceId:n.id,databaseType:wo.wg[t],parent:r})}({pageType:t||o,spaceStore:r,currentUserId:n.currentUser.id,result:e})}}(e,this.props.saveParent,this.environment,this.props.pageType),isAddTo:!0,isDefaultPrivateLocation:Xo(this.props.store),disableSuccessToast:!0,forceUntyped:this.props.forceUntyped||(t=this.props.pageType,!t||"page"===t)})}var t},this.moveToContext=this.createComputedStore((()=>{const e=U.default.state.mainEditorCurrentBlockStore;return e&&(0,Me.WE)(e)?"home_tab":e&&(0,be.qG)(e.id)?"aggregated_type":"quick_add"}))}renderComponent(){const{store:e,prefix:t,buttonStyle:n}=this.props,o=e.getParentStore();if(o&&!(o instanceof Z.T5)&&!(o instanceof Z.zq)&&!(o instanceof Z.Vf)){const e=t?(0,$.jsx)("span",{style:{color:this.theme.mediumTextColor,marginRight:4},children:(0,$.jsx)(y.FormattedMessage,{...t})}):void 0;return(0,$.jsx)(fn.Z,{debugName:"PeekMoveToMenu",capture:!0,onMoveTo:this.handleOpenPopup,children:(0,$.jsx)("div",{style:Go,children:(0,$.jsx)(bn.ZP,{renderTooltip:()=>(0,$.jsxs)("div",{children:[(0,$.jsx)(y.FormattedMessage,{defaultMessage:"Set the default page or database",id:"peekMoveToMenu.tooltip"}),(0,$.jsx)("br",{}),(0,$.jsx)(vn.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"moveTo"})]}),render:t=>(0,$.jsxs)(zo.Z,{onClick:this.handleOpenPopup,ref:this.handleButtonMount,shouldShrink:!0,style:n,...t,children:[(0,$.jsx)(Qo,{parentStore:o,prefixText:e}),(0,No.i)({width:10,marginLeft:4,fill:this.theme.lightTextColor})]})})})})}}}function $o(e,t){return e&&e instanceof Z.H2&&t&&e.id===t.id}function Qo(e){window.__c={n:"PeekMoveToPageName"};const{parentStore:t,prefixText:n}=e,o=(0,B.O7)(),r=(0,N.VK)((()=>(0,be.B7)(o)),[o]),i=(0,N.VK)((()=>t instanceof Z.G&&t.isEmptyPage()),[t]),s=(0,N.VK)((()=>t instanceof Z.H2?(0,Fo.Wd)(o,t):t.getIcon()),[o,t]),a=(0,N.VK)((()=>t instanceof Z.H2?(0,Fo.rn)(o,t):void 0),[o,t]),l=(0,N.VK)((()=>{const{currentSpaceStore:e}=U.default.state;return $o(t,e)}),[t]),d=(0,V.yK)((()=>({privatePagesText:{fontWeight:z.Z.fontWeight.medium,marginLeft:4,...z.Z.textOverflowStyle,overflow:"hidden"},icon:{marginRight:4,marginTop:1},title:{fontWeight:z.Z.fontWeight.semibold}})),[]);return(0,$.jsx)($.Fragment,{children:l?(0,$.jsxs)($.Fragment,{children:[n,(0,$.jsx)(Ko.Z,{size:22,avatarShouldShowShadow:!0,userStore:r}),(0,$.jsx)("span",{style:d.privatePagesText,children:(0,$.jsx)(y.FormattedMessage,{defaultMessage:"Private pages",id:"peekMoveToMenu.addTo.privatePages"})})]}):(0,$.jsxs)($.Fragment,{children:[n,(0,$.jsx)(Wo.Z,{disabled:!0,icon:s,isEmptyPage:i,title:a,size:18,style:d.icon}),(0,$.jsx)(qo.Z,{style:d.title,store:t})]})})}Ho.displayName="PeekMoveToMenu";const Yo=Ho;function Xo(e){const t=e.getParentStore(),{currentSpaceStore:n}=U.default.state;return $o(t,n)}var Jo=n(25906),er=n(28311),tr=n(26399),nr=n(43377),or=n(72485),rr=n(5002),ir=n(68626),sr=n(64530),ar=n(91155),lr=n(8406),dr=n(5149),cr=n(48543),ur=n(98165),pr=n(52275),mr=n(31945),hr=n(16354),gr=n(53437),fr=n(49085),vr=n(13148),br=n(3418);const Sr=165888e7;class yr extends s.Z{constructor(){super(...arguments),this.storeTypes={visible:fr.default.createClass(!1)},this.timeout=void 0}UNSAFE_willMountOrUpdate(){(function(e){const{device:t}=e;if(t.isPhone)return!1;if(br.Z.state.openPopups.size>0)return!1;const{currentUserSettingsStore:n}=U.default.state;if(!n||!n.isReady())return!1;const o=n.getSettings();if(null!=o&&o.signup_time&&(null==o?void 0:o.signup_time)>Sr)return!1;if(null!=o&&o.seen_peek_mode_tooltip)return!1;return!0})(this.environment)?(clearTimeout(this.timeout),this.timeout=setTimeout((()=>{this.stores.visible.setState(!0)}),500)):(clearTimeout(this.timeout),this.stores.visible.setState(!1))}renderComponent(){const{origin:e}=this.props,{visible:t}=this.stores,{device:n}=this.environment;return n.isMobile?e:(0,$.jsxs)("div",{style:{position:"relative"},children:[e,(0,$.jsx)(pn.Z,{isVisible:t.state,animationStyle:{opacity:1},enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},render:()=>(0,$.jsx)(kr,{})})]})}}yr.displayName="PeekModeIntroTooltip";const wr=(0,y.injectIntl)(yr);function kr(){window.__c={n:"PopupComponent"};const e=(0,V.Fg)(),t=(0,B.O7)();return(0,$.jsxs)("div",{style:{fontSize:12,color:c.ZP.white,position:"absolute",top:"calc(100% + 12px)",left:"calc(50% - 110px)",background:c.ZP.blue,borderRadius:6,padding:"8px 12px 12px 12px",width:220,boxShadow:e.largeLightBoxShadow,zIndex:99},children:[(0,$.jsx)("div",{style:{position:"absolute",top:-12,left:"calc(50% - 2.5px)",background:c.ZP.blue,width:5,height:5,borderRadius:5,boxShadow:`0 0 0 1.5px ${e.contentBackground}`}}),(0,$.jsx)("div",{style:{position:"absolute",top:-12,left:"calc(50% - 1px)",background:c.ZP.blue,width:2,height:12}}),(0,$.jsx)("div",{style:{width:"90%",fontWeight:500,marginBottom:2},children:(0,$.jsx)(y.FormattedMessage,{defaultMessage:"New! Open pages in side peek",id:"peekModeIntroTooltip.title"})}),(0,$.jsx)("div",{style:{opacity:.8,lineHeight:1.35},children:(0,$.jsx)(y.FormattedMessage,{defaultMessage:"Use Tables, Boards, Lists and Timelines while opening pages on the side for faster workflows. Switch to other peek modes here.",id:"peekModeIntroTooltip.subtitle"})}),(0,$.jsx)(Zo.Z,{icon:vr.U,style:{position:"absolute",top:4,right:4,opacity:.8},iconStyle:{width:12,fill:c.ZP.white},onClick:()=>function(e){Qn.Om({environment:e,seen:!0})}(t)})]})}const xr=(0,y.defineMessages)({changeForThisView:{id:"peekTopbar.changePeekOption.changeForThisView",defaultMessage:"Edit view default"}});class Cr extends s.Z{UNSAFE_willMount(){const e=_r(this.theme),t=ao.default.getPeekMode();e.find((e=>at.Xy(e.key,t)))||ir.log({level:"warning",from:"TopbarPeekModeButton",type:"InvalidSelectedPeekMode",error:(0,ar.Ui)("Selected key is invalid.")})}renderComponent(){const{device:e}=this.environment,{mainEditorCurrentBlockStore:t}=U.default.state,n=_r(this.theme),o=ao.default.getPeekMode();return o?(0,$.jsx)(mr.ZP,{popupType:e.isMobile?gr.kQ.SlideUp:gr.kQ.Popup,alignmentToOrigin:mr.vR.Center,placementToOrigin:mr.pO.Bottom,style:{minWidth:190},originGap:0,onClick:()=>function(e){if(!ao.default.state.open)return;const t=ao.default.state.collectionContextStore;t?lr.nS({environment:e,collectionContextStore:t,from:"peek_topbar",peek_target_id:ao.default.state.target.id,from_peek_mode:ao.default.state.mode}):$n.v2(e,{from:"peek_topbar",peek_target_id:ao.default.state.target.id,from_peek_mode:ao.default.state.mode})}(this.environment),renderOrigin:e=>(0,$.jsx)(wr,{origin:(0,$.jsx)(bn.ZP,{renderTooltip:()=>(0,$.jsx)($.Fragment,{children:(0,$.jsx)(y.FormattedMessage,{defaultMessage:"Switch peek mode",id:"peekTopbar.openPagesAs.button"})}),render:t=>(0,$.jsx)(Zo.Z,{...e,...t,icon:(0,cr.RO)(o),iconStyle:{fill:this.theme.mediumIconColor}})})}),render:r=>{var i,s,a;let l;l=e.isMobile?{menuType:Tn.og.ActionSheet}:{menuType:Tn.og.Popup,width:220};const d=at.oA([...n.map(((e,t)=>{const n=e.key,i="full_page"===n?(0,Rt.ZP)({store:this.props.store,fullyQualified:!1,pageVisitSource:Gn.tY.Expand}):function(e,t){const{mainEditorCurrentBlockStore:n}=U.default.state,o=ur.uJ(t),r=t.isNavigableBlock()?o.slice(1):[...o],i=r.length>0?r[0]:void 0;return(0,Xn.mb)({store:t,mainEditorCurrentBlockStore:i instanceof Z.G&&!ao.default.state.open?i:n,collectionContextStore:ao.default.state.collectionContextStore,fullyQualified:!1,overridePeekMode:(0,ao.getPeekModeFromCollectionPeekModeFormat)(e)})}(n,this.props.store);return{key:t,render:t=>(0,$.jsx)(hr.Z,{href:i,onClick:()=>{var e;Qn.Om({environment:this.environment,seen:!0}),$n.UZ(this.environment,{from:"peek_topbar",peek_mode:n,from_peek_mode:o,target_page_id:null===(e=ao.default.peekTarget.state)||void 0===e?void 0:e.id}),r.close()},children:(0,$.jsx)(pr.Z,{...t,disabled:!1,title:e.title,icon:e.icon,caption:e.caption,body:e.body,checkState:at.Xy(e.key,o)})}),action:()=>{}}}))]),c=ao.default.state.open?ao.default.state.collectionContextStore:void 0,u=ao.default.state.open?ao.default.state.target:void 0,p=t&&t.id===(null==c||null===(i=c.collectionViewBlockStore())||void 0===i?void 0:i.getRecordStoreUIRoot().id),m=(null==c||null===(s=c.collectionStore())||void 0===s?void 0:s.id)===(null==u||null===(a=u.getAssociatedCollectionStore())||void 0===a?void 0:a.id)&&(null==c?void 0:c.permissionScopes.state.canConfigureBlock)&&p;return(0,$.jsx)(Pn.Z,{...l,children:(0,$.jsx)(An.Z,{type:An.i.Vertical,sections:at.oA([{key:0,render:e=>(0,$.jsx)(Rn.Z,{enableActionSheetTitle:!0,...e}),items:d},m&&{key:1,render:e=>(0,$.jsx)(Rn.Z,{enableActionSheetTitle:!0,topBorder:!0,...e}),items:[{key:"change_for_view",render:e=>(0,$.jsx)(pr.Z,{...e,disabled:!1,title:Ot.default.formatMessage(xr.changeForThisView),icon:(0,sr.y)({width:16,height:16,fill:this.theme.regularIconColor})}),action:e=>{!function(e,t){const n=ao.default.state.open?ao.default.state.collectionContextStore:void 0;n&&(Qn.Om({environment:e,seen:!0}),ao.default.isCenterPeekOpen()&&t&&t(),dr.r$({collectionContextStore:n,collectionSettingsStore:n.settingsStore}),dr.H4({collectionSettingsStore:n.settingsStore,item:{type:"layout"}}),n.settingsStore.setState({...n.settingsStore.state,openButtonPopup:"peekModeFormat"}))}(this.environment,this.props.onClose),r.close()}}]}]),initialFocus:0})})}}):null}}Cr.displayName="TopbarPeekModeButton";const Mr=Cr;function _r(e){return["side_peek","center_peek","full_page"].map((t=>({key:t,title:(0,cr.LQ)(t),icon:(0,cr.RO)(t)({width:16,fill:e.mediumTextColor})})))}var Ir=n(58810);const Er=function(e){window.__c={n:"TopbarPeekOpenAsPageButton"};const{store:t,shouldShowMoveToMenu:n}=e,r=(0,B.O7)(),i=(0,y.useIntl)(),s=(0,N.VK)((()=>(0,Rt.ZP)({store:t,fullyQualified:!1,pageVisitSource:Gn.tY.Expand})),[t]),a=(0,V.yK)((e=>({keyboardShortcut:{color:e.mediumInvertedTextColor},iconButtonWrapper:{height:24}})),[]),l=(0,o.useCallback)((()=>{var e,t,o;$n.sx(r,{isNewPage:n,peek_mode:ao.default.state.mode,from:"topbar_button",target_page_id:null===(e=ao.default.peekTarget.state)||void 0===e?void 0:e.id}),$n.$C(r,{peek_mode:ao.default.state.mode,from:"topbar_open_as_page_button",target_page_id:null===(t=ao.default.peekTarget.state)||void 0===t?void 0:t.id,target_parent_id:null===(o=ao.default.peekTarget.state)||void 0===o?void 0:o.getParentId()})}),[r,n]);return(0,$.jsx)(bn.ZP,{renderTooltip:()=>(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)("div",{children:(0,$.jsx)(y.FormattedMessage,{defaultMessage:"Open in full page",id:"peekTopbar.navigateToPage.tooltip"})}),(0,$.jsx)(vn.Z,{style:a.keyboardShortcut,name:"commandEnter"})]}),render:e=>(0,$.jsx)("div",{style:a.iconButtonWrapper,children:(0,$.jsx)(Zo.Z,{...e,icon:Ir.Z,iconStyle:{width:16,height:16},href:s,onClick:l,ariaLabel:i.formatMessage({id:"peekTopbar.navigateToPage.tooltip",defaultMessage:"Open in full page"})})})})};var Tr=n(86467),jr=n(7715),Lr=n(82774),Pr=n(94107);const Ar=(0,y.defineMessages)({moveToPrefixText:{id:"peekMoveToMenu.addTo.addTo",defaultMessage:"Add to"},closeButton:{defaultMessage:"Close",id:"peekTopbar.close.button"},previousPageTooltip:{defaultMessage:"Previous page",id:"peekTopbar.peekNavUpArrow.tooltip"},nextPageTooltip:{defaultMessage:"Next page",id:"peekTopbar.peekNavDownArrow.tooltip"}});const Ur=function(e){let{store:t,shouldShowMoveToMenu:n,onClose:o,spaceStore:r,spaceViewStore:s,pageVisitStore:a,presenceStore:l}=e;window.__c={n:"PeekTopbar"};const d=(0,V.Fg)(),c=(0,B.O7)(),u=(0,N.VK)((()=>ao.default.isSidePeekOpen()),[]),p=(0,N.VK)((()=>Lo.Z.state.banners),[]);return(0,$.jsx)(So.Z,{store:t,disableRectangularSelection:!0,disableEditNearestBlock:!0,isPeekRenderer:!0,render:e=>{let{selectableEvents:m}=e;return(0,$.jsxs)("div",{...m,style:Io({theme:d,isSidePeekOpen:u}),children:[(0,$.jsxs)("div",{style:Eo({environment:c}),children:[(0,$.jsxs)("div",{style:To(c),children:[(0,$.jsx)(Or,{onClose:o}),(0,$.jsx)(Er,{store:t,shouldShowMoveToMenu:n}),ao.default.state.open&&(0,$.jsx)(Mr,{store:t,onClose:o}),(0,$.jsx)(Br,{shouldShowMoveToMenu:n}),(0,$.jsx)(Rr,{store:t,shouldShowMoveToMenu:n}),(0,$.jsx)(Oo.Z,{store:t,isMobile:!1,buttonStyle:{...!n&&{marginLeft:12}}})]}),(0,$.jsx)("div",{style:{flexGrow:1,flexShrink:1}}),(0,$.jsx)(Zr,{store:t,spaceStore:r,spaceViewStore:s,pageVisitStore:a,presenceStore:l})]}),(0,$.jsx)(i.LazyBannersRenderer,{banners:p,isMobile:!1,isInPeekRenderer:!0})]})}})};function Rr(e){let{store:t,shouldShowMoveToMenu:n}=e;window.__c={n:"MoveToMenu"};const{open:o,saveParent:r,pageVisitSource:i}=(0,N.VK)((()=>({open:ao.default.state.open,saveParent:!!ao.default.state.open&&ao.default.state.saveParent,pageVisitSource:ao.default.state.open?ao.default.state.pageVisitSource:void 0})),[]),s=(0,N.VK)((()=>{const e=t.getAssociatedCollectionStore();return(null==e?void 0:e.getDatabaseType())===wo.iS?"tasks":void 0}),[t]);return o&&n?(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(rr.Z,{}),(0,$.jsx)(Yo,{store:t,saveParent:r,prefix:Ar.moveToPrefixText,pageType:s,forceUntyped:i===Gn.tY.SidebarQuickAdd})]}):null}function Zr(e){let{store:t,spaceStore:n,spaceViewStore:o,pageVisitStore:r,presenceStore:i}=e;window.__c={n:"ActionButtons"};const s=(0,B.O7)(),{device:a}=s,l=(0,N.VK)((()=>(0,we.IJ)(s,t)),[s,t]),d=(0,N.VK)((()=>be.qG(t.id)),[t]),c=(0,N.VK)((()=>(0,Me.Kj)(t.id)),[t]),u=!a.isMobile&&n&&o&&!l&&!c,p=(0,N.VK)((()=>Boolean(n&&!n.canEdit())),[n]),m=(0,N.VK)((()=>t.canEdit()),[t]),h=(0,N.VK)((()=>t.isRestricted()),[t]),g=(0,N.VK)((()=>!a.isMobile&&R.default.checkGate("show_topbar_layout_info_button")),[a.isMobile]),f=n&&o&&!l&&(0,Jo.UP)({isSpaceGuest:p,canEditPage:m})&&!c;return(0,$.jsxs)("div",{style:{display:"flex",alignItems:"stretch",flexGrow:0,flexShrink:0,zIndex:1},children:[h&&(0,$.jsx)(jr.Z,{style:{marginRight:14},onClick:()=>{Uo.Z.setState({open:!0})}}),m&&(0,$.jsx)(Tr.Z,{rootStore:t,pageVisitStore:r,presenceStore:i}),f&&(0,$.jsx)(Lr.Z,{store:t,buttonPopupStore:Uo.Z}),u&&(0,$.jsx)(er.Z,{blockStore:t,spaceStore:n,buttonPopupStore:Po}),u&&(0,$.jsx)(Pr.Z,{blockStore:t,spaceStore:n,buttonPopupStore:Ro.Z}),g&&(0,$.jsx)(nr.b,{blockStore:t}),n&&o&&!l&&(0,$.jsx)(tr.Z,{store:t,spaceViewStore:o}),d&&(0,$.jsx)(jo.Z,{}),u&&(0,$.jsx)(or.Z,{store:t,buttonPopupStore:Ao.Z})]})}function Or(e){let{onClose:t}=e;window.__c={n:"PeekCloseComponent"};const n=(0,y.useIntl)(),o=(0,V.Fg)();return(0,N.VK)((()=>ao.default.isSidePeekOpen()),[])?(0,$.jsx)(bn.ZP,{renderTooltip:()=>(0,$.jsxs)("div",{children:[n.formatMessage(Ar.closeButton),(0,$.jsx)("br",{}),(0,$.jsx)(vn.Z,{style:{color:o.mediumInvertedTextColor},name:"esc"})]}),render:e=>(0,$.jsx)(Zo.Z,{...e,ariaLabel:n.formatMessage(Ar.closeButton),icon:Co.t,iconStyle:{width:16,height:16},onClick:()=>t("close_button")})}):null}function Br(e){let{shouldShowMoveToMenu:t}=e;window.__c={n:"PeekNavArrowsComponent"};const n=(0,y.useIntl)(),o=(0,V.Fg)(),r=(0,N.VK)((()=>ao.default.state),[]),{resultsStore:i}=r,s=(0,N.VK)((()=>null==i?void 0:i.getState()),[i]);if(!r.open)return null;if(t)return null;const a=r.target.id;return s&&s.length>0&&s.some((e=>e.id===a))?(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(rr.Z,{}),(0,$.jsx)(bn.ZP,{renderTooltip:()=>(0,$.jsxs)("div",{children:[n.formatMessage(Ar.previousPageTooltip),(0,$.jsx)("br",{}),(0,$.jsx)(vn.Z,{style:{color:o.mediumInvertedTextColor},name:"peekUp"})]}),render:e=>(0,$.jsx)(Zo.Z,{...e,ariaLabel:n.formatMessage(Ar.previousPageTooltip),disabled:a===s[0].id,icon:xo.R,onClick:()=>Mo.Qk(),iconStyle:{fill:o.mediumIconColor}})}),(0,$.jsx)(bn.ZP,{renderTooltip:()=>(0,$.jsxs)("div",{children:[n.formatMessage(Ar.nextPageTooltip),(0,$.jsx)("br",{}),(0,$.jsx)(vn.Z,{style:{color:o.mediumInvertedTextColor},name:"peekDown"})]}),render:e=>(0,$.jsx)(Zo.Z,{...e,ariaLabel:n.formatMessage(Ar.nextPageTooltip),disabled:a===s[s.length-1].id,icon:ko.E,onClick:()=>Mo.OW(),iconStyle:{fill:o.mediumIconColor}})})]}):null}function Nr(){window.__c={n:"CenterPeekRenderer"};const{open:e}=(0,N.VK)((()=>ao.default.state),[]),t=(0,N.VK)((()=>ro.Z.state),[]),n=(0,V.yK)((e=>({containerStyles:{position:"fixed",top:0,right:0,bottom:0,left:0,zIndex:ce.Nn,background:e.overlaySmokescreen},contentStyles:{...qr(e),top:ao.PeekModeOuterPadding,left:ao.PeekModeOuterPadding,right:ao.PeekModeOuterPadding,marginRight:"auto",height:`calc(100% - ${ao.PeekModeOuterPadding}px*2)`,maxWidth:ao.CenterPeekModeOuterWidth+t,borderRadius:4}})),[t]);return(0,$.jsx)(mo.Z,{open:e,children:(0,$.jsx)(Fr,{enableCaptureClick:!0,priority:void 0,showResizer:!1,styles:n})})}function Vr(){window.__c={n:"SidePeekRenderer"};const e=(0,B.O7)(),t=(0,N.VK)((()=>ao.default.state),[]),n=(0,N.VK)((()=>ao.default.getSidePeekWidth(e.WindowSizeStore.state.width)),[e]),o=(0,V.yK)((e=>({containerStyles:{position:"fixed",top:0,right:0,bottom:0,translateX:n,width:n,zIndex:ce.YO},contentStyles:{...qr(e),top:0,right:0,width:"100%",height:"100%",borderRadius:0}})),[n]);return(0,$.jsx)(pn.Z,{isVisible:!0,useCompositeLayer:!0,animationStyle:{translateX:t.open&&!t.isClosing?0:n},render:()=>(0,$.jsx)(Fr,{enableCaptureClick:!1,priority:-1,showResizer:!0,styles:o}),enterAnimationStyle:{translateX:t.open?0:n},onAnimationEnd:()=>{t.open&&t.isClosing?(ao.default.setState({...t,isClosing:!1}),Qn.ME()):t.open&&t.isOpening&&ao.default.setState({...t,isOpening:!1})}})}function Dr(){window.__c={n:"SideAndCenterPeekTopbar"};const e=(0,B.O7)(),t=(0,N.VK)((()=>ao.default.state),[]),{currentSpaceStore:n,currentSpaceViewStore:o}=(0,N.VK)((()=>U.default.state),[]);return t.open?(0,$.jsx)(Ur,{store:t.target,spaceStore:n,spaceViewStore:o,pageVisitStore:t.pageVisitStore,presenceStore:t.presenceStore,shouldShowMoveToMenu:t.showMoveTo,onClose:t=>{Hr(e,t)}}):null}function Fr(e){window.__c={n:"PeekContainer"};const{priority:t}=e,n=(0,B.O7)(),r=(0,N.VK)((()=>ao.default.state),[]),{shouldShowFrame:i}=(0,N.VK)((()=>(0,be.h1)(n)),[n]),s=(0,N.VK)((()=>to.Tx()),[]),a=(0,N.VK)((()=>r.open&&0===uo.default.state.stores.length&&!uo.default.state.pivot&&"editing"!==un.default.state.mode&&!io.ZP.state.isOpen),[r.open]),l=(0,o.useCallback)((()=>{$r(n)}),[n]),d=(0,o.useCallback)((()=>{!function(e){ao.default.peekTarget.state&&(Yn._({environment:e,store:ao.default.peekTarget.state,pageVisitSource:Gn.tY.Expand}),$n.sx(e,{isNewPage:ao.default.state.open&&ao.default.state.showMoveTo,peek_mode:ao.default.state.mode,from:"command_enter",target_page_id:ao.default.peekTarget.state.id}),$n.$C(e,{peek_mode:ao.default.state.mode,from:"command_enter",target_page_id:ao.default.peekTarget.state.id,target_parent_id:ao.default.peekTarget.state.getParentId()}))}(n)}),[n]);return i?r.open?(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(po.Z,{debugName:"PeekRenderer",priority:t,capture:s}),(0,$.jsx)(fn.Z,{debugName:"PeekRenderer",capture:a,onEsc:l,onCommandEnter:d,children:(0,$.jsx)(Wr,{...e})},r.target.id)]}):(0,$.jsx)(Wr,{...e}):null}const zr=20;function Wr(e){window.__c={n:"PeekContentContainer"};const{enableCaptureClick:t,bottomBar:n,showResizer:r,styles:s}=e,a=(0,o.useRef)(void 0);ln.Z.PeekViewScroller=a.current;const l=(0,y.useIntl)(),d=(0,B.O7)(),c=(0,N.VK)((()=>ao.default.state),[]),u=(0,N.SI)((()=>c.open?co.Z.getMode(d,c.target):co.m.disabled),[d,c]),p=(0,N.VK)((()=>{if(!c.open)return;const{currentSpaceStore:e,currentSpaceViewStore:t}=U.default.state;return{pageStore:c.target,spaceStore:e,spaceViewStore:t,presenceStore:c.presenceStore,pageVisitStore:c.pageVisitStore,publicEditModeStore:u}}),[c,u]),m=(0,o.useCallback)((()=>{$r(d)}),[d]),h=(0,o.useCallback)((e=>{let{startTime:t,endTime:n}=e;const o=c.open?Xn.fm(c.target):void 0;no.default.measure({metricName:"collections.max_scroll_lag_in_session",startTime:t,endTime:n},{environment:d,data:eo.vS(o)})}),[d,c]),g=(0,o.useCallback)((()=>{!function(e){Hr(e,"empty_space_click")}(d)}),[d]);return(0,o.useEffect)((()=>{c.open&&c.mode===ao.PeekModeCenter?k.setOverlay(!0):k.setOverlay(!1)}),[c.open,c.mode]),(0,$.jsx)(Kn.Mi,{value:p,children:(0,$.jsx)("div",{role:"region","aria-label":l.formatMessage({id:"peekRenderer.ariaLabel",defaultMessage:"Side Peek"}),"aria-hidden":!c.open||void 0,style:s.containerStyles,className:Jn.p1Q,children:c.open&&(0,$.jsxs)($.Fragment,{children:[t&&(0,$.jsx)("div",{style:{width:"100%",height:"100%"},onClick:g}),(0,$.jsxs)("div",{style:s.contentStyles,children:[r&&(0,$.jsx)(yo.Z,{type:"peek"}),(0,$.jsx)(Dr,{}),(0,$.jsx)(So.Z,{store:c.target,isDefaultContainer:!0,droppable:!0,isPeekRenderer:!0,render:e=>{let{selectableEvents:t,selectableHoverMenuOverlay:n}=e;return(0,$.jsx)(o.Suspense,{fallback:(0,$.jsx)(go.Z,{peekMode:ao.default.getPeekMode(),isVisible:!0,store:c.target}),children:(0,$.jsx)(fo.Z,{pageStore:c.target,pageVisitStore:c.pageVisitStore,initialChunkSize:25,incrementChunkSize:25,store:c.loadingContainerStore,render:e=>{let{ready:r,initialRequestCompleted:s,endOfResultsReached:l,isCollectionInPage:p}=e;return(0,$.jsxs)(o.Fragment,{children:[(0,$.jsxs)(ho.Z,{ref:a,onScrollLagMeasure:p?h:void 0,preventType:r?on.Q7(d):oo.Z.All,type:oo.Z.Y,style:{display:"flex",flexDirection:"column",flexGrow:1,position:"relative",transform:"translateZ(0)",...r?{}:Kr},store:lo.Z,...t,children:[n,(0,Se.GD)(u.state)&&(0,$.jsx)(me.GC,{scrollerStore:lo.Z}),s&&(0,$.jsxs)(o.Fragment,{children:[(0,$.jsx)(i.LazyScrollableSitesBannerContainer,{blockStore:c.target}),(0,$.jsx)(vo.ZP,{context:so.S.PeekView,store:c.target,onTitleEsc:m,forceSelectTitleOnMount:!0,paddingBottom:80,styleOverrides:{pageCoverHeight:`${zr}vh`},disabled:!c.open||c.isClosing}),(0,$.jsx)(bo.Z,{pageVisitStore:c.pageVisitStore,presenceStore:c.presenceStore,isPeekView:!0})]}),r&&!l&&(0,$.jsx)(Ln.Z,{style:{zIndex:1,opacity:.5,width:Gr,height:Gr,marginTop:0,marginBottom:24,marginLeft:"auto",marginRight:"auto"}})]}),(0,$.jsx)(go.Z,{peekMode:ao.default.getPeekMode(),isVisible:!r,store:c.target})]})}})})}},c.target.id),n]})]})})})}function qr(e){return{flexDirection:"column",position:"absolute",display:"flex",marginLeft:"auto",background:e.peekModalBackground,boxShadow:e.largeLightBoxShadow}}const Kr={opacity:0,pointerEvents:"none",height:0},Gr="1.375em";function Hr(e,t){Qn.xv(e,t)}function $r(e){Hr(e,"esc")}const Qr=function(){window.__c={n:"PeekRenderer"};const e=(0,B.O7)(),t=(0,N.VK)((()=>{const e=ao.default.state.open?ao.default.state.target:void 0;return null==e?void 0:e.getSystemBlockTypeStore().getValue()}),[]),n=(0,o.useCallback)((()=>{ao.default.state.open&&ao.default.isSidePeekOpen()&&(Ee.toggleLeftSidebarByWindowSize(e),ao.default.setState({...ao.default.state,isOpening:!1}))}),[e]);switch((0,o.useEffect)((()=>(e.WindowSizeStore.addListener(n),e.WindowSizeStore.removeListener(n))),[e.WindowSizeStore,n]),(0,o.useEffect)((()=>{(0,Hn.u7)(t)&&Qn.xv(e,"invalid_peek_page")}),[e,t]),(0,N.VK)((()=>ao.default.getPeekMode()),[])){case ao.PeekModeCenter:return(0,$.jsx)(Nr,{});case ao.PeekModeSide:return(0,$.jsx)(Vr,{})}};var Yr=n(20993),Xr=n(90965);function Jr(e){let{}=e;window.__c={n:"TransferWorkspaceModalWrapper"};const t=(0,N.VK)((()=>U.default.state.currentSpaceStore),[]),n=(0,N.VK)((()=>{var e;if(!t)return;const n=null===(e=t.getSettings())||void 0===e?void 0:e.space_request;return(0,Xr.DI)(n)?n:void 0}),[t]);return n?(0,$.jsx)(i.LazyTransferWorkspaceModal,{workspaceTransfer:n}):null}class ei extends s.Z{constructor(){super(...arguments),this.appRenderState=this.createComputedStore((()=>be.h1(this.environment))),this.showHelpButtonStore=this.createComputedStore((()=>{if(!this.environment.currentUser.isLoggedIn())return!1;if(this.environment.device.isMobile)return!1;const{mainEditorCurrentBlockStore:e}=U.default.state;return!!e&&(!(0,we.IJ)(this.environment,e)&&(!this.shouldIncludeAssistantButton.state&&!this.shouldShowAssistantUpsellButton.state))})),this.isFullPageAssistantChatEnabled=this.createComputedStore((()=>Oe.Z.isFullPageAssistantChatEnabled())),this.shouldIncludeAssistantButton=this.createComputedStore((()=>{const{device:e}=this.environment,{RouterStore:t}=this.environment,{route:n}=t.state;return"chat"!==n.name&&Oe.Z.shouldShowAssistantInCorner(e)})),this.shouldShowAssistantUpsellButton=this.createComputedStore((()=>{var e;const{inAppCalloutStore:t,currentUserSettingsStore:n}=U.default.state;if(!t.canShow("ai_add_on_upsell"))return!1;const{device:o}=this.environment,{RouterStore:r}=this.environment,{route:i}=r.state;if("chat"===i.name)return!1;const s=(null===(e=Xe.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];if((0,de.de)(s))return!1;if(void 0!==(null==n?void 0:n.getSettingsStore().getKeyStore("ai_qna_upsell_dismissed_at").getValue()))return!1;const a=Re.Z.state;if(!a.loaded)return!1;const l=a.isOnWaitlist&&(0,le.zz)(a.spaceRole),d=!a.isOnWaitlist&&(0,le.Jy)(a.spaceRole);return!(!l&&!d||!Oe.Z.shouldShowAssistantUpsellInCorner(o))}))}UNSAFE_willMount(){be.rq()}didMount(){var e;null!==(e=this.environment.mobileNative)&&void 0!==e&&e.api.appComponentMountState&&this.environment.mobileNative.api.appComponentMountState(!0)}willUnmount(){var e;null!==(e=this.environment.mobileNative)&&void 0!==e&&e.api.appComponentMountState&&this.environment.mobileNative.api.appComponentMountState(!1)}renderComponent(){const{isElectronMac:e,isMobile:t}=this.environment.device,{RouterStore:n}=this.environment,{route:o}=n.state,{mainEditorCurrentBlockStore:r,currentSpaceStore:s,currentUserRootStore:a,currentCollectionViewStore:l}=U.default.state,{publicPageData:d}=Ze.Z.state,c=this.environment.currentUser.isLoggedIn(),u=je.sidebarOpenStore.state,g=(0,Ae.in)(this.environment),{state:{shouldShowSidebar:f,shouldShowFrame:v,shouldShowError:b}}=this.appRenderState,S="page"===o.name&&o.shouldDuplicate&&r&&(0,we.S4)(r),y="page"===o.name&&r&&ve.Z.state.open&&(0,we.S4)(ve.Z.state.blockStore),w=!c&&"modal"===o.name&&(o.templateGalleryItem||o.projectManagementLaunch),k="page"===o.name&&o.workspaceId?o.workspaceId:void 0,x=(0,m.wO)(o)&&a||"nativeTab"===o.name&&a||"quickSearch"===o.name&&a||a||r,C="nativeTab"===o.name&&"search"===o.tab||"quickSearch"===o.name,M=this.isFullPageAssistantChatEnabled.state&&"chat"===o.name,I="quickSearch"===o.name,E="nativeTab"===o.name,T=(0,Ue.Y)("supportsNativeHome"),j=ae("production",this.environment.device)||!(0,Ue.Y)("supportsNativeSearch"),L=(0,Ce.H7)(),P=(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(i.LazySidebarCreateTeamModal,{}),(0,$.jsx)(i.LazySidebarTeamModal,{}),(0,$.jsx)(i.LazyCreateTeamFromPageConfirmModal,{}),(0,$.jsx)(i.LazyConfirmPrivilegedActionModal,{})]});ue.wk({environment:this.environment});const A=Xe.subscriptionDataStoreInstance.state;if(w){const{environment:e}=this;return o.projectManagementLaunch?pe.j({currentUserId:void 0,params:{tg:"gallery"}}):o.templateGalleryItem&&pe.j({currentUserId:void 0,params:{tg:o.templateGalleryItem}}),void _.c4({environment:e,url:h._j.login})}return I?(0,$.jsxs)(ft.Z,{style:oi(this.environment,this.theme),children:[x&&!b&&j&&(0,$.jsx)(i.LazySearch,{parentStore:x,renderAsPage:!0,renderId:(0,p.ZP)(),quickSearchMode:!0}),"rendered"===U.default.state.renderPhase&&(0,$.jsx)(i.LazyAppComponents,{})]}):(0,$.jsxs)(ft.Z,{style:oi(this.environment,this.theme),children:[f&&!t&&(0,$.jsx)(ti,{isElectronMac:e,isExpanded:g}),f&&t&&!T&&(0,$.jsx)(i.LazySidebarMobile,{}),f&&t&&T&&(0,$.jsx)(i.LazyTopLevelMobileComponents,{}),f&&L&&(0,$.jsx)(xe.HX,{}),(0,$.jsx)(gt,{}),(0,$.jsx)(re.R,{}),"workspaceSetup"===o.name&&(0,$.jsx)(i.LazyAppsSetup,{}),r&&v&&(0,$.jsx)(Dn.Z,{routerState:this.props.routerState,store:r,collectionViewStore:l}),M&&"chat"===o.name&&(0,$.jsx)(ge.PS,{route:o}),S?(0,$.jsx)(Bn,{blockId:o.blockId,workspaceId:k,tid:o.tid,from:o.from}):y&&(0,$.jsx)(i.LazyForkPageModal,{}),b&&d&&!S&&!y&&(0,$.jsx)(i.LazyPageError,{route:this.props.routerState.route,publicPageData:d}),f&&!(0,Ae.Jr)(this.environment)&&u&&(0,$.jsx)(ii,{}),(0,$.jsx)(yt,{}),this.showHelpButtonStore.state&&(0,$.jsx)(Fn.Z,{}),this.shouldIncludeAssistantButton.state&&(0,$.jsx)(ge.eC,{}),this.shouldIncludeAssistantButton.state?(0,$.jsx)(ge.Q,{}):this.shouldShowAssistantUpsellButton.state?(0,$.jsx)(ge.F$,{}):void 0,r&&(0,$.jsx)(yn,{pageStore:r,environment:this.environment}),(0,Se.GD)(void 0)&&(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(he.u7,{}),(0,$.jsx)(me.oF,{})]}),(0,ye.u)(this.environment)&&(0,$.jsx)(Ht,{}),!t&&"nativeTab"!==this.props.routerState.route.name&&"workspaceSetup"!==this.props.routerState.route.name&&(0,$.jsx)(Qr,{}),"rendered"===U.default.state.renderPhase&&(0,$.jsxs)($.Fragment,{children:[c&&(0,$.jsxs)($.Fragment,{children:[P,(0,$.jsx)(ke,{}),(0,$.jsx)(i.LazyCustomizePageMenuRenderer,{}),(0,$.jsx)(i.LazyTopbarPageAnalyticsOptOutMenu,{}),(0,$.jsx)(i.LazyImportModal,{}),(0,$.jsx)(i.LazyExportModal,{}),(0,$.jsx)(i.LazyImportIntoNewPageModal,{}),(0,$.jsx)(i.LazyPageTemplateModal,{}),(0,$.jsx)(i.LazyTemplateGalleryModal,{}),(0,$.jsx)(i.LazyGoogleAuthPromptModal,{}),(0,$.jsx)(i.LazyStudentNotEligibleModal,{}),(0,$.jsx)(i.LazyTypedDBMigrationModal,{}),(0,$.jsx)(i.LazyContactModal,{}),(0,$.jsx)(i.LazyCookieModal,{}),(0,$.jsx)(i.LazyAutomationModal,{}),Be.Z.state.open&&(0,$.jsx)(i.LazyConfirmOverwriteModal,{...Be.Z.state}),Ie.Z.state.open&&(0,$.jsx)(i.LazyTipsInAppModal,{...Ie.Z.state}),(0,$.jsx)(i.LazyConfigureIntegrationModal,{}),(0,$.jsx)(i.LazyConnectOAuthIntegrationModal,{}),s&&A&&Ne.Z.state.open&&(0,$.jsx)(i.LazySpaceSubscriptionUpgradeModal,{data:A,spaceStore:s}),s&&A&&Ye.Z.state.open&&(0,$.jsx)(i.LazyClaimAndUpgradeModal,{spaceStore:s,data:A}),s&&A&&(0,$.jsx)(i.LazySpaceSubscriptionUpdateModal,{data:A}),s&&A&&(0,$.jsx)(i.LazyAddOnUpgradeModal,{data:A}),s?(0,$.jsx)(i.LazySubscriptionDebugCommands,{}):null,v&&(0,$.jsx)(i.LazyOpenInDesktopAppPopup,{}),v&&(0,$.jsx)(i.LazyWikiPromoPopup,{}),v&&(0,$.jsx)(i.LazyAddOnDiscountPopup,{}),v&&(0,$.jsx)(i.LazyNotionCalendarLaunchModal,{}),v&&(0,$.jsx)(i.LazyAiQnaIntroModal,{}),v&&(0,$.jsx)(i.LazyAiQnaWaitlistModal,{}),v&&(0,$.jsx)(i.LazyEnterpriseLaunchModal,{})]}),(0,$.jsx)(i.LazyReportPageModal,{}),x&&!b&&j&&(0,$.jsx)(i.LazySearch,{parentStore:x,renderAsPage:C,renderId:C?(0,p.ZP)():void 0,quickSearchMode:!1}),E&&(0,$.jsx)(i.LazyMobileNativeFullPageComponents,{route:o}),(0,$.jsx)(i.LazyForkPagePopup,{}),void 0,(0,$.jsx)(Jr,{}),void 0]}),(0,$.jsx)(Ft,{}),"rendered"===U.default.state.renderPhase&&(0,$.jsx)(kt,{}),"rendered"===U.default.state.renderPhase&&(0,$.jsx)(i.LazyAppComponents,{}),(0,$.jsx)(zt,{}),f&&!t&&r&&(0,$.jsx)(xe.$H,{currentBlockStore:r,isElectronMac:e}),(0,$.jsx)(i.LazyAdminModeBannerListener,{}),(0,$.jsx)($e.Z,{}),(0,$.jsx)(Qe.Z,{}),(0,$.jsx)(Yr.Z,{subscriptionDataStore:Xe.subscriptionDataStoreInstance}),(0,$.jsx)(He,{}),(0,$.jsx)(Fe,{}),(0,$.jsx)(fe.j,{}),(0,$.jsx)(it,{}),(0,$.jsx)(qn,{})]})}}function ti(e){let{isElectronMac:t,isExpanded:n}=e;window.__c={n:"AppLazySidebarComponent"};const r=(0,o.useCallback)((()=>(0,$.jsx)(Le,{})),[]);return(0,$.jsx)(i.LazySidebarComponent,{isElectronMac:t,isExpanded:n,renderLoading:r})}ei.displayName="App";const ni=ei;function oi(e,t){const{mainEditorCurrentBlockStore:n}=U.default.state,o=(0,Me.WE)(n),r=e.device.isPhone;return{width:"100vw",height:"100%",position:"relative",display:"flex",flex:1,background:o?(0,_e.$1)({theme:t,isPhone:r}):t.contentBackground}}function ri(){Ee.close()}function ii(){window.__c={n:"MobileSidebarFrameBlockerComponent"};const e=(0,B.O7)(),t=(0,N.VK)((()=>function(e){return{position:"absolute",top:0,left:(0,Ae.qG)(e),right:0,bottom:0,zIndex:ce.l6}}(e)),[e]);return(0,$.jsx)("div",{style:t,onClick:ri})}var si=n(3403);var ai=n(40754);function li(e){let{payload:t}=e;window.__c={n:"ConfirmUnsubscribePage"};const n=(0,B.O7)(),[r,i]=(0,o.useState)(t?{type:"unconfirmed"}:{type:"error"}),s=(0,o.useCallback)((async()=>{if(!t)return void i({type:"error"});i({type:"loading"});const e=await async function(e){let{environment:t,payload:n}=e;const o=await qe.unsubscribeFromEmails(t,{payload:n});return"success"===o.type?{type:"success",spaceName:o.data.spaceName}:{type:"error"}}({environment:n,payload:t});i("error"===e.type?{type:"error"}:{type:"confirmed",spaceName:e.spaceName})}),[n,t]),a=(0,V.yK)((()=>({confirmUnsubscribeDescription:{marginBottom:10}})),[]);switch(r.type){case"loading":return(0,$.jsx)(ai.Z,{children:(0,$.jsx)(y.FormattedMessage,{defaultMessage:"Loading…",id:"confirmUnsubscribePage.loadingMessage"})});case"unconfirmed":return(0,$.jsxs)(ai.Z,{children:[(0,$.jsx)("div",{style:a.confirmUnsubscribeDescription,children:(0,$.jsx)(y.FormattedMessage,{defaultMessage:"Are you sure you want to unsubscribe from this list?",id:"unsubscribeFromEmails.workspace.confirmUnsubscribeDescription"})}),(0,$.jsx)(W.Z,{isLarge:!0,onClick:s,analyticsName:"unsubscribe_confirm",children:(0,$.jsx)(y.FormattedMessage,{id:"confirmUnsubscribePage.confirmButton",defaultMessage:"Unsubscribe"})})]});case"confirmed":return(0,$.jsx)(ai.Z,{children:(0,$.jsx)(y.FormattedMessage,{defaultMessage:"You have successfully unsubscribed from emails for {workspaceName}",values:{workspaceName:(0,$.jsx)("b",{children:r.spaceName})},id:"unsubscribeFromEmails.workspace.message"})});case"error":return(0,$.jsx)(ai.Z,{children:(0,$.jsx)(y.FormattedMessage,{id:"confirmUnsubscribePage.errorMessage",defaultMessage:"Could not unsubscribe."})});default:(0,nn.t1)(r)}}n(82801);var di=n(32441);const ci=(0,y.defineMessages)({pageTitle:{id:"desktopEmailConfirmPage.title",defaultMessage:"Please check your email to confirm"},pageCaption:{id:"desktopEmailConfirmPage.subtitle",defaultMessage:"Almost there!"},pageDescription1:{id:"desktopEmailConfirmPage.description1",defaultMessage:"Please check your email and click the link to confirm."},pageDescription2:{id:"desktopEmailConfirmPage.description2",defaultMessage:"Once confirmed, you'll be able to return to the desktop app to complete signup."},checkYourGmail:{id:"desktopEmailConfirmPage.button.checkYourGmail",defaultMessage:"Check your Gmail inbox"}}),ui=()=>(0,$.jsxs)("svg",{style:{display:"block",height:42},viewBox:"0 0 87 30",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,$.jsx)("path",{d:"M1.805 1.294l16.6-1.226c2.039-.175 2.563-.057 3.845.875l5.299 3.733c.874.642 1.165.817 1.165 1.516v20.473c0 1.283-.466 2.042-2.097 2.158L7.34 29.99c-1.224.058-1.807-.117-2.448-.934L.99 23.982c-.7-.934-.99-1.633-.99-2.45V3.334c0-1.049.466-1.924 1.805-2.04z",fill:"#fff"}),(0,$.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.405.068l-16.6 1.226C.466 1.41 0 2.285 0 3.334v18.198c0 .817.29 1.516.99 2.45l3.902 5.074c.641.817 1.224.992 2.448.934l19.277-1.167c1.63-.116 2.097-.875 2.097-2.158V6.192c0-.663-.262-.854-1.033-1.42a85.473 85.473 0 01-.133-.096L22.25.943c-1.282-.932-1.806-1.05-3.845-.875zM7.776 5.857c-1.574.106-1.931.13-2.825-.597L2.678 3.452c-.231-.234-.115-.526.467-.584l15.958-1.166c1.34-.117 2.038.35 2.562.758l2.737 1.983c.117.059.408.408.058.408l-16.48.992-.204.014zM5.941 26.49V9.11c0-.759.233-1.109.931-1.168L25.8 6.834c.642-.058.932.35.932 1.108v17.264c0 .759-.117 1.401-1.165 1.459l-18.113 1.05c-1.048.058-1.513-.291-1.513-1.225zm17.88-16.448c.116.525 0 1.05-.525 1.11l-.873.173v12.832c-.758.408-1.456.641-2.039.641-.932 0-1.165-.292-1.863-1.166l-5.709-8.982v8.69l1.806.409s0 1.05-1.457 1.05l-4.017.233c-.117-.234 0-.817.407-.933l1.049-.291v-11.49L9.144 12.2c-.117-.525.174-1.283.99-1.342l4.31-.29 5.94 9.098v-8.049l-1.514-.174c-.117-.643.349-1.11.931-1.167l4.02-.234z",fill:"#000"}),(0,$.jsx)("path",{className:"fill",d:"M41.434 21.251v-7.91h.137l5.704 7.91h1.796V9.627h-1.997v7.902h-.137l-5.704-7.902H39.43V21.25h2.005zM54.715 21.429c2.635 0 4.238-1.724 4.238-4.584 0-2.852-1.611-4.584-4.238-4.584-2.618 0-4.237 1.74-4.237 4.584 0 2.86 1.595 4.584 4.237 4.584zm0-1.676c-1.393 0-2.19-1.063-2.19-2.908 0-1.837.797-2.908 2.19-2.908 1.386 0 2.183 1.071 2.183 2.908 0 1.845-.789 2.908-2.183 2.908zM60.778 10.28v2.215h-1.393v1.595h1.393v4.809c0 1.708.806 2.393 2.828 2.393.386 0 .757-.04 1.047-.097v-1.563c-.242.024-.395.04-.677.04-.837 0-1.208-.386-1.208-1.256V14.09h1.885v-1.595h-1.885v-2.216h-1.99zM65.85 21.251h1.99v-8.813h-1.99v8.813zm.991-10.27c.66 0 1.192-.533 1.192-1.201 0-.669-.531-1.209-1.192-1.209-.652 0-1.192.54-1.192 1.209 0 .668.54 1.2 1.192 1.2zM73.299 21.429c2.634 0 4.237-1.724 4.237-4.584 0-2.852-1.611-4.584-4.237-4.584-2.619 0-4.238 1.74-4.238 4.584 0 2.86 1.595 4.584 4.238 4.584zm0-1.676c-1.394 0-2.192-1.063-2.192-2.908 0-1.837.798-2.908 2.192-2.908 1.385 0 2.183 1.071 2.183 2.908 0 1.845-.79 2.908-2.183 2.908zM78.725 21.251h1.998V16.12c0-1.297.75-2.119 1.941-2.119 1.217 0 1.78.677 1.78 2.022v5.228h1.999v-5.703c0-2.103-1.072-3.287-3.037-3.287-1.314 0-2.2.604-2.619 1.587h-.137v-1.41h-1.925v8.813z",fill:"#000"})]});function pi(){return(0,$.jsx)("div",{style:{padding:24},children:(0,$.jsx)(ui,{})})}function mi(e){const{experimentVariant:t}=e;return(0,$.jsx)("div",{style:{width:800,height:"80vh",margin:"0 auto"},children:(0,$.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"80vh"},children:[(0,$.jsxs)(mn.sg,{gap:16,padding:16,children:[(0,$.jsx)("div",{style:{fontSize:36,fontWeight:z.Z.fontWeight.bold},children:(0,$.jsx)(y.FormattedMessage,{...ci.pageTitle})}),(0,$.jsx)("div",{style:{fontWeight:z.Z.fontWeight.bold},children:(0,$.jsx)(y.FormattedMessage,{...ci.pageCaption})}),(0,$.jsx)("div",{children:(0,$.jsx)(y.FormattedMessage,{...ci.pageDescription1})}),(0,$.jsx)("div",{children:(0,$.jsx)(y.FormattedMessage,{...ci.pageDescription2})}),"with_gmail_cta"===t&&(0,$.jsx)(W.Z,{style:{width:"fit-content"},isLarge:!0,onClick:()=>{window.location.href="https://mail.google.com/mail/u/0/#search/Your+Notion+signup+code+is"},children:(0,$.jsx)(y.FormattedMessage,{...ci.checkYourGmail})})]}),(0,$.jsx)(mn.sg,{children:(0,$.jsx)("img",{style:{width:350},src:xt.Z.images.onboarding.couch2Png})})]})})}function hi(){window.__c={n:"DesktopEmailConfirmPage"};const e=(0,B.O7)(),[t,n]=(0,o.useState)(null);return(0,o.useEffect)((()=>{try{const t=new URLSearchParams(window.location.search).get("state");if(!t)return;const o=JSON.parse(atob(t));o.experimentVariant&&n(o.experimentVariant),o.email&&o.deviceId&&di.$k(e,{desktopAppRerouteEmail:o.email,desktopAppDeviceId:o.deviceId})}catch(t){}}),[e,n]),(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(pi,{}),(0,$.jsx)(mi,{experimentVariant:t})]})}n(23586),n(84456),n(53238);var gi=n(13559),fi=n(44819);function vi(e){window.__c={n:"FrontFallbackPage"};const{preventFrontRedirect:t}=e,n=(0,B.O7)(),{pathname:o,search:r,hash:s}=window.location;if(!t&&(0,fi.XR)(n,o)){const e=r.length>0?`${r}&${gi.AM}=1`:`?${gi.AM}=1`;return window.location.href=o+e+s,null}return(0,$.jsx)(i.LazyFrontLoginPage,{isSignup:!n.currentUser.isLoggedIn()})}var bi=n(26198);class Si extends s.Z{constructor(){super(...arguments),this.intersectionObserver=void 0,this.registry=new Map,this.handleIntersectionObserverEntries=(e,t)=>{for(const n of e){if(!(n.target instanceof HTMLElement))continue;const e=this.registry.get(n.target);e&&(e.isVisible=n.isIntersecting,e.latestTimestamp=n.time,e.isVisible&&!e.isSpawned&&(e.isSpawned=!0,e.onVisibilityChange(!0)))}this.despawnOldFrames()}}UNSAFE_willMount(){void 0!==window.IntersectionObserver&&(this.intersectionObserver=new IntersectionObserver(this.handleIntersectionObserverEntries))}willUnmount(){this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.intersectionObserver=void 0)}didUpdate(e){this.props.maxPreferredIFrames<e.maxPreferredIFrames&&this.despawnOldFrames()}despawnOldFrames(){const e=Array.from(this.registry.values()).filter((e=>e.isSpawned)),t=e.length-this.props.maxPreferredIFrames;if(t<=0)return;const n=e.filter((e=>!e.isVisible));n.sort(((e,t)=>e.latestTimestamp-t.latestTimestamp));for(const o of n.slice(0,t))o.isSpawned=!1,o.onVisibilityChange(!1)}track(e,t){this.intersectionObserver?(this.registry.set(e,{isVisible:!1,isSpawned:!1,latestTimestamp:0,onVisibilityChange:at.Ds(t,50)}),this.intersectionObserver.observe(e)):bi.uf.track(e,t)}untrack(e){this.intersectionObserver?(this.intersectionObserver.unobserve(e),this.registry.delete(e)):bi.uf.untrack(e)}renderComponent(){return(0,$.jsx)(bi.Lr.Provider,{value:this,children:this.props.children})}}function yi(e){let t=e.isMobile?10:50;return e.ramSizeInGB&&(t=Math.floor(2*e.ramSizeInGB)),{maxPreferredIFrames:t}}Si.displayName="IFrameManager";var wi=n(25777);const ki=function(e){window.__c={n:"Index"};const t=(0,B.O7)(),n={position:"absolute",top:0,left:0,bottom:0,right:0},{device:o}=t;return t.currentUser.isLoggedIn()?(0,$.jsx)("div",{style:n,children:(0,$.jsx)(wi.Z,{style:{width:"100%",height:"100%"},spinnerSize:Dn.T,showSpinnerTimeout:500})}):o.isElectron?(0,$.jsx)(i.LazyLoginDesktop,{}):o.isMobileNative?(0,$.jsx)(i.LazyLoginMobileNative,{}):(0,$.jsx)(vi,{preventFrontRedirect:!0})};var xi=n(42402),Ci=n(83785),Mi=n(84076);class _i extends s.Z{didMount(){Ei(this.props.redirect,this.environment)}renderComponent(){return(0,$.jsxs)(ai.Z,{children:[(0,$.jsx)("div",{style:{color:this.theme.regularTextColor},children:(0,$.jsx)(y.FormattedMessage,{defaultMessage:"Redirecting to your Notion app…",id:"webApp.redirectingToDesktop.message"})}),(0,$.jsx)(Mi.Z,{onClick:()=>Ei(this.props.redirect,this.environment),style:{maxWidth:300,textAlign:"center",textDecoration:"underline",color:this.theme.lightTextColor},children:(0,$.jsx)(y.FormattedMessage,{defaultMessage:"If you weren't redirected, click here.",id:"webApp.redirectingToDesktop.directLink.message"})}),(0,$.jsx)(Mi.Z,{href:this.props.redirect,style:{maxWidth:300,textAlign:"center",textDecoration:"underline",color:c.ZP.uiGray},children:(0,$.jsx)(y.FormattedMessage,{defaultMessage:"Or, continue in your browser",id:"webApp.redirectingToDesktop.continueInBrowser.message"})})]})}}_i.displayName="NativeRedirect";const Ii=_i;function Ei(e,t){_.RX({url:e,environment:t})}var Ti=n(84747),ji=n(93214),Li=n(24211),Pi=n(35793),Ai=n(47307),Ui=n(57400),Ri=n(4615),Zi=n(97978);const Oi=6e4;async function Bi(e){var t,n;void 0!==U.default.state.currentUserStore&&void 0!==U.default.state.currentSpaceStore||await U.default.waitUntil((()=>void 0!==U.default.state.currentUserStore&&void 0!==U.default.state.currentSpaceStore));const o=null===(t=U.default.state.currentUserStore)||void 0===t?void 0:t.id,r=null===(n=U.default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(!document.hasFocus())return;if(!o||!r)return;const i=Zi.Cd({userId:o,spaceId:r}),s=Date.now();i?Zi.ci({userId:o,spaceId:r,session:{...i,lastFocusedTime:s}}):Zi.ci({userId:o,spaceId:r,session:{id:(0,Ri.ZP)(),sessionStartTime:s,lastFocusedTime:s}})}var Ni=n(54064),Vi=n(88632),Di=n(29755),Fi=n(17963);const zi=new Ni.Z;var Wi=n(22974),qi=n(30021);var Ki=n(12321),Gi=n(81236);function Hi(){const e=(0,B.O7)(),{currentUserRootStore:t}=(0,N.VK)((()=>U.default.state),[]);(0,o.useEffect)((()=>{t&&async function(e,t){await Ki.w();const n=t.getSpaceViewStores();for(const o of n){const t=o.getBookmarkedPageStores();for(const e of t)$i(e);const n=o.getSharedPageStores();for(const e of n)$i(e);const r=o.getTeamsStores();for(const e of r){const t=e.getTeamPagesStores();for(const e of t)$i(e)}const i=o.getSpaceStore();if(i){Gi.Z.getPublicSpaceData(e,i.id);const t=(0,Fo.XD)(e,i);for(const e of t)$i(e)}}}(e,t)}),[t,e])}function $i(e){e.load();const t=e.getCollectionViewSourceOrLinkCollectionStores();for(const n of t)n.load()}var Qi=n(32223);async function Yi(e){if(e.device.isBrowser&&document.hidden)return;if(e.device.isElectron&&!(await k.isWindowVisible()))return;if(Qi.isConnected())return void Xi(!0);if(!1===navigator.onLine&&!P.default.isLocalhost)return void Xi(!1);"success"===(await qe.ping(e,{})).type?Xi(!0):Xi(!1)}function Xi(e){Vi.Z.setState({...Vi.Z.state,online:e,lastOfflineTimestamp:e?Vi.Z.state.lastOfflineTimestamp:Date.now()})}const Ji=5e3;var es=n(24042);var ts=n(64496);const ns=6e5;function os(e){(0,ts._3)(e)?Ui.Tm(e):Ui.Th({environment:e,force:!1})}var rs=n(24608);function is(e){(0,rs.ZP)({url:`${P.default.secureFileConfig.rootPath}/refresh`,environment:e,method:"GET",format:"text"})}const ss=at.P2(zn.XW,5e3);var as=n(55632),ls=n(58455);var ds=n(62134),cs=n(45023);var us=n(24502);var ps=n(14577),ms=n(69454);const hs=new ps.Z((()=>{const e=ms.Z.state;return e.phase===ms.i.willShow?0:e.estimatedKeyboardWebViewOverlap}),{debugName:"estimatedKeyboardWebViewOverlapStore"});var gs=n(4993),fs=n(30583);var vs=n(2449),bs=n(85844);var Ss=n(98104),ys=n(89224),ws=n(59238);const ks=window.matchMedia("(prefers-color-scheme: dark)");var xs=n(98794),Cs=n(27534);const Ms="loadCachedPageChunk";var _s=n(82530);var Is=n(64964);var Es=n(54153),Ts=n(35253),js=n(91754),Ls=n(10854),Ps=n(73329);class As extends s.Z{constructor(){super(...arguments),this.handleElectronUpdateChecking=()=>{const{AppUpdateStore:e}=this.environment;e.setState({appUpdate:e.state.appUpdate,electronUpdate:{state:"checking"}})},this.handleElectronUpdateError=(e,t)=>{const{AppUpdateStore:n}=this.environment;n.setState({appUpdate:n.state.appUpdate,electronUpdate:{state:"error",error:t}})},this.handleElectronUpdateNotAvailable=()=>{const{AppUpdateStore:e}=this.environment;e.setState({appUpdate:e.state.appUpdate,electronUpdate:{state:"no-update",timestamp:Date.now()}})},this.handleElectronUpdateAvailable=(e,t)=>{const{AppUpdateStore:n}=this.environment,o=(0,se.parseVersion)(t.version),r=k.getDesktopVersion(),i=(0,se.getUpdateType)({currentVersion:r,nextVersion:o,app:"desktop"});n.setState({appUpdate:n.state.appUpdate,electronUpdate:{state:"downloading",type:i,version:o,timestamp:Date.now(),progress:0}})},this.handleElectronUpdateProgress=(e,t)=>{const{AppUpdateStore:n}=this.environment,o=n.state;o.electronUpdate&&"downloading"===o.electronUpdate.state&&n.setState({appUpdate:o.appUpdate,electronUpdate:{...o.electronUpdate,progress:t.transferred/t.total}})},this.handleElectronUpdateReady=(e,t)=>{const{device:n}=this.environment,{AppUpdateStore:o}=this.environment,r=Es.Z.get(Ls.Tm),i=t.version;if(r===i){if(n.isMac)return o.setState({appUpdate:o.state.appUpdate,electronUpdate:{state:"ready",type:se.UpdateType.Major,version:void 0}}),void Ai.showDialog({message:(0,$.jsx)(y.FormattedMessage,{id:"desktopAppUpdater.moveNotionToApplicationsFolderDialog.prompt",defaultMessage:"Please move the Notion app into the Applications folder for the auto-updater to work."}),showCancel:!1,keepFocus:!1,handleCancel:()=>(0,Ls.mK)(this.environment),items:[{label:(0,$.jsx)(y.FormattedMessage,{id:"desktopAppUpdater.moveNotionToApplicationsFolderDialog.dismissButton.label",defaultMessage:"Okay"}),onAccept:()=>(0,Ls.mK)(this.environment)}]});ir.log({level:"error",from:"AppUpdateListener",type:"electronUpdateFailed",data:{miscDataToConvertToString:{previousUpdateReady:r,nextUpdateReady:i}}})}const s=k.getDesktopVersion(),a=(0,se.parseVersion)(t.version),l=(0,se.getUpdateType)({currentVersion:s,nextVersion:a,app:"desktop"});o.setState({appUpdate:o.state.appUpdate,electronUpdate:{state:"ready",type:l,version:a}})},this.handleAppUpdateChecking=()=>{const{AppUpdateStore:e}=this.environment;e.state.appUpdate&&"ready"===e.state.appUpdate.state||e.setState({electronUpdate:e.state.electronUpdate,appUpdate:{state:"checking"}})},this.handleElectronAppUpdateError=(e,t)=>{Os(t,this.environment)},this.handleAppUpdateNotAvailable=()=>{const{AppUpdateStore:e}=this.environment;e.state.appUpdate&&"ready"===e.state.appUpdate.state||e.setState({electronUpdate:e.state.electronUpdate,appUpdate:{state:"no-update",timestamp:Date.now()}})},this.handleElectronAppUpdateAvailable=(e,t)=>{Bs(t,this.environment)},this.handleElectronAppUpdateProgress=(e,t)=>{Ns(t,this.environment)},this.handleElectronAppUpdateReady=(e,t)=>{Vs(t,this.environment)},this.handleAppUpdateReload=e=>{Ts.Js({bannerStore:Ps.Z}),vs.hC({environment:this.environment,url:window.location.href,version:e})},this.handleElectronAppUpdateInstall=()=>{const e=this.environment.AppUpdateStore;if(Vi.Z.getState().online&&e.isSilentUpdate()){const t=e.state.appUpdate;vs.hC({environment:this.environment,url:window.location.href,version:t.version})}},this.pollForAppJsUpdates=async()=>{let e="";for(await new Promise((e=>setTimeout(e,5e3)));this.componentIsMounted;){if(void 0===bs.Z.state.isVisible||!0===bs.Z.state.isVisible)try{const t=vs.ac(),n=await qe.getAssetsJsonV2(this.environment,{hash:e});if("success"===n.type){const o=n.data;if("version"in o){const e=(0,se.parseVersion)(o.version);e&&((0,se.isEqualVersion)(e,t)||Vs(o,this.environment))}"hash"in o&&(e=o.hash||"")}}catch(t){}await new Promise((e=>setTimeout(e,6e4)))}}}didMount(){const{device:e,mobileNative:t}=this.environment;if(e.isElectron?(k.electronUpdateReady.addListener(this.handleElectronUpdateReady),k.electronUpdateError.addListener(this.handleElectronUpdateError),k.electronUpdateChecking.addListener(this.handleElectronUpdateChecking),k.electronUpdateAvailable.addListener(this.handleElectronUpdateAvailable),k.electronUpdateProgress.addListener(this.handleElectronUpdateProgress),k.electronUpdateNotAvailable.addListener(this.handleElectronUpdateNotAvailable),k.appUpdateReady.addListener(this.handleElectronAppUpdateReady),k.appUpdateError.addListener(this.handleElectronAppUpdateError),k.appUpdateChecking.addListener(this.handleAppUpdateChecking),k.appUpdateAvailable.addListener(this.handleElectronAppUpdateAvailable),k.appUpdateInstall.addListener(this.handleElectronAppUpdateInstall),k.appUpdateProgress.addListener(this.handleElectronAppUpdateProgress),k.appUpdateNotAvailable.addListener(this.handleAppUpdateNotAvailable),k.appUpdateReload.addListener(this.handleAppUpdateReload)):t?t.updateReceiveApiHandlers({appUpdateReady:e=>Vs(e,this.environment),appUpdateError:e=>Os(e,this.environment),appUpdateChecking:this.handleAppUpdateChecking,appUpdateAvailable:e=>Bs(e,this.environment),appUpdateProgress:e=>Ns(e,this.environment),appUpdateNotAvailable:this.handleAppUpdateNotAvailable}):P.default.isAdminMode||P.default.isLocalhost&&!P.default.offline||this.pollForAppJsUpdates(),function(e){const t=vs.ac(),n=vs.uG();if(!(0,se.isEqualVersion)(t,n)){0,Zs((0,se.getUpdateType)({currentVersion:t,nextVersion:n,app:"client"}),n,e)}}(this.environment),e.isMobileNative&&t&&t.api.openUpdateSettings){const t=e.osVersion,n=e.isAndroid&&(0,se.isLessThanVersion)(t,[7,0]),o=e.isIOS&&(0,se.isLessThanVersion)(t,[15,0]);(n||o)&&function(e){const{mobileNative:t}=e;if(!t)return;Ts.Bw({bannerStore:Ps.Z,id:"PlatformUpdateWarning",contentKey:"mobile_platform_unsupported",styleKey:js.v.Red})}(this.environment)}}willUnmount(){const{device:e}=this.environment;e.isElectron&&(k.electronUpdateReady.removeListener(this.handleElectronUpdateReady),k.electronUpdateError.removeListener(this.handleElectronUpdateError),k.electronUpdateChecking.removeListener(this.handleElectronUpdateChecking),k.electronUpdateAvailable.removeListener(this.handleElectronUpdateAvailable),k.electronUpdateProgress.removeListener(this.handleElectronUpdateProgress),k.electronUpdateNotAvailable.removeListener(this.handleElectronUpdateNotAvailable),k.appUpdateReady.removeListener(this.handleElectronAppUpdateReady),k.appUpdateError.removeListener(this.handleElectronAppUpdateError),k.appUpdateChecking.removeListener(this.handleAppUpdateChecking),k.appUpdateAvailable.removeListener(this.handleElectronAppUpdateAvailable),k.appUpdateProgress.removeListener(this.handleElectronAppUpdateProgress),k.appUpdateNotAvailable.removeListener(this.handleAppUpdateNotAvailable),k.appUpdateReload.removeListener(this.handleAppUpdateReload))}}As.displayName="AppUpdateListener";const Us=(0,y.injectIntl)(As);async function Rs(e){const t=await async function(e){await U.default.waitUntilRendered();const{mainEditorCurrentBlockStore:t,currentUserStore:n}=U.default.state;return!(!n||!t||(0,we.IJ)(e,t))}(e);t&&Ts.Bw({bannerStore:Ps.Z,id:"AppUpdate",contentKey:"minor_app_update",styleKey:js.v.Blue})}function Zs(e,t,n){e===se.UpdateType.Major?t&&vs.M0(t)?(vs.D$(t),Rs(n)):function(e){Ai.showDialog({message:(0,$.jsx)(y.FormattedMessage,{defaultMessage:"We just launched new features!",id:"breakingUpdateDialog.title"}),showCancel:!1,keepFocus:!1,handleCancel:()=>(0,Ls.mK)(e),items:[{label:(0,$.jsx)(y.FormattedMessage,{defaultMessage:"Update and see what's new",id:"breakingUpdateDialog.updateButtonTitle"}),color:"blue",onAccept:()=>(0,Ls.mK)(e)}],innerStyle:{width:380}})}(n):e===se.UpdateType.Minor?(t&&vs.M0(t)&&vs.D$(t),Rs(n)):t&&vs.M0(t)&&vs.D$(t)}function Os(e,t){const{AppUpdateStore:n}=t;n.state.appUpdate&&"ready"===n.state.appUpdate.state||n.setState({electronUpdate:n.state.electronUpdate,appUpdate:{state:"error",error:e}})}function Bs(e,t){const{AppUpdateStore:n}=t;if(n.state.appUpdate&&"ready"===n.state.appUpdate.state)return;const o=(0,se.parseVersion)(e.version),r=vs.ac(),i=(0,se.getUpdateType)({currentVersion:r,nextVersion:o,app:"client"});n.setState({electronUpdate:n.state.electronUpdate,appUpdate:{state:"downloading",type:i,version:o,timestamp:Date.now(),progress:0}})}function Ns(e,t){const{AppUpdateStore:n}=t,o=n.state;o.appUpdate&&"downloading"===o.appUpdate.state&&n.setState({electronUpdate:o.electronUpdate,appUpdate:{...o.appUpdate,progress:e.downloaded/e.total}})}function Vs(e,t){const{AppUpdateStore:n}=t,o=(0,se.parseVersion)(e.version),r=vs.ac(),i=(0,se.getUpdateType)({currentVersion:r,nextVersion:o,app:"client"});if(!vs.M0(o)){const e={state:"ready",type:i,version:o};n.setState({electronUpdate:n.state.electronUpdate,appUpdate:e})}Zs(i,o,t)}var Ds=n(27328);const Fs=["compact","regular","unknown"];var zs=n(92338),Ws=n(36054),qs=n(74487),Ks=n(83249),Gs=n(73990),Hs=n(97977),$s=n(98958),Qs=n(52423),Ys=n(21862),Xs=n(1357),Js=n(87531),ea=n(24677),ta=n(29974),na=n(12955),oa=n(51783),ra=n(44499),ia=n(45162),sa=n(18514),aa=n(97638);function la(e){const t=(0,Ds.w_)(e);switch(t.type){case"native":return;case"web":const e=t.route;switch(e.name){case"page":return e.collectionViewId?"collection":"page";case"nativeTab":switch(e.tab){case"search":return"search";case"updates":return"updates"}break;default:return}}}var da=n(55081),ca=n(75538),ua=n(49038),pa=n(97799),ma=n(91190),ha=n(36896),ga=n(44604),fa=n(12252),va=n(30581),ba=n(64233),Sa=n(69327),ya=n(475),wa=n(65686),ka=n(53610),xa=n(66881),Ca=n(62820),Ma=n(34583);const _a=(0,y.defineMessages)({failedToMovePageGeneric:{id:"MobileNativeListener.failedToMovePage",defaultMessage:"Failed to move page"}});let Ia;class Ea extends s.Z{constructor(){super(...arguments),this.bottomBarVisibility=this.createComputedStore((()=>{const{currentUserStore:e}=U.default.state,t=Boolean(null==e?void 0:e.id),n=ca.default.state.isOnboarding,o=(0,Ue.Y)("supportsNativeBottomBarOverlappingWebView")?br.Z.hasOpenMobileSlideUps():br.Z.hasOpenPopups(),r="web"!==(0,Ds.w_)(this.environment.TabbedRouterStore.state).type,i=t&&!n&&!o;return(0,Ue.Y)("supportsWebManagedTabNavigation")&&!!r||i})),this.customAddCommentMenuItemEnabled=this.createComputedStore((()=>{var e;if(!(0,Ue.Y)("supportsCustomAddCommentMenuItem"))return!1;const{currentUserStore:t}=U.default.state;if(!Boolean(null==t?void 0:t.id))return!1;if((0,Ue.Y)("supportsNativeBottomBarOverlappingWebView")?br.Z.hasOpenMobileSlideUps():br.Z.hasOpenPopups())return!1;const{TabbedRouterStore:n}=this.environment,o=(0,Ds.w_)(n.state),r="web"===o.type&&((null===(e=o.redirectedTo)||void 0===e?void 0:e.route)||o.route);if(!r||"page"!==r.name)return!1;const i=un.default.state;if("empty"===i.mode)return!1;const s=(0,ia.tp)({multiSelection:i.multiSelection,filterCommonAncestors:!0,focus:void 0});if(!s||0===s.stores.length)return!1;let a=!0;return s.stores.forEach((e=>{a&&(a=a&&e.canComment())})),a})),this.isOnUpdatesPage=this.createComputedStore((()=>{const e=this.environment.TabbedRouterStore.state;return"updates"===e.activeTab&&0===e.tabs.updates.pages.length})),this.aiAssistantEnabledState=this.createComputedStore((()=>{const{currentUserStore:e,currentSpaceStore:t}=U.default.state;if(!e||!t)return;const n=Oe.Z.isShowingQNAOnMobile();return{userId:e.id,spaceId:t.id,enabled:n}})),this.sideBarExpandedStateChangeHandler=()=>{var e;null===(e=this.environment.mobileNative)||void 0===e||e.sidebarVisibility(je.sidebarExpandedStore.state&&!(0,Ae.YR)(this.environment),(0,Ae.qG)(this.environment))},this.bottomBarVisibilityChange=()=>{var e;const t=this.bottomBarVisibility.state;null===(e=this.environment.mobileNative)||void 0===e||e.toggleBottomBar(t)},this.aiAssistantEnabledStateChange=()=>{var e;const t=this.aiAssistantEnabledState.state;t&&(null===(e=this.environment.mobileNative)||void 0===e||e.updateAiAssistantEnabledState(t))},this.handleSwipeNavigation=()=>{const{mobileNative:e,RouterStore:t}=this.environment;if(e&&e.setWebViewAllowsNavigationGestures){const{route:n}=t.state;"onboarding"===n.name||je.sidebarOpenStore.state||wa.Z.getPreventScrollType()!==oo.Z.None?!1!==Ia&&(Ia=!1,e.setWebViewAllowsNavigationGestures(!1)):!0!==Ia&&(Ia=!0,e.setWebViewAllowsNavigationGestures(!0))}},this.handleKeyboardAutoScroll=()=>{ms.Z.state.phase===ms.i.willShow&&$t.default.afterNextFlush((()=>on.hQ(this.environment)))},this.handleMobileNativeKeyboardStore=()=>{if(ms.Z.state.phase===ms.i.hidden){if(ba.Z.state.open)return;const{NativeMobileActionBarStore:e,device:t}=this.environment;if(e&&null!==e.state.menuType&&t.isAndroid)return;Ss.ZH(this.environment)}},this.handleTabbedRouterStoreChange=()=>{var e;const{mobileNative:t,TabbedRouterStore:n}=this.environment,o=null==t||null===(e=t.api)||void 0===e?void 0:e.handleTabbedRouterStateUpdate;if(o){const e=n.state;o({state:e,topPage:(0,Ds.w_)(e),webTransitionType:la(e),updateId:(0,Ri.ZP)()});const t=n.getPreviousState();if(!t)return;const r=(0,Ds.F9)(t),i=(0,Ds.F9)(e);at.Xy(r,i)||Ks.w3(this.environment,{origin:r,destination:i,from:e.navigationSource,action:e.navigationAction,logging_source:"mobile_native"})}},this.handleCustomAddMenuItemEnabledChanged=()=>{if(!(0,Ue.Y)("supportsCustomAddCommentMenuItem"))return;const e=this.customAddCommentMenuItemEnabled.state,{mobileNative:t}=this.environment;null==t||t.updateCustomAddCommentMenuItemEnabled(e)},this.getLocalSearchCache=at.HP((async(e,t)=>(await i.deps.searchActions.loader()).getLocalCacheFromAppState(e)),((e,t)=>{var n;return`${e.currentUser.id}-${(null===(n=U.default.state.currentSpaceViewStore)||void 0===n?void 0:n.id)??"none"}-${t??"none"}`}))}UNSAFE_willMount(){const{mobileNative:e,RouterStore:t,TabbedRouterStore:n,device:o}=this.environment;var r;o.isMobileNative&&e&&(je.sidebarOpenStore.addListener(this.handleSwipeNavigation),je.sidebarExpandedStore.addListener(this.sideBarExpandedStateChangeHandler),va.Z.addListener(this.handleSwipeNavigation),t.addListener(this.handleSwipeNavigation),ms.Z.addListener(this.handleKeyboardAutoScroll),this.bottomBarVisibility.addListener(this.bottomBarVisibilityChange),this.aiAssistantEnabledState.addListener(this.aiAssistantEnabledStateChange),this.environment.WindowSizeStore.addListener(this.sideBarExpandedStateChangeHandler),n.addListener(this.handleTabbedRouterStoreChange),this.customAddCommentMenuItemEnabled.addListener(this.handleCustomAddMenuItemEnabledChanged),e.updateReceiveApiHandlers({statusBarTap:Aa,backButtonPress:()=>ds.Zm(this.environment,{type:"backbutton"}),keyboardWillShow:e=>{ms.Z.updateKeyboardPhase(this.environment,ms.i.willShow,e??0)},keyboardDidShow:e=>ms.Z.updateKeyboardPhase(this.environment,ms.i.shown,e??0),keyboardWillHide:()=>{ms.Z.updateKeyboardPhase(this.environment,ms.i.willHide,0)},keyboardDidHide:()=>{var e;(ms.Z.updateKeyboardPhase(this.environment,ms.i.hidden,0),o.isIpad)&&(ea.ZH(this.environment),null===(e=this.environment.NativeMobileActionBarStore)||void 0===e||e.clear(!0))},keyboardShortcut:e=>ds.Zm(this.environment,e),pushNotificationTokenRefresh:e=>$s.handleTokenRefresh(this.environment,e,"refresh"),resume:fa.Z.resume,pause:fa.Z.pause,refreshSubscriptionData:async e=>{await qe.invalidateSubscriptionData(this.environment,{spaceId:e,provider:"revenue_cat"}),await Ma.bi(this.environment)},refreshSubscriptionDataV2:async()=>{await Ma.bi(this.environment)},processMobileActionBarAction:t=>{const{componentId:n,action:o}=t;e.componentEvents.dispatch("MobileActionBar",n,"onAction",{action:o})},updateExperimentData:async e=>{if((0,ts._3)(this.environment)){const t=await(0,na.getExperimentDeviceId)(this.environment),n=this.environment.currentUser.id,o=(0,ts.fP)(t,n,e);o&&R.default.updateState(o,this.environment)}},trackExperimentExposure:async e=>{await zn.Bb({environment:this.environment,experiment_id:e.experimentId,experiment_version:e.experimentVersion,experiment_group:e.group||"ineligible",logging_source:"mobile_native"})},receiveRawMessageStoreMessage:e=>{Qi.onMobileNativeReceiveRawMessageStoreMessage(e,this.environment)},updateMessageStoreState:e=>{Qi.onMobileNativeUpdateMessageStoreState(e,this.environment)},logout:e=>{Hs.logoutSingleAccount({environment:this.environment,userId:e})},logoutAll:()=>{Hs.logout(this.environment)},openDestinationV2:e=>{switch(br.Z.closeAll(),(0,sa.__)(this.environment)&&Xs.S({environment:this.environment,tab:n.state.activeTab,nativeRootPageOverrideEnabled:!1}),e.type){case"moveTo":!function(e,t){const n=new Z.G(t,{table:Mn.iU,id:e});Vo.bA({environment:t,blocks:[n],moveToContext:"home_tab",onAccept:e=>{Ys.r({store:n,environment:t,pageVisitSource:Gn.tY.Move})}})}(e.blockId,this.environment);break;case"trash":Pa({query:e.query});break;case"AIAssistant":t={query:e.query,searchSessionId:e.searchSessionId,from:e.from},o=this.environment,xa.g.update((e=>({query:t.query,searchSessionId:t.searchSessionId,from:t.from??"search",shouldReset:Boolean(t.query&&t.query.trim().length>0)}))),_.c4({environment:o,url:`${h.VP.nativeTab}/assistant`,redirect:!0})}var t,o},openDestination:e=>{br.Z.closeAll();switch("closePopup"!==e&&(0,sa.__)(this.environment)&&Xs.S({environment:this.environment,tab:n.state.activeTab,nativeRootPageOverrideEnabled:!1}),e){case"search":!function(e){(0,Ue.Y)("supportsNativeHome")&&e.device.isPhone?(M.Hu({RouterStore:e.RouterStore,currentUserId:e.currentUser.id}),Js.UT({environment:e,analyticsFrom:"mobile-bottom-bar",renderAsPage:!0})):Js.UT({environment:e,analyticsFrom:"mobile-bottom-bar"});Ks.nB(e,{itemName:"search",logging_source:"mobile_native"})}(this.environment);break;case"addPage":!function(e){(0,Ue.Y)("supportsNativeHome")&&e.device.isPhone?(M.Hu({RouterStore:e.RouterStore,currentUserId:e.currentUser.id}),Ee.quickAddPage({environment:e,from:"mobile_bottom_bar",redirect:!0,quickAddParentOverride:{type:"space-private-pages"}})):Ee.quickAddPage({environment:e,from:"mobile_bottom_bar"});Ks.nB(e,{itemName:"add_page"})}(this.environment);break;case"allUpdates":t=this.environment,(0,Ue.Y)("supportsNativeHome")&&t.device.isPhone?(M.Hu({RouterStore:t.RouterStore,currentUserId:t.currentUser.id}),_.c4({environment:t,url:`${h.VP.nativeTab}/updates`,redirect:!0})):Ca.Z.setState({...Ca.Z.state,open:!0});break;case"addAccount":ma.C.setState({...ma.C.state,open:!0});break;case"createOrJoinWorkspace":return async function(e){await da.xN(e)}(this.environment);case"notificationAndSettings":pa.Z.setState({open:!0,source:pa.Y.Home});break;case"trash":Pa({});break;case"memberSettings":ka.Z.setState({...ka.Z.state,open:!0});break;case"help":ya.Z.setState({...ya.Z.state,open:!0});break;case"intercom_messages":!function(e){j.j({environment:e,from:"help_button"})}(this.environment)}var t},setCurrentUserId:async e=>{await async function(e,t){if(t.currentUser.id===e)return;await T.x({environment:t,newCurrentUserId:e})}(e,this.environment)},setCurrentSpace:async e=>{await async function(e,t,n){const o=await T.x({environment:n,newCurrentUserId:e}),{currentUserRootStore:r,currentUserSettingsStore:i}=U.default.state;if(!r)return;await r.load();const s=(0,Fo.w3)(t);s&&await ta.y3({environment:o,spaceViewStore:s,userSettingsStore:i,userRootStore:r,pageVisitSource:Gn.tY.SwitchSpace,navigationType:"switchingToOrLoadingSpace"})}(e.userId,e.spaceId,this.environment)},updateHorizontalSizeClass:t=>{const n=(0,Ws.Gu)(qs.literals(...Fs),t)?"unknown":t;n!==e.horizontalSizeClass.state&&e.horizontalSizeClass.setState(n)},updateTabbedRouterState:e=>{var t;const{TabbedRouterStore:n}=this.environment,o=n.state;e.tab!==o.activeTab||null!==(t=e.pages)&&void 0!==t&&t.length||o.tabs[o.activeTab].pages.length?Xs.S({environment:this.environment,tab:e.tab,queryParams:e.queryParams,pages:e.pages,nativeRootPageOverrideEnabled:e.nativeRootPageOverrideEnabled,navigationAction:e.navigationAction,navigationSource:e.navigationSource}):La();const r=n.state;return[{state:r,topPage:(0,Ds.w_)(r),webTransitionType:la(r),updateId:e.updateId??(0,Ri.ZP)()}]},getLocalSearchResults:async e=>{const t=await this.getLocalSearchCache(this.environment,e.searchSessionId);if(!t)return[{error:"Local cache does not exist"}];const n=(0,Ws.Gu)(zs.GA,e.sort);if(n)return[{error:`old sort type is unsupported! ${n}`}];const o=e.sort,r=(0,ua.f)({query:{query:{text:e.query??"",filters:e.filters,sort:o},limit:e.limit},localCachedPages:t,includeRecordMap:!1,userId:this.environment.currentUser.id,environment:this.environment,applyRecallScoreThreshold:!1,canUseLtr:!1}),i=[{value:{total:0,results:[],recordMap:{},trackEventProperties:void 0}}];if(!r||0===r.results.length)return i;const s=Vi.Z.state.online?aa.g8(this.environment,r.results):r.results;return[{value:{results:s,total:s.length,recordMap:{},trackEventProperties:{}}}]},customAddCommentMenuItemTapped:()=>{(0,oa.ol)(this.environment,!0,"custom_add_comment_menu_item")},filterValidMoveToBlocks:e=>{const t=e.targets.map((e=>new Z.G(this.environment,{table:Mn.iU,id:e}))),n=e.blocks.filter((e=>{const n=new Z.G(this.environment,{table:Mn.iU,id:e});return n.canEdit()&&(0,ra.Xk)(n,t)}));return[{value:{targets:e.targets,blocks:n}}]},completeMoveToTransaction:async e=>{const{targets:t,destination:n,moveToContext:o,timeToSelectMs:r,isSearchResult:i,flowId:s}=e,a=this.environment,l=t.map((e=>new Z.G(this.environment,{table:Mn.iU,id:e}))),d=Vo.QF(a,t,n);if(l&&l.length>0&&!d)try{return await _s.createAndCommitAsync({userAction:"MobileNativeListener.completeMoveTo",environment:a,waitForServerCommit:!1,perform:async e=>{await Vo.RL({targets:l,value:n,transaction:e,environment:a,moveToContext:o,renderType:"native",timeToSelectMs:r,disableSuccessToast:!0,isSearchResult:i,flowId:s})}}),[{value:e}]}catch(c){}return Gs.fW(a,{type:"moved_to_subpage"}),[{error:Ot.default.formatMessage(_a.failedToMovePageGeneric)}]},undoRevision:()=>{Qs.Yw(this.environment,!0)},searchTeams:async e=>{const{query:t}=e,n=U.default.state.currentSpaceStore,o=U.default.state.currentSpaceViewStore;if(!n||!o)return[{error:"SpaceStore or SpaceViewStore was undefined"}];const r=await i.deps.searchActions.loader();return[{value:{ids:(await r.searchTeams({spaceViewStore:o,query:t,teamStores:o.getTeamsStores()})).map((e=>e.id))}}]}}),o.isAndroid&&ms.Z.addListener(this.handleMobileNativeKeyboardStore),null!==(r=this.environment.mobileNative)&&void 0!==r&&r.api.ready&&this.environment.mobileNative.api.ready(),this.sideBarExpandedStateChangeHandler(),this.handleCustomAddMenuItemEnabledChanged())}willUnmount(){const{mobileNative:e,RouterStore:t,TabbedRouterStore:n,device:o}=this.environment;o.isMobileNative&&e&&(je.sidebarOpenStore.removeListener(this.handleSwipeNavigation),je.sidebarExpandedStore.removeListener(this.sideBarExpandedStateChangeHandler),va.Z.removeListener(this.handleSwipeNavigation),t.removeListener(this.handleSwipeNavigation),ms.Z.removeListener(this.handleKeyboardAutoScroll),this.bottomBarVisibility.removeListener(this.bottomBarVisibilityChange),this.aiAssistantEnabledState.removeListener(this.aiAssistantEnabledStateChange),n.removeListener(this.handleTabbedRouterStoreChange),this.customAddCommentMenuItemEnabled.removeListener(this.handleCustomAddMenuItemEnabledChanged),o.isAndroid&&ms.Z.removeListener(this.handleMobileNativeKeyboardStore))}renderComponent(){return(0,$.jsx)(ja,{getLocalSearchCache:this.getLocalSearchCache})}}Ea.displayName="MobileNativeListener";const Ta=Ea;function ja(e){let{getLocalSearchCache:t}=e;window.__c={n:"MobileNativeListenerComponent"};const n=(0,B.O7)(),{device:r}=n,i=(0,o.useRef)(),s=(0,o.useRef)(),a=(0,o.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object.keys(e.tabs).forEach((n=>{const o=n;t&&(e.tabs[o].nativeRootPageOverrideEnabled=void 0),e.tabs[o].pages="home"!==o?[]:e.tabs[o].pages.splice(0,1)}))}),[]),l=(0,o.useCallback)((e=>{var o;i.current=null==e?void 0:e.id;const{mobileNative:r,TabbedRouterStore:s,currentUser:l}=n,d=U.default.state.currentSpaceStore,c=null==d?void 0:d.id;if(null!=r&&null!==(o=r.api)&&void 0!==o&&o.setCurrentSpaceInfo&&(ir.log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"Web calling nativeAPI setCurrentSpaceInfo",spaceId:c}}),r.api.setCurrentSpaceInfo({spaceId:c,spaceViewId:null==e?void 0:e.id,userId:l.id,editable:(null==d?void 0:d.canEdit())??!0})),(0,sa.__)(n)){const e=e=>{if("web"!==e.type)return;const t={...e.queryParams},n=c&&(0,Ri.cj)(c);t.spaceId=n,e.queryParams=t,e.route.spaceId=n},t=at.Xh(s.state);e(t.tabs.search.rootPage),e(t.tabs.updates.rootPage),e(t.tabs.addPage.rootPage),a(t),s.setState(t)}t(n,void 0)}),[a,n,t]),d=(0,o.useCallback)((e=>{var t;s.current=null==e?void 0:e.id,null!==(t=n.mobileNative)&&void 0!==t&&null!==(t=t.api)&&void 0!==t&&t.setCurrentUserInfo&&n.mobileNative.api.setCurrentUserInfo({userId:null==e?void 0:e.id,loggedInUserIds:n.currentUser.loggedInUserIds});const o=!(0,sa.__)(n)||void 0===n.currentUser.id,{TabbedRouterStore:r}=n,i=at.Xh(r.state);a(i,o),r.setState(i)}),[a,n]),c=(0,o.useCallback)((()=>{const{currentUserStore:e,currentSpaceStore:t}=U.default.state;null!=e&&e.id&&null!=t&&t.id&&Sa.Z.reinitializeState(n,e.id,t.id);(void 0===(null==e?void 0:e.id)||s.current!==(null==e?void 0:e.id))&&d(e);const o=U.default.state.currentSpaceViewStore;i.current!==(null==o?void 0:o.id)&&l(o)}),[n,l,d]);return(0,o.useEffect)((()=>{if(r.isMobileNative&&n.mobileNative)return c(),U.default.addListener(c),()=>{U.default.removeListener(c)}}),[r.isMobileNative,n,t,c]),null}function La(){wa.Z.getPreventScrollType()===oo.Z.None&&(je.sidebarOpenStore.state?ln.Z.SidebarMobileScroller&&ln.Z.SidebarMobileScroller.scrollToTop({animate:!0,animationCallback:at.yR}):ln.Z.MenuScroller?ln.Z.MenuScroller.scrollToTop({animate:!0,animationCallback:at.yR}):ln.Z.MenuPageScroller?ln.Z.MenuPageScroller.scrollToTop({animate:!0,animationCallback:at.yR}):ln.Z.PageScroller&&ln.Z.PageScroller.scrollToTop({animate:!0,animationCallback:at.yR}))}function Pa(e){ha.Z.setState({open:!0});const{query:t}=e;t&&ga.Z.setState({...ga.Z.state,currentTab:"all_pages",filter:t,limit:ga.Z.startLimit})}function Aa(){La()}function Ua(){window.__c={n:"NotionListeners"};const e=(0,B.Fy)();return function(){const e=(0,B.O7)(),t=(0,B.Fy)();(0,o.useEffect)((()=>{if(t.isMobileNative)return;let e;document.hasFocus()&&(e=setInterval((()=>{Bi()}),Oi),Bi());const n=()=>{e&&clearInterval(e),e=setInterval((()=>{Bi()}),Oi),Bi()},o=()=>{e&&clearInterval(e),e=void 0};return window.addEventListener("focus",n),window.addEventListener("blur",o),()=>{e&&clearInterval(e),window.removeEventListener("focus",n),window.removeEventListener("blur",o)}}),[t.isMobileNative,e])}(),function(){const e=(0,o.useRef)(!1),t=(0,B.O7)(),n=(0,o.useCallback)((async e=>{if(e.currentUser.id&&qe.pendingTaskIds.size>0){const t=await qe.getTasks(e,{taskIds:Array.from(qe.pendingTaskIds.values())});if("success"===t.type){const{results:n}=t.data,o=new Set(qe.pendingTaskIds);for(const t of n)o.delete(t.id),t.status&&qe.handleRecordMapForResponse({environment:e,eventName:t.eventName,response:t.status,userId:e.currentUser.id}),qe.pendingTaskEventsById.emit(t.id,t),zi.emit(t.eventName,t),"failure"!==t.state&&"success"!==t.state||qe.pendingTaskIds.delete(t.id);if(o.size>0)for(const e of o.values())qe.pendingTaskIds.delete(e)}}}),[]),r=(0,o.useCallback)((async e=>{if(e.currentUser.id){const t=await qe.getUserTasks(e,{});if("success"===t.type){for(const e of t.data.taskIds)qe.pendingTaskIds.add(e);t.data.taskIds.length>0&&n(e)}}}),[n]),i=(0,o.useCallback)((()=>{const n=Vi.Z.state.online;n&&!e.current&&r(t),e.current=n}),[t,r]);function s(e){"success"===e.state?Di.Z.setStatus(e.request.blockId,void 0):"in_progress"===e.state||"not_started"===e.state?Di.Z.setStatus(e.request.blockId,e.status):Di.Z.setStatus(e.request.blockId,void 0)}function a(e){"success"===e.state?Fi.Z.setStatus(e.request.blockId,!1):"in_progress"===e.state||"not_started"===e.state?Fi.Z.setStatus(e.request.blockId,!0):Fi.Z.setStatus(e.request.blockId,!1)}(0,o.useEffect)((()=>{e.current=Vi.Z.state.online;const o=setInterval((()=>n(t)),1e3);return r(t),Vi.Z.addListener(i),zi.addListener("importEvernote",s),zi.addListener("extractWebClipperContent",a),()=>{clearInterval(o),Vi.Z.removeListener(i),zi.removeListener("importEvernote",s),zi.removeListener("extractWebClipperContent",a)}}),[t,n,i,r])}(),function(){const e=(0,B.O7)(),t=(0,o.useCallback)((()=>{Wi.LH(e)}),[e]);(0,o.useEffect)((()=>(t(),qi.Z.addListener(t),()=>{qi.Z.removeListener(t)})),[t])}(),Hi(),function(){const e=(0,B.O7)();(0,o.useEffect)((()=>{Yi(e);const t=window.setInterval((()=>Yi(e)),Ji);return()=>window.clearInterval(t)}),[e])}(),function(){const e=(0,B.O7)();(0,Ti.Z)((()=>{os(e)})),(0,o.useEffect)((()=>{const t=window.setInterval((()=>os(e)),ns);return()=>{window.clearInterval(t)}}),[e])}(),function(){const e=(0,B.O7)();(0,o.useEffect)((()=>{is(e);const t=window.setInterval((()=>is(e)),Je.U6);return()=>window.clearInterval(t)}),[e])}(),function(){const e=(0,B.O7)(),t=(0,B.Fy)(),n=(0,N.VK)((()=>{const{currentUserStore:n,currentUserSettingsStore:o,currentUserRootStore:r}=U.default.state;if(!(e.currentUser.id&&n&&o&&r))return e.publicDomainUserId?{user_id:e.publicDomainUserId}:void 0;const i=r.getSpaceViewStores(),s=i.length>0&&i.every((e=>e.isReady()));if(!n.isDefined()||!o.isDefined()||!s)return;const a=at.oA(i.map((e=>e.getSpaceId()))).map((t=>Gi.Z.getPublicSpaceData(e,t)));if(!a.every((e=>Boolean(e)||null===e)))return;const l=(0,Zi.ls)(a),d=o.getSettings();if(!d)return;if(void 0===Xe.subscriptionDataStoreInstance.state)return;const c={user_id:n.id,email:n.getEmail(),user_persona:d.persona,user_team_role:d.team_role,user_use_cases:d.use_cases,user_company_size:d.company_size,user_source:d.source,user_plan_type:l,user_subscription_tier:Xe.subscriptionDataStoreInstance.state.subscriptionTier,user_has_at_least_one_free_tier_space:(0,Zi.nZ)(a),time_zone:d.time_zone,locale:d.locale,preferred_locale:d.preferred_locale,signup_time:d.signup_time,app_version:t.version};return d.signup_time&&(c.created_at=Math.floor(d.signup_time/1e3)),t.desktopAppVersion&&(c.desktop_app_version=t.desktopAppVersion),t.mobileAppVersion&&(c.mobile_app_version=t.mobileAppVersion),d.used_desktop_web_app&&(c.used_desktop_web_app=d.used_desktop_web_app),d.used_mobile_web_app&&(c.used_mobile_web_app=d.used_mobile_web_app),d.used_mac_app&&(c.used_mac_app=d.used_mac_app),d.used_windows_app&&(c.used_windows_app=d.used_windows_app),d.used_ios_app&&(c.used_ios_app=d.used_ios_app),d.used_android_app&&(c.used_android_app=d.used_android_app),c}),[e,t],{useDeepEqual:!0});(0,o.useEffect)((()=>{n&&"none"!==n.user_plan_type&&ss(e,n)}),[e,n]);const r=void 0!==n;(0,o.useEffect)((()=>{const t=window.setTimeout((()=>{!r&&e.currentUser.id&&ss(e,{user_id:e.currentUser.id})}),5e3);return()=>{window.clearTimeout(t)}}),[e,r])}(),function(){const e=(0,B.O7)(),t=(0,N.VK)((()=>ls.default.state.isLoaded),[]),n=(0,N.VK)((()=>ls.default.state.isLoggingEnabled),[]);(0,o.useEffect)((()=>{t&&async function(){const t=await(0,Zi.cG)(e);await as.j2({config:P.default,isEnabled:n,deviceId:t,cookieService:e.cookieService})}()}),[e,t,n])}(),function(){const e=(0,B.O7)();(0,o.useEffect)((()=>{const t=t=>{ds.Zm(e,t)},n=t=>{const{shortcutMap:n}=e.KeyboardShortcutStackStore,o=at.w_(n,((n,o)=>(0,cs.Z)(e,t,n)));o&&!{cut:!0,copy:!0,paste:!0}[o]&&ds.dJ(e,t,o)};return window.addEventListener("keydown",n),window.addEventListener("cut",t),window.addEventListener("copy",t),window.addEventListener("paste",t),window.addEventListener("keypress",t),()=>{window.removeEventListener("keydown",n),window.removeEventListener("cut",t),window.removeEventListener("copy",t),window.removeEventListener("paste",t),window.removeEventListener("keypress",t)}}))}(),(0,us.Z)(),function(){const e=(0,B.O7)(),t=(0,B.Fy)();(0,o.useEffect)((()=>{t.isElectron&&k.setLogglyData(ir.clientLogglyEnvironmentData),e.mobileNative&&e.mobileNative.setLogglyData(ir.clientLogglyEnvironmentData)}),[t.isElectron,e.mobileNative])}(),function(){const e=(0,B.O7)();(0,o.useEffect)((()=>{if(e.device.isMobile){function t(){$t.default.afterNextFlush((()=>{on.hQ(e)}))}return un.default.addListener(t),hs.addListener(t),()=>{un.default.removeListener(t),hs.removeListener(t)}}}),[e])}(),(0,gs.Z)(),(0,fs.ZP)(),function(){const e=(0,B.O7)();(0,o.useEffect)((()=>{const{mobileNative:t}=e;t&&t.enableBridgeMetricsCollection(e,no.default,R.default)}),[e])}(),function(){const e=(0,B.O7)();(0,o.useEffect)((()=>{function t(){bs.Z.setState({...bs.Z.state,isVisible:!document.hidden});const t=vs.W$(),n=t&&(Date.now()-t)/Je.A0>=7;if(e.device.isBrowser&&!document.hidden&&(!t||n)&&Vi.Z.getState().online){const t=e.AppUpdateStore;if(t.isSilentUpdate()){const n=t.state.appUpdate;vs.hC({environment:e,url:window.location.href,version:n.version})}}}return document.addEventListener("visibilitychange",t),t(),()=>{document.removeEventListener("visibilitychange",t)}}),[e])}(),function(){const{deviceType:e}=(0,B.Fy)(),t=(0,B.O7)(),n=t.currentUser.isLoggedIn();(0,o.useEffect)((()=>{if(!n)return;if("windows-desktop"!==e&&"mac-desktop"!==e)return;const o=async()=>{await k.isMainTabOrWindow()&&qe.registerDesktopApp(t,{deviceType:e})};o();const r=window.setInterval((()=>{o()}),5*Je.hM);return()=>{window.clearInterval(r)}}),[n,e,t])}(),function(){const e=(0,B.O7)(),t=(0,o.useRef)(),n=(0,o.useRef)();(0,o.useEffect)((()=>{function o(){const o=un.default.state,r="empty"===o.mode?void 0:o.multiSelection.start.store,i="empty"===o.mode?void 0:o.multiSelection.end.store;if(t.current===r&&n.current===i)return;if(t.current=r,n.current=i,t.current!==n.current)return;const s=Cs.getSimpleTableCellFromTextSelection();if(!s)return;const{rowIndex:a,columnIndex:l,simpleTableStore:d}=s.getProps();xs.selectCell({environment:e,rowIndex:a,columnIndex:l,simpleTableStore:d})}return un.default.addListener(o),()=>{un.default.removeListener(o),t.current=void 0,n.current=void 0}}))}(),function(){const e=(0,B.O7)(),t=(0,o.useCallback)((t=>{const n={compressed:t.decodedBodySize!==t.encodedBodySize,local_cache_hit:0===t.transferSize,next_hop_protocol:t.nextHopProtocol,did_prefetch:e.prefetchCache.isEnabled},o={dns_lookup:{startTime:t.domainLookupStart,endTime:t.domainLookupEnd},connection_establish:{startTime:t.connectStart,endTime:t.connectEnd},request_queued:{startTime:t.connectEnd,endTime:t.requestStart},response_wait:{startTime:t.requestStart,endTime:t.responseStart},response_download:{startTime:t.responseStart,endTime:t.responseEnd}};no.default.measure({metricName:"load_cached_page_chunk.fetch",startTime:t.fetchStart,endTime:t.responseEnd},{environment:e,data:{...n,sub_metrics:{dns_lookup:o.dns_lookup.endTime-o.dns_lookup.startTime,connection_establish:o.connection_establish.endTime-o.connection_establish.startTime,request_queued:o.request_queued.endTime-o.request_queued.startTime,response_wait:o.response_wait.endTime-o.response_wait.startTime,response_download:o.response_download.endTime-o.response_download.startTime}}});for(const[r,{startTime:i,endTime:s}]of Object.entries(o))no.default.measure({metricName:`load_cached_page_chunk.fetch.${r}`,startTime:i,endTime:s},{environment:e,data:n})}),[e]);(0,o.useEffect)((()=>{const e=new PerformanceObserver((n=>{const o=n.getEntries().find((e=>e.name.includes(`${P.default.api.http}/${Ms}`)&&!e.name.endsWith("s")));o&&("resource"===o.entryType&&t(o),null==e||e.disconnect())}));return e.observe({type:"resource",buffered:!0}),()=>{e.disconnect()}}),[t])}(),function(){const e=(0,B.O7)();(0,o.useEffect)((()=>{const t=()=>_s.updateConnectionState(e);return t(),Vi.Z.addListener(t),()=>{Vi.Z.removeListener(t)}}),[e])}(),function(){const e=(0,B.O7)(),t=(0,o.useRef)("none"),n=(0,o.useCallback)((e=>{const n=t.current;e!==n&&(t.current=e,"dragging"===e?ws.Z.setState({isDragging:!0}):"dragging"===n&&ws.Z.setState({isDragging:!1}))}),[]),r=(0,o.useCallback)((()=>{"none"===t.current&&n("touching")}),[n]),i=(0,o.useCallback)((()=>{n("none")}),[n]),s=(0,o.useCallback)((()=>{"touching"===t.current&&ys.isExpanded(ys.get())&&n("dragging")}),[n]);(0,o.useEffect)((()=>{if(e.device.isIOS)return window.addEventListener("touchstart",r),window.addEventListener("touchend",i),window.addEventListener("touchcancel",i),document.addEventListener("selectionchange",s),()=>{window.removeEventListener("touchstart",r),window.removeEventListener("touchend",i),window.removeEventListener("touchcancel",i),document.removeEventListener("selectionchange",s)}}),[e.device.isIOS,r,i,s]);const a=(0,o.useCallback)((()=>{$t.default.afterNextFlush((()=>{Ss.ls()}))}),[]),l=(0,o.useCallback)((()=>{setTimeout((()=>{ys.get()||Ss.ZH(e)}),0)}),[e]);(0,o.useEffect)((()=>(window.addEventListener("mousedown",a),e.device.isMobileBrowser&&document.addEventListener("focusout",l),()=>{window.removeEventListener("mousedown",a),document.removeEventListener("focusout",l)})),[e,a,l])}(),function(){const e=(0,B.O7)(),t=(0,B.Fy)(),n=(0,o.useRef)(!1),r=(0,o.useCallback)((()=>{"system"===Wi.VZ(e)&&qi.Z.emit()}),[e]),i=(0,N.VK)((()=>{var e;return null===(e=U.default.state.mainEditorCurrentBlockStore)||void 0===e?void 0:e.isReady()}),[]);(0,o.useLayoutEffect)((()=>{!n.current&&i&&(r(),n.current=!0)}),[i,r]),(0,o.useEffect)((()=>{if(t.isAndroid&&e.mobileNative)e.mobileNative.updateReceiveApiHandlers({themeChanged:e=>r()});else{if(ks.addEventListener&&ks.removeEventListener)return ks.addEventListener("change",r),()=>{ks.removeEventListener("change",r)};if(ks.addListener&&ks.removeListener)return ks.addListener(r),()=>{ks.removeListener(r)}}}),[t.isAndroid,e,r])}(),function(){const e=P.default.isLocalhost||!1;(0,o.useEffect)((()=>{function t(t){if(!e)return;if(!t.data||"string"!=typeof t.data.type)return;const n=t.data.type;"webpackInvalid"===n?Is.oV({label:(0,$.jsxs)("div",{children:[(0,$.jsx)("span",{style:{paddingRight:10},children:"Webpack Compiling"}),(0,$.jsx)("img",{src:"/images/favicon-local.ico",className:"loading-spinner",style:{display:"inline-block"}})]}),position:"top",durationMs:"keep"}):"webpackOk"!==n&&"webpackWarnings"!==n||Is.rN()}return window.addEventListener("message",t),()=>{window.removeEventListener("message",t)}}),[e])}(),(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(Us,{},"AppUpdateListener"),(0,$.jsx)(Ta,{}),e.isElectron&&(0,$.jsx)(Ra,{}),(0,$.jsx)(i.LazyInjectThirdPartyScripts,{})]})}function Ra(){return window.__c={n:"ElectronListener"},function(){const e=(0,B.O7)(),t=(0,N.VK)((()=>({observedWidth:je.sidebarSizeObserver.rect.state.width,targetWidth:je.sidebarWidthStore.state,isExpanded:je.sidebarExpandedStore.state,resizing:je.sidebarResizingStore.state})),[]),n=e.currentUser.isLoggedIn(),[r,i]=(0,o.useState)(!1),{isTabsFeatureEnabled:s}=(0,N.Kw)(es.Z);(0,o.useEffect)((()=>{r&&s&&k.windowSidebarState.set({isLoggedIn:n,...t})}),[t,n,r,s]),(0,o.useEffect)((()=>{let e;e=n?t.isExpanded?"expanded":"collapsed":"disabled",k.sidebarState.set(e)}),[t.isExpanded,n]);const a=(0,o.useCallback)(((t,n,o)=>{Zi.j(e,n,o)}),[e]);(0,o.useEffect)((()=>(k.track.addListener(a),()=>{k.track.removeListener(a)})),[a]);const l=(0,o.useCallback)(((e,t)=>{i(t)}),[]);(0,o.useEffect)((()=>(k.isActiveTab.get().then((e=>{i(e)})),k.isActiveTab.addListener(l),()=>{k.isActiveTab.removeListener(l)})),[l]);const d=(0,o.useCallback)(((e,t)=>{void 0===t.isShowingTabBar&&(t.isShowingTabBar=t.isTabsFeatureEnabled),es.Z.setState(t)}),[]);(0,o.useEffect)((()=>{var e;return null===(e=k.electronAppFeatures.get())||void 0===e||e.then((e=>{es.Z.setState(e)})),k.electronAppFeatures.addListener(d),()=>{k.electronAppFeatures.removeListener(d)}}),[d]);const c=(0,o.useCallback)((n=>{Ee.setExpand({environment:e,isExpanded:!t.isExpanded,from:"electron_listener"})}),[e,t.isExpanded]);(0,o.useEffect)((()=>(k.sidebarState.addToggleListener(c),()=>{k.sidebarState.removeToggleListener(c)})),[c]);const u=(0,o.useCallback)(((e,t)=>{t?Ee.open({fromElectron:!0}):Ee.close()}),[]);(0,o.useEffect)((()=>(k.sidebarState.addSetSidebarOpenListener(u),()=>{k.sidebarState.removeSetSidebarOpenListener(u)})),[u]);const p=(0,o.useCallback)(((e,t)=>{je.sidebarExpandedStore.setState(t.isExpanded),je.sidebarWidthStore.setState(t.targetWidth)}),[]);(0,o.useEffect)((()=>(k.windowSidebarState.addListener(p),()=>{k.windowSidebarState.removeListener(p)})),[p])}(),null}var Za=n(78354),Oa=n(77788),Ba=n(45483);function Na(e){window.__c={n:"InertWhenModalsAreOpen"};const t=(0,N.VK)((()=>R.default.checkGate("inert_html_attribute")),[]),n=(0,N.VK)((()=>Ba.Z.state.openModals.size>0),[]),o={inert:t&&n?"true":null};return(0,$.jsx)("div",{style:e.style,...o,children:e.children})}var Va=n(91948),Da=n(31104),Fa=n(17294);const za=function(){window.__c={n:"LoadingStateRenderer"};const e=(0,N.VK)((()=>Da.Z.state),[]);return(0,$.jsx)(Un.Z,{open:e.open,render:()=>(0,$.jsx)(Ka,{}),overlayZIndex:ce._})};function Wa(e){return{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minWidth:180,padding:"18px 24px 20px",textAlign:"center",maxWidth:e.device.isMobile?"300px":"100%"}}function qa(e){return{display:"flex",alignItems:"center",fontSize:14,color:e.mediumTextColor}}function Ka(){window.__c={n:"ModalComponent"};const e=(0,V.Fg)(),t=(0,B.O7)(),n=(0,N.VK)((()=>Da.Z.state),[]),{targetRecordId:o}=n,r=(0,N.VK)((()=>function(e){return void 0!==e&&Boolean(Fa.Z.state[e])}(o)),[o]);return n.open?(0,$.jsxs)("div",{style:Wa(t),children:[(0,$.jsxs)("div",{style:qa(e),children:[n.message,(0,$.jsx)(Ln.Z,{style:{marginLeft:6}})]}),r&&o&&(0,$.jsx)(Va.Z,{targetRecordId:o,style:{marginTop:10}})]}):null}var Ga=n(18466);const Ha="render_duration";new Set(["destinations","emergencyThrottlePercentage","amplitudeOptions","datadogOptions","snowflakeOptions","statsigOptions"]),qs.literals("connected_apps_settings","compliance_connected_apps_settings","external_object_instance_block","external_object_instance_inline_popup","external_object_instance_block_error_dropdown","placeholder_root_external_collection_view_block","connected_relation_property_menu","source_picker_connect_another_account","integration_gallery","collection_settings_property_type","integration_file_picker","send_to_notion","unfurl","messages_tab","install_redirect","all_updates","notifications_and_settings","collection_view_settings","share_menu","space_settings","workspace_connections_redirect");var $a=n(77897);function Qa(){return 1}function Ya(e){let{id:t,targetRenderPhase:n="all",samplePercent:r=Qa(),children:i}=e;window.__c={n:"PerformanceProfiler"};const s=(0,B.O7)(),a=(0,o.useCallback)(((e,t,o,i,a,l)=>{(0,$a.lB)(r)&&("all"!==n&&t!==n||Zi.j(s,`${Ha}.${e}`,{time:o,render_phase:t}))}),[s,n,r]),[l]=(0,o.useState)(Ga.Z.withListenerIgnored((()=>R.default.checkGate("client-performance-profiler"))));return l?(0,$.jsx)(o.Profiler,{id:t,onRender:a,children:i}):(0,$.jsx)($.Fragment,{children:i})}function Xa(e){let{children:t}=e;window.__c={n:"Notion"};const n=(0,y.useIntl)(),r=(0,B.O7)(),i=(0,V.Fg)();(0,Ti.Z)((()=>{const{device:e,mobileNative:t}=r;if(Pi.mc(r),Ui.Yh(r),t&&t.hideSplashscreen(),e.isMobile){const e=document.body.parentElement;e&&e.classList.add(Jn.aiP)}Zi.pH(r),l.rQ({device:e,config:P.default,cookieService:r.cookieService}),e.isElectronMac&&k.getAppPath().then((e=>{e&&(e.startsWith("/Volumes/Notion Installer")||e.startsWith("/Volumes/Notion Dev Installer")||e.startsWith("/Volumes/Notion Stg Installer"))&&Ai.showMessage({message:n.formatMessage({defaultMessage:"Please move the Notion.app into the /Applications folder for the auto-updater to work.",id:"notionAppContainer.dialog.notionAppNotInApplications.message"})})})),Li.DM(a.SP),(0,ji.yN)(window.location.href)})),(0,o.useEffect)((()=>{const{device:e}=r;"external"===(0,m.Wj)({url:window.location.href,isMobile:e.isMobile,baseUrl:P.default.domainBaseUrl,publicDomainName:P.default.publicDomainName,protocol:P.default.protocol,currentUrl:window.location.href}).name&&Ai.showDialog({message:"Mismatch between origin and baseUrl (dev).",showCancel:!1,keepFocus:!1,items:[{label:(0,$.jsx)(y.FormattedMessage,{defaultMessage:"Okay",id:"notionAppContainer.dialog.mismatchedOriginURL.okayButton.label"}),onAccept:()=>{const e=S.O_({relativeUrl:S.T1(window.location.href),baseUrl:P.default.domainBaseUrl}),t=S.Qc(e);t.protocol=S.Qc(window.location.href).protocol,window.location.href=S.WU(t)}}]})}),[r]),(0,o.useEffect)((()=>{const{mobileNative:e}=r;null==e||e.markTransitionReady({type:"mount"})}),[r]);const s="light"===i.mode?Jn.MsS:Jn.Xj_,c=(0,V.yK)((e=>({root:{...(0,d.N7)(a.SP),color:e.regularTextColor,WebkitFontSmoothing:"auto",backgroundColor:e.contentBackground}})),[]);return(0,$.jsxs)(Ya,{id:"app",targetRenderPhase:"mount",children:[(0,$.jsx)(Ua,{}),(0,$.jsxs)("div",{style:c.root,className:["notion-app-inner",s].join(" "),children:[(0,$.jsx)(Na,{style:{height:"100%"},children:t}),(0,$.jsx)(Oa.Z,{store:va.Z,zIndex:ce.mJ,isDefault:!0}),(0,$.jsx)(Za.Z,{}),(0,$.jsx)(za,{})]})]})}var Ja=n(94273),el=n(12714);function tl(){window.__c={n:"OpenExternal"};const e=(0,B.O7)();return(0,Ti.Z)((()=>{const t=f.u5({schemeUrl:window.location.href,baseUrl:P.default.domainBaseUrl});el.D({environment:e,url:t}),Ja.vq(),_.c4({environment:e,url:h._j.root,redirect:!0})})),null}class nl extends s.Z{constructor(){super(...arguments),this.didCatchError=!1,this.caughtErrorId=void 0,this.openSupportMessages=()=>{j.j({environment:this.environment,from:"page_error"})},this.handleOpenNativeLink=e=>{"string"==typeof e?this.handleOpenNativeLinkV2(e,!1,!1):this.handleOpenNativeLinkV2(e.url,!1,!1)},this.handleOpenNativeLinkV2=(e,t,n)=>{const{RouterStore:o}=this.environment,r=f.RD({url:e,protocol:P.default.protocol,baseUrl:P.default.domainBaseUrl}),i=f.u5({schemeUrl:r,baseUrl:P.default.domainBaseUrl}),s=m.Wj({url:i,baseUrl:P.default.domainBaseUrl,publicDomainName:P.default.publicDomainName,isMobile:this.environment.device.isMobile,protocol:P.default.protocol,currentUrl:window.location.href});(this.environment.device.isAndroid||t)&&M.Hu({RouterStore:o,currentUserId:this.environment.currentUser.id}),this.environment.mobileNative&&this.environment.mobileNative.closeInAppBrowser(),"googleAuthCallback"!==s.name&&"samlAuthCallback"!==s.name?_.c4({environment:this.environment,url:i,redirect:t,updateMobileTabbedRouterArgs:{clearNativeRootPageOverride:n},queryId:"page"===s.name?s.queryId:void 0}):_.c4({environment:this.environment,url:i})}}didMount(){this.environment.currentUser.isLoggedIn()&&U.default.waitUntil((()=>{const e=U.default.state.currentUserSettingsStore,t=(null==e?void 0:e.isDefined())??!1;if(e&&t){const t=e.getSettings(),n=null==t?void 0:t.disable_auto_set_timezone;t&&!n&&E.wk({environment:this.environment,userSettingsStore:e})}return t}))}UNSAFE_willMount(){const{RouterStore:e,currentUser:t}=this.environment,n=t.id;window.addEventListener("beforeunload",(()=>{M.Vz({historyId:e.state.id,currentUserId:n})})),window.onpopstate=async t=>{const n=window.location.href,o=t.state?t.state.currentUserId:void 0;let r=this.environment;o&&o!==this.environment.currentUser.id&&(r=await T.x({environment:r,newCurrentUserId:o}));const i=e.state.route,s=m.Wj({url:n,isMobile:r.device.isMobile,baseUrl:P.default.domainBaseUrl,publicDomainName:P.default.publicDomainName,protocol:P.default.protocol,currentUrl:window.location.href}),a="page"===i.name&&"page"===s.name&&i.blockId===s.blockId,l="onboarding"!==i.name&&"onboarding"===s.name;M.Vz({historyId:e.state.id,currentUserId:o}),await I.e({environment:r,id:t.state&&t.state.id||(0,p.ZP)(),action:"pop",href:n}),l&&!this.environment.device.isMobileNative&&_.c4({environment:r,url:h._j.root}),a&&_.Oj(r)},this.environment.mobileNative&&this.environment.mobileNative.subscribeToOpenLink(this.handleOpenNativeLinkV2),k.subscribeToProtocolUrl(this.handleOpenNativeLink),k.subscribeToSettingsMenuItem(al),k.ready(),k.onNewWindow(((e,t)=>{e.preventDefault(),_.c4({environment:this.environment,url:t,openInNew:"tab"})}))}componentDidCatch(e,t){console.error("Client crash during React render:",e),this.caughtErrorId=b.rn(e,{from:"Router",type:"ClientCrash",data:{miscDataToConvertToString:t}}),this.didCatchError=!0,this.forceUpdate()}renderComponent(){return(0,$.jsx)(y.IntlProvider,{defaultLocale:"en-US",locale:a.SP,messages:a.sY,children:(0,$.jsx)(Si,{...yi(this.environment.device),children:this.renderRouteOrError()})})}renderRouteOrError(){return this.didCatchError?(0,$.jsxs)("div",{style:rl,children:[(0,u.H)({width:42,height:42}),(0,$.jsxs)("div",{style:il,children:[(0,$.jsx)("div",{children:(0,$.jsx)(y.FormattedMessage,{defaultMessage:"Oops! Something went wrong.",id:"router.renderErrorPage.message.part1"})}),(0,$.jsx)("div",{children:(0,$.jsx)(y.FormattedMessage,{defaultMessage:"Please refresh and try again or <textlink>message support</textlink>.",id:"router.renderErrorPage.message.part2",values:{textlink:e=>(0,$.jsx)(xi.Z,{onClick:this.openSupportMessages,children:e})}})}),this.caughtErrorId&&(0,$.jsx)("div",{style:sl,children:(0,$.jsx)(y.FormattedMessage,{defaultMessage:"Error ID: {errorId}",id:"router.renderErrorPage.message.errorId",values:{errorId:this.caughtErrorId.slice(0,8)}})})]}),(0,$.jsx)(W.Z,{isLarge:!0,onClick:()=>window.location.reload(),children:(0,$.jsx)(y.FormattedMessage,{defaultMessage:"Refresh",id:"router.renderErrorPage.reloadButton.label"})})]}):(0,$.jsx)(Xa,{children:this.renderRoute()})}renderRoute(){const{RouterStore:e}=this.environment,t=e.state;if("root"!==t.route.name&&"page"!==t.route.name&&"space"!==t.route.name&&(x.setInitialRenderCompleted(),U.default.setState({...U.default.state,renderPhase:"rendered"})),this.environment.currentUser.isLoggedIn()||"page"===t.route.name||"space"===t.route.name||l.j({device:this.environment.device,event:{facebook:{eventName:"PageView",data:{content_name:window.location.href}},google:{eventName:"pageView",path:window.location.pathname}},cookieService:this.environment.cookieService}),this.environment.currentUser.isLoggedIn()&&U.default.state.currentUserSettingsStore){const{currentUserSettingsStore:e}=U.default.state;L.dM(this.environment,e)}const{device:o}=this.environment;if(o.isNative&&m.lQ[t.route.name])return(0,$.jsx)(tl,{});if("front"===t.route.name)return(0,$.jsx)(vi,{preventFrontRedirect:t.route.alreadyRedirected});if("root"===t.route.name)return(0,$.jsx)(ki,{route:t.route});if("nativeRedirect"===t.route.name)return(0,$.jsx)(Ii,{redirect:t.route.redirect});if("login"===t.route.name)return(0,$.jsx)(i.LazyLoginPage,{isSignup:!1,email:t.route.email,redirectURL:t.route.redirectURL});if("desktopEmailConfirm"===t.route.name)return(0,$.jsx)(hi,{});if("teamsInvite"===t.route.name){const{teamId:e}=t.route;return w.uA(this.environment,{teamId:e}),(0,$.jsx)(Ci.Z,{fetch:async()=>{const t=new Z.zX(this.environment,{table:g.e0,id:e});await t.load()},render:()=>(0,$.jsx)(ne,{teamId:e})})}if("signup"===t.route.name)return(0,$.jsx)(i.LazyLoginPage,{isSignup:!0,email:t.route.email});if("unsubscribe"===t.route.name)return(0,$.jsx)(li,{payload:t.route.payload});if("onboarding"===t.route.name)return(0,$.jsx)(i.LazyOnboarding,{});if("upcomingInvoice"===t.route.name)return(0,$.jsx)(i.LazyInvoice,{route:t.route});if("invoiceById"===t.route.name)return(0,$.jsx)(i.LazyInvoice,{route:t.route});if("settingsConsoleOrganization"===t.route.name)return(0,$.jsx)(i.LazyOrganizationSettingsConsole,{organizationId:t.route.organizationId,tabRoute:t.route.tabRoute,properties:t.route.properties,params:t.route.params});if("settingsConsoleWorkspace"===t.route.name)return(0,$.jsx)(i.LazyWorkspaceSettingsConsole,{workspaceId:t.route.workspaceId,tabRoute:t.route.tabRoute,properties:t.route.properties,params:t.route.params});if(t.route.name,t.route.name,"admin"===t.route.name&&P.default.isAdminMode)return(0,$.jsx)(Ci.Z,{fetch:()=>Promise.all([n.e(2743),n.e(782),n.e(2069),n.e(1275),n.e(4162),n.e(637),n.e(2328)]).then(n.bind(n,68611)),render:e=>{let{default:t}=e;return(0,$.jsx)(t,{})}});if("adminListData"===t.route.name){const{category:e}=t.route;if(P.default.isAdminMode)return(0,$.jsx)(Ci.Z,{fetch:()=>Promise.all([n.e(2743),n.e(782),n.e(2069),n.e(1275),n.e(4162),n.e(637),n.e(2328)]).then(n.bind(n,65585)),render:t=>{let{default:n}=t;return(0,$.jsx)(n,{category:e})}})}if("adminSingleRecord"===t.route.name&&P.default.isAdminMode){const{id:e,table:o}=t.route;return(0,$.jsx)(Ci.Z,{fetch:()=>Promise.all([n.e(2743),n.e(782),n.e(2069),n.e(1275),n.e(4162),n.e(637),n.e(3854)]).then(n.bind(n,48807)),render:t=>{let{default:n}=t;return(0,$.jsx)(n,{table:o,id:e})}})}if("oauthAuthorization"===t.route.name){const{responseType:e,redirectUri:o,integrationId:r,state:i,owner:s,userId:a,spaceId:l}=t.route;return(0,$.jsx)(Ci.Z,{fetch:()=>Promise.all([n.e(2774),n.e(2743),n.e(9081),n.e(3370)]).then(n.bind(n,18330)),render:t=>{let{default:n}=t;return(0,$.jsx)(n,{responseType:e,redirectUri:o,integrationId:r,state:i,owner:s,userId:a,spaceId:l})}})}if("notionCalendarAuthorization"===t.route.name){const{csrf:e,calendarCsrf:o,redirectUri:r,spaceId:i,state:s}=t.route;return(0,$.jsx)(Ci.Z,{fetch:()=>n.e(7304).then(n.bind(n,67943)),render:t=>{let{default:n}=t;return(0,$.jsx)(n,{csrf:e,calendarCsrf:o,redirectUri:r,spaceId:i,state:s})}})}if("initiateExternalAuthentication"===t.route.name){const{notion_user_id:e,notion_workspace_id:o,notion_last_visited_url:r,notion_authorization_code:i,external_object_instance_block_id:s,callback_type:a,integration_id:l,redirectToAuth:d}=t.route;return(0,$.jsx)(Ci.Z,{fetch:()=>n.e(1023).then(n.bind(n,84750)),render:t=>{let{default:n}=t;return(0,$.jsx)(n,{notion_user_id:e,notion_workspace_id:o,notion_last_visited_url:r,notion_authorization_code:i,external_object_instance_block_id:s,callback_type:a,integration_id:l,redirectToAuth:d})}})}if("initiateExternalAuthenticationFromDesktop"===t.route.name){if(R.default.checkGate("enable_oauth_from_desktop_ux_v2")){const{redirectUri:e}=t.route;if(this.environment.currentUser.isLoggedIn())return(0,$.jsx)(Ci.Z,{fetch:()=>n.e(3871).then(n.bind(n,94810)),render:t=>{let{default:n}=t;return(0,$.jsx)(n,{redirectUri:e})}});{const t=S.bf({url:`${P.default.domainBaseUrl}${h._j.initiateExternalAuthenticationFromDesktop}`,query:{redirectUri:e}}),n=S.bf({url:`${P.default.domainBaseUrl}${h._j.login}`,query:{redirectURL:t}});v.hw(),_.c4({environment:this.environment,url:n,redirect:!0})}}else _.c4({environment:this.environment,url:h._j.notFound,redirect:!0})}if("myIntegrations"===t.route.name)return"pointer"in t.route?(0,$.jsx)(i.LazyDeveloperIntegrationViewV2,{botOrIntegrationPointer:t.route.pointer}):(0,$.jsx)(i.LazyDeveloperIntegrationsList,{});if("myIntegrationsLab"===t.route.name)return(0,$.jsx)(i.LazyDeveloperIntegrationLab,{integrationPointer:t.route.pointer});var r;if("inAppTemplateSubmission"===t.route.name)return"inAppTemplateCreatorSubmission"===(null===(r=t.initialRoute)||void 0===r?void 0:r.name)?(0,$.jsx)(oe,{openCreatorProfileModal:!0}):(0,$.jsx)(oe,{openCreatorProfileModal:!1});if("inAppTemplateCreatorSubmission"===t.route.name&&_.c4({environment:this.environment,url:h._j.templateSubmission,redirect:!0}),["creatorProfile","creatorProfileTemplates","creatorProfileAnalytics"].includes(t.route.name)){const e=R.default.checkGate("enable_new_creator_profile");if(e&&"creatorProfileAnalytics"===t.route.name)_.c4({environment:this.environment,url:h._j.creatorProfile,redirect:!0});else{if(e)return(0,$.jsx)(A,{});_.c4({environment:this.environment,url:h._j.notFound,redirect:!0})}}return"studentGroupSignup"===t.route.name?(0,$.jsx)(O,{}):"notFound"===t.route.name?(0,$.jsx)(i.LazyPageError,{route:t.route,publicPageData:void 0}):"page"===t.route.name||"space"===t.route.name||"nativeTab"===t.route.name||"workspaceSetup"===t.route.name||"modal"===t.route.name||"quickSearch"===t.route.name||"chat"===t.route.name?(0,$.jsx)(ni,{routerState:t}):(0,$.jsx)(si.Z,{})}}nl.displayName="Router";const ol=nl,rl={width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingBottom:100,...(0,d.N7)(a.SP)},il={fontSize:14,textAlign:"center",marginTop:6,marginBottom:12,color:c.ZP.uiGray},sl={fontSize:10,marginTop:8};function al(e){C.r$({currentTab:e})}function ll(e){let{environment:t,onMount:n}=e;window.__c={n:"NotionRoot"};const s=(0,o.useRef)(!1);return(0,o.useEffect)((()=>{s.current||(s.current=!0,null==n||n())}),[n]),(0,$.jsx)(r.B9,{value:t,children:(0,$.jsx)(i.DependencyProviderAll,{children:(0,$.jsx)(ol,{})})})}},14694:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});n(67294);var o=n(480),r=n(86628),i=n(24405),s=n(39567),a=n(50659),l=n(85893);function d(){window.__c={n:"AliasIcon"};const e=(0,i.yK)((e=>({icon:{position:"absolute",width:"50%",height:"50%",right:0,bottom:0,fill:"dark"===e.mode?e.regularTextColor:"#3E3C38",stroke:"dark"===e.mode?e.sidebarBackground:"white",strokeWidth:"dark"===e.mode?"1.85px":"1.5px"}})),[]);return(0,l.jsx)("div",{children:(0,s.Y)(e.icon)})}function c(e){var t;window.__c={n:"SidebarItem"};const n=(0,o.O7)(),s=n.device.isMobile,c=(0,r.VK)((()=>{var t,o;if(s)return n.WindowSizeStore.getSafePaddingLeftCSS("number"==typeof(null===(t=e.style)||void 0===t?void 0:t.paddingLeft)?null===(o=e.style)||void 0===o?void 0:o.paddingLeft:10)}),[n.WindowSizeStore,s,null===(t=e.style)||void 0===t?void 0:t.paddingLeft]),u=(0,i.yK)((t=>({wrapper:{...s?{display:"flex",alignItems:"center",width:"100%",minHeight:26,fontSize:16,paddingTop:8,paddingBottom:8,paddingLeft:c,paddingRight:10,userSelect:"none",WebkitUserSelect:"none",boxShadow:e.disableMobileBorder?void 0:`0 1px 0 ${t.regularDividerColor}`,marginBottom:e.shouldShowMobileMarginBottom?12:1}:{display:"flex",alignItems:"center",width:"100%",fontSize:14,minHeight:27,paddingTop:2,paddingBottom:2,marginTop:1,marginBottom:1,...(0,a.MF)()},...e.style},icon:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,flexGrow:0,width:s?28:22,height:s?24:18,marginLeft:-3,marginRight:4,position:"relative"},right:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,flexGrow:0,height:"100%",...e.rightStyle},left:{flexShrink:0,flexGrow:0,borderRadius:4,color:t.mediumTextColor,width:s?26:22,height:s?24:22,display:"flex",alignItems:"center",justifyContent:"center",marginRight:e.icon?0:8},children:{flexGrow:1,flexShrink:1,flexBasis:"auto",whiteSpace:"nowrap",minWidth:0,overflow:"hidden",textOverflow:e.right&&!s?"clip":"ellipsis",...e.childrenStyle}})),[s,c,e.disableMobileBorder,e.shouldShowMobileMarginBottom,e.style,e.rightStyle,e.icon,e.right,e.childrenStyle]);return(0,l.jsxs)("div",{role:e.role,"aria-current":e["aria-current"],"aria-expanded":e["aria-expanded"],"aria-owns":e["aria-owns"],"aria-labelledby":e["aria-labelledby"],style:u.wrapper,onFocus:e.onFocus,onBlur:e.onBlur,onMouseMove:e.onMouseMove,onMouseLeave:e.onMouseLeave,onClick:e.onClick,className:e.className,children:[e.left&&(0,l.jsx)("div",{style:u.left,children:e.left}),e.icon&&(0,l.jsxs)("div",{style:u.icon,children:[e.icon,e.isAlias&&(0,l.jsx)(d,{})]}),(0,l.jsx)("div",{style:u.children,children:e.children}),e.right&&(0,l.jsx)("div",{style:u.right,children:e.right})]})}},55064:(e,t,n)=>{"use strict";n.d(t,{Z:()=>L});var o=n(67294),r=n(83355),i=n(480),s=n(86628),a=n(24405),l=n(97880),d=n(51454),c=n(9291),u=n(17659),p=n(99553),m=n(24677),h=n(28651),g=n(98742),f=n(89224),v=n(35350),b=n(41549),S=n(74948),y=n(24646),w=n(38676),k=n(36391),x=n(96049),C=n(66353),M=n(45325),_=n(88923),I=n(6685),E=n(26388),T=n(85893);class j extends r.Z{constructor(){super(...arguments),this.didDragMove=!1,this.storeTypes={mouseStore:h.Z},this.handleDragStart=()=>{m.ZH(this.environment),this.stores.mouseStore.setState({...this.stores.mouseStore.state,mousePressed:!0}),this.didDragMove=!1,P({...w.sidebarResizingStore.state,isResizing:!0},this.props.type)},this.handleDragMove=e=>{const{type:t}=this.props;switch(f.clear(this.environment),this.didDragMove=!0,t){case"page":S.setWidth({width:U(e.currentX,this.props.type),environment:this.environment});break;case"update":S.setUpdateWidth({width:U(e.currentX,this.props.type),environment:this.environment});break;case"peek":S.setPeekWidth({width:U(e.currentX,this.props.type),environment:this.environment});break;case"inbox":v.c(U(e.currentX,this.props.type));break;default:(0,l.t1)(t)}},this.handleDragEnd=()=>{const{type:e}=this.props;if(!this.didDragMove){switch(e){case"page":S.setExpand({environment:this.environment,isExpanded:!w.sidebarExpandedStore.state,from:"sidebar_resizer"}),w.sidebarOpenStore.setState(!1);break;case"update":S.setUpdateExpand({environment:this.environment,isExpanded:!(0,y.Sx)(this.environment),from:"drag"});break;case"peek":p.xv(this.environment,"resizer_click");break;case"inbox":u.qQ({environment:this.environment,open:!M.default.isOpen()});break;default:(0,l.t1)(e)}this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})}this.stores.mouseStore.setState({...this.stores.mouseStore.state,mousePressed:!1}),P({isResizing:!1},this.props.type)},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDragCancel=()=>{return e=this.props.type,(t=this.stores.mouseStore).setState({...t.state,mousePressed:!1}),void P({isResizing:!1},e);var e,t}}renderComponent(){const{device:e}=this.environment,{type:t}=this.props,n=function(e){const t=function(e){switch(e){case"page":return w.sidebarWidthStore.state;case"inbox":return b.l5();case"update":return k.ZP.state.width;case"peek":return _.default.state.preferredSidePeekWidth;default:(0,l.t1)(e)}}(e);switch(e){case"page":return t;case"inbox":return w.sidebarWidthStore.state+b.l5();case"peek":case"update":return window.innerWidth-t;default:(0,l.t1)(e)}}(this.props.type),o=w.sidebarMouseEnterYStore.state;if(!x.Z.state&&!e.isChromebook)return(0,T.jsx)(E.ZP,{renderTooltip:()=>(0,T.jsx)(Z,{type:this.props.type}),originRect:new DOMRect(n,o,0,0),delayThreshold:500,placement:"page"===t||"inbox"===t?E.ug.Right:E.ug.Left,originGap:10,render:e=>(0,T.jsx)("div",{style:R(this.props.type,this.environment),...(0,g.Z)(e,{onMouseMove:()=>function(e){P({isResizerHovered:!0},e)}(this.props.type),onMouseLeave:()=>function(e){P({isResizerHovered:!1},e)}(this.props.type),onMouseEnter:O}),children:(0,T.jsx)(I.Z,{onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,onDraggableDragEnd:this.handleDragEnd,onDraggableDragCancel:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDragCancel,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,render:e=>(0,T.jsx)("div",{style:A(this.props.type),...e})})})})}}j.displayName="SidebarResizer";const L=j;function P(e,t){switch(t){case"page":w.sidebarResizingStore.update((t=>({...t,...e})));break;case"update":k.ZP.update((t=>({...t,...e})));break;case"inbox":M.default.update((t=>({...t,...e})));break;case"peek":break;default:(0,l.t1)(t)}}function A(e){return{cursor:"col-resize",height:"100%",width:12,marginLeft:"update"===e?-k.ZP.state.width:-6}}function U(e,t){let n;switch(t){case"page":n=e;break;case"inbox":n=e-(w.sidebarExpandedStore.state?w.sidebarWidthStore.state:0);break;case"peek":case"update":n=window.innerWidth-e;break;default:(0,l.t1)(t)}const o=function(e){const t=window.innerWidth;switch(e){case"page":return 480;case"update":return Math.min(t/2,y.Nc);case"peek":return t>2*_.sidePeekMinWidth?t/1.5:t;case"inbox":return C.Rx;default:(0,l.t1)(e)}}(t),r=function(e){switch(e){case"page":return w.SidebarMinWidth;case"update":return k.AO;case"peek":return _.sidePeekMinWidth;case"inbox":return C.fK;default:(0,l.t1)(e)}}(t);return n>o?o:n<r?r:n}function R(e,t){const n=(0,y.in)(t);return{position:"absolute",left:"peek"===e?0:void 0,right:"peek"!==e?0:void 0,width:0,flexGrow:0,zIndex:"peek"===e?d.YO:1,top:n?0:-1,bottom:n?0:-1,pointerEvents:"auto"}}function Z(e){let{type:t}=e;window.__c={n:"TooltipComponent"};const n=(0,a.Fg)(),r=(0,i.O7)(),d=(0,s.VK)((()=>function(e,t){switch(e){case"page":return(0,y.in)(t);case"update":return(0,y.Sx)(t);case"peek":return _.default.state.open;case"inbox":return M.default.isOpen();default:(0,l.t1)(e)}}(t,r)),[t,r]),u=n.mediumInvertedTextColor;return(0,T.jsxs)("div",{style:{textAlign:"center"},children:[(0,T.jsx)(c.FormattedMessage,{defaultMessage:"Drag <invertedcolor>to resize</invertedcolor>",id:"sidebarResizer.tooltip.dragMessage",values:{invertedcolor:e=>(0,T.jsx)("span",{style:{color:u},children:e})}}),(0,T.jsxs)(o.Fragment,{children:[(0,T.jsx)("br",{}),(0,T.jsx)(c.FormattedMessage,{defaultMessage:"Click <invertedcolor>to {expanded, select, true {close} other {lock open}}</invertedcolor>",id:"sidebarResizer.clickToToggleSidebar.message",values:{expanded:d,invertedcolor:e=>(0,T.jsx)("span",{style:{color:u},children:e})}})]})]})}function O(e){w.sidebarMouseEnterYStore.setState(e.clientY)}},60442:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});n(67294);var o=n(82990),r=n(47853),i=n(85893);const s=function(e){let{imageURL:t,imageWidth:n,imageHeight:o,caption:s,title:l}=e;if(t){const e=(0,r.D)(t);return(0,i.jsxs)("div",{style:{width:n||200,marginTop:4,marginBottom:4},children:[(0,i.jsx)("div",{style:{width:"100%",height:o||100,borderRadius:4,backgroundImage:`url(${e})`,backgroundSize:"cover",marginBottom:6}}),(0,i.jsx)(a,{caption:s,title:l})]})}return(0,i.jsx)(a,{caption:s,title:l,style:{width:n}})};function a(e){let{style:t,caption:n,title:r}=e;return(0,i.jsxs)("div",{style:{whiteSpace:"normal",lineHeight:1.4,...t},children:[r&&(0,i.jsx)("header",{style:{fontWeight:o.Z.fontWeight.bold,marginBottom:4},children:r}),n]})}},80133:(e,t,n)=>{"use strict";n.d(t,{Z:()=>B});n(67294);var o=n(83355),r=n(86628),i=n(24405),s=n(45238),a=n(85893);const l=(0,s.I)("mobileBottomBarUpdates",{viewBox:"0 0 26 26",svg:(0,a.jsx)("path",{d:"M4.48145 20.4092H15.2988C15.2129 21.8594 14.2891 22.7832 12.9893 22.7832C11.7002 22.7832 10.7656 21.8594 10.6904 20.4092H9.01465C9.10059 22.4717 10.7227 24.2871 12.9893 24.2871C15.2666 24.2871 16.8887 22.4824 16.9746 20.4092H21.5078C22.5176 20.4092 23.1299 19.8828 23.1299 19.1094C23.1299 18.0352 22.0342 17.0684 21.1104 16.1123C20.4014 15.3711 20.208 13.8457 20.1221 12.6104C20.0469 8.37793 18.9512 5.63867 16.0938 4.60742C15.7285 3.21094 14.5791 2.09375 12.9893 2.09375C11.4102 2.09375 10.25 3.21094 9.89551 4.60742C7.03809 5.63867 5.94238 8.37793 5.86719 12.6104C5.78125 13.8457 5.58789 15.3711 4.87891 16.1123C3.94434 17.0684 2.85938 18.0352 2.85938 19.1094C2.85938 19.8828 3.46094 20.4092 4.48145 20.4092ZM4.94336 18.7871V18.6582C5.13672 18.3359 5.78125 17.7129 6.33984 17.0791C7.11328 16.2197 7.47852 14.8447 7.5752 12.7393C7.66113 8.05566 9.05762 6.55176 10.8945 6.05762C11.1631 5.99316 11.3135 5.85352 11.3242 5.58496C11.3564 4.45703 12.001 3.67285 12.9893 3.67285C13.9883 3.67285 14.6221 4.45703 14.665 5.58496C14.6758 5.85352 14.8154 5.99316 15.084 6.05762C16.9316 6.55176 18.3281 8.05566 18.4141 12.7393C18.5107 14.8447 18.876 16.2197 19.6387 17.0791C20.208 17.7129 20.8418 18.3359 21.0352 18.6582V18.7871H4.94336Z"})});var d=n(59078);const c=(0,s.I)("sidebarUpdates",{viewBox:"0 0 20 20",svg:(0,a.jsx)("path",{d:"M6.87695 10.8601C6.72038 10.8601 6.58708 10.8072 6.47705 10.7014C6.37126 10.5956 6.31836 10.4644 6.31836 10.3079C6.31836 10.1555 6.37126 10.0264 6.47705 9.92065C6.58708 9.81486 6.72038 9.76196 6.87695 9.76196H9.44775V6.24536C9.44775 6.08879 9.50065 5.9576 9.60645 5.85181C9.71224 5.74601 9.84131 5.69312 9.99365 5.69312C10.1502 5.69312 10.2814 5.74601 10.3872 5.85181C10.493 5.9576 10.5459 6.08879 10.5459 6.24536V10.3079C10.5459 10.4644 10.493 10.5956 10.3872 10.7014C10.2814 10.8072 10.1502 10.8601 9.99365 10.8601H6.87695ZM10 16.6174C9.0944 16.6174 8.2417 16.4439 7.44189 16.0969C6.64209 15.7542 5.9375 15.2781 5.32812 14.6687C4.71875 14.0593 4.24056 13.3569 3.89355 12.5613C3.55078 11.7615 3.37939 10.9067 3.37939 9.99683C3.37939 9.09123 3.55078 8.24064 3.89355 7.44507C4.24056 6.64526 4.71663 5.94067 5.32178 5.3313C5.93115 4.72192 6.63574 4.24585 7.43555 3.90308C8.23535 3.55607 9.08805 3.38257 9.99365 3.38257C10.8993 3.38257 11.752 3.55607 12.5518 3.90308C13.3558 4.24585 14.0604 4.72192 14.6655 5.3313C15.2749 5.94067 15.7531 6.64526 16.1001 7.44507C16.4471 8.24064 16.6206 9.09123 16.6206 9.99683C16.6206 10.9067 16.4471 11.7615 16.1001 12.5613C15.7531 13.3569 15.2749 14.0593 14.6655 14.6687C14.0604 15.2781 13.3579 15.7542 12.5581 16.0969C11.7583 16.4439 10.9056 16.6174 10 16.6174ZM10 15.1638C10.7152 15.1638 11.3838 15.0305 12.0059 14.7639C12.6322 14.4973 13.1823 14.1292 13.6562 13.6594C14.1302 13.1855 14.5005 12.6375 14.7671 12.0154C15.0337 11.3891 15.167 10.7162 15.167 9.99683C15.167 9.28166 15.0316 8.61304 14.7607 7.99097C14.4941 7.36466 14.1239 6.81453 13.6499 6.34058C13.1802 5.86662 12.6322 5.49634 12.0059 5.22974C11.3838 4.96313 10.7131 4.82983 9.99365 4.82983C9.27848 4.82983 8.60775 4.96313 7.98145 5.22974C7.35938 5.49634 6.81136 5.86662 6.3374 6.34058C5.86768 6.81453 5.49951 7.36466 5.23291 7.99097C4.97054 8.61304 4.83936 9.28166 4.83936 9.99683C4.83936 10.7162 4.97054 11.3891 5.23291 12.0154C5.49951 12.6375 5.86979 13.1855 6.34375 13.6594C6.81771 14.1292 7.36572 14.4973 7.98779 14.7639C8.6141 15.0305 9.28483 15.1638 10 15.1638Z"})});var u=n(82990),p=n(9291),m=n(19719),h=n(17659),g=n(8055),f=n(98742),v=n(50659),b=n(18514),S=n(51811),y=n(77907),w=n(48451),k=n(50770),x=n(4023),C=n(5162),M=n(62820),_=n(4761),I=n(64921),E=n(31945),T=n(58261),j=n(26388),L=n(39849),P=n(92955),A=n(14694);const U={display:"flex",alignItems:"center",justifyContent:"center",width:62,flex:"none"},R={display:"flex",alignItems:"center",justifyContent:"center",flex:1},Z={display:"flex",alignItems:"center",justifyContent:"center",flexGrow:0,flexShrink:0,height:"100%",minWidth:34,position:"relative"};class O extends o.Z{willUnmount(){V(this.environment)}renderComponent(){const{device:e,mobileNative:t}=this.environment;if(this.props.format===S.EX.RenderAsPage)return(0,a.jsx)("div",{style:{background:this.theme.popoverBackground},children:(0,k.H7)()?(0,a.jsx)(w.LV,{format:this.props.format,onClose:()=>D(this.environment)}):(0,a.jsx)(y.LazyUpdatesPopup,{format:this.props.format,onClose:()=>D(this.environment)})});const n=(0,a.jsx)(p.FormattedMessage,{defaultMessage:"Updates for all pages in this workspace",id:"updatesButton.tooltip"});return(0,a.jsx)(j.ZP,{renderTooltip:()=>(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:n}),(0,a.jsx)(T.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleAllUpdates"})]}),originGap:6,placement:x.u.Right,render:n=>(0,a.jsx)(E.ZP,{popupType:e.isMobile?E.Z4.SlideUp:E.Z4.Popup,alignmentToOrigin:x.v.Start,placementToOrigin:x.u.Right,onClick:()=>{return e=this.environment,_.ZP.endSession(),void h.G7({environment:e,newTab:"mentions",shouldTrack:!0});var e},originGap:0,style:{...!e.isMobile&&{width:500,overflow:"hidden"}},isWideTabletWidth:!0,render:()=>(0,k.H7)()?(0,a.jsx)(w.LV,{format:this.props.format,onClose:()=>D(this.environment)}):(0,a.jsx)(y.LazyUpdatesPopup,{format:this.props.format,onClose:()=>D(this.environment)}),onClose:()=>{V(this.environment)},isFullWidthOnMobile:!0,preventScaleTransition:!0,preventSlideUpTransition:(null==t?void 0:t.supportsNativeHomeOnPhone())||!1,buttonPopupStore:M.Z,renderOrigin:e=>(0,a.jsx)(N,{format:this.props.format,tooltipEvents:n,buttonPopupEvents:e})})})}}O.displayName="UpdatesButton";const B=O;function N(e){let{tooltipEvents:t,buttonPopupEvents:n,format:o}=e;window.__c={n:"ButtonComponent"};const s=(0,i.Fg)(),m=(0,r.VK)((()=>M.Z.state.open),[]),g=(0,r.VK)((()=>h.aY()),[]),b=(0,r.VK)((()=>(0,k.H7)()),[]),y=(0,r.VK)((()=>function(e){return e===S.EX.Sidebar&&M.Z.state.open}(o)),[o]),w=L.N.Red;if(o===S.EX.MobileBottomBarPhone)return(0,a.jsx)(I.Z,{style:R,mobileFeedback:!0,...n,children:(0,a.jsxs)("div",{style:{position:"relative"},children:[b?(0,d.W)({height:26,width:26,fill:s.regularTextColor}):l({width:26,fill:s.regularTextColor}),(0,a.jsx)(P.Z,{type:"currentSpace",color:w,style:{position:"absolute",top:-3,right:g<99?-5:-8}})]})});if(o===S.EX.MobileBottomBarTablet)return(0,a.jsx)(I.Z,{style:U,mobileFeedback:!0,...n,children:(0,a.jsxs)("div",{style:{position:"relative"},children:[l({width:26,fill:s.regularTextColor}),(0,a.jsx)(P.Z,{type:"currentSpace",color:w,style:{position:"absolute",top:-3,right:g<99?-5:-8}})]})});if(o===S.EX.TopbarMobile)return(0,a.jsxs)(I.Z,{style:{...Z,marginLeft:2,marginRight:2},mobileFeedback:!0,...n,children:[b?(0,d.W)({height:26,width:26}):l({width:26}),(0,a.jsx)(P.Z,{type:"currentSpace",color:w,style:{position:"absolute",top:8,right:0}})]});if(o===S.EX.SidebarMobile)return(0,a.jsxs)(I.Z,{style:Z,mobileFeedback:!0,...n,children:[b?(0,d.W)({height:26,width:26}):l({width:26}),(0,a.jsx)(P.Z,{type:"currentSpace",color:w,style:{position:"absolute",top:8,right:0}})]});if(o===S.EX.Sidebar){const e=(0,a.jsx)(p.FormattedMessage,{defaultMessage:"Updates",id:"updatesButton.allUpdates.sidebarButton"}),o=b?(0,d.W)({fill:y?s.regularIconColor:s.mediumIconColor,width:20}):c({fill:y?s.regularIconColor:s.mediumIconColor,width:20});return(0,a.jsx)(I.Z,{style:{...y&&{fontWeight:u.Z.fontWeight.medium,color:s.regularTextColor},...(0,v.G$)({isMobile:!1})},...(0,f.Z)(t,n),children:(0,a.jsx)(A.Z,{left:(0,a.jsx)("div",{style:{color:y?s.regularTextColor:"inherit"},children:o}),right:(0,a.jsx)(P.Z,{type:"currentSpace",color:w,style:{marginBottom:2,marginLeft:6}}),style:{background:m?s.buttonHoveredBackground:"none"},children:e})})}return null}function V(e){m.nI(e),h.G7({environment:e,newTab:"mentions",shouldTrack:!1})}function D(e){(0,C.Y)("supportsNativeInbox")&&b.__(e)&&b.NW(e)?g.op(e):(V(e),M.Z.setState({...M.Z.state,open:!1}))}},69098:(e,t,n)=>{"use strict";n.d(t,{j:()=>c,o:()=>o});var o={};n.r(o),n.d(o,{showAsyncModal:()=>p,showAsyncModalComponent:()=>m,testOnly:()=>w});var r=n(67294),i=n(86628),s=n(49085);class a extends s.default{getInitialState(){return{asyncModals:[]}}}const l=new a;var d=n(85893);const c=r.memo((e=>{window.__c={n:"AsyncModalRenderer"};const{store:t=l}=e,n=(0,i.VK)((()=>t.state.asyncModals),[t]);return(0,d.jsx)(d.Fragment,{children:n.map((e=>{const{id:t,internalRenderModal:n,isOpen:o}=e,i=n(o);return(0,d.jsx)(r.Fragment,{children:i},t)}))})}));var u=n(4615);function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;return new Promise(((n,o)=>{try{h({asyncModal:b({renderModal:e,promiseResolve:n,promiseReject:o,store:t}),store:t})}catch(r){o(r)}}))}function m(e){return p((t=>r.createElement(e,t)),arguments.length>1&&void 0!==arguments[1]?arguments[1]:l)}function h(e){const{asyncModal:t,store:n=l}=e;n.update((e=>({asyncModals:[...e.asyncModals,t]})))}function g(e){const{id:t,promiseResolve:n,store:o=l}=e;return e=>{const r=S({id:t,store:o});null!=r&&r.isOpen&&(y({id:t,store:o,update:{isOpen:!1}}),n(e))}}function f(e){const{id:t,promiseResolve:n,store:o=l}=e;return()=>{const e=S({id:t,store:o});null!=e&&e.isOpen&&(y({id:t,store:o,update:{isOpen:!1}}),n())}}function v(e){const{id:t,store:n=l}=e;return()=>{n.update((e=>({asyncModals:e.asyncModals.filter((e=>e.id!==t))})))}}function b(e){const{renderModal:t,promiseResolve:n,promiseReject:o,store:r=l}=e,i=(0,u.ZP)(),s=v({id:i,store:r}),a=f({id:i,promiseResolve:n,store:r}),d=g({id:i,promiseResolve:n,store:r});return{id:i,internalRenderModal:e=>{try{return t({isOpen:e,onClosed:s,onDismiss:a,resolve:d})}catch(n){throw o(n),n}},isOpen:!0}}function S(e){const{id:t,store:n=l}=e;return n.state.asyncModals.find((e=>e.id===t))}function y(e){const{id:t,update:n,store:o=l}=e;o.update((e=>({asyncModals:e.asyncModals.map((e=>e.id!==t?e:{...e,...n}))})))}const w={addAsyncModal:h,createAsyncModal:b,createOnClosed:v,createOnDismiss:f,createResolve:g,getAsyncModal:S,updateAsyncModal:y}},30106:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},83420:(e,t,n)=>{"use strict";n.d(t,{TL:()=>u,nc:()=>c,ue:()=>d});var o=n(66897),r=n(54368),i=n(77420),s=n(19889),a=n(97880),l=n(79797);function d(e){const{parentStore:t,pointer:n}=e,r=(0,l.Kv)(t,n).getValue();if(r)return(0,o.LU)({table:n.table,value:r})}function c(e){const{parentStore:t,pointer:n}=e;return n.table===i.cZ?l.Qx.createChildStore(t,n):n.table===s.KJ?l.U6.createChildStore(t,n):n.table===r.y?l.fg.createChildStore(t,n):void(0,a.t1)(n)}function u(e){return e.table===i.cZ?(0,o.ON)(e.getValue()):e.table===s.KJ?(0,o.m3)(e.getValue()):e.table===r.y?(0,o.I4)(e.getValue()):void(0,a.t1)(e)}},65556:(e,t,n)=>{"use strict";n.r(t),n.d(t,{setupOnBeforeUnload:()=>i,showConfirmationDialogEventEmitter:()=>o});const o=new(n(33147).Z),r={transaction_queue_has_tasks:"Changes you made may not be saved. Are you sure you want to quit?",uploading_files:"The files you are currently uploading may not be saved. Are you sure you want to quit?",generating_ai_completions:"Changes being made by AI may not be saved. Are you sure you want to quit?"};function i(e){const{TransactionQueue:t,device:n,AppUpdateStore:i,GlobalFileUploadStore:s}=e;window.onbeforeunload=function(){const e=!t.hasTasks()||n.isMobileNative||n.isElectron||i.isMajorUpdate()?s.isUploading()?"uploading_files":void 0:"transaction_queue_has_tasks";if(e)return o.emit(e),r[e]}}},80025:(e,t,n)=>{"use strict";n.d(t,{Vn:()=>s,mF:()=>a,qf:()=>d});var o=n(9291),r=n(33929);const i=(0,o.defineMessages)({default:{defaultMessage:"Light gray",id:"colors.select.lightGray"},gray:{defaultMessage:"Gray",id:"colors.select.gray"},translucentGray:{defaultMessage:"Gray",id:"colors.select.gray"},brown:{defaultMessage:"Brown",id:"colors.select.brown"},orange:{defaultMessage:"Orange",id:"colors.select.orange"},yellow:{defaultMessage:"Yellow",id:"colors.select.yellow"},green:{defaultMessage:"Green",id:"colors.select.green"},blue:{defaultMessage:"Blue",id:"colors.select.blue"},purple:{defaultMessage:"Purple",id:"colors.select.purple"},pink:{defaultMessage:"Pink",id:"colors.select.pink"},red:{defaultMessage:"Red",id:"colors.select.red"}});function s(e){const t=i[e]||i.gray;return r.default.formatMessage(t)}const a=(0,o.defineMessages)({foregroundColorDefault:{id:"action.foregroundColor.default.name",defaultMessage:"Default"},foregroundColorGray:{id:"action.foregroundColor.gray.name",defaultMessage:"Gray"},foregroundColorBrown:{id:"action.foregroundColor.brown.name",defaultMessage:"Brown"},foregroundColorOrange:{id:"action.foregroundColor.orange.name",defaultMessage:"Orange"},foregroundColorYellow:{id:"action.foregroundColor.yellow.name",defaultMessage:"Yellow"},foregroundColorGreen:{id:"action.foregroundColor.green.name",defaultMessage:"Green"},foregroundColorBlue:{id:"action.foregroundColor.blue.name",defaultMessage:"Blue"},foregroundColorPurple:{id:"action.foregroundColor.purple.name",defaultMessage:"Purple"},foregroundColorPink:{id:"action.foregroundColor.pink.name",defaultMessage:"Pink"},foregroundColorRed:{id:"action.foregroundColor.red.name",defaultMessage:"Red"},backgroundColorGray:{id:"action.backgroundColor.gray.name",defaultMessage:"Gray background"},backgroundColorBrown:{id:"action.backgroundColor.brown.name",defaultMessage:"Brown background"},backgroundColorOrange:{id:"action.backgroundColor.orange.name",defaultMessage:"Orange background"},backgroundColorYellow:{id:"action.backgroundColor.yellow.name",defaultMessage:"Yellow background"},backgroundColorGreen:{id:"action.backgroundColor.green.name",defaultMessage:"Green background"},backgroundColorBlue:{id:"action.backgroundColor.blue.name",defaultMessage:"Blue background"},backgroundColorPurple:{id:"action.backgroundColor.purple.name",defaultMessage:"Purple background"},backgroundColorPink:{id:"action.backgroundColor.pink.name",defaultMessage:"Pink background"},backgroundColorRed:{id:"action.backgroundColor.red.name",defaultMessage:"Red background"},backgroundColorDefault:{id:"action.backgroundColor.default.name",defaultMessage:"Default background"}}),l={default:{...a.foregroundColorDefault},gray:{...a.foregroundColorGray},brown:{...a.foregroundColorBrown},orange:{...a.foregroundColorOrange},yellow:{...a.foregroundColorYellow},teal:{...a.foregroundColorGreen},blue:{...a.foregroundColorBlue},purple:{...a.foregroundColorPurple},pink:{...a.foregroundColorPink},red:{...a.foregroundColorRed},gray_background:{...a.backgroundColorGray},brown_background:{...a.backgroundColorBrown},orange_background:{...a.backgroundColorOrange},yellow_background:{...a.backgroundColorYellow},teal_background:{...a.backgroundColorGreen},blue_background:{...a.backgroundColorBlue},purple_background:{...a.backgroundColorPurple},pink_background:{...a.backgroundColorPink},red_background:{...a.backgroundColorRed}};function d(e){return l[e]}},70511:(e,t,n)=>{"use strict";n.r(t),n.d(t,{setupTransactionLoadGenerator:()=>l});var o=n(92595),r=n(993),i=n(82530),s=n(80444),a=n(24666);function l(e){(0,o.exposeDebugValue)("generateTransactionLoad",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const l=s.default.state.mainEditorCurrentBlockStore;if(!l)return void console.info("Cannot generateTransactionLoad: No current block");const d=l.getTitleStore();if(!d)return void console.info("Cannot generateTransactionLoad: block has no title");if("editing"!==a.default.state.mode)return void console.info("not editing anything. Click the page title.");const c=t=>{i.createAndCommit({userAction:"generateTransactionLoad.createTransaction",environment:e,perform:o=>{console.info("createAndCommit #",t);for(let i=0;i<n;i++){const n=`This is transaction #${t+1}, op ${i+1}, of load started at ${u}`;r.aS({environment:e,store:d,newValue:n,disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:o})}}})},u=new Date;if(0===o)for(let e=0;e<t;e++)c(e);else{let e=0;const n=setInterval((()=>{e<t?(c(e),e++):clearInterval(n)}),o)}}))}},92725:(e,t,n)=>{"use strict";n.r(t),n.d(t,{instrumentRenderQueue:()=>d});var o=n(1302),r=n(77897),i=n(29091),s=n(97978),a=n(97448);const l={componentRender:{enabledPercent:0,sampleRate:0},recomputeStore:{enabledPercent:0,sampleRate:0}};function d(e){const t=(0,a.fastGetConfig)("event_trail_events"),n=(null==t?void 0:t.get("browser.render_queue.component_render",l.componentRender))||l.componentRender,d=(null==t?void 0:t.get("browser.render_queue.store_recompute",l.recomputeStore))||l.recomputeStore;if(0===n.enabledPercent&&0===d.enabledPercent)return;const c=Math.random(),u=(0,i.XJ)(1e4);(0,r.aw)(n.enabledPercent,(()=>c))&&o.default.setComponentRenderTracker({shouldTrackThisRender:()=>(0,r.aw)(n.sampleRate,u),trackRender:t=>{let{componentName:n,renderTime:o}=t;s.j(e,"browser.render_queue.component_render",{time:o,component:n})}}),(0,r.aw)(d.enabledPercent,(()=>c))&&o.default.setStoreRecomputeTracker({shouldTrackThisRecompute:()=>(0,r.aw)(d.sampleRate,u),trackRecompute:(t,n)=>{s.j(e,"browser.render_queue.store_recompute",{time:n,computed_store:t})}})}},19077:(e,t,n)=>{"use strict";n.r(t),n.d(t,{initialize:()=>a});var o=n(68626),r=n(95477),i=n(77080),s=n(15517);function a(e){"object"==typeof r.default&&r.default.version&&(o.clientLogglyEnvironmentData.version=r.default.version);const{device:t,currentUser:n}=e;t.isMobileNative&&(o.clientLogglyEnvironmentData.isMobileNative=!0),t.isMobile&&(o.clientLogglyEnvironmentData.isMobile=!0),t.isAndroid&&(o.clientLogglyEnvironmentData.isAndroid=!0),t.isIOS&&(o.clientLogglyEnvironmentData.isIOS=!0),t.isElectron&&(o.clientLogglyEnvironmentData.isElectron=!0),t.isChromeExtension&&(o.clientLogglyEnvironmentData.isChromeExtension=!0),o.clientLogglyEnvironmentData.os=t.os,o.clientLogglyEnvironmentData.platform=t.platform,window.navigator.userAgent&&(o.clientLogglyEnvironmentData.userAgent=window.navigator.userAgent),document.referrer&&(o.clientLogglyEnvironmentData.referrer=document.referrer),n.id&&(o.clientLogglyEnvironmentData.userId=n.id),o.clientLogglyEnvironmentData.experiments=i.default.getUsedNonControlExperimentsMap(),i.default.addListener((()=>{o.clientLogglyEnvironmentData.experiments=i.default.getUsedNonControlExperimentsMap()})),(0,s.sK)().then((e=>{e&&(o.clientLogglyEnvironmentData.storageUsageEstimate=e.usage,o.clientLogglyEnvironmentData.storageQuotaEstimate=e.quota)}))}},50659:(e,t,n)=>{"use strict";n.d(t,{G$:()=>i,MF:()=>s,Z3:()=>r});const o=4;function r(e){let{isMobile:t}=e;return{...!t&&{borderRadius:3}}}function i(e){let{isMobile:t}=e;return t?{}:{...r({isMobile:t}),marginLeft:o,marginRight:o,width:`calc(100% - ${2*o}px)`,transition:"background 100ms ease-out"}}function s(){return{paddingLeft:14-o,paddingRight:14-o}}},51811:(e,t,n)=>{"use strict";n.d(t,{EX:()=>o,HB:()=>l,IS:()=>d,Tj:()=>a,yW:()=>s});let o=function(e){return e[e.Sidebar=0]="Sidebar",e[e.SidebarMobile=1]="SidebarMobile",e[e.MobileBottomBarPhone=2]="MobileBottomBarPhone",e[e.MobileBottomBarTablet=3]="MobileBottomBarTablet",e[e.TopbarMobile=4]="TopbarMobile",e[e.RenderAsPage=5]="RenderAsPage",e}({});const r=new Map,i=new Map;function s(e,t){r.set(c(e),t)}function a(e){return r.get(c(e))}function l(e,t){i.set(u(e),t)}function d(e){return i.get(u(e))??[]}function c(e){return Object.keys(e).sort().map((t=>{const n=e[t];return JSON.stringify(n)})).join("-")}function u(e){return Object.keys(e).sort().map((t=>{const n=e[t];return JSON.stringify(n)})).join("-")}},48916:(e,t,n)=>{"use strict";n.r(t),n.d(t,{mainApp:()=>o});n(21703);async function o(e){const{minimalEnvironment:t,mainStartTime:o,prefetchInitiatedTime:r,prefetchCache:i}=e,{device:s}=t,[{setupOnBeforeUnload:a},l,{createClientEnvironment:d},{setupTransactionQueue:c},{default:u},p]=await Promise.all([Promise.resolve().then(n.bind(n,65556)),Promise.resolve().then(n.bind(n,68626)),Promise.resolve().then(n.bind(n,20882)),Promise.resolve().then(n.bind(n,53730)),Promise.resolve().then(n.bind(n,27411)),Promise.resolve().then(n.bind(n,44133))]);let m=await d({minimalEnvironment:t,prefetchCache:i});const{ElectronSqlite:h}=m;p.setupRecordCacheDebugging(s);const g=await c(m);a({device:s,TransactionQueue:g,AppUpdateStore:m.AppUpdateStore,GlobalFileUploadStore:u});const[f,{default:v}]=await Promise.all([Promise.resolve().then(n.bind(n,19077)),Promise.resolve().then(n.bind(n,18245))]);if(f.initialize(m),s.isMobileNative){const e=v.mark("mobilenative.initialize_from_js"),[t,o]=await Promise.all([Promise.resolve().then(n.bind(n,98958)),Promise.resolve().then(n.bind(n,57491))]);await t.initializeMobileNativeApp(m),Object.assign(l.clientLogglyEnvironmentData,o.getMobileNativeDeviceInfo()),v.measure(e,{environment:m,data:{}})}if(s.isElectron){const e=await Promise.resolve().then(n.bind(n,47839));await e.initializeElectron({device:s,electronSqlite:h});const t=await Promise.resolve().then(n.bind(n,74503)),o=await t.getDesktopDeviceInfo();Object.assign(l.clientLogglyEnvironmentData,o,{desktopVersion:s.desktopAppVersion})}const[b,S,y,w,k]=await Promise.all([Promise.resolve().then(n.bind(n,97977)),Promise.resolve().then(n.bind(n,74948)),Promise.resolve().then(n.bind(n,89224)),Promise.resolve().then(n.bind(n,32219)),Promise.resolve().then(n.bind(n,82530))]),{setupTransactionLoadGenerator:x}=await Promise.resolve().then(n.bind(n,70511));x(m);const C=performance.now(),[{default:M},_,I,E,{CurrentUser:T},{getGhostAdminUserId:j},{default:L}]=await Promise.all([Promise.resolve().then(n.bind(n,52418)),Promise.resolve().then(n.t.bind(n,67294,19)),Promise.resolve().then(n.t.bind(n,73935,19)),Promise.resolve().then(n.t.bind(n,20745,19)),Promise.resolve().then(n.bind(n,87997)),Promise.resolve().then(n.bind(n,12955)),Promise.resolve().then(n.bind(n,77080))]);S.initialize(),y.startListeners(s),m=await b.initialize(m),m.updateCurrentUserId=async e=>{const t=await j(m),n={...e.environment,currentUser:new T({id:e.currentUserId,loggedInUserIds:e.userIds,adminUserId:t})};z(n)},w.initialize(m),g.startLoop();const[{maybeClearCookies:P,refreshNotionCookies:A,validateHasPermissionArgs:U,clearNotionCookiesWithNoPermission:R,clearThirdPartyCookiesAndLocalStorageWithNoPermission:Z},{clearNotionLocalStorageWithNoPermission:O},{instrumentRenderQueue:B},N,V,{deviceSupportsSqlite:D}]=await Promise.all([Promise.resolve().then(n.bind(n,12955)),Promise.resolve().then(n.bind(n,18613)),Promise.resolve().then(n.bind(n,92725)),Promise.resolve().then(n.bind(n,32223)),Promise.resolve().then(n.bind(n,32603)),Promise.resolve().then(n.bind(n,26492))]);P(),Promise.all([R(m),Z(m)]).then((()=>A(m))),O(),U(m);const[{TransactionQueueDependenciesImpl:F}]=await Promise.all([Promise.resolve().then(n.bind(n,68026))]);if(D(m.device)){const{default:e}=await Promise.resolve().then(n.bind(n,41226));e.setNotionPerformance(v)}B(m);const z=e=>{const t=performance.now(),n=document.querySelector("#notion-app");if(!n)throw new Error('Could not find element with id "notion-app"');const i=L.checkGate("react_18_concurrent_rendering");g.updateDependencies(new F(e)),k.updateConnectionState(e),N.updateEnvironment(e),l.clientLogglyEnvironmentData.userId=e.currentUser.id;const s=()=>{const e=document.getElementById("initial-loading-spinner"),n=document.getElementById("skeleton");e&&e.remove(),n&&n.remove();const i=performance.now();V.setSubMetricsAtRenderCallback({mainStartTime:o,prefetchInitiatedTime:r,renderStartTime:t,renderEndTime:i,mainImportEndTime:C})},a=_.createElement(M,{environment:e,onMount:i?s:void 0});if(i){E.createRoot(n).render(a)}else I.render(a,n,s)};return z(m),{transactionQueue:g,environment:m}}},35350:(e,t,n)=>{"use strict";n.d(t,{T:()=>s,c:()=>a});var o=n(19719),r=n(41549),i=n(66353);function s(e,t){i.ZP.setState({...r.yJ(),filter:t}),o.bE(e,{tab:t})}function a(e){i.ZP.setState({...r.yJ(),width:e})}},52389:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},49038:(e,t,n)=>{"use strict";n.d(t,{Y:()=>A,f:()=>P});var o=n(58573),r=n(72126),i=n(4615),s=n(21202),a=n(45366),l=n(92338),d=n(97978),c=n(97638),u=(n(57658),n(80444)),p=n(46735),m=n(42198);const h=e=>{var t;let{result:n,featureExtractor:o}=e;const r=null===(t=o.frecencyStore)||void 0===t?void 0:t.getFrecencyScore(n.block.blockModel.id);return{name:"FRECENCY_SCORE",value:r||0}},g=e=>{let{result:t}=e;return{name:"LEXICAL_MATCH_SCORE",value:t.score}},f={name:"CLIENT_FEATURESET_V2_RAW",features:[e=>{let{result:t}=e;return{name:"IS_EXACT_MATCH",value:t.matchMetadata&&"isExactMatch"in t.matchMetadata?1:0}},e=>{let{result:t}=e;return{name:"IS_PREFIX_MATCH",value:t.matchMetadata&&"isPrefixMatch"in t.matchMetadata?1:0}},e=>{let{result:t}=e;return{name:"IS_WORD_PREFIX_MATCH",value:t.matchMetadata&&"isWordPrefixMatch"in t.matchMetadata?1:0}},e=>{let{result:t}=e;return{name:"IS_SUBSTRING_MATCH",value:t.matchMetadata&&"isSubstringMatch"in t.matchMetadata?1:0}},e=>{let{result:t}=e;return{name:"IS_FUZZY_MATCH",value:t.matchMetadata&&"isFuzzyMatch"in t.matchMetadata?1:0}},e=>{let{result:t}=e;return{name:"IS_FRECENT_PAGE",value:t.block.source.has("frecencyStore")?1:0}},e=>{let{result:t}=e;return{name:"IS_BOOKMARKED_PAGE",value:t.block.source.has("bookmarkedPage")?1:0}},e=>{let{result:t}=e;return{name:"IS_TEAM_PAGE",value:t.block.source.has("teamPage")?1:0}},e=>{let{result:t}=e;return{name:"IS_SHARED_PAGE",value:t.block.source.has("sharedPage")?1:0}},e=>{let{result:t,featureExtractor:n}=e;const[o,r]=n.getFrecencyScoreBounds();return{name:"FRECENCY_SCORE_SCALED",value:n.minMaxScale(h({result:t,featureExtractor:n}).value,o,r)}},e=>{let{result:t}=e;return{name:"IS_RECENT_VISIT_BY_ME",value:t.block.source.has("recentVisit")?1:0}},e=>{let{result:t}=e;return{name:"TIME_SINCE_LAST_VIEWED_BY_ME",value:t.block.timeSinceLastViewedMs??-1}},e=>{let{result:t,featureExtractor:n}=e;return{name:"IS_SIMILAR_USER_1D_RECENT_PAGE",value:m.default.isSimilarUsersRecentPages({userId:n.userId,spaceId:n.spaceId,pageId:t.block.blockModel.id})?1:0}},e=>{let{result:t,featureExtractor:n}=e;return{name:"NUM_SIMILAR_USERS_VIEWED_PAGE",value:m.default.getNumSimilarUsersVisitedPage({userId:n.userId,spaceId:n.spaceId,pageId:t.block.blockModel.id})||0}},e=>{let{result:t,featureExtractor:n}=e;return{name:"PAGE_MOST_SIMILAR_VIEWER_SIMILARITY",value:m.default.getHighestViewerSimilarityScoreForPage({userId:n.userId,spaceId:n.spaceId,pageId:t.block.blockModel.id})||0}},e=>{let{result:t,featureExtractor:n}=e;const o=m.default.getSimilarUsersMostRecentVisitTimeForPage({userId:n.userId,spaceId:n.spaceId,pageId:t.block.blockModel.id});return{name:"TIME_SINCE_SIM_USER_VISIT",value:o?n.currentTimeMs-o:-1}},e=>{let{result:t,featureExtractor:n}=e;return{name:"IS_TOP_PAGES_7D_PAGE_VIEWS",value:m.default.isTopPages7dPageView({userId:n.userId,spaceId:n.spaceId,pageId:t.block.blockModel.id})?1:0}},e=>{let{result:t,featureExtractor:n}=e;return{name:"PAGE_AUTHORITY_V1",value:m.default.getPageAuthorityV1ForPage({userId:n.userId,spaceId:n.spaceId,pageId:t.block.blockModel.id})||0}},e=>{let{result:t,featureExtractor:n}=e;return{name:"TIME_SINCE_LAST_EDIT",value:n.currentTimeMs-t.block.blockModel.last_edited_time}},e=>{let{result:t,featureExtractor:n}=e;return{name:"IS_LAST_EDITED_BY_ME",value:n.userId&&t.block.blockModel.last_edited_by_id===n.userId?1:0}},e=>{let{result:t}=e;return{name:"IS_LAST_EDITED_BY_ME_WITHIN_12H",value:t.block.source.has("defaultRecordCache")?1:0}},e=>{let{result:t,featureExtractor:n}=e;return{name:"TIME_SINCE_LAST_EDITED_BY_ME",value:m.default.getUserLastEditedTimeForPage({userId:n.userId,spaceId:n.spaceId,pageId:t.block.blockModel.id})??-1}},e=>{let{result:t,featureExtractor:n}=e;return{name:"TIME_SINCE_SIM_USER_LAST_EDIT",value:m.default.getSimilarUserLastEditedTimeForPage({userId:n.userId,spaceId:n.spaceId,pageId:t.block.blockModel.id})??-1}},g,h]};function v(e){let t=0,n=0;for(const o of e)o<t&&(t=o),o>n&&(n=o);return[t,n]}class b{constructor(e,t,n){var o;this.featuresets=void 0,this.frecencyStore=void 0,this.results=void 0,this.resultsFeatureMetadata={},this.userId=void 0,this.spaceId=void 0,this.currentTimeMs=void 0,this.frecencyStore=p.Z.lazyFrecencyStore.get(t.currentUser.id),this.featuresets=e,this.results=n,this.userId=t.currentUser.id,this.spaceId=null===(o=u.default.state.currentSpaceStore)||void 0===o?void 0:o.id,this.currentTimeMs=Date.now()}minMaxScale(e,t,n){return t===n?0:(e-t)/(n-t)}getFrecencyScoreBounds(){if(!this.resultsFeatureMetadata.minFrecencyScore||!this.resultsFeatureMetadata.maxFrecencyScore){const e=this.results.map((e=>h({result:e,featureExtractor:this}).value||0)),[t,n]=v(e);this.resultsFeatureMetadata.minFrecencyScore=t,this.resultsFeatureMetadata.maxFrecencyScore=n}return[this.resultsFeatureMetadata.minFrecencyScore,this.resultsFeatureMetadata.maxFrecencyScore]}getLexicalMatchScoreBounds(){if(!this.resultsFeatureMetadata.minLexicalMatchScore||!this.resultsFeatureMetadata.maxLexicalMatchScore){const e=this.results.map((e=>g({result:e,featureExtractor:this}).value||0)),[t,n]=v(e);this.resultsFeatureMetadata.minLexicalMatchScore=t,this.resultsFeatureMetadata.maxLexicalMatchScore=n}return[this.resultsFeatureMetadata.minLexicalMatchScore,this.resultsFeatureMetadata.maxLexicalMatchScore]}extractFeatureGroup(e){const t=[];for(const n of this.featuresets){const o={groupName:n.name,features:[]};for(const t of n.features)o.features.push(t({result:e,featureExtractor:this}));t.push(o)}return t}}var S=n(29026);var y=n(77080),w=n(26842),k=n(88893),x=n(43759);const C=1.25;function M(e){const{results:t,featureGroups:n}=e;return t.map(((e,t)=>{const{block:o,score:r,personalizationBoost:i,rendered:s,terms:a}=e;return{sources:[l.vp.Local],id:o.blockModel.id,spaceId:o.blockModel.space_id,score:r,localSource:o.source,personalizationBoost:i,terms:a,highlight:{text:s},featureGroups:n[t]}}))}function _(e){return e.has("recentVisit")||e.has("frecencyStore")||e.has("bookmarkedPage")||e.has("defaultRecordCache")?C:1}const I=(e,t,n,i,s)=>r.oA(e.map((e=>{if(!t.matches(e))return;let r;if(i.includes(e.blockModel.id))r={rendered:"",score:o.$r,matchMetadata:{isExactIdMatch:!0}};else{r=(0,o.C6)(n,e.text,{pre:l.Um,post:l.dK,ignoreFuzzyFallback:s})}if(r){const{rendered:t,score:n}=r;return{block:e,rendered:t,score:n,personalizationBoost:_(e.source),terms:[]}}}))),E=e=>Math.round(.6*e+.5);const T=e=>e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");function j(e){const{block:t,score:n,terms:o}=e,{source:r,text:i}=t,s=o.map(T).join("|"),a=new RegExp(s,"ig");return{block:t,rendered:o.length>0?i.replaceAll(a,`${l.Um}$&${l.dK}`):i,score:n,personalizationBoost:_(r),terms:o}}function L(e,t,n){const o=function(e,t,n){const o=e=>n.matches(e.block),r=(0,a.wS)(t);if(1===r.length)return e.search(t,{filter:o,prefix:!0,fields:["text","inits"]});const i=e.search(t,{filter:o,combineWith:"AND",fields:["text"]});if(i.length>0)return i;const s=r.filter((e=>e.length>=x.Q)),l=E(s.length);return e.search(t,{filter:e=>e.queryTerms.length>=l&&o(e)})}(e,t,n);return o.map(j)}function P(e){let{query:t,localCachedPages:n,userId:s,includeRecordMap:a,environment:l,applyRecallScoreThreshold:u,canUseLtr:p}=e;const{query:m,limit:h}=t,{filters:g,sort:v}=m,w=y.default.getEligibleGroup({experimentId:"search-client-page-match"}),x=function(e,t,n,o,r){const{blocks:s,getAllBlocks:a}=e,l=r.text.trim(),d=(0,i.nv)(l),u=d.length>0?d.join(" "):l,p=new c.uL(n),m="minisearch"===t||"minisearch-frecency"===t;return m&&u.length>0?L(s,u,p):m?a().filter((e=>p.matches(e.block))).map(j):I(a().map((e=>{let{block:t}=e;return t})),p,l,d,o)}(n,w,g,u,m);if(0===x.length)return;const C=function(e,t){const{field:n}=e,o="relevance"===n||"desc"===e.direction?-1:1;switch(n){case"lastEdited":case"scroll":return r.MR(t,(e=>{let{block:{blockModel:t}}=e;return o*(t.last_edited_time||0)}));case"created":return r.MR(t,(e=>{let{block:{blockModel:t}}=e;return o*(t.created_time||0)}));default:return r.MR(t,(e=>{let{score:t}=e;return o*t}))}}(v,x);p&&(0,d.j)(l,"search_local_recall_results",{num_visible_members:(0,k.qX)(),results:C.map((e=>({id:e.block.blockModel.id,localSource:[...e.block.source]})))});let _;if("relevance"===v.field&&"minisearch"!==w)if(t.query.text.length>1&&p){const e=C.map((e=>({...e,matchMetadata:(0,o.EB)(t.query.text,e.block.text)}))),n=new b([f],l,e);_=function(e){const{sort:t,currentUserId:n,unsorted:o}=e;return(0,c.YB)({sort:t,currentUserId:n,unsorted:o,batchSize:S.Xv})}({sort:v,unsorted:M({results:C,featureGroups:e.map((e=>n.extractFeatureGroup(e)))}),currentUserId:s})}else _=(0,c.YB)({sort:v,currentUserId:s,unsorted:M({results:C,featureGroups:C.map((e=>[]))}),batchSize:S.Xv});else _=M({results:C,featureGroups:C.map((e=>[]))});_=_.slice(0,h);const E=a??!0;return{total:x.length,results:_,recordMap:E?n.recordMap.toJson({allowVersionDowngrade:!1}):{},trackEventProperties:void 0}}function A(e){let{query:t,localCachedPages:n,parentStore:o,isOnline:r,environment:i,shouldLimitLocalResultsWhenOnline:a,applyScoreThresholdWhenOnline:d,maxLocalResultsOverride:u,canUseLtr:p}=e;const m=P({query:t,localCachedPages:n,userId:i.currentUser.id,environment:i,applyRecallScoreThreshold:r&&d,canUseLtr:p});if(!m)return;if(0===m.results.length)return{error:l.Ix.NoResults};let h=m.results.map(((e,t)=>({...e,originalPosition:t,store:w.G.createChildStore(o,{table:s.iU,id:e.id}),serverEventProperties:void 0})));const g=h.length;return r&&a&&(h=(0,c.g8)(i,h,u)),0===h.length?{error:l.Ix.NoResults}:{value:{total:g,results:h,debugInfo:void 0}}}},20882:(e,t,n)=>{"use strict";n.r(t),n.d(t,{createClientEnvironment:()=>ve});var o=n(26263),r=n(45631),i=n(87997),s=n(58287),a=n(94023),l=n(91814),d=n(27328),c=n(42389),u=n(20475),p=n(99747),m=n(12139),h=n(47839),g=n(22974),f=n(97978),v=n(12955);function b(e){return e.isBrowser&&function(e){if(!e.isChrome)return!1;try{const t=Number(e.browserVersion.split(".")[0]);return t>=92&&t<=121}catch(t){return!1}}(e)}var S=n(84709),y=n(97448),w=(n(21703),n(57658),n(28084)),k=n(68626),x=n(55652),C=n(72126),M=n(91155),_=n(77897),I=n(45953),E=n(21202),T=n(49984),j=n(35092),L=n(66504),P=n(77080),A=n(84693);let U=1;class R{constructor(e,t){this.trackWithDynamicSampling=void 0,this.getLatency=new x.s,this.batchReadWorkers=15,this.pendingWrites=I.Ao.create(),this.getManyFromDisk=async e=>{const t=I.Ao.create();e.forEach(((e,n)=>{let{pointer:o}=e;t.set(o,n)}));const n=await A.Q6(this.connection,e),o=I.Ao.create();for(const r of n)this.setCachedRecordMap(o,r);return e.map((e=>{let{pointer:t,userId:n}=e;const r=this.getInMemory(t,n);if(r)return r;const i=o.get(t);return i&&i[n]}))},this.diskReadQueue=new w.Z({batchSize:Math.floor(j.mz/3)-1,maxWorkers:this.batchReadWorkers>0?this.batchReadWorkers:1,performRequests:this.getManyFromDisk}),this.flushWrites=async()=>{const e=this.pendingWrites;this.pendingWrites=I.Ao.create();const t=C.VS(Array.from(e),(e=>{let{value:t}=e;return t?Object.values(t):[]}));try{var n;await A.Y3(this.connection,this.maxSize,t),null===(n=this.trackWithDynamicSampling)||void 0===n||n.call(this,{eventName:"sqlite_record_cache.flush_writes",eventProperties:{status:"success"},options:{preboot:!0,defaultSampleRateOverride:0}})}catch(r){var o;(0,_.aw)(this.sampleRateForFlushWritesErrorsInSentry())&&m.IE(r,{tags:{from:"SqliteRecordCache",type:"applyRecordCacheOperationsError"},extra:this.getExtraDataForReadOrWriteError(r)}),(0,_.aw)(this.sampleRateForFlushWritesErrorsInSplunk())&&k.log({level:"warning",from:"SqliteRecordCache",type:"applyRecordCacheOperationsError",error:{...(0,M.Ui)(r),miscDataString:JSON.stringify(this.getExtraDataForReadOrWriteError(r))}}),null===(o=this.trackWithDynamicSampling)||void 0===o||o.call(this,{eventName:"sqlite_record_cache.flush_writes",eventProperties:{status:"error"},options:{preboot:!0,defaultSampleRateOverride:0}})}},this.debouncedFlushWrites=C.Ds(this.flushWrites,500,{maxWait:3e3}),this.sampleRateForGetRecordErrorsInSentry=C.P2((()=>P.default.getConfigKey("sqlite_record_cache_errors","getRecordSampleRateSentry")),5e3),this.sampleRateForGetRecordErrorsInSplunk=C.P2((()=>P.default.getConfigKey("sqlite_record_cache_errors","getRecordSampleRateSplunk")),5e3),this.sampleRateForFlushWritesErrorsInSentry=C.P2((()=>P.default.getConfigKey("sqlite_record_cache_errors","flushWritesSampleRateSentry")),5e3),this.sampleRateForFlushWritesErrorsInSplunk=C.P2((()=>P.default.getConfigKey("sqlite_record_cache_errors","flushWritesSampleRateSplunk")),5e3),this.connection=e,this.maxSize=t}set(e,t,n,o,r){if(void 0===e||void 0===e.id){const t=new Error("Attempting to set a record with an invalid pointer.");return k.log({level:"error",from:"SqliteRecordCache",type:"SqliteRecordCache.setBadPointer",error:{message:"Attempting to set a record with an invalid pointer.",stack:t.stack},data:{pointer:e}}),void m.IE(t)}const i={pointer:e,userId:o=o||L.I,value:t,timestamp:Date.now(),importance:n};this.removePendingWrite(e,o,"delete"),this.enqueueWrite({type:"set",record:i,maybeStaleRecord:r})}async get(e,t){const n=`get ${U}`;t=t||L.I,U++,this.getLatency.start(n);try{const r=this.getInMemory(e,t);if(r)return this.enqueueWrite({type:"access",record:r}),this.getLatency.end(n,"memory"),r.value;const i=await(this.batchReadWorkers>0?this.diskReadQueue.enqueue({pointer:e,userId:t}):this.getFromDiskUnbatched(e,t));var o;if(i)return this.enqueueWrite({type:"access",record:i}),this.getLatency.end(n,"disk"),null===(o=this.trackWithDynamicSampling)||void 0===o||o.call(this,{eventName:"sqlite_record_cache.get_record",eventProperties:{status:"success"},options:{preboot:!0,defaultSampleRateOverride:0}}),i.value}catch(i){var r;return(0,_.aw)(this.sampleRateForGetRecordErrorsInSentry())&&m.IE(i,{tags:{from:"SqliteRecordCache",type:"getError"},extra:this.getExtraDataForReadOrWriteError(i)}),(0,_.aw)(this.sampleRateForGetRecordErrorsInSplunk())&&k.log({level:"warning",from:"SqliteRecordCache",type:"getError",error:{...(0,M.Ui)(i),miscDataString:JSON.stringify(this.getExtraDataForReadOrWriteError(i))}}),void(null===(r=this.trackWithDynamicSampling)||void 0===r||r.call(this,{eventName:"sqlite_record_cache.get_record",eventProperties:{status:"error"},options:{preboot:!0,defaultSampleRateOverride:0}}))}finally{this.getLatency.end(n,"miss")}}deleteRecord(e,t){t=t||L.I,this.removePendingWrite(e,t,"set"),this.enqueueWrite({type:"delete",record:{pointer:e,userId:t}})}async getBlocksWithParent(e){const t=Date.now(),n=e.userId||L.I,o=await A.lR(this.connection,{...e,timestamp:t,userId:n}),r=I.Ao.create(),i=C.oA(Array.from(this.pendingWrites).map((o=>{const i=o&&o.value&&n&&o.value[n];if(!i||"set"!==i.type)return;const s=i.record.value?i.record.value.value:void 0;if(!s)return;if(i.record.pointer.table!==E.iU)return;const a=s;return a.parent_id===e.parent.id&&a.parent_table===e.parent.table?(r.set(i.record.pointer,!0),i.record.timestamp<t&&(i.record.timestamp=t),i.record.value):void 0})));for(const s of o)r.get(s.pointer)||this.getInMemory(s.pointer,s.userId)||i.push(s.value);return i}async getPageBlocksByParent(e){const t=Date.now(),n=e.userId||L.I,o=await A.GF(this.connection,{...e,timestamp:t,userId:n});return o.forEach((e=>{this.enqueueWrite({type:"access",record:{pointer:e.pointer,timestamp:t,userId:n,importance:void 0,value:e.value}})})),o}async reset(){this.pendingWrites=I.Ao.create(),await A.G$(this.connection)}setTrackWithDynamicSampling(e){this.trackWithDynamicSampling=e}enqueueWrite(e){this.debouncedFlushWrites();const{pointer:t,userId:n}=e.record,o=this.pendingWrites.get(t),r=o&&o[n];if(r){if("set"===r.type&&"access"===e.type){const t={type:"set",record:{...r.record,timestamp:e.record.timestamp}};return void this.setCacheOperationMap(this.pendingWrites,t)}const t="set"===r.type&&!r.maybeStaleRecord&&r.record.value&&r.record.value.value?r.record.value.value.version:void 0,n="set"===e.type&&e.maybeStaleRecord&&e.record.value&&e.record.value.value?e.record.value.value.version:void 0;if("number"==typeof t&&"number"==typeof n&&t>=n)return}this.setCacheOperationMap(this.pendingWrites,e)}async getFromDiskUnbatched(e,t){const[n]=await this.getManyFromDisk([{pointer:e,userId:t}]);return n}getInMemory(e,t){const n=this.pendingWrites.get(e),o=n&&n[t];if(o&&"set"===o.type)return o.record}setCacheOperationMap(e,t){const n=t,{pointer:o,userId:r}=n.record,i=e.get(o)||{};e.set(o,{...i,[r]:n})}setCachedRecordMap(e,t){const{pointer:n,userId:o}=t,r=e.get(n)||{};e.set(n,{...r,[o]:t})}removePendingWrite(e,t,n){const o=this.pendingWrites.get(e);o&&o[t]&&o[t].type===n&&this.pendingWrites.delete(e)}getExtraDataForReadOrWriteError(e){return{errorSql:e instanceof T.S7?e.debugInfo.errorSql:void 0,lastSuccessfulSqlBatch:e instanceof T.q2?e.debugInfo.lastSuccessfulSqlBatch:void 0}}}var Z=n(4615),O=n(65044),B=n(77892);const N=[WebSocket.OPEN,WebSocket.CONNECTING];class V{constructor(){this.sqliteConnection=void 0,this.environment=void 0,this.requests=new Map}setEnvironment(e){var t;this.environment=e,null===(t=this.sqliteConnection)||void 0===t||t.setEnvironment(e)}async initialize(){if(h.electronApi&&h.electronApi.sqliteServerEnabled){await this.initializeWebSocket();const e={execSqliteBatchV2:async e=>{const t=(0,Z.ZP)(),{batch:n,precondition:o}=e,r=JSON.stringify({id:t,batch:n,precondition:o,auth:this.authToken});return await this.execSqliteBatchInner(t,r)},execSqliteBatch:async e=>{const t=(0,Z.ZP)(),n=JSON.stringify({id:t,batch:e,auth:this.authToken});return await this.execSqliteBatchInner(t,n)}};this.sqliteConnection=new O.s({connection:e,type:"v2",migrations:await(0,B.kk)(e)})}}async execSqliteBatchInner(e,t){const n=new Promise((t=>{this.requests.set(e,t)}));this.ws.readyState===WebSocket.CLOSED&&await this.initializeWebSocket();try{this.ws.send(t)}catch(r){const e=this.ws;this.ws.onopen=function(n){e.send(t)}}const o=await n;if(o.error)throw new Error("Received SQLite error.");return o.value}async initializeWebSocket(){if(!h.electronApi||!h.electronApi.getSqliteMeta)return;const e=await h.electronApi.getSqliteMeta();if(e.error)return;if(this.ws&&N.includes(this.ws.readyState))return;const{serverProcessPort:t,authToken:n}=e.value;this.authToken=n;const o=`ws://127.0.0.1:${t}`;this.ws=new WebSocket(o),this.ws.onclose=()=>{k.log({level:"warning",from:"electronSqlite",type:"reinitializingWebsocket"}),this.initializeWebSocket()},this.ws.addEventListener("message",(e=>{const t=e.data.toString(),{id:n,result:o}=JSON.parse(t),r=this.requests.get(n);r&&(this.requests.delete(n),r({value:o}))})),await new Promise((e=>{this.ws.onopen=()=>{e()}}))}}class D{constructor(){this.worker=new Worker(new URL(n.p+n.u(7244),n.b))}postMessage(e){this.worker.postMessage(e)}addMessageListener(e){this.worker.addEventListener("message",e)}removeMessageListener(e){this.worker.removeEventListener("message",e)}}class F{constructor(){this.sqliteConnection=void 0,this.worker=new D}setEnvironment(e){var t;null===(t=this.sqliteConnection)||void 0===t||t.setEnvironment(e)}async initialize(){await this.initializeServiceWorker();const e={execSqliteBatchV2:async e=>{const t=(0,Z.ZP)();return this.execSqliteBatchInner(t,e)},execSqliteBatch:async e=>{const t=(0,Z.ZP)();return this.execSqliteBatchInner(t,{batch:e})}};this.sqliteConnection=new O.s({connection:e,type:"v2",migrations:await(0,B.kk)(e)})}async execSqliteBatchInner(e,t){return new Promise(((n,o)=>{const r=t=>{let{data:i}=t;"ExecComplete"!==i.type&&"ExecError"!==i.type||i.id===e&&("ExecComplete"===i.type?(this.worker.removeMessageListener(r),n(i.result)):"ExecError"===i.type&&(this.worker.removeMessageListener(r),o(i.error)))};this.worker.addMessageListener(r),this.worker.postMessage({type:"Exec",id:e,...t})}))}async initializeServiceWorker(){const e=new Promise(((e,t)=>{const n=o=>{let{data:r}=o;"InitializeSuccess"!==r.type&&"InitializeError"!==r.type||("InitializeSuccess"===r.type?(this.worker.removeMessageListener(n),e()):"InitializeError"===r.type&&(this.worker.removeMessageListener(n),t(r.error)))};this.worker.addMessageListener(n),this.worker.postMessage({type:"Initialize"})})),t=new Promise(((e,t)=>{window.setTimeout((()=>{t(new Error("Wasm Sqlite worker not initialized within 1 second"))}),1e3)}));return Promise.race([e,t])}}var z=n(758),W=n(77144),q=n(49085),K=n(70203),G=n(77907);class H extends q.default{getInitialState(){return{loading:!1,loaded:!1}}async loadIfNeeded(e){if(this.state.loaded||this.state.loading)return;const t=e();if(!t)return;if(0===K.CGe(t).length)return;const n=G.deps.katex.loader();this.setState({loading:!0,loaded:!1,result:n}),this.setState({loading:!1,loaded:!0,result:await n})}getKatex(){if(this.state.loaded)return this.state.result}}var $=n(15157),Q=n(44615),Y=n(606),X=n(63143),J=n(54642),ee=n(2688),te=n(53730);class ne extends q.default{static getCacheKey(e){return`LocalBacklinkStore2:${e}`}getInitialState(){return{}}initializeBacklinks(e){let{block:t,currentUserId:n,environment:o}=e;if(this.instanceState[t.id])return;const r=this.getCachedBacklinkState({blockId:t.id,currentUserId:n});r?this.setState({...this.instanceState,[t.id]:{state:r,loaded:!0}}):this.setState({...this.instanceState,[t.id]:{state:{backlinks:[],inaccessibleBacklinkCount:0},loaded:!1}}),oe(o,t),this.startMessageListeners(t,o)}awaitLoaded(e){return this.waitUntil((()=>{const t=this.state[e];return Boolean(t&&t.loaded)}))}destroyBacklinks(e,t){this.stopMessageListeners(e,t),delete this.instanceState[e]}getBacklinkState(e){let{blockId:t,currentUserId:n}=e;const o=this.state[t];return o?o.state:this.getCachedBacklinkState({blockId:t,currentUserId:n})||{backlinks:[],inaccessibleBacklinkCount:0}}setBacklinkState(e){let{blockId:t,state:n,currentUserId:o}=e;this.setCachedBacklinkState({blockId:t,state:n,currentUserId:o});const r=this.state[t];r&&this.setState({...this.state,[t]:{...r,state:n,loaded:!0}})}updateBacklinks(e){const{createdBacklinks:t,deletedBacklinks:n,currentUserId:o}=e,r=(0,X.cf)(t),i=(0,X.cf)(n),s=r.reduce(((e,t)=>{const{block_id:n}=t;return e[n]=e[n]?[...e[n],t]:[t],e}),{}),a=i.reduce(((e,t)=>{const{block_id:n}=t;return e[n]=e[n]?[...e[n],t]:[t],e}),{}),l=new Set([...Object.keys(s),...Object.keys(a)]);return l.forEach((e=>{const t=s[e]||[],n=a[e]||[],r=this.getBacklinkState({blockId:e,currentUserId:o}),i=t.filter((e=>!r.backlinks.some((t=>C.Xy(e,t))))),l=[...r.backlinks,...i].filter((e=>!n.some((t=>C.Xy(e,t)))));this.setBacklinkState({blockId:e,state:{...r,backlinks:l},currentUserId:o})})),Array.from(l)}resetBacklinkState(e){let{blockIds:t,currentUserId:n}=e;for(const o of t)this.setCachedBacklinkState({blockId:o,state:{backlinks:[],inaccessibleBacklinkCount:0},currentUserId:n})}getCachedBacklinkState(e){let{blockId:t,currentUserId:n}=e;return $.Z.get({userId:n,key:ne.getCacheKey(t)})}setCachedBacklinkState(e){let{blockId:t,state:n,currentUserId:o}=e;return $.Z.set({userId:o,key:ne.getCacheKey(t),value:n})}async startMessageListeners(e,t){const n=Y.dr.fromSpaceShardRecordId(e,E.iU);te.transactionQueue.isPendingTransactionForRecord(n)&&await te.transactionQueue.drain();const o=this.instanceState[n.id];if(!o)return;let r,i=!1;const s=C.P2(((n,o)=>{const s=r,a=o||void 0;r=a,i?s!==a&&oe(t,e):i=!0}),1e3),a=(0,Q.Mv)(n.id);o.messageStoreListenerReference=ee.ZP.addListener(a,s,void 0,t)}stopMessageListeners(e,t){const n=this.instanceState[e];n&&n.messageStoreListenerReference&&(ee.ZP.removeListener(n.messageStoreListenerReference,t),n.messageStoreListenerReference=void 0)}}async function oe(e,t){await te.transactionQueue.awaitRecordTransaction({id:t.id,table:E.iU});const n=await J.getBacklinksForBlock(e,{block:t});"failed"!==n.type&&e.LocalBacklinkStore.setBacklinkState({blockId:t.id,state:{backlinks:n.data.backlinks,inaccessibleBacklinkCount:n.data.inaccessibleBacklinkCount},currentUserId:e.currentUser.id})}var re=n(29477);class ie extends q.default{getInitialState(){return{isOpen:!1,isSubMenuOverridden:!1,subMenuType:null,menuType:null,shouldRestoreSelectionForMenu:!0,enableShouldShowDebugging:!1}}clear(e){this.update((t=>({...t,menuType:null,shouldRestoreSelectionForMenu:e})))}async clearNativeActionMenuAndRestoreSelectionIfNecessary(){null!==this.state.menuType&&(this.clear(!0),await re.Vs(10))}}var se=n(97880);function ae(e){return`PageDetailsStore:${e.type}:${e.id}`}class le extends q.default{getInitialState(){return{}}static getDefaultToggleState(e){return"discussion"===e.type||"backlinks"!==e.type&&void(0,se.t1)(e)}getToggleState(e){const t=ae(e);if(t in this.state)return this.state[t]}setToggleState(e,t){const n=ae(e);this.setState({...this.state,[n]:t})}}var de=n(54153);const ce="spellcheckEnabled";class ue{constructor(e){let{device:t}=e;this.enabled=void 0,this.currentLanguages=void 0;const n=de.Z.get(ce);this.setEnabled(void 0===n||n)}setEnabled(e){var t,n;(this.enabled=e,de.Z.set(ce,e),null!==(t=h.electronApi)&&void 0!==t&&t.setSpellCheckerEnabled)&&(null===(n=h.electronApi)||void 0===n||n.setSpellCheckerEnabled(e))}isEnabled(){return this.enabled}getCorrections(e){return e.dictionarySuggestions}addToDictionary(e){var t;null!==(t=h.electronApi)&&void 0!==t&&t.addToDictionary&&h.electronApi.addToDictionary(e)}setLanguages(e){var t;C.Xy(this.currentLanguages,e)||(this.currentLanguages=e,null!==(t=h.electronApi)&&void 0!==t&&t.setSpellCheckerLanguages&&h.electronApi.setSpellCheckerLanguages(0===e.length?[navigator.language]:e))}async getLanguages(){var e;const t=new Intl.DisplayNames([navigator.language],{type:"language"}),n=[];if(null!==(e=h.electronApi)&&void 0!==e&&e.getSpellCheckerLanguages){const e=await h.electronApi.getSpellCheckerLanguages();for(const o of e)n.push({code:o,name:t.of(o)})}return n}async getAvailableLanguages(){var e;const t=new Intl.DisplayNames([navigator.language],{type:"language"}),n=[];if(null!==(e=h.electronApi)&&void 0!==e&&e.getAvailableSpellCheckerLanguages){const e=await h.electronApi.getAvailableSpellCheckerLanguages();for(const o of e)n.push({code:o,name:t.of(o)})}return n}}var pe=n(14577);class me extends pe.Z{}const he=["nativeRedirect","page","space","nativeTab","onboarding","unsubscribe","unknown","uiDoc","root","chat"],ge=[...he,"login","signup","quickSearch"];let fe=0;async function ve(e){var t,n,w,k;const{minimalEnvironment:x,prefetchCache:C}=e,{device:M,mobileNative:_,cookieService:I}=x,E=""+fe++,T=M.isElectron&&Boolean(null===(t=h.electronApi)||void 0===t?void 0:t.sqliteServerEnabled)?await async function(e){var t;if(!e.device.isElectron||null===(t=h.electronApi)||void 0===t||!t.sqliteServerEnabled)return;const n=new V;return await n.initialize(),n}({device:M}):void 0;let j,L,A;if(b(M)&&(j=(0,y.fastGetGroup)("browser_sqlite"),"on"===j))try{L=await async function(){const e=new F;return await e.initialize(),e}()}catch(Q){A=Q}const U=new l.Z,Z=new d.Xk,O=new u.Z;let B;B=null!==(n=h.electronApi)&&void 0!==n&&n.getAvailableSpellCheckerLanguages?new ue({device:M}):new z.P({device:M});const N=(null==_?void 0:_.sqliteConnection)||(null==T?void 0:T.sqliteConnection)||(null===(w=L)||void 0===w?void 0:w.sqliteConnection),D=N?new R(N,M.isDesktop?1e6:1e5):void 0,q=function(e){const{device:t,RouterStore:n,ThemeStore:o}=e;let r=he;return(t.isElectron||t.isMobileNative)&&(r=ge),new me((()=>{const e=n.state.route;return e&&r.includes(e.name)?o.state.mode:"light"}),{debugName:"ThemeModeStore"})}({device:M,RouterStore:U,ThemeStore:O}),K=M.isMobile?new ie:void 0,G=await v.getPublicDomainUserId({device:M,mobileNative:_,cookieService:I}),$={key:E,AppUpdateStore:new s.D,device:M,WindowSizeStore:new p.j({device:M},window,{mobileBrowserRemoveBottomPaddingHack:P.default.checkGate("mobile_browser_remove_bottom_padding_hack")}),KeyboardShortcutStackStore:new a.h({device:M}),defaultRecordCache:new r.q({inMemoryRecordCache:new o.Z({name:"default"}),persistedRecordCache:D}),mobileNative:_,RouterStore:U,ThemeStore:O,ThemeModeStore:q,ElectronSqlite:T,KatexStore:new H,LocalBacklinkStore:new ne,PageDetailsStore:new le,updateCurrentUserId:void 0,currentUser:new i.CurrentUser,SpellCheckStore:B,NativeMobileActionBarStore:K,TextSelectionCompositionStore:new c.h,recordSubscriptionActions:S,prefetchCache:C,TabbedRouterStore:Z,cookieService:I,publicDomainUserId:G};return g.LH($),null==T||T.setEnvironment($),null==_||_.setEnvironment($),null===(k=L)||void 0===k||k.setEnvironment($),"on"===j?A?(W.Z.state.metricData.update((e=>({...e,wasm_sqlite_initialized:"error"}))),m.rn(A,{from:"clientEnvironment",type:"wasmSqliteInitializeError"})):W.Z.state.metricData.update((e=>({...e,wasm_sqlite_initialized:"success"}))):"control"===j?W.Z.state.metricData.update((e=>({...e,wasm_sqlite_initialized:"skipped-control-group"}))):void 0===j&&W.Z.state.metricData.update((e=>({...e,wasm_sqlite_initialized:"skipped-undefined-group"}))),D&&D.setTrackWithDynamicSampling((e=>f.kB({environment:$,...e}))),$}},91190:(e,t,n)=>{"use strict";n.d(t,{C:()=>i,E:()=>r});var o=n(61766);const r=new o.Z,i=new o.Z},26492:(e,t,n)=>{"use strict";function o(e){return e.isElectron||e.isMobileNative}n.r(t),n.d(t,{deviceSupportsSqlite:()=>o})},43604:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const o=n(49085).default.createValue({open:!1})},74055:(e,t,n)=>{"use strict";n.d(t,{V:()=>r,Z:()=>s});var o=n(49085);let r=function(e){return e.IN_APP_CALLOUT_CONFLICT="in-app callout conflict",e.DARK_MODE="not shown in dark mode",e}({});class i extends o.default{getInitialState(){return{isVisible:!1,suppressReason:void 0}}}const s=new i},66881:(e,t,n)=>{"use strict";n.d(t,{g:()=>o});const o=n(49085).default.createValue({shouldReset:!1})},56638:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},12309:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var o=n(49085),r=n(4615);class i extends o.default{getInitialState(){return{modalInfoById:{}}}async showModal(e){const t=(0,r.ZP)();return new Promise((n=>{const o=e((e=>{n(e),this.internalCloseModal(t,(()=>{this.internalRemoveModal(t)}))}));this.update((e=>({modalInfoById:{...e.modalInfoById,[t]:{...o,isOpen:!0}}})))}))}internalRemoveModal(e){this.update((t=>{const n={...t.modalInfoById};return delete n[e],{modalInfoById:n}}))}internalCloseModal(e,t){this.update((n=>({modalInfoById:{...n.modalInfoById,[e]:{...n.modalInfoById[e],isOpen:!1,onClosed:t}}})))}}const s=new i},40745:(e,t,n)=>{"use strict";n.d(t,{M:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("arrowDown",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M8 1.57715C7.5625 1.57715 7.25488 1.88477 7.25488 2.33594V10.8262L7.30957 12.3027L5.50488 10.2861L3.95312 8.75488C3.82324 8.625 3.63184 8.53613 3.42676 8.53613C3.0166 8.53613 2.70898 8.85059 2.70898 9.26758C2.70898 9.46582 2.78418 9.64355 2.94141 9.80762L7.44629 14.3193C7.59668 14.4697 7.79492 14.5586 8 14.5586C8.20508 14.5586 8.40332 14.4697 8.55371 14.3193L13.0586 9.80762C13.2158 9.64355 13.291 9.46582 13.291 9.26758C13.291 8.85059 12.9902 8.53613 12.5801 8.53613C12.3682 8.53613 12.1836 8.625 12.0469 8.75488L10.4951 10.2861L8.69043 12.2959L8.74512 10.8262V2.33594C8.74512 1.88477 8.44434 1.57715 8 1.57715Z"})})},8597:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("arrowUp",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M8 14.5586C8.44434 14.5586 8.74512 14.251 8.74512 13.7998V5.30957L8.69043 3.83984L10.4951 5.84961L12.0469 7.38086C12.1836 7.51074 12.3682 7.59961 12.5801 7.59961C12.9902 7.59961 13.291 7.28516 13.291 6.86816C13.291 6.66992 13.2158 6.49219 13.0586 6.32812L8.55371 1.81641C8.40332 1.66602 8.20508 1.57715 8 1.57715C7.79492 1.57715 7.59668 1.66602 7.44629 1.81641L2.94141 6.32812C2.78418 6.49219 2.70898 6.66992 2.70898 6.86816C2.70898 7.28516 3.0166 7.59961 3.42676 7.59961C3.63184 7.59961 3.82324 7.51074 3.95312 7.38086L5.50488 5.84961L7.30957 3.83301L7.25488 5.30957V13.7998C7.25488 14.251 7.5625 14.5586 8 14.5586Z"})})},82855:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("chevronDownRounded",{viewBox:"0 0 15 9",svg:(0,r.jsx)("path",{d:"M7.92188 8.65625C8.19531 8.64844 8.44531 8.54688 8.64844 8.32812L14.5859 2.25C14.7578 2.07812 14.8516 1.85938 14.8516 1.60156C14.8516 1.08594 14.4453 0.671875 13.9297 0.671875C13.6797 0.671875 13.4375 0.773438 13.2578 0.953125L7.92969 6.42969L2.58594 0.953125C2.40625 0.78125 2.17188 0.671875 1.91406 0.671875C1.39844 0.671875 0.992188 1.08594 0.992188 1.60156C0.992188 1.85938 1.08594 2.07812 1.25781 2.25L7.20312 8.32812C7.41406 8.54688 7.64844 8.65625 7.92188 8.65625Z"})})},25278:(e,t,n)=>{"use strict";n.d(t,{H:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("eyes",{viewBox:"0 0 72 72",svg:(0,r.jsx)("path",{d:"M17.0312 64.4375C26.25 64.4375 33.5625 52.9688 33.5625 36.4375C33.5625 19.9062 26.25 8.46875 17.0312 8.46875C7.8125 8.46875 0.5 19.9062 0.5 36.4375C0.5 52.9688 7.8125 64.4375 17.0312 64.4375ZM54.9688 64.4375C64.1875 64.4375 71.5 52.9688 71.5 36.4375C71.5 19.9062 64.1875 8.46875 54.9688 8.46875C45.75 8.46875 38.4375 19.9062 38.4375 36.4375C38.4375 52.9688 45.75 64.4375 54.9688 64.4375ZM10.0625 47.1875C15.125 47.1875 18.4688 43.6562 18.4688 38.3438C18.4688 33.0938 15.125 29.5625 10.0625 29.5625C7.6875 29.5625 5.71875 30.3125 4.25 31.6875C5.375 19.9375 10.6875 11.9375 17.0312 11.9062C24.25 11.875 30.125 22.0312 30.125 36.4375C30.125 50.7812 24.25 60.9688 17.0312 61C11.5312 61.0312 6.78125 54.9688 4.90625 45.5938C6.28125 46.625 8.03125 47.1875 10.0625 47.1875ZM47.9688 47.1875C53 47.1875 56.4062 43.6562 56.4062 38.3438C56.4062 33.0938 53 29.5625 47.9688 29.5625C45.5938 29.5625 43.5938 30.3438 42.1562 31.6875C43.2812 19.9375 48.5938 11.9375 54.9688 11.9375C62.1562 11.9062 68 22.0938 68 36.4375C68 50.7812 62.1562 60.9688 54.9688 60.9688C49.4375 61 44.6875 54.9375 42.7812 45.5938C44.1562 46.5938 45.9375 47.1875 47.9688 47.1875ZM45.5312 37.4062C44.4375 37.25 43.75 35.9688 44.0312 34.6562C44.3125 33.3125 45.3125 32.3438 46.375 32.5312C47.4688 32.75 48.0938 34.0312 47.8438 35.3125C47.5938 36.6562 46.5938 37.5938 45.5312 37.4062ZM7.625 37.4062C6.53125 37.25 5.84375 35.9688 6.09375 34.6562C6.375 33.3125 7.40625 32.3438 8.4375 32.5312C9.5625 32.7812 10.1875 34.0312 9.9375 35.3125C9.6875 36.6562 8.65625 37.5938 7.625 37.4062Z"})})},70954:(e,t,n)=>{"use strict";n.d(t,{C:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("notionLogoStroked",{viewBox:"0 0 41 42",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M4.253 2.903h0-.01c-1.02.09-1.806.481-2.322 1.142-.5.642-.671 1.441-.671 2.21v23.228c0 1.267.47 2.316 1.416 3.577h0l.006.008 4.99 6.477h0l.005.005c.465.593.963 1.017 1.617 1.256.63.23 1.33.26 2.138.221h.01l24.652-1.49h.008c1.137-.08 2.038-.396 2.632-1.071.588-.668.746-1.543.746-2.431V9.904c0-.584-.133-1.05-.508-1.486-.27-.311-.669-.602-1.113-.925a54.305 54.305 0 01-.176-.13l-.007-.004-.005-.004-6.772-4.761c-.838-.609-1.516-1.017-2.365-1.21-.824-.187-1.75-.156-3.047-.044L4.253 2.903z",fill:"#fff",stroke:"#fff",strokeWidth:"1.5"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M25.257 3.158L5.176 4.637c-1.62.14-2.184 1.197-2.184 2.464v21.971c0 .987.352 1.83 1.198 2.959l4.72 6.126c.776.987 1.48 1.198 2.96 1.127l23.32-1.408c1.973-.14 2.537-1.057 2.537-2.606V10.552c0-.801-.316-1.032-1.25-1.714l-.16-.117-6.41-4.507c-1.55-1.126-2.184-1.268-4.65-1.056zM12.4 10.146c-1.904.129-2.337.158-3.418-.72l-2.75-2.183c-.28-.283-.14-.635.565-.705L26.102 5.13c1.62-.141 2.466.423 3.1.916l3.311 2.394c.141.07.493.492.07.492L12.645 10.13l-.245.016zM10.179 35.06V14.074c0-.916.281-1.338 1.126-1.41l22.898-1.337c.777-.07 1.128.423 1.128 1.338v20.844c0 .916-.14 1.691-1.41 1.761l-21.91 1.268c-1.269.07-1.832-.352-1.832-1.48zm21.63-19.86c.141.635 0 1.268-.635 1.34l-1.056.21v15.492c-.916.493-1.761.775-2.466.775-1.128 0-1.41-.352-2.255-1.408l-6.905-10.845v10.493l2.185.493s0 1.267-1.763 1.267l-4.86.282c-.142-.282 0-.986.492-1.127l1.269-.351V17.947l-1.761-.142c-.141-.634.21-1.549 1.197-1.62l5.214-.351 7.187 10.986V17.1l-1.832-.21c-.14-.776.422-1.339 1.127-1.409l4.863-.283z",fill:"#222"})]})})},53470:(e,t,n)=>{"use strict";n.d(t,{H:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("rename",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M14.7881 2.5752L15.3008 2.04199C15.5605 1.76855 15.5742 1.39941 15.3213 1.13965L15.1436 0.955078C14.9111 0.722656 14.5283 0.763672 14.2754 1.00977L13.749 1.5293L14.7881 2.5752ZM6.68066 9.87598L8.0752 9.28809L14.2891 3.06738L13.25 2.03516L7.03613 8.25586L6.4209 9.60254C6.35254 9.75977 6.52344 9.9375 6.68066 9.87598ZM4.09668 14.4355H12.0674C13.373 14.4355 14.1387 13.6768 14.1387 12.2207V4.99512L12.7988 6.33496V12.1045C12.7988 12.7676 12.4434 13.1025 11.9854 13.1025H4.17871C3.54297 13.1025 3.19434 12.7676 3.19434 12.1045V4.49609C3.19434 3.83301 3.54297 3.49805 4.17871 3.49805H10.0234L11.3633 2.1582H4.09668C2.62695 2.1582 1.85449 2.91699 1.85449 4.37988V12.2207C1.85449 13.6836 2.62695 14.4355 4.09668 14.4355Z"})})},59078:(e,t,n)=>{"use strict";n.d(t,{W:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("sidebarInbox",{viewBox:"0 0 20 20",svg:(0,r.jsx)("path",{d:"M4.61084 16.0537C3.90837 16.0537 3.37305 15.8717 3.00488 15.5078C2.64095 15.1481 2.45898 14.6191 2.45898 13.9209V10.1504C2.45898 9.89225 2.47168 9.67432 2.49707 9.49658C2.52669 9.31462 2.57536 9.15169 2.64307 9.00781C2.71077 8.86393 2.80387 8.71794 2.92236 8.56982L4.94092 6.09424C5.20752 5.76416 5.44238 5.50602 5.64551 5.31982C5.85286 5.12939 6.07715 4.99609 6.31836 4.91992C6.5638 4.83952 6.88118 4.79932 7.27051 4.79932H12.7358C13.1252 4.79932 13.4404 4.83952 13.6816 4.91992C13.9271 4.99609 14.1514 5.12939 14.3545 5.31982C14.5576 5.50602 14.7946 5.76416 15.0654 6.09424L17.0776 8.56982C17.2004 8.71794 17.2956 8.86393 17.3633 9.00781C17.431 9.15169 17.4775 9.31462 17.5029 9.49658C17.5283 9.67432 17.541 9.89225 17.541 10.1504V13.9209C17.541 14.6191 17.359 15.1481 16.9951 15.5078C16.6312 15.8717 16.098 16.0537 15.3955 16.0537H4.61084ZM4.69971 14.6445H15.3066C15.5817 14.6445 15.7912 14.5747 15.9351 14.4351C16.0832 14.2912 16.1572 14.0711 16.1572 13.7749V10.7852H12.4946C12.4142 11.1533 12.2576 11.4813 12.0249 11.769C11.7964 12.0568 11.5086 12.2853 11.1616 12.4546C10.8146 12.6196 10.4274 12.7021 10 12.7021C9.57682 12.7021 9.19173 12.6196 8.84473 12.4546C8.49772 12.2896 8.20785 12.0632 7.9751 11.7754C7.74235 11.4834 7.58789 11.1533 7.51172 10.7852H3.84277V13.7749C3.84277 14.0711 3.91471 14.2912 4.05859 14.4351C4.20671 14.5747 4.42041 14.6445 4.69971 14.6445ZM10 11.4072C10.2751 11.4072 10.512 11.3395 10.7109 11.2041C10.9098 11.0687 11.0643 10.8973 11.1743 10.6899C11.2843 10.4784 11.3394 10.2646 11.3394 10.0488V10.0298C11.3394 9.90706 11.3774 9.79915 11.4536 9.70605C11.5298 9.60872 11.6525 9.56006 11.8218 9.56006H15.8335C15.9351 9.56006 15.9964 9.52409 16.0176 9.45215C16.043 9.38021 16.0303 9.3125 15.9795 9.24902L13.7197 6.43701C13.5885 6.26774 13.4447 6.14502 13.2881 6.06885C13.1315 5.98844 12.9495 5.94824 12.7422 5.94824H7.25781C7.05469 5.94824 6.87484 5.98844 6.71826 6.06885C6.56169 6.14502 6.41569 6.26774 6.28027 6.43701L4.0332 9.24902C3.97819 9.3125 3.96126 9.38021 3.98242 9.45215C4.00781 9.52409 4.07129 9.56006 4.17285 9.56006H8.18457C8.35384 9.56006 8.47656 9.60872 8.55273 9.70605C8.62891 9.79915 8.66699 9.90706 8.66699 10.0298V10.0488C8.66699 10.2646 8.71989 10.4784 8.82568 10.6899C8.93571 10.8973 9.09017 11.0687 9.28906 11.2041C9.48796 11.3395 9.72493 11.4072 10 11.4072Z"})})},18613:(e,t,n)=>{"use strict";n.r(t),n.d(t,{clearNotionLocalStorageWithNoPermission:()=>i});var o=n(46637),r=n(72128);function i(){o.Z.removeAllIfNoPermission(),r.Z.removeAllIfNoPermission()}},29091:(e,t,n)=>{"use strict";function o(e){let[t,n]=e;return Math.floor(function(e){let[t,n]=e;return Math.random()*(n-t)+t}([t,n]))}function r(e){if(!e)return Math.random;let t=function(e){let t=0;for(let n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t|=0}return t}(e);return()=>{t|=0,t=t+1831565813|0;let e=Math.imul(t^t>>>15,1|t);return e=e+Math.imul(e^e>>>7,61|e)^e,((e^e>>>14)>>>0)/4294967296}}function i(e){const t=Array.from({length:e},(()=>Math.random()));let n=0;return()=>{const e=t[n];return n=n===t.length-1?0:n+1,e}}n.d(t,{Iy:()=>o,XJ:()=>i,yH:()=>r})},45366:(e,t,n)=>{"use strict";n.d(t,{wS:()=>i});var o=n(72126);const r=/[-./\\()"'’‘”“，。、·～；,;<>~!@#$%^&*|+=[\]{}`~?:\s]/u;function i(e){return(0,o.oA)(e.split(r))}},27117:(e,t,n)=>{var o=n(17187),r=n(35717);function i(e){if(!(this instanceof i))return new i(e);"number"==typeof e&&(e={max:e}),e||(e={}),o.EventEmitter.call(this),this.cache={},this.head=this.tail=null,this.length=0,this.max=e.max||1e3,this.maxAge=e.maxAge||0}e.exports=i,r(i,o.EventEmitter),Object.defineProperty(i.prototype,"keys",{get:function(){return Object.keys(this.cache)}}),i.prototype.clear=function(){this.cache={},this.head=this.tail=null,this.length=0},i.prototype.remove=function(e){if("string"!=typeof e&&(e=""+e),this.cache.hasOwnProperty(e)){var t=this.cache[e];return delete this.cache[e],this._unlink(e,t.prev,t.next),t.value}},i.prototype._unlink=function(e,t,n){this.length--,0===this.length?this.head=this.tail=null:this.head===e?(this.head=t,this.cache[this.head].next=null):this.tail===e?(this.tail=n,this.cache[this.tail].prev=null):(this.cache[t].next=n,this.cache[n].prev=t)},i.prototype.peek=function(e){if(this.cache.hasOwnProperty(e)){var t=this.cache[e];if(this._checkAge(e,t))return t.value}},i.prototype.set=function(e,t){var n;if("string"!=typeof e&&(e=""+e),this.cache.hasOwnProperty(e)){if((n=this.cache[e]).value=t,this.maxAge&&(n.modified=Date.now()),e===this.head)return t;this._unlink(e,n.prev,n.next)}else n={value:t,modified:0,next:null,prev:null},this.maxAge&&(n.modified=Date.now()),this.cache[e]=n,this.length===this.max&&this.evict();return this.length++,n.next=null,n.prev=this.head,this.head&&(this.cache[this.head].next=e),this.head=e,this.tail||(this.tail=e),t},i.prototype._checkAge=function(e,t){return!(this.maxAge&&Date.now()-t.modified>this.maxAge)||(this.remove(e),this.emit("evict",{key:e,value:t.value}),!1)},i.prototype.get=function(e){if("string"!=typeof e&&(e=""+e),this.cache.hasOwnProperty(e)){var t=this.cache[e];if(this._checkAge(e,t))return this.head!==e&&(e===this.tail?(this.tail=t.next,this.cache[this.tail].prev=null):this.cache[t.prev].next=t.next,this.cache[t.next].prev=t.prev,this.cache[this.head].next=e,t.prev=this.head,t.next=null,this.head=e),t.value}},i.prototype.evict=function(){if(this.tail){var e=this.tail,t=this.remove(this.tail);this.emit("evict",{key:e,value:t})}}},20745:(e,t,n)=>{"use strict";var o=n(73935);t.createRoot=o.createRoot,t.hydrateRoot=o.hydrateRoot}}]);