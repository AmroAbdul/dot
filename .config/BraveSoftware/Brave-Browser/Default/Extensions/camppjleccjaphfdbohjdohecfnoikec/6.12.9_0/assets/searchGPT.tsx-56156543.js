import{r as t,j as e,R as et,c as Oe}from"./client-64cc3330.js";import{A as lt,d as Te,b as ct,x as Et,q as Ue,a as jt,R as dt,e as St,s as Rt,c as tt,y as Nt,f as kt,g as _t}from"./index-1a12ff06.js";import{L as At}from"./hook-90290a85.js";import{c as se,k as Tt,L as Ve,o as Me,g as Mt,p as Lt}from"./index-6400eb41.js";import{C as Ft}from"./index-8e3fd625.js";import{b as Ye,a as It,A as Pt}from"./index-5fbb8478.js";import{a as ut,S as mt,C as Bt}from"./Combination-734d114c.js";import{a as Ht,M as Dt}from"./messageContext-b7a474d6.js";import{T as qt}from"./themeContext-73b6440c.js";import{c as Ot}from"./index-a295f481.js";import{T as Ee}from"./index-eb167f60.js";import{B as Q,b as ft}from"./button-5c866ab2.js";import{I as be}from"./input-9a173b93.js";import{c as $}from"./utils-01642ffa.js";import{q as pt,a as Ut}from"./backend-8962bc7f.js";import{f as L,o as Vt}from"./analytics-4a9d4e40.js";import{b as Ne,c as Qt,f as Qe}from"./webAccess-b75d05a0.js";import{u as st}from"./useSSE-a5deda20.js";import{S as ht}from"./merlin-logo-6bb5639f.js";import{u as ge}from"./useTranslation-b0b08d2e.js";import{C as rt}from"./index-9f256355.js";import{F as zt}from"./index-876a044c.js";import{c as Zt,A as nt,M as Gt}from"./utils-f7fcf05a.js";import{c as $t,B as ze,A as at,a as Ze,d as Kt}from"./avatar-2c1c2e36.js";import{c as J}from"./createLucideIcon-cc1e4b70.js";import{m as V}from"./motion-064cf623.js";import{A as xt}from"./index-82863451.js";import{I as it}from"./IconX-f6f2534f.js";import{C as gt,S as Wt,P as Xt,a as Yt,L as Jt,b as es,c as ts,d as ss,e as rs,f as ns,g as as,h as is}from"./switch-758eec2e.js";import{D as os,a as ls,b as cs,k as ds,e as us,d as ms,c as ve}from"./dropdown-menu-bf41fbb1.js";import{u as fs}from"./useSharedUserSettings-15caf5a1.js";import{c as ps}from"./createReactComponent-3abc0bad.js";import{I as ke}from"./IconArrowUpRight-b2c79567.js";import{I as _e}from"./IconUser-917049b8.js";import{I as hs}from"./IconSettings-b145c3ad.js";import{c as xs,a as gs}from"./atom-one-light-7372aee1.js";import{c as ys}from"./index-75aa899c.js";import{P as Cs}from"./PersistQueryClientProvider-dcb1f9d7.js";import"./index-6e1689d3.js";import"./index-3e5c8eb0.js";import"./v4-4a60fe23.js";import"./useMedia-691d1918.js";import"./purify.es-8e338605.js";import"./useAsyncWithPromise-a02bc426.js";import"./IconCheck-c9ab9461.js";import"./IconCopy-40883e9b.js";import"./index-5468b753.js";var ws=ps("star","IconStar",[["path",{d:"M12 17.75l-6.172 3.245l1.179 -6.873l-5 -4.867l6.9 -1l3.086 -6.253l3.086 6.253l6.9 1l-5 4.867l1.179 6.873z",key:"svg-0"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=J("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=J("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=J("Keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=J("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=J("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=J("MessageCirclePlus",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=J("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=J("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=J("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=J("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=J("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=J("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function As(r){const{queryTerms:o}=r,[l,p]=t.useState(null),{t:f}=ge(),{merlinConfig:n}=t.useContext(ut);return t.useEffect(()=>{let i=!1;n.availableTools.forEach((u,c)=>{u.keywords.forEach(E=>{if(o.toLowerCase().includes(E.toLowerCase())){p(n.availableTools[c]),i=!0;return}})})},[o,n]),e.jsx(e.Fragment,{children:l&&e.jsxs("div",{className:"dark:bg-background my-4 flex  flex-col justify-between rounded-lg border-zinc-300  bg-zinc-50 p-3 dark:border-zinc-700",children:[e.jsx("img",{src:l.toolImage,alt:"",className:"h-[194.63px] w-full rounded-lg"}),e.jsxs(Q,{className:"mt-2 flex w-full items-center space-x-2 font-semibold",onClick:()=>{L({eventData:{searchedKeyword:o,toolName:l.toolName},eventName:"Serp Tools Advertisement Card",eventType:"Button",firedFromFile:"features/serp/advertisementCard"}),window.open(l.ctaLink,"_blank")},children:[e.jsx(ht,{className:"h-4"}),e.jsx("p",{children:f("serp_index.try_for_free")})]})]})})}const Ts=r=>t.createElement("svg",{width:346,height:195,viewBox:"0 0 346 195",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r},t.createElement("g",{clipPath:"url(#clip0_3529_1352)"},t.createElement("path",{d:"M0 6.02357C0 2.70986 2.68629 0.0235596 6 0.0235596H340C343.314 0.0235596 346 2.70985 346 6.02356V188.649C346 191.962 343.314 194.649 340 194.649H5.99999C2.68628 194.649 0 191.962 0 188.649V6.02357Z",fill:"#D5D5D5"}),t.createElement("g",{filter:"url(#filter0_f_3529_1352)"},t.createElement("circle",{cx:172.547,cy:-17.8467,r:82.8777,transform:"rotate(-180 172.547 -17.8467)",fill:"#FAD16A"})),t.createElement("g",{filter:"url(#filter1_f_3529_1352)"},t.createElement("ellipse",{cx:37.1786,cy:58.8569,rx:76.9485,ry:111.918,transform:"rotate(144.354 37.1786 58.8569)",fill:"#FF844E"})),t.createElement("g",{filter:"url(#filter2_f_3529_1352)"},t.createElement("ellipse",{cx:47.2615,cy:-41.0882,rx:73.3504,ry:77.9856,transform:"rotate(144.354 47.2615 -41.0882)",fill:"#FF5252"})),t.createElement("path",{d:"M55.0992 53.6358C55.0992 48.4995 59.2631 44.3357 64.3994 44.3357H281.601C286.737 44.3357 290.901 48.4995 290.901 53.6358V97.0364C290.901 102.173 286.737 106.337 281.601 106.337H64.3994C59.263 106.337 55.0992 102.173 55.0992 97.0364V53.6358Z",fill:"white"}),t.createElement("path",{d:"M73.6995 75.3361C73.6995 65.0635 82.0271 56.7358 92.2997 56.7358H123.3C133.573 56.7358 141.9 65.0635 141.9 75.3361C141.9 85.6087 133.573 93.9364 123.3 93.9364H92.2997C82.0271 93.9364 73.6995 85.6087 73.6995 75.3361Z",fill:"#18181B"}),t.createElement("path",{d:"M107.8 75.3362C107.8 66.7756 114.74 59.8359 123.3 59.8359C131.861 59.8359 138.8 66.7756 138.8 75.3362C138.8 83.8967 131.861 90.8364 123.3 90.8364C114.74 90.8364 107.8 83.8967 107.8 75.3362Z",fill:"white"}),t.createElement("path",{d:"M155.885 82.8359V67.6457H158.055V81.1216H164.999V82.8359H155.885ZM167.583 82.8359V71.899H169.754V82.8359H167.583ZM168.69 69.8375C168.271 69.8375 167.923 69.7073 167.649 69.4468C167.388 69.1864 167.258 68.8537 167.258 68.4486C167.258 68.058 167.388 67.7398 167.649 67.4938C167.923 67.2334 168.271 67.1032 168.69 67.1032C169.095 67.1032 169.435 67.2334 169.71 67.4938C169.985 67.7398 170.122 68.058 170.122 68.4486C170.122 68.8537 169.985 69.1864 169.71 69.4468C169.435 69.7073 169.095 69.8375 168.69 69.8375ZM175.96 82.8359L171.858 71.899H174.137L177.24 80.7527L180.365 71.899H182.6L178.52 82.8359H175.96ZM188.972 83.0963C187.931 83.0963 187.005 82.8576 186.195 82.3802C185.385 81.9028 184.748 81.2373 184.285 80.3838C183.837 79.5303 183.612 78.5393 183.612 77.4109C183.612 76.2535 183.837 75.2481 184.285 74.3945C184.748 73.5265 185.385 72.8538 186.195 72.3764C187.005 71.8845 187.945 71.6386 189.016 71.6386C190.086 71.6386 191.005 71.8773 191.772 72.3547C192.538 72.8321 193.132 73.4686 193.551 74.2643C193.971 75.0455 194.18 75.9135 194.18 76.8684C194.18 77.013 194.173 77.1722 194.159 77.3458C194.159 77.5049 194.152 77.6857 194.137 77.8883H185.197V76.3475H192.01C191.967 75.4361 191.663 74.7273 191.099 74.2209C190.535 73.7001 189.833 73.4397 188.994 73.4397C188.401 73.4397 187.858 73.5771 187.367 73.852C186.875 74.1124 186.477 74.503 186.173 75.0238C185.884 75.5302 185.739 76.1739 185.739 76.9552V77.5628C185.739 78.3729 185.884 79.0601 186.173 79.6243C186.477 80.174 186.875 80.5936 187.367 80.8829C187.858 81.1578 188.394 81.2952 188.972 81.2952C189.667 81.2952 190.238 81.1433 190.687 80.8395C191.135 80.5357 191.468 80.1234 191.685 79.6026H193.855C193.667 80.2681 193.349 80.8684 192.9 81.4037C192.452 81.9245 191.895 82.3368 191.229 82.6406C190.578 82.9444 189.826 83.0963 188.972 83.0963ZM207.221 83.0963C206.108 83.0963 205.131 82.901 204.292 82.5104C203.453 82.1054 202.802 81.5412 202.339 80.8178C201.876 80.0945 201.644 79.2482 201.644 78.2789H203.923C203.937 78.8286 204.068 79.335 204.314 79.7979C204.574 80.2464 204.943 80.608 205.42 80.8829C205.912 81.1433 206.513 81.2735 207.221 81.2735C207.829 81.2735 208.35 81.1722 208.784 80.9697C209.232 80.7672 209.572 80.4923 209.804 80.1451C210.035 79.7834 210.151 79.3711 210.151 78.9082C210.151 78.3729 210.028 77.9317 209.782 77.5845C209.536 77.2373 209.203 76.9552 208.784 76.7382C208.379 76.5067 207.901 76.3041 207.352 76.1305C206.816 75.9569 206.252 75.7689 205.659 75.5663C204.458 75.1757 203.561 74.6694 202.968 74.0473C202.39 73.4252 202.1 72.6151 202.1 71.6169C202.1 70.7633 202.303 70.0255 202.708 69.4034C203.113 68.7669 203.677 68.275 204.4 67.9278C205.138 67.5662 206.006 67.3853 207.004 67.3853C207.988 67.3853 208.849 67.5662 209.587 67.9278C210.325 68.2895 210.903 68.7886 211.323 69.4251C211.742 70.0617 211.952 70.8067 211.952 71.6603H209.652C209.652 71.2697 209.551 70.8863 209.348 70.5102C209.146 70.134 208.842 69.8302 208.437 69.5988C208.032 69.3528 207.533 69.2298 206.939 69.2298C206.447 69.2154 206.006 69.2949 205.616 69.4685C205.225 69.6422 204.921 69.8953 204.704 70.2281C204.487 70.5608 204.379 70.9586 204.379 71.4216C204.379 71.8845 204.473 72.2607 204.661 72.55C204.863 72.8249 205.153 73.0636 205.529 73.2661C205.905 73.4686 206.339 73.6567 206.831 73.8303C207.337 73.9894 207.894 74.1703 208.502 74.3728C209.254 74.6188 209.92 74.9226 210.498 75.2842C211.091 75.6314 211.554 76.0871 211.887 76.6514C212.234 77.2011 212.408 77.91 212.408 78.778C212.408 79.5303 212.213 80.2319 211.822 80.8829C211.431 81.5339 210.853 82.0692 210.086 82.4887C209.319 82.8938 208.364 83.0963 207.221 83.0963ZM219.827 83.0963C218.786 83.0963 217.86 82.8576 217.05 82.3802C216.24 81.9028 215.603 81.2373 215.14 80.3838C214.692 79.5303 214.468 78.5393 214.468 77.4109C214.468 76.2535 214.692 75.2481 215.14 74.3945C215.603 73.5265 216.24 72.8538 217.05 72.3764C217.86 71.8845 218.8 71.6386 219.871 71.6386C220.941 71.6386 221.86 71.8773 222.627 72.3547C223.394 72.8321 223.987 73.4686 224.406 74.2643C224.826 75.0455 225.036 75.9135 225.036 76.8684C225.036 77.013 225.028 77.1722 225.014 77.3458C225.014 77.5049 225.007 77.6857 224.992 77.8883H216.052V76.3475H222.866C222.822 75.4361 222.518 74.7273 221.954 74.2209C221.39 73.7001 220.688 73.4397 219.849 73.4397C219.256 73.4397 218.714 73.5771 218.222 73.852C217.73 74.1124 217.332 74.503 217.028 75.0238C216.739 75.5302 216.594 76.1739 216.594 76.9552V77.5628C216.594 78.3729 216.739 79.0601 217.028 79.6243C217.332 80.174 217.73 80.5936 218.222 80.8829C218.714 81.1578 219.249 81.2952 219.827 81.2952C220.522 81.2952 221.093 81.1433 221.542 80.8395C221.99 80.5357 222.323 80.1234 222.54 79.6026H224.71C224.522 80.2681 224.204 80.8684 223.755 81.4037C223.307 81.9245 222.75 82.3368 222.084 82.6406C221.433 82.9444 220.681 83.0963 219.827 83.0963ZM231.07 83.0963C230.174 83.0963 229.428 82.9444 228.835 82.6406C228.242 82.3368 227.801 81.9318 227.512 81.4254C227.222 80.9046 227.078 80.3476 227.078 79.7545C227.078 79.0312 227.266 78.4163 227.642 77.91C228.018 77.3892 228.553 76.9913 229.248 76.7165C229.942 76.4416 230.774 76.3041 231.743 76.3041H234.586C234.586 75.6676 234.492 75.1396 234.304 74.72C234.116 74.3005 233.834 73.9894 233.457 73.7869C233.096 73.5699 232.633 73.4614 232.069 73.4614C231.418 73.4614 230.861 73.6205 230.398 73.9388C229.935 74.2426 229.645 74.6983 229.53 75.3059H227.36C227.446 74.5392 227.707 73.8882 228.141 73.3529C228.589 72.8032 229.161 72.3836 229.855 72.0943C230.55 71.7905 231.287 71.6386 232.069 71.6386C233.096 71.6386 233.957 71.8194 234.651 72.1811C235.345 72.5428 235.866 73.0563 236.213 73.7218C236.575 74.3728 236.756 75.154 236.756 76.0654V82.8359H234.868L234.694 80.9914C234.535 81.2807 234.347 81.5556 234.13 81.816C233.913 82.0764 233.653 82.3007 233.349 82.4887C233.06 82.6768 232.72 82.8215 232.329 82.9227C231.953 83.0385 231.533 83.0963 231.07 83.0963ZM231.483 81.3386C231.946 81.3386 232.365 81.2446 232.741 81.0565C233.118 80.8684 233.436 80.6153 233.696 80.297C233.971 79.9643 234.174 79.5954 234.304 79.1903C234.448 78.7707 234.528 78.344 234.542 77.91V77.8449H231.96C231.338 77.8449 230.832 77.9244 230.441 78.0836C230.065 78.2282 229.79 78.4308 229.617 78.6912C229.443 78.9516 229.356 79.2554 229.356 79.6026C229.356 79.9643 229.436 80.2753 229.595 80.5357C229.768 80.7816 230.014 80.9769 230.333 81.1216C230.651 81.2663 231.034 81.3386 231.483 81.3386ZM239.526 82.8359V71.899H241.479L241.674 73.9605C241.92 73.4686 242.238 73.0563 242.629 72.7236C243.02 72.3764 243.475 72.1088 243.996 71.9207C244.531 71.7326 245.139 71.6386 245.819 71.6386V73.9388H245.038C244.589 73.9388 244.162 73.9967 243.757 74.1124C243.352 74.2137 242.991 74.3945 242.672 74.6549C242.369 74.9153 242.13 75.2698 241.956 75.7182C241.783 76.1667 241.696 76.7237 241.696 77.3892V82.8359H239.526ZM252.529 83.0963C251.473 83.0963 250.532 82.8576 249.708 82.3802C248.883 81.8884 248.232 81.2156 247.755 80.3621C247.292 79.5086 247.06 78.5176 247.06 77.3892C247.06 76.2463 247.292 75.2481 247.755 74.3945C248.232 73.5265 248.883 72.8538 249.708 72.3764C250.532 71.8845 251.473 71.6386 252.529 71.6386C253.86 71.6386 254.974 71.9858 255.871 72.6802C256.768 73.3746 257.339 74.315 257.585 75.5012H255.328C255.184 74.8647 254.851 74.3728 254.33 74.0256C253.824 73.6784 253.216 73.5048 252.507 73.5048C251.928 73.5048 251.393 73.6567 250.901 73.9605C250.409 74.2499 250.012 74.6839 249.708 75.2625C249.418 75.8267 249.274 76.5284 249.274 77.3675C249.274 77.9895 249.361 78.5465 249.534 79.0384C249.708 79.5158 249.939 79.9209 250.229 80.2536C250.532 80.5863 250.88 80.8395 251.27 81.0131C251.661 81.1722 252.073 81.2518 252.507 81.2518C252.985 81.2518 253.411 81.1795 253.787 81.0348C254.178 80.8757 254.504 80.6442 254.764 80.3404C255.039 80.0366 255.227 79.6749 255.328 79.2554H257.585C257.339 80.4127 256.768 81.3458 255.871 82.0547C254.974 82.7491 253.86 83.0963 252.529 83.0963ZM260.124 82.8359V67.2117H262.294V73.6784C262.656 73.0419 263.155 72.5428 263.791 72.1811C264.442 71.8194 265.159 71.6386 265.94 71.6386C266.808 71.6386 267.553 71.8194 268.175 72.1811C268.797 72.5283 269.274 73.0563 269.607 73.7652C269.94 74.4596 270.106 75.3349 270.106 76.3909V82.8359H267.958V76.6297C267.958 75.6025 267.741 74.8285 267.307 74.3077C266.873 73.7724 266.229 73.5048 265.376 73.5048C264.797 73.5048 264.276 73.6422 263.813 73.9171C263.35 74.192 262.981 74.5971 262.706 75.1323C262.432 75.6531 262.294 76.2897 262.294 77.042V82.8359H260.124Z",fill:"#09090B"}),t.createElement("g",{filter:"url(#filter3_d_3529_1352)"},t.createElement("g",{clipPath:"url(#clip1_3529_1352)"},t.createElement("path",{d:"M124.083 130.503L118.25 137.503H123.5L122.917 142.17L128.75 135.17H123.5L124.083 130.503Z",stroke:"#18181B",strokeWidth:1.33,strokeLinecap:"round",strokeLinejoin:"round"})),t.createElement("path",{d:"M136.737 141.337V133.119L135.029 133.553V132.503L137.255 131.537H138.165V141.337H136.737ZM144.033 141.505C143.165 141.505 142.418 141.295 141.793 140.875C141.167 140.445 140.687 139.853 140.351 139.097C140.015 138.331 139.847 137.445 139.847 136.437C139.847 135.429 140.015 134.547 140.351 133.791C140.687 133.025 141.167 132.433 141.793 132.013C142.418 131.583 143.165 131.369 144.033 131.369C144.901 131.369 145.643 131.583 146.259 132.013C146.884 132.433 147.36 133.025 147.687 133.791C148.023 134.547 148.191 135.429 148.191 136.437C148.191 137.445 148.023 138.331 147.687 139.097C147.36 139.853 146.884 140.445 146.259 140.875C145.643 141.295 144.901 141.505 144.033 141.505ZM144.033 140.259C144.555 140.259 145.022 140.105 145.433 139.797C145.853 139.489 146.179 139.05 146.413 138.481C146.646 137.911 146.763 137.23 146.763 136.437C146.763 135.643 146.646 134.962 146.413 134.393C146.179 133.823 145.853 133.389 145.433 133.091C145.022 132.783 144.555 132.629 144.033 132.629C143.501 132.629 143.025 132.783 142.605 133.091C142.185 133.389 141.858 133.823 141.625 134.393C141.391 134.962 141.275 135.643 141.275 136.437C141.275 137.23 141.391 137.911 141.625 138.481C141.858 139.05 142.185 139.489 142.605 139.797C143.025 140.105 143.501 140.259 144.033 140.259ZM149.571 141.337V140.329C150.225 139.825 150.845 139.316 151.433 138.803C152.021 138.289 152.544 137.781 153.001 137.277C153.468 136.763 153.832 136.264 154.093 135.779C154.355 135.284 154.485 134.813 154.485 134.365C154.485 134.047 154.429 133.753 154.317 133.483C154.205 133.212 154.028 132.993 153.785 132.825C153.543 132.647 153.211 132.559 152.791 132.559C152.39 132.559 152.054 132.647 151.783 132.825C151.522 133.002 151.321 133.24 151.181 133.539C151.051 133.828 150.985 134.15 150.985 134.505H149.627C149.637 133.833 149.781 133.263 150.061 132.797C150.341 132.33 150.719 131.975 151.195 131.733C151.681 131.49 152.222 131.369 152.819 131.369C153.445 131.369 153.986 131.485 154.443 131.719C154.901 131.943 155.255 132.274 155.507 132.713C155.759 133.142 155.885 133.669 155.885 134.295C155.885 134.743 155.797 135.191 155.619 135.639C155.442 136.077 155.199 136.507 154.891 136.927C154.593 137.347 154.257 137.753 153.883 138.145C153.51 138.527 153.123 138.891 152.721 139.237C152.329 139.582 151.951 139.895 151.587 140.175H156.193V141.337H149.571ZM161.359 141.337V131.257H162.759V141.337H161.359ZM167.874 141.505C167.202 141.505 166.604 141.351 166.082 141.043C165.559 140.735 165.148 140.305 164.85 139.755C164.56 139.204 164.416 138.565 164.416 137.837C164.416 137.09 164.56 136.441 164.85 135.891C165.148 135.331 165.559 134.897 166.082 134.589C166.604 134.271 167.211 134.113 167.902 134.113C168.592 134.113 169.185 134.267 169.68 134.575C170.174 134.883 170.557 135.293 170.828 135.807C171.098 136.311 171.234 136.871 171.234 137.487C171.234 137.58 171.229 137.683 171.22 137.795C171.22 137.897 171.215 138.014 171.206 138.145H165.438V137.151H169.834C169.806 136.563 169.61 136.105 169.246 135.779C168.882 135.443 168.429 135.275 167.888 135.275C167.505 135.275 167.155 135.363 166.838 135.541C166.52 135.709 166.264 135.961 166.068 136.297C165.881 136.623 165.788 137.039 165.788 137.543V137.935C165.788 138.457 165.881 138.901 166.068 139.265C166.264 139.619 166.52 139.89 166.838 140.077C167.155 140.254 167.5 140.343 167.874 140.343C168.322 140.343 168.69 140.245 168.98 140.049C169.269 139.853 169.484 139.587 169.624 139.251H171.024C170.902 139.68 170.697 140.067 170.408 140.413C170.118 140.749 169.759 141.015 169.33 141.211C168.91 141.407 168.424 141.505 167.874 141.505ZM173.167 141.337V133.329C173.167 132.843 173.246 132.447 173.405 132.139C173.573 131.831 173.816 131.607 174.133 131.467C174.45 131.327 174.833 131.257 175.281 131.257H176.107V132.447H175.505C175.169 132.447 174.926 132.517 174.777 132.657C174.637 132.787 174.567 133.021 174.567 133.357V141.337H173.167ZM172.131 135.471V134.281H176.261V135.471H172.131ZM180.582 141.337C180.143 141.337 179.76 141.267 179.434 141.127C179.107 140.987 178.855 140.753 178.678 140.427C178.5 140.1 178.412 139.657 178.412 139.097V135.471H177.194V134.281H178.412L178.58 132.517H179.812V134.281H181.814V135.471H179.812V139.111C179.812 139.512 179.896 139.787 180.064 139.937C180.232 140.077 180.521 140.147 180.932 140.147H181.744V141.337H180.582Z",fill:"#09090B"})),t.createElement("g",{filter:"url(#filter4_d_3529_1352)"},t.createElement("path",{d:"M196.5 132.337C196.5 129.023 199.186 126.337 202.5 126.337H235.5C238.814 126.337 241.5 129.023 241.5 132.337V140.337C241.5 143.65 238.814 146.337 235.5 146.337H202.5C199.186 146.337 196.5 143.65 196.5 140.337V132.337Z",fill:"#DC2626"}),t.createElement("path",{d:"M207 136.337H214",stroke:"#FAFAFA",strokeWidth:1.33,strokeLinecap:"round",strokeLinejoin:"round"}),t.createElement("path",{d:"M222.585 140.337V133.581L221.097 133.965V132.849L223.161 131.937H224.061V140.337H222.585ZM229.097 140.481C228.337 140.481 227.685 140.301 227.141 139.941C226.597 139.573 226.177 139.065 225.881 138.417C225.593 137.761 225.449 137.001 225.449 136.137C225.449 135.273 225.593 134.517 225.881 133.869C226.177 133.213 226.597 132.705 227.141 132.345C227.685 131.977 228.337 131.793 229.097 131.793C229.849 131.793 230.493 131.977 231.029 132.345C231.573 132.705 231.989 133.213 232.277 133.869C232.573 134.517 232.721 135.273 232.721 136.137C232.721 137.001 232.573 137.761 232.277 138.417C231.989 139.065 231.573 139.573 231.029 139.941C230.493 140.301 229.849 140.481 229.097 140.481ZM229.085 139.185C229.509 139.185 229.885 139.065 230.213 138.825C230.541 138.577 230.793 138.225 230.969 137.769C231.153 137.313 231.245 136.769 231.245 136.137C231.245 135.505 231.153 134.961 230.969 134.505C230.793 134.049 230.541 133.701 230.213 133.461C229.885 133.213 229.509 133.089 229.085 133.089C228.661 133.089 228.285 133.213 227.957 133.461C227.629 133.701 227.373 134.049 227.189 134.505C227.013 134.961 226.925 135.505 226.925 136.137C226.925 136.769 227.013 137.313 227.189 137.769C227.373 138.225 227.629 138.577 227.957 138.825C228.285 139.065 228.661 139.185 229.085 139.185Z",fill:"white"}))),t.createElement("defs",null,t.createElement("filter",{id:"filter0_f_3529_1352",x:28.7613,y:-161.632,width:287.571,height:287.571,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},t.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),t.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),t.createElement("feGaussianBlur",{stdDeviation:30.4538,result:"effect1_foregroundBlur_3529_1352"})),t.createElement("filter",{id:"filter1_f_3529_1352",x:-143.089,y:-132.479,width:360.534,height:382.673,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},t.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),t.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),t.createElement("feGaussianBlur",{stdDeviation:44.9556,result:"effect1_foregroundBlur_3529_1352"})),t.createElement("filter",{id:"filter2_f_3529_1352",x:-117.61,y:-207.45,width:329.744,height:332.723,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},t.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),t.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),t.createElement("feGaussianBlur",{stdDeviation:44.9556,result:"effect1_foregroundBlur_3529_1352"})),t.createElement("filter",{id:"filter3_d_3529_1352",x:102.5,y:121.337,width:94,height:32,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},t.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),t.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),t.createElement("feOffset",{dy:1}),t.createElement("feGaussianBlur",{stdDeviation:1}),t.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.0627451 0 0 0 0 0.0941176 0 0 0 0 0.156863 0 0 0 0.05 0"}),t.createElement("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_3529_1352"}),t.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_3529_1352",result:"shape"})),t.createElement("filter",{id:"filter4_d_3529_1352",x:194.5,y:125.337,width:48.9999,height:24,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},t.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),t.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),t.createElement("feOffset",{dy:1}),t.createElement("feGaussianBlur",{stdDeviation:1}),t.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.0627451 0 0 0 0 0.0941176 0 0 0 0 0.156863 0 0 0 0.05 0"}),t.createElement("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_3529_1352"}),t.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_3529_1352",result:"shape"})),t.createElement("clipPath",{id:"clip0_3529_1352"},t.createElement("path",{d:"M0 6.02357C0 2.70986 2.68629 0.0235596 6 0.0235596H340C343.314 0.0235596 346 2.70985 346 6.02356V188.649C346 191.962 343.314 194.649 340 194.649H5.99999C2.68628 194.649 0 191.962 0 188.649V6.02357Z",fill:"white"})),t.createElement("clipPath",{id:"clip1_3529_1352"},t.createElement("rect",{width:14,height:14,fill:"white",transform:"translate(116.5 129.337)"}))));function xe({children:r}){const[o,l]=t.useState(!1),[p,f]=t.useState(0),n=t.useRef(null);return t.useEffect(()=>{var i;n!=null&&n.current&&f((i=n==null?void 0:n.current)==null?void 0:i.textContent.length)},[r]),e.jsxs("div",{ref:n,className:$("w-full",p>15&&"truncate"),onMouseLeave:()=>l(!o),onMouseEnter:()=>l(!o),children:[r,o&&p>15&&e.jsx("div",{className:"opacity-1 text-foreground bg-background absolute -top-3.5 left-1/2 z-[999] -translate-x-1/2 rounded-lg border bg-zinc-200 px-2 py-0.5 shadow-md dark:bg-zinc-700",children:r})]})}const Le=$t(r=>({currentMode:"",defaultResponse:{answer:"",relatedQuestions:[]},realtimeResponse:{answer:"",medias:[],relatedQuestions:[],sources:[]},setCurrentMode:o=>r(()=>({currentMode:o})),setDefaultAnswer:o=>{r(l=>({defaultResponse:{...l.defaultResponse,answer:`${l.defaultResponse.answer}${o}`}}))},setDefaultRelatedQuestions:o=>r(l=>({defaultResponse:{...l.defaultResponse,relatedQuestions:o}})),setRealtimeAnswer:o=>{r(l=>({realtimeResponse:{...l.realtimeResponse,answer:`${l.realtimeResponse.answer}${o}`}}))},setRealtimeMedias:o=>{r(l=>({realtimeResponse:{...l.realtimeResponse,medias:o}}))},setRealtimeRelatedQuestions:o=>r(l=>({realtimeResponse:{...l.realtimeResponse,relatedQuestions:o}})),setRealtimeSources:o=>{r(l=>({realtimeResponse:{...l.realtimeResponse,sources:o}}))}})),yt=r=>{const{alt:o,src:l,...p}=r,[f,n]=t.useState(!1);return e.jsx(e.Fragment,{children:f||l==null?e.jsx(bs,{size:24,className:"text-muted-foreground mx-auto rounded-lg object-fill"}):e.jsx("img",{src:l,alt:o,...p,onError:()=>n(!0)})})},Ms={animate:{opacity:1,transition:{duration:.3,type:"spring"}},initial:{opacity:0}};function Ls(){return e.jsx(V.div,{variants:Ms,className:"group/message min-w-full scroll-mt-20",children:e.jsxs("div",{className:"grid items-start gap-2 pt-3",children:[e.jsx("div",{className:"text-ds-text-muted select-none text-sm",children:e.jsx("div",{className:"bg-primary/10 mb-2 h-8 w-[60%] animate-pulse rounded-md py-1"})}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx(V.div,{initial:{opacity:0,width:"10%",x:-15},animate:{opacity:1,transition:{duration:.9,type:"spring"},width:"100%",x:0},style:{"--gradient-skeleton-delay":"0ms"},className:"gradient-skeleton h-4 rounded-md"}),e.jsx(V.div,{initial:{opacity:0,width:"10%",x:-15},animate:{opacity:1,transition:{delay:.1,duration:.9,type:"spring"},width:"85%",x:0},style:{"--gradient-skeleton-delay":"300ms"},className:"gradient-skeleton h-4 rounded-md"}),e.jsx(V.div,{initial:{opacity:0,width:"10%",x:-15},animate:{opacity:1,transition:{delay:.3,duration:.9,type:"spring"},width:"95%",x:0},style:{"--gradient-skeleton-delay":"500ms"},className:"gradient-skeleton h-4 rounded-md"}),e.jsx(V.div,{initial:{opacity:0,width:"10%",x:-15},animate:{opacity:1,transition:{delay:.1,duration:.9,type:"spring"},width:"90%",x:0},style:{"--gradient-skeleton-delay":"100ms"},className:"gradient-skeleton h-4 rounded-md"}),e.jsx(V.div,{initial:{opacity:0,width:"10%",x:-15},animate:{opacity:1,transition:{delay:.2,duration:.9,type:"spring"},width:"100%",x:0},style:{"--gradient-skeleton-delay":"300ms"},className:"gradient-skeleton h-4 rounded-md"})]}),e.jsx("div",{className:"text-ds-text-muted select-none text-sm",children:e.jsx("div",{className:"bg-primary/10 h-4 w-full animate-pulse rounded-md py-0.5"})}),e.jsx("div",{className:"text-ds-text-muted select-none text-sm",children:e.jsx("div",{className:"bg-primary/10 h-4 w-20 animate-pulse rounded-md py-0.5"})}),e.jsxs("div",{className:"grid h-full grid-cols-2 items-center justify-start gap-2",children:[e.jsx(V.div,{initial:{opacity:0,width:"10%",x:-15},animate:{opacity:1,transition:{duration:.9,type:"spring"},width:"100%",x:0},style:{"--gradient-skeleton-delay":"300ms"},className:"gradient-skeleton h-[115px] rounded-md"}),e.jsx(V.div,{initial:{opacity:0,width:"10%",x:-15},animate:{opacity:1,transition:{duration:.9,type:"spring"},width:"100%",x:0},style:{"--gradient-skeleton-delay":"300ms"},className:"gradient-skeleton h-[115px] rounded-md"})]})]})})}const Y=r=>r.split("").reverse().join(""),Fs=()=>{const r=document.title,o="- Google Search",l=Y(r).replace(Y(o),""),p=Y(l);return new URLSearchParams(window.location.search).get("q"),p},Is=()=>{const r=document.title,o="_百度搜索",l=Y(r).replace(Y(o),"");return Y(l)},Ps=()=>{const r=document.title,o="- Search",l=Y(r).replace(Y(o),"");return Y(l)},Bs=()=>{const r=document.title,l=/^(.*?) - Yahoo.*?Search Results/.exec(r);return l&&l.length>1?l[1].trim():null},Hs=()=>{const o=new URLSearchParams(window.location.search).get("text");return o||null},Ds=()=>{const r=document.title,o="at DuckDuckGo",l=Y(r).replace(Y(o),"");return Y(l)},T=()=>{const r=window.location.hostname;return r.includes("google")?"google":r.includes("baidu")?"baidu":r.includes("bing")?"bing":r.includes("yahoo")?"yahoo":r.includes("yandex")?"yandex":r.includes("duckduckgo")?"duckduckgo":"google"},Ge=async(r,o,l,p)=>{const f=T(),i=(await Ae(p,l,o,f)).map(async c=>{var O,_,B,U,h;const E=await o(lt.EXTRACT_DOM,"SERP_REALTIME",{url:c.url}),C=new DOMParser().parseFromString(E,"text/html"),P=((O=C.querySelector('meta[property="og:image"]'))==null?void 0:O.getAttribute("content"))||((_=C.querySelector("img"))==null?void 0:_.getAttribute("src")),D=`https://www.google.com/s2/favicons?sz=256&domain=${c.url}`||((B=C.querySelector('link[rel="icon"]'))==null?void 0:B.getAttribute("href"))||((U=C.querySelector('link[rel="icon shortcut"]'))==null?void 0:U.getAttribute("href")),q=((h=C.querySelector('meta[property="og:description"]'))==null?void 0:h.getAttribute("content"))||c.body;return{alt:c.alt,description:q,faviconLink:c.imgLink||D,ogImage:P||null,title:c.title,url:c.url}});return(await Promise.all(i)).filter(c=>c!==null)};function qs(r){try{const l=new URL("https://"+r).hostname;if(!/^(?!:\/\/)([a-zA-Z0-9-_]{1,63}\.)+[a-zA-Z]{2,6}$/.test(l))return null;const f=l.split(".");return f.length>2&&f[f.length-2].length===2?f[f.length-3]:f.length>1?f[f.length-2]:f[0]}catch{return null}}async function Ae(r,o,l,p){const f=`${r} ${o.filter(E=>!["google.com","yahoo.com","baidu.com","bing.com","yandex.com","duckduckgo.com"].includes(E)).map(E=>"site:"+E)}`;let n=["yahoo","baidu","yandex","duckduckgo"].includes(p)?"google":p,{html:i,success:u}=await Ne({engine:n,getFromBackground:l,query:f});return u||(n=n==="google"?"bing":"google",{html:i,success:u}=await Ne({engine:n,getFromBackground:l,query:f})),u||(n=n==="bing"?"yahoo":"google",{html:i,success:u}=await Ne({engine:n,getFromBackground:l,query:f})),u||(n="baidu",{html:i,success:u}=await Ne({engine:n,getFromBackground:l,query:f})),u?Qt(i,n):[]}function Os(r,o){return Object.fromEntries(Object.entries(r).map(([l,p])=>[l,{...p,isSelected:l===o}]))}function Us(r){for(const o in r)if(r[o].isSelected)return o;return T()}const Vs=r=>{const{isComplementaryPage:o,setShowSources:l,sources:p}=r,{t:f}=ge(),n=t.useCallback(()=>{l(!1)},[]);return e.jsx(xt,{children:e.jsxs("div",{className:$("max-h-96 bg-transparent",T()=="google"?"w-96":"w-full"),children:[e.jsxs("div",{className:"flex justify-between font-serif",children:[e.jsx("p",{className:"text-2xl",children:f("serp_index.sources")}),e.jsx("button",{type:"button",onClick:n,children:e.jsx(Xe,{className:$("h-4 w-4",o?"mr-6":"mr-2")})})]}),e.jsx("div",{children:e.jsx("ul",{className:"max-h-[348px] min-h-[20rem]",children:e.jsx(mt,{className:T()=="google"&&"w-[372px]",children:p.map((i,u)=>e.jsxs("li",{onClick:()=>se(i.url),className:"animate-slide-up my-2 flex cursor-pointer rounded-lg bg-transparent p-1 py-2 transition duration-300 ease-in-out hover:bg-gray-400/20",style:{animationDelay:`${u*200}ms`},children:[e.jsx("div",{className:"mx-auto flow-root max-w-min self-center pr-2",children:e.jsx("div",{className:"mx-auto flow-root max-w-fit rounded-xl bg-gray-900/5 ring-1 ring-inset ring-gray-900/10",children:e.jsx("div",{className:"bg-muted mx-auto flex h-16 w-28 items-center overflow-hidden rounded-md",children:e.jsx(yt,{src:i.ogImage||i.faviconLink,alt:i.alt,className:"h-full w-full rounded-lg "+(i.ogImage?"aspect-video object-cover":"aspect-square object-contain")})})})}),e.jsxs("div",{className:$("flex flex-col space-y-1",T()=="google"?"w-60":T()=="yahoo"?"w-72":"w-fit"),children:[e.jsx("p",{className:"text-card-foreground line-clamp-1 text-base",children:i.title}),e.jsx("div",{className:"text-card-foreground/80 line-clamp-1 text-xs",children:i.description}),e.jsx("p",{className:"text-muted-foreground/80 truncate text-xs",children:new URL(i.url).hostname})]})]},u))})})})]})})},$e=3e3,Qs={hidden:{opacity:0,scale:.5,y:100},visible:{opacity:1,scale:.96,transition:{damping:25,duration:.2,stiffness:200,type:"spring"},y:0}};function zs({UserSettings:r,fetchData:o,followupInputRef:l,isComplementaryPage:p,isLoading:f,platformResponse:n,queryTerms:i,realtimeLimitExceeded:u,realtimeSearchPlatforms:c,requestIdHeader:E,selectedPlatforms:C,setShowFollowup:P,setTriggerCompleteResponseAfterLogin:D,shadowWrapper:q,toggleRealtimeMode:z,update:O}){const{t:_}=ge(),[B,U]=t.useState(!1),{...h}=t.useContext(Ye),[K,G]=t.useState(!1),{currentMode:m,defaultResponse:N,realtimeResponse:F,setCurrentMode:v}=Le(g=>({currentMode:g.currentMode,defaultResponse:g.defaultResponse,realtimeResponse:g.realtimeResponse,setCurrentMode:g.setCurrentMode})),[b,A]=t.useState($e),[x,j]=t.useState(!1),[Fe,H]=t.useState(!0),[le,me]=t.useState(!1),[ce,fe]=t.useState(!1),he=et.useRef(null),je=et.useRef(m==="DEFAULT"),[W,re]=t.useState(null),[Ie,ne]=t.useState(null),[ae,X]=t.useState(r.serp.showQueryConsent??!1),ye=()=>(b-$e)/$e*282.6,Pe=t.useCallback(()=>{fe(!0)},[]),Be=t.useCallback(()=>{var g,M,Z,k,de,S;return((Z=(M=(g=h.usageDetails)==null?void 0:g.cappedFeatures)==null?void 0:M.realtimeSerp)==null?void 0:Z.limit)-((S=(de=(k=h.usageDetails)==null?void 0:k.cappedFeatures)==null?void 0:de.realtimeSerp)==null?void 0:S.used)},[h]),Ce=t.useCallback(async()=>{clearInterval(he.current),fe(!1),v("DEFAULT"),A(0),o(),je.current=!0,await O({...r,serp:{...r.serp,realtime:!1}})},[he.current,r,o,O]);t.useEffect(()=>{m==="DEFAULT"&&A(0)},[m]),t.useEffect(()=>(ce&&b>0?he.current=setInterval(()=>{A(g=>g-10)},10):!ce&&b===0&&(A(0),fe(!1)),b===0&&ce&&Ce(),()=>clearInterval(he.current)),[ce,b]),t.useEffect(()=>{m==="REALTIME"&&(!h.isAuthenticated||u)&&!je.current&&Pe()},[h.isAuthenticated,m,u]),t.useEffect(()=>{if(n[C[0]].answer.length<=0||n[C[0]].sources.length<=0||K)return;const g=Array.from(q.shadowRoot.querySelectorAll("a"));return g.forEach(M=>{M.addEventListener("pointerenter",Z=>{const k=n[C[0]].sources.filter(de=>de.url===M.href);k[0]&&(ne(Z.target),re(k[0]))}),M.addEventListener("pointerleave",Z=>{ne(null),re(null)}),M.addEventListener("mousedown",Z=>{ne(null),re(null)})}),()=>{g.forEach(M=>{M.removeEventListener("pointerenter",Z=>{const k=n[C[0]].sources.filter(de=>de.url===M.href);k[0]&&(ne(Z.target),re(k[0]))}),M.removeEventListener("pointerleave",Z=>{ne(null),re(null)}),M.removeEventListener("mousedown",Z=>{ne(null),re(null)})})}},[n[C[0]].answer,C,K]);function He(){navigator.clipboard.writeText(m==="REALTIME"?n[C[0]].answer:N.answer),U(!0),setTimeout(()=>{U(!1)},1e3),L({eventName:"CopyButton",eventType:"Button",feature:"SUPER SERP",firedFromFile:"src/features/serp/body.tsx"})}return t.useEffect(()=>{H(!1);const g=setTimeout(()=>{H(!0)},2300);return()=>clearTimeout(g)},[le]),t.useEffect(()=>{function g(M){M.key==="a"&&l.current&&M.target.localName!=="textarea"&&M.target.localName!=="input"&&(L({eventName:"AskAFollowupSERP",eventType:"Button",feature:"SUPER SERP",firedFromFile:"src/features/serp/body.tsx"}),M.target.blur(),l.current.focus())}return document.addEventListener("keyup",g),q.shadowRoot.querySelector("#reactAppRoot").addEventListener("keyup",g),()=>{document.removeEventListener("keyup",g),q.shadowRoot.querySelector("#reactAppRoot").removeEventListener("keyup",g)}},[l]),t.useEffect(()=>{(!h.isAuthenticated||u)&&P(!1),h.isAuthenticated&&!u&&P(!0)},[h.isAuthenticated,u]),t.useEffect(()=>{m==="REALTIME"&&h.isAuthenticated&&h.usageDetails.type==="FREE"&&Be()<=0&&X(r.serp.showQueryConsent??!1)},[r,m,h,C]),m==="REALTIME"&&ae&&h.isAuthenticated&&h.usageDetails.type==="FREE"?e.jsx("div",{className:"flex min-h-96 w-full flex-col overflow-hidden",children:e.jsxs("div",{className:"merlinExt-custom-scrollbar relative flex w-full items-center justify-center overflow-y-auto bg-transparent",children:[e.jsxs(Q,{size:"icon",variant:"ghost",className:"absolute right-2 top-0 h-7 w-7 rounded-full",onClick:()=>{v("DEFAULT"),X(!1)},children:[e.jsx("svg",{className:"absolute right-0 top-0 h-full w-full -rotate-90 transform",viewBox:"0 0 100 100",children:e.jsx("circle",{className:"text-foreground",fill:"none",strokeWidth:"8",stroke:"currentColor",strokeDasharray:"282.6",strokeDashoffset:ye(),strokeLinecap:"round",cx:"50",cy:"50",r:"45"})}),e.jsx(it,{className:"h-4 w-4"})]}),e.jsxs(V.div,{variants:Qs,initial:"hidden",animate:"visible",className:"my-6 flex min-h-96 flex-col items-center justify-center gap-2 p-2 text-center",children:[e.jsx(Ts,{className:p?"w-[95%]":"w-[90%]"}),e.jsxs("div",{className:$("flex flex-col items-center justify-center gap-3",p?"w-[90%]":"w-[85%]"),children:[e.jsxs("span",{className:"font-serif text-xl font-medium",children:[_("serp_index.realtime")," ",e.jsx("span",{className:"text-ds-bg-magic italic",children:_("serp_index.pro").toLowerCase()})," ",_("serp_index.trial_over")]}),e.jsxs("div",{className:"text-muted-foreground text-md text-start",children:[e.jsx("span",{children:_("serp_index.use_daily_queries")})," ",e.jsx("a",{className:"text-cornblue-500 dark:text-cornblue-600 underline",href:Te+"?from=super-serp-consent",target:"_blank",rel:"noreferrer",children:_("serp_index.buy_pro_for_limitless_experience")})]}),e.jsx(Q,{onClick:()=>{L({eventData:{selectedPlatform:C[0]},eventName:"SwitchAgreeCTARealtimeBody",eventType:"Button",feature:"SUPER SERP",firedFromFile:"src/features/serp/body.tsx"}),X(!1),z(!0,!1),O({...r,serp:{...r.serp,showQueryConsent:!1}})},className:"mx-3 w-full",children:_("serp_index.i_agree")})]})]})]})}):m==="REALTIME"&&(!h.isAuthenticated||u)?e.jsx("div",{className:"flex min-h-96 w-full flex-col overflow-hidden",children:e.jsxs("div",{className:"merlinExt-custom-scrollbar relative flex w-full items-center justify-center overflow-y-auto bg-transparent",children:[e.jsxs(Q,{size:"icon",variant:"ghost",className:"absolute right-2 top-2 h-7 w-7 rounded-full",onClick:()=>{Ce(),P(!0)},children:[e.jsx("svg",{className:"absolute right-0 top-0 h-full w-full -rotate-90 transform",viewBox:"0 0 100 100",children:e.jsx("circle",{className:"text-foreground",fill:"none",strokeWidth:"8",stroke:"currentColor",strokeDasharray:"282.6",strokeDashoffset:ye(),strokeLinecap:"round",cx:"50",cy:"50",r:"45"})}),e.jsx(it,{className:"h-4 w-4"})]}),e.jsxs("div",{className:"flex min-h-96 w-[60%] flex-col items-center justify-center gap-2 p-2 text-center",children:[e.jsxs(Q,{variant:"ghost",className:"merlinExt-magic-btn-border relative my-4 flex rotate-6 items-center justify-center gap-2 rounded-full p-1 shadow-lg",children:[e.jsxs("div",{className:"bg-background center-with-flex h-full w-full rounded-full p-2",children:["🌐 ",_("serp_index.realtime_search_cta")]}),e.jsxs("div",{className:"absolute -right-6 -top-2 flex rotate-45 items-end gap-0.5",children:[e.jsx("div",{className:"border-muted-foreground w-3 rotate-45 border-t-2"}),e.jsx("div",{className:"border-muted-foreground mb-1 w-3 rotate-90 border-t-2"}),e.jsx("div",{className:"border-muted-foreground w-3 -rotate-45 border-t-2"})]}),e.jsxs("div",{className:"items-endx absolute -bottom-2 -left-6 flex rotate-45 gap-0.5",children:[e.jsx("div",{className:"border-muted-foreground w-3 -rotate-45 border-t-2"}),e.jsx("div",{className:"border-muted-foreground mt-1 w-3 rotate-90 border-t-2"}),e.jsx("div",{className:"border-muted-foreground w-3 rotate-45 border-t-2"})]})]}),e.jsx("span",{className:"text-lg font-semibold",children:h.isAuthenticated?`${_("serp_index.exhausted_all")}`:`${_("serp_index.login_for_free")}`}),e.jsx("span",{className:"text-muted-foreground text-sm",children:h.isAuthenticated?`${_("serp_index.subscribe_prompt")}`:`${_("serp_index.login_prompt")}`}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{onClick:()=>{L({eventName:h.isAuthenticated?"SubscribeCTARealtimeBody":"LoginCTARealtimeBody",eventType:"Button",feature:"SUPER SERP",firedFromFile:"src/features/serp/body.tsx"}),se(h.isAuthenticated?Te+"?from=super-serp-realtime-cta":ct),D(g=>g+1)},children:h.isAuthenticated?e.jsxs(e.Fragment,{children:[e.jsx(_s,{className:"mr-2 h-4 w-4"}),_("serp_index.go_pro")]}):e.jsxs(e.Fragment,{children:[e.jsx(Es,{className:"mr-2 h-4 w-4"}),_("serp_index.login")]})}),!h.isAuthenticated&&e.jsx(Q,{variant:"secondary",onClick:()=>{L({eventName:"RegisterCTARealtimeBody",eventType:"Button",feature:"SUPER SERP",firedFromFile:"src/features/serp/body.tsx"}),se(Et+"?from=super-serp-realtime-cta"),D(g=>g+1)},children:_("serp_index.register")})]})]})]})}):e.jsxs("div",{className:"w-full",children:[e.jsx(mt,{className:"relative flex w-full flex-col",children:e.jsx("div",{className:"relative w-full",children:e.jsx("div",{className:"w-full",children:m==="REALTIME"&&n[C[0]].answer.length==0||m!=="REALTIME"&&N.answer.length==0?e.jsx("div",{children:e.jsx(Ls,{})}):K&&m=="REALTIME"&&n[C[0]].sources.length>0?e.jsx(Vs,{sources:n[C[0]].sources,setShowSources:G,isComplementaryPage:p}):e.jsxs("div",{className:["google"].includes(T())&&"max-w-[390px]",children:[e.jsxs("div",{className:"pt-1",children:[e.jsxs("p",{className:"mb-2 font-serif text-xl font-[550]",children:[e.jsx("span",{className:"text-muted-foreground",children:_("serp_index.here_more_on")}),i]}),e.jsx("div",{className:"text-foreground min-w-0 text-base",children:m==="DEFAULT"?e.jsx(rt,{addMath:!1,content:N.answer}):e.jsx(rt,{addMath:!1,content:n[C[0]].answer.replaceAll(/\[citation:(.*?)\]/g,(g,M)=>{var Z;return`<sup className="rounded-full text-xs cursor-pointer [&>*]:!text-white h-4 w-4 px-1 bg-zinc-400 hover:bg-zinc-500 dark:bg-zinc-700 hover:dark:bg-zinc-600">[${M}](${(Z=n[C[0]].sources[M-1])==null?void 0:Z.url})</sup> `})})})]}),m==="REALTIME"&&!f&&F.medias.length>0&&e.jsx("div",{className:"space-y-2 pb-2 pt-1",children:e.jsx("div",{className:"grid h-full grid-cols-2 items-center justify-start gap-2 overflow-x-auto",children:F.medias.slice(Math.min(c[C[0]].id*2,F.medias.length-3),Math.min(c[C[0]].id*2+2,F.medias.length-1)).map((g,M)=>e.jsx(V.button,{initial:{opacity:0},animate:{opacity:1,transition:{duration:.3}},type:"button",onClick:()=>se(g.id?`https://www.google.com/search?q=${i}&tbm=isch#vhid=${g.id}&vssid=mosaic`:g.link),className:"border-muted-foreground h-24 space-y-1 overflow-hidden rounded-lg border hover:cursor-pointer",children:e.jsx("img",{className:"h-full w-full object-cover",src:g.link,alt:g.link})},M))})})]})})})}),!f&&(m==="REALTIME"&&n[C[0]].answer.length>0||m==="DEFAULT"&&N.answer.length>0||!h.isAuthenticated)&&e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex justify-between pt-2",children:[e.jsxs("div",{className:"flex items-center justify-start gap-1",children:[e.jsx(Q,{size:"icon-sm",variant:"ghost",onClick:He,disabled:B,children:B?e.jsx(gt,{className:"h-4 w-4 text-zinc-400"}):e.jsx(vs,{className:"hover:text-accent-foreground h-4 w-4 text-zinc-400"})}),(m==="REALTIME"?n[C[0]].answer.length>0:N.answer.length>0)&&e.jsx("div",{children:!x&&e.jsx(zt,{hideText:!0,queryTerms:i,promptResult:m==="REALTIME"?n[C[0]].answer:N.answer,callingSite:window.location.href,email:h.isAuthenticated?h.email:"UNAUTHENTICATED_USER",requestId:E,parentFeedbackSent:j,setFeedbackClicked:me})})]}),m=="REALTIME"&&n[C[0]].sources.length>0&&e.jsxs("button",{type:"button",className:$(ft({variant:"ghost"}),"px-2 py-2",K&&"bg-gray-500/15"),onClick:()=>{L({eventData:{currentMode:m,selectedPlatform:C[0]},eventName:"AnswerSourcesSERP",eventType:"Button",feature:"SUPER SERP",firedFromFile:"src/features/serp/body.tsx"}),G(g=>!g)},children:[C.slice(0,2).map((g,M)=>e.jsx("span",{className:$("bg-background border-ds-icon-muted rounded-full border",M==0?"":"-ml-2",c[g].name=="google"?"":"p-[3px]"),children:e.jsx("img",{src:c[g].iconUrl,alt:c[g].name,className:"rounded-sm "+(c[g].name=="google"?"h-5 w-5":"h-4 w-4")})},M)),C.length>2&&e.jsxs("span",{className:"bg-background border-ds-icon-muted text-muted-foreground -ml-2 rounded-full border p-0.5 text-xs",children:["+ ",C.length-2]}),e.jsx("p",{className:"text-muted-foreground mx-2 text-xs",children:e.jsx(xe,{children:_("serp_index.sources")})}),e.jsx(We,{className:"text-muted-foreground h-3 w-3"})]})]}),Fe&&e.jsx(V.p,{className:"text-muted-foreground/50 mx-auto text-start text-xs italic",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{delay:.5,duration:.7,ease:"easeInOut"},children:_("serp_index.ai_can_be_inaccurate")})]}),W&&e.jsx(V.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1,transition:{duration:.3,type:"spring"}},transition:{type:"spring"},style:{...Zt(Ie),marginBottom:`${nt}px`,marginTop:`${nt}px`,maxWidth:`${Gt}px`,minHeight:"90px",width:"100%"},className:"bg-ds-bg-subtle border-border text-text z-50 whitespace-break-spaces break-words rounded-xl border shadow-2xl",children:e.jsxs("div",{className:"max-h-96 rounded-lg",children:[e.jsx("div",{className:"mx-auto flow-root max-w-min self-center pr-2",children:e.jsx("div",{className:"mx-auto flow-root max-w-fit rounded-t-xl bg-gray-900/5 ring-1 ring-inset ring-gray-900/10",children:e.jsx("div",{className:"bg-muted mx-auto flex h-[185px] w-[360px] items-center overflow-hidden rounded-t-xl",children:e.jsx(yt,{className:"h-full w-full rounded-t-xl "+(W.ogImage?"aspect-video object-cover":"aspect-square object-contain"),src:W.ogImage||W.faviconLink,alt:W.alt})})})}),e.jsxs("div",{className:"space-y-3 p-3",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-md text-ds-text-info line-clamp-2 font-bold tracking-tight",children:W.title}),e.jsx("p",{className:"text-muted-foreground/80 truncate text-xs",children:new URL(W.url).hostname})]}),!W.description&&e.jsxs("div",{role:"status",className:"mt-4 w-full animate-pulse rounded shadow",children:[e.jsx("div",{className:"mb-2.5 h-3 rounded-full bg-gray-200 dark:bg-gray-700"}),e.jsx("div",{className:"mb-2.5 h-3 rounded-full bg-gray-200 dark:bg-gray-700"}),e.jsx("div",{className:"mb-2.5 h-3 rounded-full bg-gray-200 dark:bg-gray-700"}),e.jsx("div",{className:"h-3 rounded-full bg-gray-200 dark:bg-gray-700"})]}),e.jsx("div",{className:"line-clamp-3 text-sm",children:W.description})]})]})},W.url)]})}const Zs=({UserSettings:r,isShowQueryConsent:o,platformResponse:l,selectedPlatforms:p,toggleRealtimeMode:f})=>{var K,G;const{t:n}=ge(),{...i}=t.useContext(It),{usageDetails:u}=i;function c(){var m,N,F,v;return((N=(m=u==null?void 0:u.cappedFeatures)==null?void 0:m.realtimeSerp)==null?void 0:N.limit)-((v=(F=u==null?void 0:u.cappedFeatures)==null?void 0:F.realtimeSerp)==null?void 0:v.used)}const E=t.useRef(null),{sharedUserSettingsMutation:C,sharedUserSettingsQuery:P}=fs(),D=P.data.language,[q,z]=t.useState(!1),O=t.useMemo(()=>Object.keys(Ue).map(m=>({label:Ue[m],value:m})),[]),_=t.useCallback(m=>{if(L({eventData:m,eventName:"SwitchLanguage",eventType:"Dropdown",feature:"ActiveLanguage",firedFromFile:"features/serp/footer.tsx"}),Object.keys(Ue).includes(m)){C.mutate({language:m}),z(!1);return}C.mutate({language:"AUTO"}),z(!1)},[C]),{currentMode:B,setCurrentMode:U}=Le(m=>({currentMode:m.currentMode,defaultResponse:m.defaultResponse,realtimeResponse:m.realtimeResponse,setCurrentMode:m.setCurrentMode}));function h(){var v;if(!i.isAuthenticated)return e.jsx(Ze,{children:e.jsx(_e,{className:"h-5 w-5"})});const m=Vt(i==null?void 0:i.token);if(!m)return e.jsx(Ze,{children:e.jsx(_e,{className:"h-5 w-5"})});const N=(v=m==null?void 0:m.details)==null?void 0:v.picture,F=t.useMemo(()=>{const b=i.name;if(b){const[x,j]=b.split(" ");if(x&&j)return x[0].toUpperCase()+j[0].toUpperCase();if(x)return x[0].toUpperCase();if(j)return j[0].toUpperCase()}const A=i.email;return A?A[0].toUpperCase():"U"},[i.name,i.email]);return e.jsxs(e.Fragment,{children:[" ",e.jsx(Kt,{src:N,alt:F}),e.jsx(Ze,{children:F||e.jsx(_e,{className:"h-5 w-5 stroke-[1.5]"})})]})}return t.useEffect(()=>{q&&setTimeout(()=>{const m=E.current;if(!m)return;function N(F){m.scrollBy(0,F.deltaY)}return m.addEventListener("wheel",N),()=>{m.removeEventListener("wheel",N)}})},[q,E.current]),e.jsxs("div",{className:"flex h-full w-full items-center justify-between bg-transparent py-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("a",{rel:"noreferrer",target:"_blank",className:"center-with-flex hover:cursor-pointer",onClick:()=>{se(jt.DOMAIN),L({eventData:"Merlin Dashboard",eventName:"OpenPage",eventType:"Button",feature:"SUPER SERP",firedFromFile:"features/serp"})},children:e.jsx(ht,{className:"h-7 w-7"})}),e.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>{window.parent.postMessage({type:dt.SEARCH_GPT},"*"),L({eventData:{currentMode:B,selectedPlatform:p[0]},eventName:"StartNewChatSERP",eventType:"Button",feature:"SUPER SERP",firedFromFile:"src/features/serp/body.tsx"})},className:"mx-2 px-3 text-xs",children:e.jsx("span",{children:e.jsx(xe,{children:n("serp_index.open_chat")})})})]}),e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"mx-2 flex items-center text-xs",children:[e.jsx(Wt,{checked:B=="REALTIME",onCheckedChange:()=>{L({eventData:{currentMode:B,selectedPlatform:p[0]},eventName:"ToggleRealtimeSERPSwitch",eventType:"Switch",feature:"SUPER SERP",firedFromFile:"src/features/serp/footer.tsx"}),B==="REALTIME"?f(!1):l[p[0]].answer.length===0&&(o(i,r)||f(!0)),U(B=="REALTIME"?"DEFAULT":"REALTIME")},className:"mr-2"}),e.jsx(xe,{children:n("serp_index.realtime")}),e.jsx(ze,{className:"bg-ds-bg-magic hover:bg-ds-bg-magic mx-2 px-1 py-0.5 text-white",children:!i.isAuthenticated||i.usageDetails.type!=="FREE"?e.jsx("span",{children:n("serp_index.pro")}):e.jsxs("span",{children:[c()>0?c():0,"/10"]})})]}),e.jsxs(os,{children:[e.jsx(ls,{asChild:!0,children:e.jsx(at,{onClick:()=>L({eventName:"AvatarClickSERPfooter",eventType:"Button",feature:"SUPER SERP",firedFromFile:"src/features/serp/footer.tsx"}),className:"h-8 w-8 text-sm hover:cursor-pointer",children:h()})}),e.jsxs(cs,{className:"my-2 w-64",align:"end",children:[e.jsxs(ds,{className:"flex items-center justify-between px-3 py-1 font-normal",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(at,{className:"h-8 w-8",children:h()}),e.jsxs("div",{className:"flex w-32 flex-col items-start justify-center",children:[e.jsx("span",{className:"w-full truncate text-sm font-medium",children:i!=null&&i.name?i==null?void 0:i.name:n("serp_index.hi_there")}),e.jsx("span",{className:"text-muted-foreground w-full truncate text-xs",children:i!=null&&i.email?i==null?void 0:i.email:n("serp_index.login_to_get_more")})]})]}),i.isAuthenticated?e.jsx(ze,{variant:"secondary",className:"rounded-md px-2 py-0.5",children:i.isAuthenticated?u.type==="PAID"?n("serp_index.pro"):n("serp_index.free"):n("serp_index.pro")}):e.jsx(ze,{variant:"secondary",className:"rounded-md px-2 py-1 hover:cursor-pointer",onClick:()=>{L({eventName:"LoginDropdownSERP",eventType:"Button",feature:"SUPER SERP",firedFromFile:"src/features/serp/footer.tsx"}),se(ct)},children:n("serp_index.login")})]}),e.jsx(us,{className:"my-0"}),e.jsxs(ms,{className:"p-1",children:[i.usageDetails.type===n("serp_index.free")&&e.jsx(ve,{asChild:!0,children:e.jsxs(Q,{variant:"ghost",onClick:()=>{L({eventName:"GoProSERPDropdown",eventType:"Button",feature:"SUPER SERP",firedFromFile:"src/features/serp/footer.tsx"}),se(Te+"?from=super-serp-dropdown")},className:"flex w-full items-center justify-between hover:cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-start gap-2 text-sm font-normal",children:[e.jsx(ws,{className:"h-4 w-4"})," ",n("serp_index.go_pro")]}),e.jsx(ke,{className:"h-4 w-4 stroke-[1.5px]"})]})}),e.jsx(ve,{asChild:!0,children:e.jsxs(Q,{variant:"ghost",onClick:()=>{L({eventName:"DashboardSERPDropdown",eventType:"Button",feature:"SUPER SERP",firedFromFile:"src/features/serp/footer.tsx"}),se(St)},className:"flex w-full items-center justify-between hover:cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-start gap-2 text-sm font-normal",children:[e.jsx(_e,{className:"h-4 w-4"})," ",n("serp_index.dashboard")]}),e.jsx(ke,{className:"h-4 w-4 stroke-[1.5px]"})]})}),e.jsx(ve,{asChild:!0,children:e.jsxs(Q,{variant:"ghost",className:"flex w-full items-center justify-between hover:cursor-pointer",onClick:()=>{L({eventName:"FeedbackSERPDropdown",eventType:"Button",feature:"SUPER SERP",firedFromFile:"src/features/serp/footer.tsx"}),se(Rt)},children:[e.jsxs("div",{className:"flex items-center justify-start gap-2 text-sm font-normal",children:[e.jsx(js,{className:"h-4 w-4"})," ",n("dotmenu.feedback")]}),e.jsx(ke,{className:"h-4 w-4 stroke-[1.5px]"})]})}),e.jsx(ve,{asChild:!0,children:e.jsxs(Q,{variant:"ghost",className:"flex w-full items-center justify-between hover:cursor-pointer",onClick:()=>{L({eventName:"SettingsPageSERPDropdown",eventType:"Button",feature:"SUPER SERP",firedFromFile:"src/features/serp/footer.tsx"}),Tt({action:lt.OPEN_OPTIONS_PAGE})},children:[e.jsxs("div",{className:"flex items-center justify-start gap-2 text-sm font-normal",children:[e.jsx(hs,{className:"h-4 w-4"})," ",n("serp_index.settings")]}),e.jsx(ke,{className:"h-4 w-4 stroke-[1.5px]"})]})}),e.jsx(ve,{asChild:!0,children:e.jsxs(Xt,{open:q,onOpenChange:z,children:[e.jsx(Yt,{asChild:!0,children:e.jsxs(Q,{variant:"ghost",role:"combobox","aria-expanded":q,className:"outline-primary w-full justify-between p-0 px-2 outline-1",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Jt,{className:"h-4 w-4"}),D?((K=O.find(m=>m.value===D))==null?void 0:K.label)==="AUTO"?"Language (AUTO)":(G=O.find(m=>m.value===D))==null?void 0:G.label:n("dotmenu.lang")]}),e.jsx(es,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(ts,{align:"start",side:"right",className:"h-44 w-full p-0",children:e.jsxs(ss,{children:[e.jsx(rs,{placeholder:"Search language..."}),e.jsxs("div",{ref:E,className:"h-44 overflow-y-auto",children:[e.jsx(ns,{children:"No language found."}),e.jsx(as,{children:O.map(m=>e.jsxs(is,{value:m.value,disabled:!1,onSelect:N=>{_(N.toUpperCase())},children:[e.jsx(gt,{className:$("mr-2 h-4 w-4",D===m.value?"opacity-100":"opacity-0")}),m.label]},m.value))})]})]})})]})})]})]})]})]})]})},Gs=r=>t.createElement("svg",{viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r},t.createElement("g",{clipPath:"url(#clip0_16340_8741)"},t.createElement("path",{d:"M6.5 1L1.5 7H6L5.5 11L10.5 5H6L6.5 1Z",fill:"url(#paint0_linear_16340_8741)",stroke:"url(#paint1_linear_16340_8741)",strokeWidth:1.33,strokeLinecap:"round",strokeLinejoin:"round"})),t.createElement("defs",null,t.createElement("linearGradient",{id:"paint0_linear_16340_8741",x1:6,y1:1,x2:6,y2:11,gradientUnits:"userSpaceOnUse"},t.createElement("stop",{stopColor:"#EFD6FE"}),t.createElement("stop",{offset:.458333,stopColor:"#FF9BFB"}),t.createElement("stop",{offset:1,stopColor:"#8383FF"})),t.createElement("linearGradient",{id:"paint1_linear_16340_8741",x1:6,y1:1,x2:6,y2:11,gradientUnits:"userSpaceOnUse"},t.createElement("stop",{stopColor:"#EFD6FE"}),t.createElement("stop",{offset:.458333,stopColor:"#FF9BFB"}),t.createElement("stop",{offset:1,stopColor:"#8383FF"})),t.createElement("clipPath",{id:"clip0_16340_8741"},t.createElement("rect",{width:12,height:12,fill:"white"})))),$s={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.3,ease:"easeInOut"}}},Ks={hidden:{opacity:0,scale:0,y:100},visible:{opacity:1,scale:1,transition:{damping:25,delay:.2,duration:.5,stiffness:300,type:"spring"},y:0}},Ws=r=>{const{UserSettings:o,changeSelectedPlatform:l,setShowFollowup:p,setShowSettings:f,update:n}=r,{t:i}=ge(),{...u}=t.useContext(Ye),[c,E]=t.useState([...Object.keys(o.serp.realtimeSearchPlatforms[0]).map(v=>({...o.serp.realtimeSearchPlatforms[0][v]}))]),[C,P]=t.useState(!1),[D,q]=t.useState(!1),[z,O]=t.useState(""),[_,B]=t.useState(""),[U,h]=t.useState(""),K=t.useCallback(()=>{f(!1),p(!0)},[]),G=t.useCallback(()=>{const v="bcdefghijklnopqstuvwxz";let b=v[Math.floor(Math.random()*v.length)];const A=new Set(c.map(x=>x.key));for(;["bing","yahoo"].includes(T())&&A.has(b);)b=v[Math.floor(Math.random()*v.length)];c.length<5&&(E([...c,{domain:"",iconUrl:"https://www.google.com/s2/favicons?sz=256&domain=example.com",id:c.length+1,isSelected:!1,key:["bing","yahoo"].includes(T())?b:"",name:""}]),P(!0))},[c]),m=t.useCallback(v=>{const b=c.filter(A=>A.id!==v);E(b),P(!0)},[c]),N=t.useCallback(async(v,b,A)=>{let x=null;b==="domain"&&A.length>0&&(x=qs(A),h(x===null?"Invalid domain: "+A:""),c.filter(j=>j.id===v)[0].isSelected&&await l(T())),E(c.map(j=>j.id===v?{...j,[b]:A,name:b=="domain"?x:j.name}:j)),P(!0)},[l,c]),F=t.useCallback(async()=>{if(!u.isAuthenticated||u.usageDetails.type==="FREE")return;const v=new Set,b=new Set;b.add("/"),b.add("a");let A=!1;for(let x=0;x<c.length;x++)try{if(c[x].domain.length===0){B("Domain cannot be empty"),A=!0;break}else B("");if(c[x].key.length>1||c[x].key.length===0){O("Key must be a single character, Please change key for "+c[x].domain),A=!0;break}else O("");const j=new URL("https://"+c[x].domain).hostname;if(v.has(j)||b.has(c[x].key)){c[x].key==="/"||c[x].key==="a"?B("a or / key is already reserved for use"):B("Duplicate domains or keys are not allowed."),A=!0;break}else _!==""&&B("");v.add(j),b.add(c[x].key)}catch{h("Failed to save: "+c[x].domain);return}A||U||(h(""),O(""),B(""),q(!0),P(!1))},[u,c,U,z,_]);return t.useEffect(()=>{if(!D)return;const v=c.some(x=>x.isSelected),b=c.map((x,j)=>({domain:x.domain,iconUrl:`https://www.google.com/s2/favicons?sz=256&domain=${x.domain}`,id:j,isSelected:v?x.isSelected:x.name==T(),key:x.key,name:x.name}));async function A(){try{v||await l(T()),await n({...o,serp:{...o.serp,realtimeSearchPlatforms:[b.reduce((x,j)=>(x[j.name]={domain:j.domain,iconUrl:j.iconUrl,id:j.id,isSelected:j.isSelected,key:j.key,name:j.name},x),{})]}})}catch(x){console.error(x)}}A(),q(!1),K()},[D]),e.jsxs(xt,{children:[e.jsxs("div",{className:"relative flex h-[424px] w-full flex-col bg-transparent",children:[e.jsxs("div",{className:"ml-1 flex justify-between font-serif",children:[e.jsx("p",{className:"text-2xl",children:i("serp_index.advance_searches")}),e.jsx("button",{type:"button",onClick:K,children:e.jsx(Xe,{className:"h-4 w-4"})})]}),e.jsxs(V.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.4,ease:"easeInOut"},children:[e.jsxs("div",{className:"my-4 mr-2 flex items-center gap-2",children:[e.jsx("img",{src:c[0].iconUrl,alt:c[0].name,className:"h-5 w-5 rounded-sm"}),e.jsxs("div",{className:"bg-background border-muted flex items-center rounded-md border px-2",children:[e.jsx(We,{className:"text-muted-foreground my-auto mr-1 h-4 w-4"}),e.jsx(be,{value:c[0].domain,disabled:!0,className:"border-0 py-1"})]}),e.jsxs("div",{className:"bg-background border-muted flex items-center rounded-md border px-2",children:[e.jsx(ot,{className:"text-muted-foreground my-auto mr-1 h-4 w-4"}),e.jsx(be,{value:c[0].key,disabled:!0,className:"border-0 py-1"})]})]}),e.jsx("hr",{}),c.slice(1).map((v,b)=>e.jsxs("div",{className:"my-4 mr-2 flex items-center gap-2",children:[e.jsx("img",{src:v.iconUrl,alt:v.name,className:"h-4 w-4 rounded-sm"}),e.jsxs("div",{className:"bg-background border-muted flex items-center rounded-md border px-2",children:[e.jsx(We,{className:"text-muted-foreground my-auto mr-1 h-4 w-4"}),e.jsx(be,{value:v.domain,placeholder:"example.com",onChange:A=>N(v.id,"domain",A.target.value),className:"border-0 py-1"})]}),e.jsxs("div",{className:"bg-background border-muted group relative flex items-center rounded-md border px-2",children:[e.jsx(ot,{className:"text-muted-foreground my-auto mr-1 h-4 w-4"}),e.jsx(be,{value:v.key,placeholder:"e",disabled:["bing","yahoo"].includes(T()),onChange:A=>N(v.id,"key",A.target.value),className:"border-0 py-1"}),["bing","yahoo"].includes(T())&&e.jsx("div",{className:"invisible group-hover:visible",children:e.jsx(Ee,{text:i("serp_index.shortcut_key_disabled")})})]}),e.jsx("button",{type:"button",onClick:()=>{m(v.id)},children:e.jsx(Ns,{className:"h-5 w-5"})})]},b))]}),e.jsx("span",{className:$("text-center text-sm",U!==""||z!==""||_!==""?"text-red-600":"text-muted-foreground"),children:U!==""||z!==""||_!==""?U||z||_:i("serp_index.add_platform_info")}),e.jsxs("div",{className:"my-4 flex items-center justify-center gap-2",children:[e.jsxs("div",{className:"group relative",children:[e.jsx(Q,{onClick:G,size:"sm",disabled:c.length>=5,children:e.jsx(xe,{children:i("serp_index.add_more")})}),c.length>=5&&e.jsx("div",{className:"invisible group-hover:visible",children:e.jsx(Ee,{text:i("serp_index.add_platform_info")})})]}),e.jsx("button",{type:"button",onClick:()=>{L({eventData:{links:c},eventName:"SaveNewSourceRealtimeSettings",eventType:"Button",feature:"SUPER SERP",firedFromFile:"src/features/serp/settings.tsx"}),F()},disabled:!C,className:$(ft({size:"sm",variant:"outline"}),"bg-muted text-muted-foreground hover:bg-muted/60"),children:e.jsx(xe,{children:i("serp_index.save_changes")})})]})]}),u.isAuthenticated&&u.usageDetails.type==="FREE"&&e.jsx(V.div,{initial:"hidden",animate:"visible",exit:"hidden",variants:$s,transition:{duration:.4,ease:"easeInOut"},className:"bg-background/80 absolute z-[200] h-full w-full items-center justify-center backdrop-blur-[2px]",children:e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(V.div,{className:"mx-auto w-[80%]",variants:Ks,initial:"hidden",animate:"visible",exit:"exit",children:e.jsxs("div",{className:"border-muted bg-background shadow-muted-foreground/15 relative mx-auto flex w-full flex-col items-center justify-center gap-4 rounded-md border p-4 shadow-xl",children:[e.jsx("button",{onClick:()=>{L({eventName:"CloseSubscribeCTARealtimeSettings",eventType:"Button",feature:"SUPER SERP",firedFromFile:"src/features/serp/settings.tsx"}),K()},className:"absolute right-1 top-1 flex items-center justify-center rounded-full p-1 transition-all",type:"button",children:e.jsx(Xe,{className:"stroke-primary h-4 w-4"})}),e.jsxs("div",{className:"mt-2 flex flex-col items-center justify-center",children:[e.jsx("h1",{className:"mb-2 text-center text-lg font-semibold",children:i("serp_index.upgrade_to_pro_title")}),e.jsx("p",{className:"text-md text-center",children:i("serp_index.upgrade_to_pro_benefits")}),e.jsx("div",{className:"mt-4",children:e.jsxs(Q,{size:"sm",variant:"default",onClick:()=>{L({eventName:"SubscribeCTARealtimeSettings",eventType:"Button",feature:"SUPER SERP",firedFromFile:"src/features/serp/settings.tsx"}),se(Te+"?from=super-serp-realtime-cta")},children:[e.jsx(Gs,{className:"mr-2 h-5 w-5"}),e.jsx(xe,{children:i("serp_index.go_pro")})]})})]})]})})})})]})};function Xs({UserSettings:r,newMount:o,shadowWrapper:l,update:p}){const{t:f}=ge(),[n,i]=t.useState(!1),[u,c]=t.useState(""),[E,C]=t.useState([]),[P,D]=t.useState(0),{merlinConfig:q}=t.useContext(ut),[z,O]=t.useState(null),[_,B]=t.useState(""),[U,h]=t.useState(!1),[K,G]=t.useState(!1),m=t.useRef(null),{...N}=t.useContext(Ye),{usageDetails:F}=N,v=t.useCallback(()=>{var s,a,d,w;return((a=(s=F==null?void 0:F.cappedFeatures)==null?void 0:s.realtimeSerp)==null?void 0:a.limit)-((w=(d=F==null?void 0:F.cappedFeatures)==null?void 0:d.realtimeSerp)==null?void 0:w.used)},[F]),{getFromBackground:b}=t.useContext(Ht),[A,x]=t.useState(!1),[j,Fe]=t.useState(!1),{currentMode:H,defaultResponse:le,realtimeResponse:me,setCurrentMode:ce}=Le(s=>({currentMode:s.currentMode,defaultResponse:s.defaultResponse,realtimeResponse:s.realtimeResponse,setCurrentMode:s.setCurrentMode})),fe=t.useRef(!1),{setDefaultAnswer:he,setDefaultRelatedQuestions:je,setRealtimeAnswer:W,setRealtimeMedias:re,setRealtimeRelatedQuestions:Ie,setRealtimeSources:ne}=Le(s=>({setDefaultAnswer:s.setDefaultAnswer,setDefaultRelatedQuestions:s.setDefaultRelatedQuestions,setRealtimeAnswer:s.setRealtimeAnswer,setRealtimeMedias:s.setRealtimeMedias,setRealtimeRelatedQuestions:s.setRealtimeRelatedQuestions,setRealtimeSources:s.setRealtimeSources})),{serpSSE:ae}=st(`${tt.DOMAIN}/serp?&customJWT=true&requestFrom=SEARCH_GPT`,"serpSSE",{method:"POST",onClose:()=>{ae.setStatus("success"),h(!1),G(!0)},onError:()=>{i(!0),h(!1),G(!0)},onMessage:s=>{var w,y,I;const a=JSON.parse(s.data),d=a.data.content;he(d),((w=a==null?void 0:a.data)==null?void 0:w.eventType)==="SYSTEM"&&a!=null&&a.data.hasOwnProperty("questions")&&(C((y=a==null?void 0:a.data)==null?void 0:y.questions),je((I=a==null?void 0:a.data)==null?void 0:I.questions))},onOpen:async s=>{s.ok&&s.headers.get("X-Request-Id")&&(O(s.headers.get("X-Request-Id")),h(!0),G(!1))}},!1),{serpSSE:X}=st(`${tt.DOMAIN}/serp/realtime?&customJWT=true&requestFrom=REALTIME_SEARCH_GPT`,"serpSSE",{method:"POST",onClose:()=>{X.setStatus("success"),h(!1),G(!0)},onError:s=>{s.type=="RATE_LIMITED"?Fe(!0):(i(!0),h(!1),G(!0))},onMessage:s=>{var a,d,w;try{const y=JSON.parse(s.data),I=y.data.content;W(I),((a=y==null?void 0:y.data)==null?void 0:a.eventType)==="SYSTEM"&&y!=null&&y.data.hasOwnProperty("questions")&&(C((d=y==null?void 0:y.data)==null?void 0:d.questions),Ie((w=y==null?void 0:y.data)==null?void 0:w.questions))}catch{}},onOpen:async s=>{s.ok&&s.headers.get("X-Request-Id")&&(O(s.headers.get("X-Request-Id")),h(!0),G(!1))}},!1),[ye,Pe]=t.useState(!1),[Be,Ce]=t.useState(!1),[He,g]=t.useState(!0),[M,Z]=t.useState(!1),[k,de]=t.useState(r.serp.realtimeSearchPlatforms[0]),[S,Ct]=t.useState([Us(k)]),[ee,we]=t.useState(Object.keys(k).reduce((s,a)=>(s[a]={answer:"",sources:[]},s),{})),De=()=>{let s;const{hostname:a}=window.location;let w=pt.getQueryData(["sharedUserSettings"]).language??"AUTO";if(a.includes("google"))s=Fs();else if(a.includes("bing"))s=Ps();else if(a.includes("yahoo"))s=Bs();else if(a.includes("yandex"))w==="AUTO"&&(w="RUSSIAN"),s=Hs();else if(a.includes("duckduckgo"))s=Ds();else if(a.includes("baidu"))w==="AUTO"&&(w="CHINESE_SIMPLIFIED"),s=Is();else return;return c(s),B(w),[s,w]},Se=t.useCallback(async s=>{if(le.answer.length>0)return;h(!0);const[a,d]=De();a&&ae.execute({forceFullResponse:!fe.current,language:d||"AUTO",query:a,showRelatedQuestions:!0})},[ae,fe]),Je=async()=>{let s;const{hostname:a}=window.location;if(a.includes("google")){const d=document.getElementById("rcnt"),w=d.querySelector("#rhs")!==null,y=d.querySelector('div.TzHB6b[role="complementary"]')!==null,I=window.location.search;if(/tbm=/.test(I)||/tbs=/.test(I)||/.com\/maps=/.test(I)||/.com\/travel=/.test(I))return;if(y)s=document.querySelector('div.TzHB6b[role="complementary"]'),s.children.length>0&&await new Promise(R=>setTimeout(R,100)),Z(!0);else if(w)d.querySelector('#rhs div[jsname="TlEBqd"]')!==null?s=document.querySelector('div[jsname="TlEBqd"]'):s=document.getElementById("rhs"),s.children.length>0&&await new Promise(R=>setTimeout(R,100));else{const R=document.createElement("div");R.setAttribute("class","TQc1id k5T88b"),window.getComputedStyle(d).display==="grid"&&R.setAttribute("style","grid-column: 15 / span 7"),R.setAttribute("jscontroller","cSX9Xe"),R.setAttribute("data-pws","1300"),R.setAttribute("data-spe","true"),R.setAttribute("jsaction","rcuQ6b:npT2md"),R.setAttribute("id","rhs"),R.setAttribute("jsdata","MdeVKb;_;A9HQIA"),R.setAttribute("role","complementary"),R.setAttribute("data-hveid","CAEQAA"),s=document.createElement("div"),s.setAttribute("jsname","TlEBqd"),s.setAttribute("jsmodel","HX2tLd"),s.setAttribute("class","kp-wholepage ss6qqb u7yw9 zLsiYe mnr-c kp-wholepage-osrp Jb0Zif EyBRub"),s.setAttribute("data-hveid","CC8QAA"),s.setAttribute("data-ved","2ahUKEwih3ef17v2GAxWeS2wGHY8hD8gQ8esCKAB6BAgvEAA"),R.appendChild(s),await new Promise(ue=>setTimeout(ue,100)),d.appendChild(R)}}else if(a.includes("bing"))document.getElementById("b_content").querySelector("#b_context")!==null&&(s=document.getElementById("b_context"),s.children.length>0&&await new Promise(y=>setTimeout(y,100)));else if(a.includes("yahoo"))document.getElementById("results").querySelector("#right")!==null&&(s=document.querySelector("#right"),s.children.length>0&&await new Promise(y=>setTimeout(y,100)));else if(a.includes("yandex"))document.querySelector(".main__content").querySelector("#search-result-aside")!==null&&(s=document.querySelector("#search-result-aside"),s.children.length>0&&await new Promise(y=>setTimeout(y,100)));else if(a.includes("duckduckgo")){let d;const w=await Me(".js-react-sidebar");w?(d=w,d.children.length>0&&await new Promise(I=>setTimeout(I,100))):(d=await Me(".react-results--sidebar"),d.children.length>0&&await new Promise(I=>setTimeout(I,100)));const y=document.getElementById("merlin-serp");d.prepend(y),y.hidden=!1}else if(a.includes("baidu")){let d="",w;new MutationObserver(I=>{const te=document.querySelector("div#_mask");if(w=document.querySelector("div#content_right.cr-offset"),location.href!=d&&te==null){d=location.href,(()=>{document.querySelector("div#wrapper_wrapper").querySelector("div#content_right.cr-offset")!==null&&(w=document.querySelector("div#content_right.cr-offset"))})();const ue=document.getElementById("merlin-serp");w.prepend(ue),ue.hidden=!1}}).observe(document.documentElement,{childList:!0,subtree:!0})}if(!a.includes("baidu")){const d=document.getElementById("merlin-serp");s.prepend(d),d.hidden=!1}};async function pe(s,a){L({eventData:"SERP Realtime Mode",eventName:s?"EnableFeature":"DisableFeature",eventType:"Button",feature:"SERP",firedFromFile:"features/serp"});try{if(F.type!=="FREE"&&await p({...r,serp:{...r.serp,realtime:s}}),!N.isAuthenticated||j||H==="REALTIME"&&ee[S[0]].answer.length>0)return;if(h(!0),x(s),a){ae.execute({forceFullResponse:!fe.current,language:_,query:u,showRelatedQuestions:!0});return}if(ae.close(),s){const d=T(),w=S.map(I=>k[I].domain),y=await Ae(u,w,b,d);if(N.isAuthenticated&&!j){const I=await Qe(b,u);re(I),X.execute({articles:y,language:_,query:u,showRelatedQuestions:!0}),ne(y.map(R=>({alt:R.from,imgLink:R.imgLink,title:R.title,url:R.url})));const te=await Ge(y,b,w,u);we(R=>({...R,[S[0]]:{...R[S[0]],sources:te}}))}}}catch{}}const qe=t.useCallback((s,a)=>{let d=!1;return s.isAuthenticated&&s.usageDetails.type==="FREE"&&v()<=0?[!0,!1].includes(a.serp.showQueryConsent)?a.serp.showQueryConsent?d=!0:d=!1:(p({...a,serp:{...a.serp,showQueryConsent:!0}}),d=!0):s.isAuthenticated&&s.usageDetails.type!=="FREE"&&a.serp.showQueryConsent&&(p({...a,serp:{...a.serp,showQueryConsent:!1}}),d=!1),d},[v,p]);t.useEffect(()=>{async function s(){try{v()<=0&&N.usageDetails.type==="FREE"&&([!0,!1].includes(r.serp.showQueryConsent)?await p({...r,serp:{...r.serp,queryExhausted:!0,realtime:!1}}):await p({...r,serp:{...r.serp,queryExhausted:!0,realtime:!1,showQueryConsent:!0}}),ce("DEFAULT"))}catch{}}s()},[]),t.useEffect(()=>{(async()=>{var a,d,w;const s=await Ve.get("UserSettings");Pe((a=s==null?void 0:s.serp)==null?void 0:a.showResponse),ce(s.serp.realtime?"REALTIME":"DEFAULT"),s.serp.realtime||Se(),N.isAuthenticated&&q.misc.serp.realtime&&v()>0&&(x((d=s==null?void 0:s.serp)==null?void 0:d.realtime),s.serp.realtime&&ce("REALTIME")),(w=s==null?void 0:s.serp)!=null&&w.showResponse&&H==="DEFAULT"&&Se()})()},[]),t.useEffect(()=>{(async()=>{try{P&&N.isAuthenticated&&(H==="REALTIME"?await pe(!0):await Se(!0),D(0))}catch{}})()},[P,N.isAuthenticated]),t.useEffect(()=>{if(o){let s=!1;document.addEventListener("DOMContentLoaded",async()=>{if(!s){Je();const[a,d]=De();s=!0;const w=await Ve.get("UserSettings"),y=T(),I=S.map(R=>k[R].domain),te=await Ae(a,I,b,y);if(N.isAuthenticated&&!j){const R=await Qe(b,a);re(R),w.serp.realtime&&X.execute({articles:te,language:d,query:a,showRelatedQuestions:!0}),ne(te.map(ie=>({alt:ie.from,imgLink:ie.imgLink,title:ie.title,url:ie.url})));const ue=await Ge(te,b,I,a);we(ie=>({...ie,[S[0]]:{...ie[S[0]],sources:ue}}))}}}),document.addEventListener("readystatechange",async a=>{if((a.target.readyState==="interactive"||a.target.readyState==="complete")&&!s){Je();const[d,w]=De();s=!0;const y=await Ve.get("UserSettings"),I=T();if(N.isAuthenticated&&!j){const te=S.map(oe=>k[oe].domain),R=await Ae(d,te,b,I),ue=await Qe(b,d);re(ue),y.serp.realtime&&!(v()<=0&&F.type==="FREE")&&X.execute({articles:R,language:w,query:d,showRelatedQuestions:!0}),ne(R.map(oe=>({alt:oe.from,imgLink:oe.imgLink,title:oe.title,url:oe.url})));const ie=await Ge(R,b,te,d);we(oe=>({...oe,[S[0]]:{...oe[S[0]],sources:ie}}))}}})}},[o]),t.useEffect(()=>{S.length===1&&(me.answer.length>0&&(me.answer=""),H==="DEFAULT"&&S[0]===T()&&le.answer.length===0&&!ae.loading?pe(!1,!0):H==="REALTIME"&&ee[S[0]].answer.length===0&&(qe(N,r)||pe(!0,!1)),S[0]!==T()&&H==="DEFAULT"&&(ee[S[0]].answer.length===0&&(qe(N,r)||pe(!0,!1)),ce("REALTIME")))},[S[0]]),t.useEffect(()=>{r&&r.serp&&r.serp.realtimeSearchPlatforms[0]&&de(r.serp.realtimeSearchPlatforms[0])},[r]),t.useEffect(()=>{H==="DEFAULT"&&(S[0]===T()&&le.answer.length===0&&u.trim()!==""?pe(!1,!0):Re(T()))},[H]),t.useEffect(()=>{me.answer.length>0&&we(s=>({...s,[S[0]]:{...s[S[0]],answer:me.answer}}))},[me.answer]),t.useEffect(()=>{(()=>{const a={};Object.keys(k).forEach(d=>{ee[d]?a[d]=ee[d]:a[d]={answer:"",sources:[]}}),we(a)})()},[k]),t.useEffect(()=>{const s=T();if(r&&Object.keys(k)[0]!==s){const a=Object.fromEntries(Object.entries(k).map(([d,w],y)=>[y===0?s:d,y===0?{domain:`${s}.com`,iconUrl:`https://www.google.com/s2/favicons?sz=256&domain=${s}.com`,id:0,isSelected:!0,key:s.toLowerCase()[0]==="y"?"s":s.toLowerCase()[0],name:s}:{...w}]));p({...r,serp:{...r.serp,realtimeSearchPlatforms:[a]}})}},[r]);const[wt,vt]=t.useState("");t.useEffect(()=>{if(["bing","yahoo"].includes(T()))return;function s(a){if(["input","textarea","merlin-component"].includes(a.target.localName)||a.ctrlKey||a.altKey||a.metaKey||a.shiftKey)return;T()!=="google"&&a.stopPropagation();const d=Object.fromEntries(Object.entries(k).map(([w,y])=>[y.key,{name:w}]));Object.keys(d).includes(a.key)&&!["streaming","pending","loading","retrying"].includes(X.status)&&!U&&(L({eventData:{newSelectedPlatform:d[a.key].name},eventName:"keyboardChangeSelectedRealtimeSourceSERP",eventType:"Button",feature:"SUPER SERP",firedFromFile:"src/features/serp/index.tsx"}),Re(d[a.key].name)),a.target.blur()}return document.addEventListener("keydown",s),l.shadowRoot.querySelector("#reactAppRoot").addEventListener("keydown",s),()=>{document.removeEventListener("keydown",s),l.shadowRoot.querySelector("#reactAppRoot").removeEventListener("keydown",s)}}),t.useEffect(()=>{vt(A?X.status||!n?"success":"error":ae.status||!n?"success":"error")},[A,X.status,ae.status,n]);async function Re(s){const a=Os(k,s);await p({...r,serp:{...r.serp,realtimeSearchPlatforms:[a]}}),Ct([s])}function bt(s){return ye?n?e.jsxs("div",{className:"flex min-h-[435px] w-full flex-col items-center justify-center bg-transparent",children:[e.jsx("div",{className:"my-2 -rotate-6 rounded-md bg-red-500",children:e.jsx(ks,{className:"text-background m-2 h-5 w-5"})}),e.jsx("span",{className:"text-lg font-semibold",children:f("serp_index.something_wrong")}),e.jsx("span",{className:"text-muted-foreground text-sm",children:f("serp_index.looks_like_something_got_missing")}),e.jsx("div",{className:"mt-4",children:e.jsx(Q,{variant:"secondary",onClick:()=>{L({eventName:"ReportErrorSERP",eventType:"Button",feature:"SUPER SERP",firedFromFile:"src/features/serp/index.tsx"}),se(Nt+"?from=super-serp-realtime-cta")},children:f("serp_index.report")})})]}):Be?e.jsx(Ws,{setShowSettings:Ce,setShowFollowup:g,UserSettings:r,update:p,changeSelectedPlatform:Re}):ye?e.jsx(zs,{setTriggerCompleteResponseAfterLogin:D,isLoading:U,queryTerms:u,requestIdHeader:z,realtimeLimitExceeded:j,fetchData:Se,selectedPlatforms:s,realtimeSearchPlatforms:k,followupInputRef:m,platformResponse:ee,UserSettings:r,update:p,shadowWrapper:l,setShowFollowup:g,isComplementaryPage:M,toggleRealtimeMode:pe}):null:null}return r?e.jsxs(e.Fragment,{children:[e.jsx(As,{queryTerms:u}),e.jsxs(V.div,{initial:{opacity:0,y:-10},animate:{opacity:1,transition:{duration:.3},y:0},className:$("border-muted w-full pb-4",!M&&T()!=="bing"?"border-l":"-ml-4 border-l-0"),children:[e.jsxs("div",{className:Ot("plain-text-color relative mb-4 ml-4 flex min-h-[28rem] w-full max-w-[600px] flex-col items-center justify-start rounded-lg bg-transparent transition-[min-height] duration-500"),children:[e.jsxs("div",{className:"flex w-full flex-col items-center justify-start pb-4 pt-1",children:[e.jsxs("p",{className:"text-muted-foreground my-2 min-w-fit self-start text-xs",children:[f("serp_index.search_within"),e.jsx("span",{className:"text-sm font-medium",children:S[0][0].toUpperCase()+S[0].slice(1)})]}),e.jsxs("div",{className:"h-18 flex w-fit flex-wrap justify-start gap-x-2.5 gap-y-2 self-start",children:[Object.keys(k).map(s=>e.jsxs("button",{type:"button",onClick:()=>{S.includes(s)||!["streaming","pending","loading","retrying"].includes(X.status)&&!U&&(Re(s),L({eventData:{context:H==="REALTIME"?ee[S[0]].answer:le.answer,currentMode:H,newSelectedPlatform:s},eventName:"ChangeRealtimeSourcePlatformSERP",eventType:"Tabs",feature:"SUPER SERP",firedFromFile:"src/features/serp/index.tsx"}))},className:$("border-muted group relative flex items-center justify-center rounded-md border px-3 py-1.5 shadow-sm",S.includes(s)?"bg-primary":"bg-background",["bing","yahoo"].includes(T())&&"gap-0"),children:[e.jsx("img",{src:k[s].iconUrl,alt:k[s].name,className:"rounded-sm "+(["google","bing"].includes(k[s].name)?"h-5 w-5":"h-4 w-4")}),!["bing","yahoo"].includes(T())&&e.jsx("kbd",{className:$("border-muted/80 bg-muted rounded-md border px-2 py-0.5 text-xs font-semibold",k[s].name==T()?"ml-1":"ml-2"),children:k[s].key}),e.jsx("div",{className:"invisible group-hover:visible",children:["bing","yahoo"].includes(T())?e.jsx(Ee,{text:f("serp_index.press_to_search_on")+k[s].name[0].toUpperCase()+k[s].name.slice(1)}):e.jsx(Ee,{text:f("serp_index.press")+k[s].key+f("serp_index.to_search_in")+k[s].name[0].toUpperCase()+k[s].name.slice(1)})})]},s)),e.jsxs("button",{type:"button",onClick:()=>{L({eventName:"AddNewSourceSERP",eventType:"Button",feature:"SUPER SERP",firedFromFile:"src/features/serp/index.tsx"}),Ce(!0),g(!1)},className:"bg-muted group relative rounded-md px-2.5 py-2",children:[e.jsx(Ss,{className:"text-muted-foreground h-4 w-4"}),e.jsx("div",{className:"invisible group-hover:visible",children:e.jsx(Ee,{text:f("serp_index.add_new_source")})})]})]})]}),bt(S),!U&&(H==="REALTIME"&&ee[S[0]].answer.length>0||H==="REALTIME"&&r.serp.showQueryConsent||H==="DEFAULT"&&le.answer.length>0||!N.isAuthenticated)&&e.jsxs(e.Fragment,{children:[wt==="success"&&He&&!(H==="REALTIME"&&r.serp.showQueryConsent)&&e.jsx(e.Fragment,{children:e.jsx(V.div,{initial:{opacity:0},animate:{opacity:1,transition:{duration:.3}},className:"w-full space-y-2 bg-transparent pb-2 pt-4 text-sm",children:e.jsxs("div",{className:"bg-background border-border flex items-center rounded-md border px-2 focus:ring-1",children:[e.jsx(Rs,{className:"text-muted-foreground my-auto mr-1 h-4 w-4"}),e.jsx(be,{ref:m,placeholder:`${["bing","yahoo"].includes(T())?f("serp_index.followup"):f("serp_index.ask_followup_cta")}`,className:"bg-background border-0 pl-0 shadow-none focus-visible:ring-0",onKeyDown:s=>{s.key=="a"&&s.stopPropagation(),s.key==="Enter"&&(window.parent.postMessage({data:{context:H==="REALTIME"?ee[S[0]].answer:le.answer,query:s.currentTarget.value},type:dt.SEARCH_GPT},"*"),L({eventData:{context:H==="REALTIME"?ee[S[0]].answer:le.answer,currentMode:H,query:s.currentTarget.value,selectedPlatform:S[0]},eventName:"AskAFollowupSERP",eventType:"Input",feature:"SUPER SERP",firedFromFile:"src/features/serp/index.tsx"}),s.currentTarget.value="")}})]})})}),e.jsx(Zs,{toggleRealtimeMode:pe,selectedPlatforms:S,platformResponse:ee,UserSettings:r,isShowQueryConsent:qe})]})]}),e.jsx("hr",{className:"-mr-4 ml-4"})]})]}):null}const Ys=async()=>{if(document.getElementById("merlin-serp"))return;const r=await Mt();if(r&&!r.misc.serp.visible)return;const o=document.createElement("merlin-component");o.id="merlin-serp",o.className="merlin serp";const l=o.attachShadow({mode:"open"}),p=document.createElement("style");p.textContent=`${ys}
  :host(#merlin-serp) {
  }
  .reactAppRoot {
    all: initial; /* 1st rule so subsequent properties are reset. */
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    position: relative;
    z-index: 1;
  }

  .dark {
    ${xs}
}
${gs}
  `;const f=document.createElement("div");f.id="reactAppRoot",f.className="reactAppRoot serp",kt.forEach(n=>{f.addEventListener(n,i=>{i.stopPropagation()})}),l.appendChild(p),l.appendChild(f),r.misc.serp.newMount?(o.hidden=!0,Lt(o),Oe(f).render(e.jsx(Ke,{newMount:r.misc.serp.newMount,shadowWrapper:o}))):document.onreadystatechange=async()=>{if(document.readyState==="interactive"){let n;const{hostname:i}=window.location;if(i.includes("google")){const u=document.getElementById("rcnt"),c=u.querySelector("#rhs")!==null,E=window.location.search;if(/tbm=/.test(E)||/tbs=/.test(E)||/.com\maps=/.test(E)||/.com\/travel=/.test(E))return;if(c)n=document.getElementById("rhs"),n.children.length>0&&await new Promise(P=>setTimeout(P,100));else{const P=u.querySelector("#center_col"),D=P.parentNode,q=Array.prototype.indexOf.call(D.children,P);n=document.createElement("div"),n.id="rhs",await new Promise(z=>setTimeout(z,100)),u.insertBefore(n,u.children[q+1])}}else if(i.includes("bing"))document.getElementById("b_content").querySelector("#b_context")!==null&&(n=document.getElementById("b_context"),n.children.length>0&&await new Promise(E=>setTimeout(E,100)));else if(i.includes("yahoo"))document.getElementById("results").querySelector("#right")!==null&&(n=document.querySelector("#right"),n.children.length>0&&await new Promise(E=>setTimeout(E,100)));else if(i.includes("yandex"))document.querySelector(".main__content").querySelector("#search-result-aside")!==null&&(n=document.querySelector("#search-result-aside"),n.children.length>0&&await new Promise(E=>setTimeout(E,100)));else if(i.includes("duckduckgo")){let u;const c=await Me(".js-react-sidebar");c?(u=c,u.children.length>0&&await new Promise(E=>setTimeout(E,100))):(u=await Me(".react-results--sidebar"),u.children.length>0&&await new Promise(E=>setTimeout(E,100)))}else if(i.includes("baidu")){let u="",c;new MutationObserver(C=>{const P=document.querySelector("div#_mask");c=document.querySelector("div#content_right.cr-offset"),location.href!=u&&P==null&&(u=location.href,document.querySelector("div#wrapper_wrapper").querySelector("div#content_right.cr-offset")!==null&&(c=document.querySelector("div#content_right.cr-offset")),c.prepend(o),Oe(f).render(e.jsx(Ke,{newMount:r.misc.serp.newMount,shadowWrapper:o})))}).observe(document.documentElement,{childList:!0,subtree:!0})}i.includes("baidu")||(n.prepend(o),Oe(f).render(e.jsx(Ke,{newMount:r.misc.serp.newMount,shadowWrapper:o})))}}};function Ke({newMount:r,shadowWrapper:o}){const[l=null,p]=At({instance:new _t({area:"local"}),key:"UserSettings"});return l&&l.serp.visible?e.jsx(Ft,{children:e.jsx(Dt,{isWebpage:!1,children:e.jsx(qt,{websiteOverride:!0,children:e.jsx(Bt,{children:e.jsx(Cs,{client:pt,persistOptions:{persister:Ut},children:e.jsx(Pt,{children:e.jsx(Xs,{newMount:r,UserSettings:l,update:p,shadowWrapper:o})})})})})})}):null}Ys();
