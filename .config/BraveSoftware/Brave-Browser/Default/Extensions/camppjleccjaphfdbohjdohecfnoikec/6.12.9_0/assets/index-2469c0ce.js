import{R as ie,r as s,j as e}from"./client-64cc3330.js";import{g as Xe,A as at,H as q,e as _t,q as ze,r as At,s as Mt,k as Lt,d as bt,U as xt,O as fe,S as h,P as Ke,F as Rt,b as Dt,c as Ot,E as Ft}from"./index-1a12ff06.js";import{L as Qe}from"./hook-90290a85.js";import{c as p}from"./index-a295f481.js";import{p as Ut}from"./purify.es-8e338605.js";import{Y as Bt,c as qe,r as lt,D as qt,F as Gt,G as ht,H as ct,f as gt,K as Vt,h as Wt,d as Se,C as Kt}from"./index-6400eb41.js";import{F as Ht}from"./index-876a044c.js";import{T as Xt}from"./index-eb167f60.js";import{b as vt}from"./index-5fbb8478.js";import{q as Qt}from"./backend-8962bc7f.js";import{a as yt,f as J,b as He}from"./analytics-4a9d4e40.js";import{u as Ne}from"./useAsyncWithPromise-a02bc426.js";import{u as Yt}from"./useSSE-a5deda20.js";import{a as $t,L as Jt,I as Zt,b as er}from"./languageLogoMap-4245085e.js";import{P as tr}from"./index-5f29b16d.js";import{F as rr}from"./foyerLogo-c0f0d78f.js";import{u as nr}from"./index-958f621a.js";import{u as sr}from"./useSharedUserSettings-15caf5a1.js";import{u as kt,I as Ge}from"./useOnClickOutside-6cd227e1.js";import{u as or}from"./useUserSettings-eb91a32a.js";import{f as Nt,i as be,I as jt,j as Te,g as wt,S as dt,a as ut,d as ir,c as ar,e as Ce,k as Ve,R as pt,h as lr,b as cr}from"./fuzzysort-6a5075ee.js";import{u as je}from"./useTranslation-b0b08d2e.js";import{I as Ye}from"./IconX-f6f2534f.js";import{I as Ae}from"./IconCheck-c9ab9461.js";import{v as St}from"./v4-4a60fe23.js";import{A as ae}from"./index-82863451.js";import{m as w}from"./motion-064cf623.js";import{c as dr}from"./createReactComponent-3abc0bad.js";import{a as mt,I as ur}from"./IconSend-7465868f.js";import{I as ft}from"./IconReload-76a665f0.js";import{I as pr}from"./IconExclamationCircle-954ba15b.js";import{I as _e}from"./IconChevronRight-3a7ad62a.js";import{I as mr}from"./IconLanguage-d550ce4a.js";import{I as fr}from"./IconSettings-b145c3ad.js";import{I as br}from"./IconBulb-01a33b5a.js";import{I as xr}from"./IconHeadset-4d4a643f.js";var hr=dr("octagon","IconOctagon",[["path",{d:"M12.802 2.165l5.575 2.389c.48 .206 .863 .589 1.07 1.07l2.388 5.574c.22 .512 .22 1.092 0 1.604l-2.389 5.575c-.206 .48 -.589 .863 -1.07 1.07l-5.574 2.388c-.512 .22 -1.092 .22 -1.604 0l-5.575 -2.389a2.036 2.036 0 0 1 -1.07 -1.07l-2.388 -5.574a2.036 2.036 0 0 1 0 -1.604l2.389 -5.575c.206 -.48 .589 -.863 1.07 -1.07l5.574 -2.388a2.036 2.036 0 0 1 1.604 0z",key:"svg-0"}]]);const We=(f,i)=>{const u=ie.useMemo(()=>new Xe({area:"local"}),[]),[l=null,r]=Qe({instance:u,key:i}),o=ie.useCallback(async b=>{await r({...l,[f]:b})},[f,r,l]);return ie.useMemo(()=>({[f]:{setSharedState:o,state:(l==null?void 0:l[f])||null}}),[f,o,l])};function gr(f){const[i,u]=s.useState(!1),l=s.useMemo(()=>new IntersectionObserver(([r])=>u(r.isIntersecting)),[f]);return s.useEffect(()=>(l.observe(f.current),()=>l.disconnect()),[]),i}function vr(f){var V;const{t:i}=je(),{...u}=ie.useContext(vt),[l,r]=ie.useState(!1),{host:o,setActiveWindow:b}=f,g=s.useRef(null),v=s.useRef(null),k=gr(g),y=s.useRef(null),M=s.useRef(null),Z=s.useRef(`dot-menu-portal-${St()}`);kt(M,()=>r(!1));const{sharedUserSettingsMutation:G,sharedUserSettingsQuery:H}=sr(),[le,T,ue]=or(),ee=Object.keys(ze),{tutorial:ce,updateTutorial:te}=nr(o);s.useEffect(()=>{var C;const c=(C=g.current)==null?void 0:C.getBoundingClientRect();ce&&(c!=null&&c.x)&&(c!=null&&c.y)&&k&&window.parent.postMessage({data:{action:at.OPEN_TUTORIAL,position:{x:c==null?void 0:c.x,y:c==null?void 0:c.y}},type:"TUTORIAL"},"*")},[ce,k]),s.useEffect(()=>{l&&yt({page_location:"components/fabStrip",page_title:"Dot Menu FabStrip"})},[l]);const re=c=>{if(ee.includes(c)){G.mutate({language:c});return}J({eventData:c,eventName:"SwitchLanguage",eventType:"Button",feature:"Dot Menu",firedFromFile:"features/chat/components/header"}),G.mutate({language:"AUTO"})},ne=()=>{J({eventName:"OpenOptionsPage",eventType:"Button",feature:q[o],firedFromFile:"components/fabStrip/dotMenu"}),qt.runtime.sendMessage({action:at.OPEN_OPTIONS_PAGE}),r(!1)};function L(){var c,C;return(c=H.data.apiKey)!=null&&c.enabled&&((C=H.data.apiKey)!=null&&C.value)?e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ge,{className:"res-icon-big fill-blue-400 text-blue-400"}),i("dotmenu.key")]}):u.usageDetails.type===Lt.PAID?e.jsx("div",{className:"flex items-center justify-center rounded-md border-2 border-amber-400 px-2 py-0.5 text-xs font-medium text-zinc-800 transition-colors duration-300 ease-in-out dark:border-amber-500 dark:text-zinc-100",children:e.jsx("span",{className:"whitespace-nowrap text-zinc-50",children:i("dotmenu.pro")})}):u.usageDetails.type&&lt(u.usageDetails.type)?e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ge,{className:"res-icon-big fill-blue-400 text-blue-400"}),i("dotmenu.work")]}):e.jsx("div",{onClick:()=>{J({eventName:"GoProButton",eventType:"Button",feature:q[o],firedFromFile:"components/fabStrip/dotMenu"}),qe(bt+"?from=go-pro-three-dot-menu-fabstrip")},className:"bg-btn-gradient flex cursor-pointer items-center justify-center rounded-md bg-right-bottom px-2 py-0.5 text-xs font-medium transition-all duration-500 [background-size:400%_400%] hover:bg-left-top",children:e.jsx("span",{className:"whitespace-nowrap text-zinc-50",children:i("dotmenu.go_pro")})})}return e.jsxs("div",{className:p({"relative flex items-center text-gray-800 dark:text-gray-200":!0}),ref:g,children:[e.jsx("button",{id:"three-dot-menu",type:"button",ref:v,onMouseDownCapture:c=>{l&&(c.preventDefault(),c.stopPropagation())},onClick:()=>{r(!l)},children:e.jsx($t,{})}),e.jsx(tr,{selector:{mountAsHtmlChild:!0},shouldMount:l,id:Z.current,className:"merlin dot-menu-fab-strip-portal",groupBy:"dot-menu-fab-strip-portal-group",websiteOverride:!0,children:e.jsx(ae,{children:e.jsxs(w.div,{ref:M,className:p("dark:bg-background my-2 flex h-fit w-48 flex-col rounded-lg border border-zinc-200 bg-zinc-100 text-sm shadow-lg dark:border-zinc-700 dark:text-zinc-100"),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{position:"fixed",...Bt(v,{height:200,width:200},10,!1)},children:[e.jsxs("div",{className:"flex w-full justify-between px-2 py-1",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-5 w-5 cursor-pointer",onClick:()=>{J({eventData:"Merlin Dashboard",eventName:"OpenPage",eventType:"Button",feature:q[o],firedFromFile:"components/fabStrip/dotMenu"}),qe(_t+"?from=go-pro-three-dot-menu-fabstrip"),r(!1)},children:e.jsx(rr,{})}),e.jsx("div",{children:i("merlin")})]}),e.jsx("div",{children:u.isAuthenticated&&e.jsx(e.Fragment,{children:L()})})]}),e.jsx("span",{className:p({"w-full border-b border-b-zinc-200 dark:border-b-zinc-800":!0})}),u.isAuthenticated&&e.jsx(e.Fragment,{children:!lt(u.usageDetails.type)&&!((V=H.data.apiKey)!=null&&V.enabled)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:p("flex w-full items-center justify-between px-2 py-0.5",{}),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"res-icon-big fill-amber-400 text-amber-400"}),u.usageDetails.limit-u.usageDetails.used]}),e.jsx("div",{children:i("dotmenu.queries_left")})]}),e.jsx("span",{className:p({"w-full border-b border-b-zinc-200 dark:border-b-zinc-800":!0})})]})}),e.jsxs("div",{ref:y,className:"language-dropdown group/language-dropdown relative flex w-full cursor-pointer items-center justify-between px-2 py-0.5 hover:bg-zinc-300 dark:hover:bg-zinc-800",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(mr,{className:"h-4 w-4 text-zinc-600 dark:text-zinc-300"}),i("dotmenu.lang")]}),e.jsx("div",{children:e.jsx(_e,{className:"h-4 w-4 text-zinc-600 dark:text-zinc-300"})}),e.jsx(ae,{children:e.jsx(w.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,transition:{delay:.1}},className:"c-hide group-hover/language-dropdown:c-show absolute right-[100%] top-0 h-fit w-48 flex-col overflow-hidden rounded-lg",children:e.jsx("div",{className:"merlinExt-custom-scrollbar scrollbar-w-1 dark:bg-background flex h-[121px] w-full scroll-m-1 flex-col gap-1 overflow-y-auto overflow-x-hidden scroll-smooth rounded border border-zinc-200 bg-zinc-100 text-sm text-zinc-700 dark:border-zinc-700 dark:text-zinc-100",children:ee.map((c,C)=>e.jsxs("div",{className:"flex cursor-pointer items-center justify-between px-2 py-0.5 text-sm hover:bg-zinc-200 hover:dark:bg-zinc-800",onClick:()=>re(c),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Jt,{language:c}),ze[c]]}),ze[H.data.language]==ze[c]&&e.jsx(Ae,{size:20,strokeWidth:4,color:"green"})]},C))})})})]}),e.jsxs(e.Fragment,{children:[e.jsxs("button",{type:"button",className:p("flex w-full cursor-pointer appearance-none items-center gap-2 px-2 py-0.5 hover:bg-zinc-300 dark:hover:bg-zinc-800"),onClick:()=>{b&&b(ge.SAVED_PROMPTS),r(!1)},children:[e.jsx(Nt,{className:p({"h-4 w-4 text-zinc-600 dark:text-zinc-300":!0})}),e.jsx("div",{children:i("dotmenu.all_prompts")})]}),e.jsx("span",{className:p({"w-full border-b border-b-zinc-200 dark:border-b-zinc-800":!0})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:p("group/disable relative flex w-full cursor-pointer items-center justify-between px-2 py-0.5 hover:bg-zinc-300 dark:hover:bg-zinc-800"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Zt,{className:p({"h-4 w-4 text-zinc-600 dark:text-zinc-300":!0})}),i("dotmenu.disable")]}),e.jsx("div",{children:e.jsx(_e,{className:p({"h-4 w-4 text-zinc-600 dark:text-zinc-300":!0})})}),e.jsx(ae,{children:e.jsx(w.div,{className:p("c-hide group-hover/disable:c-show dark:bg-background absolute right-[100%] top-0 flex h-fit w-48 flex-col overflow-hidden rounded-lg bg-zinc-100 text-sm text-zinc-800 dark:border dark:border-zinc-700 dark:text-zinc-200"),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsx("div",{className:p("flex w-full cursor-pointer items-center justify-between px-2 py-0.5 hover:bg-zinc-300 dark:hover:bg-zinc-800"),onClick:()=>{J({eventName:"DisableFeature",eventType:"Button",feature:q[o],firedFromFile:"components/fabStrip/dotMenu"}),T(o)},children:i("dotmenu.forever")})})})]}),e.jsxs("button",{type:"button",onClick:ne,className:p({"flex w-full cursor-pointer appearance-none items-center gap-2 px-2 py-0.5 transition-colors duration-300 ease-in-out hover:bg-zinc-300 dark:bg-inherit dark:hover:bg-zinc-800":!0}),children:[e.jsx("div",{children:e.jsx(fr,{className:p({"h-4 w-4 text-zinc-600 dark:text-zinc-300":!0})})}),e.jsx("p",{children:i("dotmenu.settings")})]}),e.jsxs("button",{type:"button",onClick:()=>{te(!0),r(!1)},className:p({"flex w-full cursor-pointer appearance-none items-center gap-2 px-2 py-0.5 transition-colors duration-300 ease-in-out hover:bg-zinc-300 dark:bg-inherit dark:hover:bg-zinc-800":!0}),children:[e.jsx("div",{children:e.jsx(br,{className:p({"h-4 w-4 text-zinc-600 dark:text-zinc-300":!0})})}),e.jsx("p",{children:i("dotmenu.tutorial")})]})]}),e.jsxs(e.Fragment,{children:[e.jsx("span",{className:p({"w-full border-b border-b-zinc-200 dark:border-b-zinc-800":!0})}),e.jsxs("div",{children:[e.jsxs("div",{className:p("flex w-full cursor-pointer items-center gap-2 px-2 py-0.5 hover:bg-zinc-300 dark:hover:bg-zinc-800"),onClick:()=>{J({eventData:"Product Wiki",eventName:"OpenPage",eventType:"Button",feature:q[o],firedFromFile:"components/fabStrip/dotMenu"}),window.open(At,"_blank"),r(!1)},children:[e.jsx(er,{className:p({"h-4 w-4 text-zinc-600 dark:text-zinc-300":!0})}),e.jsx("div",{children:i("dotmenu.product_wiki")})]}),e.jsxs("div",{className:p("pt-0,5 group/support relative flex w-full cursor-pointer items-center justify-between rounded-b-lg px-2 pb-1 hover:bg-zinc-300 dark:hover:bg-zinc-800"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xr,{className:p({"h-4 w-4 text-zinc-600 dark:text-zinc-300":!0})}),i("dotmenu.support")]}),e.jsx("div",{children:e.jsx(_e,{className:p({"h-4 w-4 text-zinc-600 dark:text-zinc-300":!0})})}),e.jsx(ae,{children:e.jsxs(w.div,{className:p("group-hover/support:c-show c-hide dark:bg-background absolute bottom-0 right-[100%] flex h-fit w-48 flex-col overflow-hidden rounded-lg bg-zinc-100 text-sm text-zinc-800 dark:border dark:border-zinc-700 dark:text-zinc-200"),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[e.jsx("a",{className:p("flex w-full cursor-pointer appearance-none items-center justify-between px-2 py-0.5 hover:bg-zinc-300 dark:hover:bg-zinc-800"),target:"_blank",onClick:()=>{J({eventData:"Mail Us",eventName:"OpenPage",eventType:"Button",feature:q[o],firedFromFile:"components/fabStrip/dotMenu"}),qe(u.usageDetails.type==="PAID"?"mailto:urgent-support@getmerlin.in":"mailto:support@getmerlin.in"),r(!1)},rel:"noreferrer",children:i("dotmenu.mail")}),e.jsx("div",{className:p("flex w-full cursor-pointer items-center justify-between px-2 py-0.5 hover:bg-zinc-300 dark:hover:bg-zinc-800"),onClick:()=>{J({eventData:"Feedback Page",eventName:"OpenPage",eventType:"Button",feature:q[o],firedFromFile:"components/fabStrip/dotMenu"}),window.open(Mt,"_blank"),r(!1)},children:i("dotmenu.feedback")})]})})]})]})]})]})})})]})}const $e=s.createContext(null),yr=({children:f,isWebpage:i=!1})=>{const[u,l]=s.useState([]),[r,o]=s.useState([]),[b,g]=s.useState({editPrompt:!1,id:null}),[v,k]=s.useState({activeUI:"",isCollapsed:!i,isVisible:i}),[y,M]=s.useState({activeUI:"",isCollapsed:!i,isVisible:!0});return e.jsx($e.Provider,{value:{editorState:b,isWebpage:i,leftUI:v,pinnedSavedPrompts:u,rightUI:y,setEditorState:g,setLeftUI:k,setPinnedSavedPrompts:l,setRightUI:M,setUserMadePromptTemplates:o,userMadePromptTemplates:r},children:f})};function kr(f){const{t:i}=je(),{changeActiveWindow:u,from:l="DEFAULT",host:r,promptsFor:o,setUserPromptsUpdated:b,userPrompt:g}=f,{editorState:v,isWebpage:k,setEditorState:y,setLeftUI:M,setUserMadePromptTemplates:Z,userMadePromptTemplates:G}=s.useContext($e),{addUserPromptTemplate:H}=Ne(Gt,"addUserPromptTemplate",!1),{editUserPromptTemplate:le}=Ne(ht,"editUserPromptTemplate",!1),[T,ue]=s.useState(""),[ee,ce]=s.useState(g?g.toString():""),te=s.useRef(null),re=s.useRef(null);function ne(){l==="FAB_STRIP"?u(""):M({activeUI:"",isCollapsed:!1,isVisible:!1})}function L(){l==="FAB_STRIP"?u("Saved Prompts"):M({activeUI:"Saved Prompts",isCollapsed:!1,isVisible:!0})}s.useEffect(()=>{if(r==="twitter"){try{te.current.addEventListener("click",be),re.current.addEventListener("click",be)}catch{}return()=>{try{te.current.removeEventListener("click",be),re.current.removeEventListener("click",be)}catch{}}}},[]),s.useEffect(()=>{if(v.editPrompt){const j=G.findIndex(I=>I.id===v.id);ue(G[j].promptName),ce(G[j].promptText)}return()=>{v.editPrompt&&y({editPrompt:!1,id:null})}},[]);const[V,c]=s.useState(!1),[C,se]=s.useState(!1),[X,D]=s.useState(!1);async function O(){const j=ct(o??"");try{const I=await H.execute({id:St(),promptName:T,promptTag:j,promptText:ee});I&&(Z(I.userMade),l==="FAB_STRIP"&&b(Q=>Q+1)),c(!1),D(!0),setTimeout(()=>{D(!1),L()},1e3)}catch{se(!0),c(!1),setTimeout(()=>{se(!1)},1e3)}}async function F(){var I;const j=ct(o??"");try{const Q=G.findIndex(me=>me.id===v.id),xe=(I=G[Q])==null?void 0:I.type;if(xe&&xe==="merlin"){O();return}const we={id:G[Q].id,promptName:T,promptTag:G[Q].promptTag??j,promptText:ee},he=await le.execute(we);he&&(Z(he.userMade),l==="FAB_STRIP"&&b(me=>me+1)),c(!1),D(!0),setTimeout(()=>{y({editPrompt:!1,id:null}),D(!1),L()},1e3)}catch{se(!0),c(!1),setTimeout(()=>{se(!1)},1e3)}}function pe(){return X?e.jsx("div",{className:"center-with-flex merlinExt-custom-scrollbar scrollbar-w-1 flex-1 overflow-y-auto overflow-x-hidden p-2",children:e.jsx("span",{className:"text-lg",children:v.editPrompt?i("prompt.edited"):i("prompt.added")})}):C?e.jsx("div",{className:"center-with-flex merlinExt-custom-scrollbar scrollbar-w-1 flex-1 overflow-y-auto overflow-x-hidden p-2",children:e.jsxs("span",{className:"text-lg",children:[i("fab_strip.failed_to_save"),"("]})}):V?e.jsx("div",{className:"center-with-flex merlinExt-custom-scrollbar scrollbar-w-1 flex-1 overflow-y-auto overflow-x-hidden p-2",children:e.jsx("span",{className:"merlinExt-circular-loader"})}):e.jsxs("form",{onSubmit:j=>{if(j.preventDefault(),T.trim().length===0||ee.trim().length===0)return!1;v.editPrompt?F():O(),c(!0)},className:"flex h-full flex-1 flex-col items-stretch justify-between gap-3",children:[e.jsxs("div",{className:"",children:[e.jsx("div",{className:"res-small-text mb-1 font-medium text-zinc-500",children:i("fab_strip.name")}),e.jsx("input",{ref:te,required:!0,type:"text",value:T,onChange:j=>ue(j.target.value),onInput:j=>{const I=j.target;I.checkValidity()&&I.value.trim().length===0?I.setCustomValidity("Please provide a prompt name"):I.setCustomValidity("")},placeholder:i("prompt.short_name"),autoFocus:!0,minLength:2,maxLength:40,className:"focus-visible:ring-cornblue-800 w-full rounded bg-zinc-100 p-3 outline-none dark:bg-zinc-800"})]}),e.jsxs("div",{className:"flex flex-1 flex-col items-stretch",children:[e.jsx("div",{className:"res-small-text mb-1 font-medium text-zinc-500",children:i("fab_strip.desc")}),e.jsx("textarea",{ref:re,required:!0,value:ee,onChange:j=>ce(j.target.value),onInput:j=>{const I=j.target;I.checkValidity()&&I.value.trim().length===0?I.setCustomValidity("Please provide a prompt description"):I.setCustomValidity("")},placeholder:i("prompt.eg"),minLength:2,maxLength:8e3,className:"focus-visible:ring-cornblue-800 box-border h-full w-full flex-1 resize-none rounded bg-zinc-100 p-3 outline-none dark:bg-zinc-800"})]}),e.jsx("div",{className:"flex items-center justify-center gap-2",children:e.jsxs("button",{type:"submit",id:"save",className:"c-transition-colors flex items-center justify-center gap-1 rounded-lg bg-transparent px-3 py-2 hover:bg-zinc-400 dark:hover:bg-zinc-800",children:[e.jsx(Ae,{className:"res-icon-small"}),e.jsx("span",{children:i("fab_strip.save")})]})})]})}return e.jsxs(e.Fragment,{children:[!k&&e.jsxs("div",{className:"font-inter flex items-stretch justify-between border-b border-b-zinc-800 px-3 py-2",children:[v.editPrompt&&e.jsx("button",{type:"button",onClick:()=>L(),children:e.jsx(jt,{className:"res-icon-big"})}),e.jsx("span",{className:"flex items-center gap-1",children:v.editPrompt?e.jsxs(e.Fragment,{children:[e.jsx(Te,{className:"res-icon-big"}),e.jsx("span",{className:"res-text-medium font-medium",children:i("fab_strip.edit_prompt")})]}):e.jsxs(e.Fragment,{children:[e.jsx(wt,{className:"res-icon-big"}),e.jsx("span",{className:"res-text-medium font-medium",children:i("fab_strip.save_prompt")})]})}),e.jsx("button",{type:"button",onClick:()=>ne(),children:e.jsx(Ye,{className:"res-icon-big"})})]}),e.jsx("div",{className:"res-small-text flex h-full flex-1 flex-col items-stretch bg-zinc-200 p-3 dark:bg-zinc-700",children:pe()})]})}function Nr(f){const{t:i}=je(),u=ie.useRef(null),{handleCustomPrompt:l,host:r="none",setActiveWindow:o,setValue:b,value:g}=f,v=k=>{k.stopPropagation(),k.preventDefault(),b(k.target.value)};return ie.useEffect(()=>{u.current.style.height="auto",u.current.style.height=`${Math.min(u.current.scrollHeight+2,80)}px`},[g]),ie.useEffect(()=>{try{setTimeout(()=>{u.current.focus()},100)}catch{}},[]),ie.useEffect(()=>{if(r==="twitter"){const k=u.current;try{k.addEventListener("click",be)}catch{}return()=>{try{k.removeEventListener("click",be)}catch{}}}},[]),e.jsxs("div",{className:"center-with-flex border-cornblue-500 dark:border-cornblue-400 relative flex w-full appearance-none items-center justify-between gap-1 overflow-hidden truncate whitespace-nowrap rounded-2xl  border  px-2 py-[5.5px] text-sm text-zinc-700 outline-none transition-[colors,box-shadow] duration-300 placeholder:text-zinc-400 dark:text-zinc-200 dark:placeholder:text-zinc-400 ",children:[e.jsx("textarea",{value:g,ref:u,onChange:v,rows:1,style:{overflow:"auto",resize:"none",width:"100%"},className:"h-full resize-none border-none bg-inherit text-inherit outline-none placeholder:max-w-[90%] placeholder:truncate ",placeholder:i("fab_strip.personalized"),onKeyDown:k=>{k.shiftKey&&k.key==="Enter"||k.key==="Enter"&&(He({feature:q[r],firedFromFile:"components/fabStrip",prompt_text:g,prompt_type:"Custom"}),l(g),k.stopPropagation())}}),r!=="facebook"&&e.jsx(wt,{onClick:()=>{o(ge.SAVE_PROMPT)},className:"text-cornblue-500 dark:text-cornblue-200 h-5 w-5 cursor-pointer"})]})}const It=f=>{var o;const[i=xt,u]=Qe({instance:new Xe({area:"local"}),key:"UserSettings"});return{model:(o=i.merlinOnSocialMedia[f])==null?void 0:o.prefferedModel,updateModel:b=>{u({...i,merlinOnSocialMedia:{...i.merlinOnSocialMedia,[f]:{...i.merlinOnSocialMedia[f],prefferedModel:b}}})}}};function jr(f){const{host:i,isTwitterModal:u=!1,mountOn:l="NONE",promptsFor:r,value:o}=f,[b,g]=s.useState(!1),{updateModel:v}=It(i),k=s.useRef(null);return kt(k,ie.useCallback(()=>g(!1),[])),e.jsxs("div",{className:p({"relative flex items-center text-gray-800 dark:text-gray-200":!0}),ref:k,children:[e.jsxs("button",{className:"ml-2 rounded-full border border-gray-300 p-2 hover:bg-gray-100 dark:border-gray-700 dark:hover:bg-gray-800",type:"button",onClick:()=>{g(!b)},children:[(o==null?void 0:o.name)===fe.GPT_4.name&&e.jsx(dt,{className:"h-4 w-4"}),(o==null?void 0:o.name)===fe.GPT_3.name&&e.jsx(ut,{className:"h-4 w-4"})]}),e.jsx(ae,{children:b&&e.jsxs(w.div,{className:p("absolute bottom-[45px] right-2 flex h-fit w-32 flex-col rounded-lg bg-zinc-200 text-sm shadow-lg dark:border dark:border-zinc-700 dark:bg-zinc-700",{"bottom-[4px] right-8":u||l===h.FACEBOOK.PERSONAL.POST,"top-[120%]":r===Ke.TWEET&&!u}),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[e.jsx("div",{onClick:()=>{v(fe.GPT_3),g(!b)},className:"w-full cursor-pointer justify-between rounded-t-lg px-2 py-1 hover:bg-zinc-300 dark:hover:bg-zinc-800",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex flex-1 items-center",children:[e.jsx("span",{className:"mr-2",children:e.jsx(ut,{className:"h-4 w-4"})}),fe.GPT_3.name]}),(o==null?void 0:o.name)===fe.GPT_3.name&&e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(Ae,{className:"h-4 w-4"})})]})}),e.jsx("span",{className:p({"w-full border-b border-b-zinc-200 dark:border-b-zinc-800":!0})}),e.jsx("div",{onClick:()=>{v(fe.GPT_4),g(!b)},className:"w-full cursor-pointer justify-between rounded-b-lg px-2 py-1 hover:bg-zinc-300 dark:hover:bg-zinc-800",children:e.jsxs("div",{className:"flex  gap-2",children:[e.jsxs("div",{className:"flex flex-1 items-center",children:[e.jsx("span",{className:"mr-2",children:e.jsx(dt,{className:"h-4 w-4"})}),fe.GPT_4.name]}),(o==null?void 0:o.name)===fe.GPT_4.name&&e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(Ae,{className:"h-4 w-4"})})]})})]})})]})}function wr(f){const{t:i}=je(),{changeActiveWindow:u,from:l="DEFAULT",host:r,merlinPrompts:o,setUserPromptsUpdated:b,updateUserPrompt:g}=f,[v,k]=s.useState(""),{getUserPromptTemplates:y}=Ne(gt,"getUserPromptTemplates",!1),{deleteUserPromptTemplate:M}=Ne(Vt,"deleteUserPromptTemplate",!1),{editUserPromptTemplate:Z}=Ne(ht,"editUserPromptTemplate",!1),{isWebpage:G,setEditorState:H,setLeftUI:le,setPinnedSavedPrompts:T,setUserMadePromptTemplates:ue,userMadePromptTemplates:ee}=s.useContext($e),[ce,te]=s.useState(!0),[re,ne]=s.useState(!1),[L,V]=s.useState(ee),[c,C]=s.useState([]),[se,X]=s.useState(!1),D=s.useRef(null),O=s.useRef(c),F=s.useRef(c);s.useEffect(()=>{if(r==="twitter"){try{D.current.addEventListener("click",be)}catch{}return()=>{try{D.current.removeEventListener("click",be)}catch{}}}},[]),s.useEffect(()=>{(async()=>{var _,E;const n=await y.execute();if(n){if(n!=null&&n.userMade){if(ne(!1),n.pinnedPromptIds){const R=(E=(_=n.pinnedPromptIds)==null?void 0:_.map(oe=>n.userMade.find(Pe=>Pe.id===oe)))==null?void 0:E.filter(Boolean);C(R||[])}const N=o.map((R,oe)=>({id:(n==null?void 0:n.userMade.length)+oe,promptName:R.name,promptText:R.content,type:"merlin"})),x=[...n.userMade,...N],B=x.filter(R=>{var oe;return!((oe=n.pinnedPromptIds)!=null&&oe.includes(R.id))});V(B),ue(x),T((n==null?void 0:n.pinnedPromptIds)||[]),l==="FAB_STRIP"&&b(R=>R+1)}else ne(!0),V("It seems like you don't have any saved prompts.");te(!1);return}ne(!0),V("Failed to get user saved prompts."),te(!1)})()},[]);function pe(n){I(),H({editPrompt:!0,id:n})}function j(){l==="FAB_STRIP"?u(""):le({activeUI:"",isCollapsed:!1,isVisible:!1})}function I(){l==="FAB_STRIP"?u("Edit your prompt"):le({activeUI:"Edit your prompt",isCollapsed:!1,isVisible:!0})}async function Q(n){const _=c.filter(x=>x.id!==n);C(_);const E=L.filter(x=>x.id!==n);V(E);const N=await M.execute({id:n});if(N){const x=o.map((R,oe)=>({id:(N==null?void 0:N.userMade.length)+oe,promptName:R.name,promptText:R.content,type:"merlin"})),B=[...N.userMade,...x];ue(B),T((N==null?void 0:N.pinnedPromptIds)||[]),l==="FAB_STRIP"&&b(R=>R+1)}}const xe=async n=>{try{C(x=>[...x,n]),V(x=>x.filter(B=>B.id!==n.id));const _=c.map(x=>x.id);_.push(n.id);const E={pinnedPromptIds:_},N=await Z.execute(E);N!=null&&N.pinnedPromptIds&&T((N==null?void 0:N.pinnedPromptIds)||[])}catch{ne(!0),te(!1),setTimeout(()=>{ne(!1)},1e3)}},we=async n=>{try{C(B=>B.filter(R=>R.id!==n.id)),V(B=>[n,...B]);const N={pinnedPromptIds:c.filter(B=>B.id!==n.id).map(B=>B.id)},x=await Z.execute(N);x!=null&&x.pinnedPromptIds&&T((x==null?void 0:x.pinnedPromptIds)||[])}catch{ne(!0),te(!1),setTimeout(()=>{ne(!1)},1e3)}},he=async n=>{C(n),O.current=n},me=async n=>{const _={pinnedPromptIds:n},E=await Z.execute(_);E!=null&&E.pinnedPromptIds&&T((E==null?void 0:E.pinnedPromptIds)||[])};function Me(n,_){const E=[];return lr.go(n,_,{keys:["promptName","promptText"],scoreFn:x=>Math.max(x[0]?x[0].score:-1e3,x[1]?x[1].score-100:-1e3)}).forEach(x=>E.push(x.obj)),E}const Ie=()=>{X(!0)},W=()=>{X(!1);const n=O.current.map(N=>N.id),_=F.current.map(N=>N.id);!n.every((N,x)=>N===_[x])&&(me(n),F.current=[...O.current])},ve=()=>c.map(n=>e.jsx(pt.Item,{value:n,onDragStart:Ie,onDragEnd:W,children:e.jsxs("div",{className:"font-hanken dark:bg-background group relative min-h-[90px] items-stretch overflow-hidden rounded-[4px] bg-zinc-50",children:[e.jsxs("div",{onClick:()=>{se||g(n.promptText,!0)},className:"z-10 flex w-[92%] cursor-pointer flex-col items-stretch gap-1 p-3 transition-[width] group-hover:w-[90%]",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("span",{className:"truncate text-ellipsis whitespace-nowrap font-semibold",children:[n.promptName,(n==null?void 0:n.type)==="merlin"?" (by merlin)":""]})}),e.jsx("div",{className:"line-clamp-2 text-ellipsis",children:n.promptText})]}),e.jsxs("div",{className:"absolute right-[5px] top-1/2 flex h-[90%] w-[10%] -translate-y-1/2 flex-col items-center justify-center gap-[3px]",children:[e.jsx("div",{className:"absolute left-0 top-0 h-full w-full translate-x-[116%] rounded-[4px] bg-zinc-200 p-2 transition-all group-hover:translate-x-0 dark:bg-zinc-700"}),e.jsxs("div",{className:"relative top-0 z-10 flex w-full translate-x-[116%] flex-col items-center justify-center gap-[3px] transition-all group-hover:translate-x-0",children:[e.jsx("button",{type:"button",className:"dark:hover:bg-background rounded-sm p-[2px] hover:bg-zinc-50",onClick:()=>pe(n.id),children:e.jsx(Te,{size:16,className:"res-icon-small"})}),e.jsx("button",{onClick:()=>Q(n.id),type:"button",className:"dark:hover:bg-background rounded-sm p-[2px] hover:bg-zinc-50",children:e.jsx(Ce,{size:16,className:"res-icon-small"})})]}),e.jsx("button",{className:"dark:hover:bg-background z-10 rounded-sm p-[2px] hover:bg-zinc-50",type:"button",onClick:()=>we(n),children:e.jsx(Ve,{size:16,className:"res-icon-small"})})]})]})},n.id));function Le(){return ce?e.jsx("div",{className:"center-with-flex flex-1",children:e.jsx("span",{className:"merlinExt-circular-loader"})}):re?e.jsx("div",{className:"center-with-flex flex-1",children:L}):L.length>0||c.length>0?v!==""?e.jsx(e.Fragment,{children:Me(v,[...L,...c]).map(n=>e.jsx(w.div,{children:e.jsxs("div",{className:"font-hanken dark:bg-background group relative min-h-[90px] items-stretch overflow-hidden rounded-[4px] bg-zinc-50",children:[e.jsxs("div",{onClick:()=>{g(n.promptText,!0)},className:"flex w-full cursor-pointer flex-col items-stretch gap-1 p-3 transition-[width] group-hover:w-[90%]",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("span",{className:"truncate text-ellipsis whitespace-nowrap font-semibold",children:[n.promptName,(n==null?void 0:n.type)==="merlin"?" (by merlin)":""]})}),e.jsx("div",{className:"line-clamp-2 text-ellipsis",children:n.promptText})]}),e.jsxs("div",{className:"absolute right-[5px] top-1/2 flex h-[90%] w-[10%] -translate-y-1/2 translate-x-[116%] flex-col items-center justify-center gap-[3px] rounded-[4px] bg-zinc-200 p-2 transition-all group-hover:-translate-y-1/2 group-hover:translate-x-0 dark:bg-zinc-700",children:[e.jsx("button",{type:"button",className:"dark:hover:bg-background rounded-sm p-[2px] hover:bg-zinc-50",onClick:()=>pe(n.id),children:e.jsx(Te,{size:16,className:"res-icon-small"})}),e.jsx("button",{onClick:()=>Q(n.id),type:"button",className:"dark:hover:bg-background rounded-sm p-[2px] hover:bg-zinc-50",children:e.jsx(Ce,{size:16,className:"res-icon-small"})}),e.jsx("button",{className:"dark:hover:bg-background rounded-sm p-[2px] hover:bg-zinc-50",type:"button",onClick:()=>xe(n),children:e.jsx(Ve,{size:16,className:"res-icon-small"})})]})]})},n.id))}):e.jsxs(e.Fragment,{children:[c.length>0&&e.jsx("div",{style:{overflow:L.length>0?"hidden":"initial"},className:"table overflow-hidden",children:e.jsx(pt.Group,{axis:"y",values:c,onReorder:he,className:"flex flex-col gap-2",children:ve()})}),c.length>0&&L.length>0&&e.jsx(w.div,{className:"relative w-full py-1",children:e.jsx("div",{className:"dark:bg-background absolute left-0 top-1/2 h-[2px] w-full -translate-y-1/2 bg-zinc-300"})}),e.jsx("div",{className:"flex flex-col gap-2",children:L.map(n=>e.jsx(w.div,{layoutId:n.id,children:e.jsxs("div",{className:"font-hanken dark:bg-background group relative min-h-[90px] items-stretch overflow-hidden rounded-[4px] bg-zinc-50",children:[e.jsxs("div",{onClick:()=>{g(n.promptText,!0)},className:"flex w-full cursor-pointer flex-col items-stretch gap-1 p-3 transition-[width] group-hover:w-[90%]",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("span",{className:"truncate text-ellipsis whitespace-nowrap font-semibold",children:[n.promptName,(n==null?void 0:n.type)==="merlin"?" (by merlin)":""]})}),e.jsx("div",{className:"line-clamp-2 text-ellipsis",children:n.promptText})]}),e.jsxs("div",{className:"absolute right-[5px] top-1/2 flex h-[90%] w-[10%] -translate-y-1/2 translate-x-[116%] flex-col items-center justify-center gap-[3px] rounded-[4px] bg-zinc-200 p-2 transition-all group-hover:-translate-y-1/2 group-hover:translate-x-0 dark:bg-zinc-700",children:[e.jsx("button",{type:"button",className:"dark:hover:bg-background rounded-sm p-[2px] hover:bg-zinc-50",onClick:()=>pe(n.id),children:e.jsx(Te,{size:16,className:"res-icon-small"})}),e.jsx("button",{onClick:()=>Q(n.id),type:"button",className:"dark:hover:bg-background rounded-sm p-[2px] hover:bg-zinc-50",children:e.jsx(Ce,{size:16,className:"res-icon-small"})}),e.jsx("button",{className:"dark:hover:bg-background rounded-sm p-[2px] hover:bg-zinc-50",type:"button",onClick:()=>xe(n),children:e.jsx(Ve,{size:16,className:"res-icon-small"})})]})]})},n.id))})]}):e.jsxs("div",{className:"center-with-flex flex-1 flex-col",children:[e.jsxs("div",{children:[i("fab_strip.no_prev_prompt"),"("]}),e.jsx("div",{className:"mb-4",children:i("fab_strip.add_new_prompt")})]})}return e.jsxs(e.Fragment,{children:[!G&&e.jsxs("div",{className:"font-inter flex items-stretch justify-between border-b border-b-zinc-200 px-3 py-2 dark:border-b-zinc-800",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Nt,{className:"res-icon-big"}),e.jsx("span",{className:"res-text-medium font-medium",children:i("fab_strip.saved_prompt")})]}),e.jsx("button",{type:"button",onClick:()=>j(),children:e.jsx(Ye,{className:"res-icon-big"})})]}),e.jsxs("div",{className:"font-inter flex items-center justify-between gap-1 px-3 dark:bg-zinc-800",children:[e.jsx(ir,{className:"res-icon-big"}),e.jsx("input",{ref:D,type:"text",value:v,autoFocus:!0,onChange:n=>k(n.target.value),className:"w-full flex-1 bg-transparent p-2 focus-visible:outline-none dark:bg-zinc-800",placeholder:i("prompt.search_prompt")})]}),e.jsx("div",{className:"res-small-text merlinExt-custom-scrollbar scrollbar-w-1 flex h-full flex-col gap-2 overflow-y-auto bg-zinc-200 p-2 dark:bg-zinc-700",children:e.jsx(ae,{children:Le()})}),e.jsx("div",{className:"font-inter flex items-center justify-center rounded-b-lg px-3 py-1 dark:bg-zinc-800",children:e.jsxs("button",{type:"button",className:"c-transition-colors flex items-center justify-center gap-1 self-center rounded-md bg-transparent px-2 py-2 hover:bg-zinc-400 dark:hover:bg-zinc-700",onClick:()=>I(),children:[e.jsx(ar,{className:"res-icon-small"}),e.jsx("div",{className:"text-sm",children:i("fab_strip.add_prompt")})]})})]})}function Sr({stopGenerating:f}){const{t:i}=je();return e.jsxs("button",{type:"button",className:"center-with-flex border-cornblue-500 text-cornblue-500 hover:border-cornblue-600 hover:bg-cornblue-100 focus-visible:ring-cornblue-400 active:border-cornblue-700 disabled:border-cornblue-200 dark:border-cornblue-400 dark:text-cornblue-200 dark:hover:bg-cornblue-300/50 dark:focus-visible:text-cornblue-300 dark:focus-visible:ring-cornblue-500 dark:active:bg-cornblue-300/30 dark:disabled:border-cornblue-800 relative gap-1 overflow-hidden truncate whitespace-nowrap rounded-full border px-2 py-1 text-sm font-semibold ring-0 transition-[background-color,box-shadow] duration-300 focus-visible:outline-none focus-visible:ring",onClick:()=>{J({eventName:"StopGeneratingButton",eventType:"Button",feature:"merlinOnSocialMedia",firedFromFile:"components/fabStrip"}),f()},children:[e.jsx(hr,{strokeWidth:0,size:"18px",fill:"red"}),i("fab_strip.stop_gen")]})}function Ir(f){const{handleStripBtn:i,host:u="NONE",id:l,prompt:r,promptsFor:o,setCustomPromptActive:b,setTextareaValue:g}=f;function v(k){b(!0),g(k)}return e.jsxs("div",{className:"border-cornblue-500 text-cornblue-500 hover:border-cornblue-600  active:border-cornblue-700 disabled:border-cornblue-200 disabled:text-cornblue-200 dark:border-cornblue-400 dark:text-cornblue-200 dark:active:text-cornblue-100 dark:disabled:border-cornblue-800 dark:disabled:text-cornblue-800  flex max-w-[180px] items-center text-ellipsis whitespace-nowrap rounded-full border text-sm font-semibold transition-colors duration-300 ease-in-out",children:[e.jsx("button",{type:"button",onClick:()=>{u!=="twitter"&&i(r)},onMouseDownCapture:()=>{u==="twitter"&&i(r)},className:p({"border-cornblue-500 hover:border-cornblue-600 hover:bg-cornblue-100 focus-visible:ring-cornblue-400 active:border-cornblue-700 disabled:border-cornblue-200 dark:border-cornblue-400 dark:hover:bg-cornblue-300/50 dark:focus-visible:text-cornblue-300 dark:focus-visible:ring-cornblue-500 dark:active:bg-cornblue-300/30 dark:disabled:border-cornblue-800 truncate rounded-l-full border-r px-2 py-1  ring-0 transition-[background-color,box-shadow] duration-300 focus-visible:outline-none focus-visible:ring":!0}),children:f.children}),e.jsx("button",{type:"button",onClick:()=>v(r),className:p({"hover:bg-cornblue-100 focus-visible:ring-cornblue-400 dark:hover:bg-cornblue-300/50 dark:focus-visible:text-cornblue-300 dark:focus-visible:ring-cornblue-500 dark:active:bg-cornblue-300/30 h-full rounded-r-full  p-1 ring-0 transition-[background-color,box-shadow] duration-300 focus-visible:outline-none focus-visible:ring":!0}),children:e.jsx(cr,{className:"res-icon-big"})})]})}const ge={NONE:"",SAVE_PROMPT:"Edit your prompt",SAVED_PROMPTS:"Saved Prompts"};function dn(f){var st,ot,it;const{t:i}=je(),{contextData:u,editor:l,host:r,mountOn:o,promptsFor:b,setTextareaValue:g,textareaValue:v,toggleStrip:k}=f,{...y}=s.useContext(vt),[M,Z]=s.useState(null),[G,H]=s.useState(!1),[le,T]=s.useState(!1),[ue,ee]=s.useState(null),[ce,te]=s.useState(null),{model:re,updateModel:ne}=It(r),[L,V]=s.useState(null),c=s.useRef(null),C=s.useRef([]),se=s.useRef(null),X=s.useRef(null),D=s.useRef(null),O=s.useRef(null),F=s.useRef(null),[pe,j]=s.useState("none"),[I,Q]=s.useState(!1),[xe,we]=s.useState(""),[he,me]=s.useState(!1),[Me,Ie]=s.useState(0),[W,ve]=s.useState("left"),[Le=xt,n]=Qe({instance:new Xe({area:"local"}),key:"UserSettings"}),[_,E]=s.useState(""),[N,x]=s.useState(""),[B,R]=s.useState(null);function oe(){if(F.current){const t=F.current.scrollLeft===0,a=Math.ceil(F.current.scrollLeft)>=F.current.scrollWidth-F.current.clientWidth;t&&ve("left"),a&&ve("right"),t&&a&&ve("both"),!a&&!t&&ve("none")}}function Pe(t){Object.values(ge).includes(t)?j(t):(console.error("Invalid window name passed to changeActiveWindow"),j(ge.NONE))}function Re(t,a=!0){a&&T(!0),g(t),we(t),j(ge.NONE)}function Je(){const{parentNode:t}=l,a=t.querySelector(".DraftEditor-root > .DraftEditor-editorContainer > .public-DraftEditor-content").querySelector(".public-DraftStyleDefault-block > span");se.current=a}function De(){var a,d,m,z;let t;o===h.LINKEDIN.COMMENT_REPLY||o===h.LINKEDIN.COMMENT?(d=(a=l.parentElement)==null?void 0:a.querySelector('div.ql-editor[contenteditable="true"][role="textbox"]'))!=null&&d.querySelector("p:last-child")?t=(z=(m=l.parentElement)==null?void 0:m.querySelector('div.ql-editor[contenteditable="true"][role="textbox"]'))==null?void 0:z.querySelector("p:last-child"):t=l.parentElement.querySelector('div.ql-editor[contenteditable="true"][role="textbox"]'):o===h.LINKEDIN.POST?t=l.closest(".share-box").querySelector(".ql-editor"):o===h.LINKEDIN.MESSAGE?t=l.parentNode.querySelector(".msg-form__contenteditable"):o===h.LINKEDIN.INVITE&&(t=l.parentNode.querySelector("textarea")),X.current=t}function Pt(){const t=l.parentElement.parentElement,a='div[contenteditable="true"][role="textbox"]',d='div[aria-autocomplete="list"][aria-expanded="false"][contenteditable="true"][role="combobox"]',m='textarea[aria-busy="false"][aria-disabled="false"][aria-invalid="true"]',z="textarea";let P;t.querySelector(a)&&(P=t.querySelector(a)),t.querySelector(d)&&(P=t.querySelector(d)),t.querySelector(m)&&(P=t.querySelector(m)),t.querySelector(z)&&(P=t.querySelector(z)),c.current=P}function Et(){const t=l.parentElement,a='[dir="ltr"][role="textbox"][contenteditable="true"]';if(t.querySelector(a)){const d=t.querySelector(a);se.current=d}}const{getUserPromptTemplates:zt}=Ne(gt,"getUserPromptTemplates",!1),{handleSSE:A}=Yt(`${Ot.DOMAIN}/generative/${r}?&customJWT=true&generativeVersion=1.1`,"handleSSE",{method:"POST",onError:t=>{Z(t)},onMessage:t=>{let d=JSON.parse(t.data).data.content;if(x(m=>m+d),r==="twitter"){Je();const m=se.current;d=d.replaceAll(`
`," "),new Promise(z=>setTimeout(()=>{Se(m,d),z(null)},0))}else if(r==="linkedin"){De();const m=X.current;o===h.LINKEDIN.INVITE?(m.focus(),m.value+=d):o===h.LINKEDIN.MESSAGE?Se(m,d):m.textContent+=d}else if(r==="facebook"){const m=c.current;if(o===h.FACEBOOK.BUSINESS.AD||o===h.FACEBOOK.BUSINESS.MESSAGE){m.focus(),m.value+=d;const z=new Event("input",{bubbles:!0});m.dispatchEvent(z)}else Se(m,d)}else if(r==="outlook")Se(se.current,d);else{O.current||(O.current=D.current),C.current.includes(O.current)||C.current.push(O.current),O.current.textContent+=d;const m=D.current.querySelector(".gmail_quote"),z=D.current.querySelector(".gmail_signature");if(d.includes(`
`)){const P=D.current.querySelector("br");P&&P.remove();const S=document.createElement("p"),de=D.current;if(z){const U=O.current;U.parentElement.insertBefore(S,U.nextSibling)}else if(m){const U=m.parentNode.childNodes,Be=Array.prototype.indexOf.call(U,m);de.insertBefore(S,de.childNodes[Be])}else de.appendChild(S);O.current=S}}},onOpen:async t=>{t.ok&&t.headers.get("X-Request-Id")&&R(t.headers.get("X-Request-Id")),o===h.LINKEDIN.MESSAGE&&Se(X.current,"")}});function Ze(t){const a=F.current,d=a.offsetWidth,m={left:-d+60,right:d-60};a.scrollBy(m[t],0),setTimeout(()=>{oe()},350)}async function et(){if(J({eventName:"ClearButton",eventType:"Button",feature:q[r],firedFromFile:"components/fabStrip"}),Z(null),g(""),r==="linkedin"){De();const t=X.current;o===h.LINKEDIN.MESSAGE?t.textContent="":o===h.LINKEDIN.INVITE?(t.value="",X.current.focus(),X.current.blur()):o===h.LINKEDIN.COMMENT_REPLY||o===h.LINKEDIN.COMMENT?t.closest('div.ql-editor[contenteditable="true"][role="textbox"]').innerHTML="":t.textContent="",A.setStatus("idle");return}if(r==="gmail"){C.current.forEach(t=>{t.textContent=""}),A.setStatus("idle");return}r==="outlook"&&(se.current.textContent="",A.setStatus("idle"))}function tt(){J({eventName:"GoBackButton",eventType:"Button",feature:q[r],firedFromFile:"components/fabStrip"}),A.setStatus("idle"),v&&T(!0)}function rt(){J({eventName:"RegenerateButton",eventType:"Button",feature:q[r],firedFromFile:"components/fabStrip"}),Z(null),A.reset(),et(),ye(ue)}async function ye(t,a=re==null?void 0:re.id){if(r==="twitter"&&Je(),r==="linkedin"){De();const P=X.current;try{P.textContent!==""&&(P.innerHTML+=`

`)}catch{}}if(r==="gmail"){let P=null;P=l.closest(".iN").querySelector('.editable[role="textbox"]'),D.current=P;const S=D.current;if(S==null?void 0:S.querySelector(".gmail_quote")){const U=document.createElement("div");S.insertBefore(U,S.childNodes[0]),O.current=U}else{const U=S.querySelector("div");O.current=U}}r==="facebook"&&Pt(),r==="outlook"&&Et(),ee(t);const d=Qt.getQueryData(["sharedUserSettings"]);let m=!1;typeof u=="object"?Object.values(u).filter(S=>!S).length>Object.values(u).length/2&&(m=!0):m=(u==null?void 0:u.length)===0;let z="";if(m){const P=Kt(),S=Ut.sanitize(P,{ADD_TAGS:["merlin-component"],FORBID_ATTR:["data-*"],FORBID_CONTENTS:["script"],FORBID_TAGS:["style","noscript","script","aside","code","pre","svg","img","iframe","video"],USE_PROFILES:{html:!0}}),de='<merlin-component data-artdeco-is-focused="true" class="merlin fabStrip" id="merlin-fabStrip"></merlin-component>',U=S.indexOf(de);if(U!==-1){const Be=Math.max(0,U-Math.floor(262144)),Ct=Math.min(S.length,U+de.length+Math.floor(512*1024/2));let Ee=S.slice(Be,Ct);for(;Ee.length>512*1024;)Ee=Ee.slice(0,512*1024);z=Ee}else z=S.slice(-1024*1024)}A.execute({context:u,language:d.language,modelId:a,mountOn:o,query:t,...z&&{sanitizedDomForContext:z.replaceAll(/\s\s+/g," ")}}),E(JSON.stringify({contextData:u,feature:o,mountOn:o,prompt:t})),He({feature:q[r],firedFromFile:"components/fabStrip",prompt_text:t,prompt_type:"Saved"})}function nt(t){t&&(ee(t),ye(t),T(!1),H(!1))}s.useEffect(()=>{if(r==="linkedin"){const{parentNode:t}=l,a=new MutationObserver(d=>{for(const m of d){const{parentNode:z}=l,P=z.querySelector(".comments-comment-box__form-container .comments-comment-box__form .comments-comment-box__submit-button");try{P&&P.addEventListener("click",()=>{tt()})}catch{}}});return a.observe(t,{attributes:!0,childList:!0,subtree:!0}),()=>{a.disconnect()}}oe()},[]),s.useEffect(()=>{if(r==="twitter"){const a=l.parentElement.closest('[aria-labelledby="modal-header"]');Q(!!a)}},[]),s.useEffect(()=>{if(r==="linkedin"&&o===h.LINKEDIN.INVITE&&A.status==="success")try{X.current.blur()}catch{}},[A.status]),s.useEffect(()=>{if(F.current){const t=F.current.offsetWidth;F.current.scrollWidth>t?me(!0):me(!1)}},[F.current,L]),s.useEffect(()=>{y.isAuthenticated&&!y.isLoading&&(async()=>{try{let t=await Wt(),a;Object.keys(t).includes(b)?(a=[...t[b]],t=t[b]):(a=[...t[Ke.FALLBACK]],t=t[Ke.FALLBACK]),te(a);const d=await zt.execute();d&&d!=null&&d.userMade&&d.userMade.forEach(m=>{const{id:z,promptName:P,promptTag:S,promptText:de}=m,U={content:de,id:z,name:P};S&&S===b?t.unshift(U):t.push(U)}),V(t)}catch{V(Rt)}})()},[y.isLoading,y.isAuthenticated,Me]);const Oe=s.useRef(null),Fe=s.useRef(null),Ue=ie.useRef(null);s.useEffect(()=>{if(r==="gmail"){let t=null;const a=l.closest(".h7.ie");if(a){const d=a.querySelector(".adn.ads");d&&(t=d.getAttribute("data-message-id"))}Fe.current=t;return}if(r==="facebook"){const t=document.querySelector('div[role="main"].x9f619.x1n2onr6.x1ja2u2z.x78zum5.x1iyjqo2.xs83m0k.xeuugli.xl56j7k.x1qjc9v5.xozqiw3.x1q0g3np.x1iplk16.x1xfsgkm.xqmdsaz.x1mtsufr.x1w9j1nh .x9f619.x1n2onr6.x1ja2u2z.x78zum5.xdt5ytf.x2lah0s.x193iq5w.xeuugli');t&&(Oe.current=t.getAttribute("data-message-id"));return}if(r==="linkedin"&&o===h.LINKEDIN.INVITE){const t=document.querySelector(".scaffold-layout__main");if(t){const a=t.querySelector(".pv-top-card");if(a){const d=a.getAttribute("data-member-id")||"linkedin";Ue.current=d}}}},[l]);const{[Oe.current]:Y}=We(Oe.current,"facebook"),{[Fe.current]:K}=We(Fe.current,"gmail"),{[Ue.current]:$}=We(Ue.current,"linkedin"),ke=s.useRef(!1);s.useEffect(()=>{var t;r==="gmail"&&!y.isLoading&&y.isAuthenticated&&!ke.current&&(K.state&&((t=K.state)==null?void 0:t.status)==="loading"&&(ke.current=!0),(async()=>{var a,d,m;K.state&&((a=K.state)==null?void 0:a.status)==="loading"&&await ye(K.state.prompt,(m=(d=K.state)==null?void 0:d.model)==null?void 0:m.id)})())},[(st=K.state)==null?void 0:st.status]),s.useEffect(()=>{var t;r==="facebook"&&!y.isLoading&&y.isAuthenticated&&!ke.current&&(Y.state&&((t=Y.state)==null?void 0:t.status)==="loading"&&(ke.current=!0),(async()=>{var a,d,m;Y.state&&((a=Y.state)==null?void 0:a.status)==="loading"&&await ye(Y.state.prompt,(m=(d=Y.state)==null?void 0:d.model)==null?void 0:m.id)})())},[(ot=Y.state)==null?void 0:ot.status]),s.useEffect(()=>{var t;r==="linkedin"&&o===h.LINKEDIN.INVITE&&!y.isLoading&&y.isAuthenticated&&!ke.current&&($.state&&((t=$.state)==null?void 0:t.status)==="loading"&&(ke.current=!0),(async()=>{var a,d,m;$.state&&((a=$.state)==null?void 0:a.status)==="loading"&&await ye($.state.prompt,(m=(d=$.state)==null?void 0:d.model)==null?void 0:m.id)})())},[(it=$.state)==null?void 0:it.status]),s.useEffect(()=>{(async()=>{var t;r==="gmail"&&K.state&&A.status==="success"&&K.state.status==="loading"&&(g((t=K.state)==null?void 0:t.prompt),await K.setSharedState({prompt:null,status:"idle"})),r==="facebook"&&Y.state&&A.status==="success"&&Y.state.status==="loading"&&await Y.setSharedState({prompt:null,status:"idle"}),r==="linkedin"&&o===h.LINKEDIN.INVITE&&$.state&&A.status==="success"&&$.state.status==="loading"&&await $.setSharedState({prompt:null,status:"idle"})})()},[A.status]),s.useEffect(()=>{y.isAuthenticated&&yt({page_location:"components/fabStrip",page_title:q[r]+" FabStrip"})},[y.isAuthenticated]),s.useEffect(()=>()=>{(async()=>(r==="gmail"&&K.state&&await K.setSharedState({prompt:null,status:"idle"}),r==="facebook"&&Y.state&&await Y.setSharedState({prompt:null,status:"idle"}),r==="linkedin"&&o===h.LINKEDIN.INVITE&&$.state&&await $.setSharedState({prompt:null,status:"idle"})))()},[]);function Tt(){return M&&M.type===Ft.RATE_LIMITED?e.jsx(w.span,{initial:{opacity:0},animate:{opacity:1,transition:{duration:.3}},children:e.jsxs("button",{type:"button",className:"center-with-flex border-cornblue-500 text-cornblue-500 hover:border-cornblue-600 hover:bg-cornblue-100 focus-visible:ring-cornblue-400 active:border-cornblue-700 disabled:border-cornblue-200 dark:border-cornblue-400 dark:text-cornblue-200 dark:hover:bg-cornblue-300/50 dark:focus-visible:text-cornblue-300 dark:focus-visible:ring-cornblue-500 dark:active:bg-cornblue-300/30 dark:disabled:border-cornblue-800 relative gap-1 overflow-hidden truncate whitespace-nowrap rounded-full border px-2 py-1 text-sm font-semibold ring-0 transition-[background-color,box-shadow] duration-300 focus-visible:outline-none focus-visible:ring",onClick:()=>window.open(bt+"?from=out-of-queries-fabstrip","_blank"),children:[i("fab_strip.out_of_queries")," ",e.jsx("span",{className:"underline",children:i("fab_strip.merlin_pro")})," ",i("fab_strip.for_more")]})}):A.status==="streaming"||A.loading?e.jsxs("span",{className:"flex items-center justify-end gap-2 py-1",children:[e.jsx(w.span,{initial:{opacity:0,y:-10},animate:{opacity:1,transition:{delay:.1,duration:.3},y:0},children:e.jsx(Sr,{stopGenerating:async()=>{A.close(),g(""),r==="gmail"&&await K.setSharedState({prompt:null,status:"idle"}),r==="facebook"&&await Y.setSharedState({prompt:null,status:"idle"}),r==="linkedin"&&o===h.LINKEDIN.INVITE&&await $.setSharedState({prompt:null,status:"idle"})}})}),e.jsx(w.span,{initial:{opacity:0,y:-10},animate:{opacity:1,transition:{delay:.2,duration:.3},y:0},children:e.jsxs("span",{children:[i("fab_strip.writing"),"..."]})})]},"loading"):A.status==="success"&&o!==h.LINKEDIN.MESSAGE&&r!=="twitter"&&r!=="facebook"?e.jsxs("span",{className:"text-cornblue-500 dark:text-cornblue-200 flex items-stretch justify-end gap-2 py-1 text-sm font-semibold",children:[e.jsx(w.span,{initial:{opacity:0},animate:{opacity:1,transition:{duration:.3}},children:e.jsxs("button",{type:"button",className:"center-with-flex border-cornblue-500 hover:border-cornblue-600 hover:bg-cornblue-100 focus-visible:ring-cornblue-400 active:border-cornblue-700 disabled:border-cornblue-200 dark:border-cornblue-400 dark:hover:bg-cornblue-300/50 dark:focus-visible:text-cornblue-300 dark:focus-visible:ring-cornblue-500 dark:active:bg-cornblue-300/30 dark:disabled:border-cornblue-800 relative gap-1 overflow-hidden truncate whitespace-nowrap rounded-full rounded-l-full border px-2 py-1 ring-0 transition-[background-color,box-shadow] duration-300 focus-visible:outline-none focus-visible:ring",onClick:()=>tt(),children:[o!==h.FACEBOOK.PERSONAL.MESSAGE&&e.jsx(mt,{size:20,strokeWidth:1.5}),i("fab_strip.go_back")]})}),e.jsx(w.span,{initial:{opacity:0},animate:{opacity:1,transition:{duration:.3}},children:e.jsxs("button",{type:"button",className:"center-with-flex border-cornblue-500 hover:border-cornblue-600 hover:bg-cornblue-100 focus-visible:ring-cornblue-400 active:border-cornblue-700 disabled:border-cornblue-200 dark:border-cornblue-400 dark:hover:bg-cornblue-300/50 dark:focus-visible:text-cornblue-300 dark:focus-visible:ring-cornblue-500 dark:active:bg-cornblue-300/30 dark:disabled:border-cornblue-800 relative gap-1 overflow-hidden truncate whitespace-nowrap rounded-full rounded-l-full border px-2 py-1 ring-0 transition-[background-color,box-shadow] duration-300 focus-visible:outline-none focus-visible:ring",onClick:()=>et(),children:[e.jsx(Ce,{size:20,strokeWidth:1.5}),i("fab_strip.clear")]})}),e.jsx(w.span,{initial:{opacity:0},animate:{opacity:1,transition:{duration:.3}},children:e.jsxs("button",{type:"button",className:"center-with-flex border-cornblue-500 hover:border-cornblue-600 hover:bg-cornblue-100 focus-visible:ring-cornblue-400 active:border-cornblue-700 disabled:border-cornblue-200 dark:border-cornblue-400 dark:hover:bg-cornblue-300/50 dark:focus-visible:text-cornblue-300 dark:focus-visible:ring-cornblue-500 dark:active:bg-cornblue-300/30 dark:disabled:border-cornblue-800 relative gap-1 overflow-hidden truncate whitespace-nowrap rounded-full rounded-l-full border px-2 py-1 ring-0 transition-[background-color,box-shadow] duration-300 focus-visible:outline-none focus-visible:ring",onClick:()=>rt(),children:[e.jsx(ft,{size:20,strokeWidth:1.5}),i("fab_strip.regen")]})})]},"success"):A.status==="error"||M?e.jsxs("span",{className:"flex items-stretch justify-end gap-2 py-1",children:[e.jsxs(w.span,{initial:{opacity:0,y:-10},animate:{opacity:1,transition:{delay:0*.1+.3,duration:.3},y:0},className:"group",children:[(M==null?void 0:M.message)&&e.jsxs("div",{className:"res-tiny-text absolute bottom-[120%] left-2/4 z-50 -mr-2 -mt-2 w-fit max-w-full -translate-x-2/4 font-medium opacity-0 transition-all duration-300 group-hover:opacity-100 group-hover:will-change-transform",children:[e.jsx("div",{className:"relative break-words rounded-lg bg-gray-100 px-2 py-1.5 text-center text-zinc-700 dark:bg-gray-800 dark:text-zinc-200",children:M.message}),e.jsx("div",{className:"absolute -bottom-1 left-1/2 -z-10 h-3 w-3 -translate-x-1/2 rotate-45 transform bg-gray-100 dark:bg-gray-800"})]}),e.jsxs("button",{type:"button",className:"center-with-flex relative cursor-default gap-1 overflow-hidden whitespace-nowrap rounded-full border-2 border-rose-500 bg-rose-100 px-2 py-1 text-sm text-rose-500 dark:border-rose-600 dark:bg-rose-900 dark:text-rose-100",children:[e.jsx(pr,{size:20,strokeWidth:1.5}),i("external_mount.something_wrong")]})]}),e.jsx(w.span,{initial:{opacity:0,y:-10},animate:{opacity:1,transition:{delay:1*.1+.3,duration:.3},y:0},children:e.jsxs("button",{type:"button",className:"center-with-flex border-cornblue-500 hover:border-cornblue-600 hover:bg-cornblue-100 focus-visible:ring-cornblue-400 active:border-cornblue-700 disabled:border-cornblue-200 dark:border-cornblue-400 dark:hover:bg-cornblue-300/50 dark:focus-visible:text-cornblue-300 dark:focus-visible:ring-cornblue-500 dark:active:bg-cornblue-300/30 dark:disabled:border-cornblue-800 relative gap-1 overflow-hidden truncate whitespace-nowrap rounded-full rounded-l-full border px-2 py-1 ring-0 transition-[colors,box-shadow] duration-300 focus-visible:outline-none focus-visible:ring",onClick:()=>rt(),children:[e.jsx(ft,{size:20,strokeWidth:1.5}),i("external_mount.retry")]})})]},"error"):L?le?e.jsxs(w.div,{className:"center-with-flex min-h-[33px] w-full gap-2",initial:{opacity:0,y:-10},animate:{opacity:1,transition:{delay:.4,duration:.3},y:0},children:[e.jsx(w.button,{initial:{opacity:0,y:-10},animate:{opacity:1,transition:{delay:.6,duration:.3},y:0},className:"appearance-none",onClick:()=>{T(!1),Re("",!1)},children:e.jsx(jt,{className:"text-cornblue-500 dark:text-cornblue-200 h-5 w-5"})}),e.jsx(Nr,{value:v,setValue:Re,setActiveWindow:j,host:r,handleCustomPrompt:nt}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(w.button,{initial:{opacity:0,y:-10},animate:{opacity:1,transition:{delay:.5,duration:.3},y:0},className:"appearance-none",onClick:()=>{He({feature:q[r],firedFromFile:"components/fabStrip",prompt_text:v,prompt_type:"Custom"}),nt(v)},children:e.jsx(ur,{className:"text-cornblue-500 dark:text-cornblue-200 h-5 w-5"})})})]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{children:e.jsx(w.button,{initial:{opacity:0,y:-10},animate:{opacity:1,transition:{delay:0*.1+.3,duration:.3},y:0},exit:{opacity:0,y:-10},onClick:()=>Ze("left"),disabled:W==="left"||W==="both",className:p("center-with-flex",W==="left"||W==="both"?"text-gray-500 focus-visible:outline-none":"text-cornblue-500 focus-visible:outline-cornblue-400 dark:text-cornblue-200 dark:focus-visible:text-cornblue-300 dark:focus-visible:outline-cornblue-500 rounded-full outline-none transition-[background-color,outline] duration-300 ease-in-out focus-visible:outline-2 focus-visible:outline-offset-0"),id:"leftBtn",children:e.jsx(mt,{size:20,className:p("rounded-full transition-colors duration-200 ease-in-out",W==="left"||W==="both"?"":"hover:bg-cornblue-100 dark:hover:bg-cornblue-300/50 bg-transparent")})})}),e.jsx("span",{ref:F,className:p({"merlinExt-custom-scrollbar scrollbar-h-1 flex snap-x scroll-px-0.5 items-stretch justify-between gap-2 overflow-x-auto scroll-smooth px-0.5 py-1":!0,"pr-1":!he}),children:L.map((t,a)=>e.jsx(w.span,{className:"snap-start",initial:{opacity:0,y:-10},animate:{opacity:1,transition:{delay:a*.1+.4,duration:.3},y:0},children:e.jsx(Ir,{id:a,prompt:t.content,promptsFor:b,handleStripBtn:ye,setTextareaValue:g,setCustomPromptActive:T,host:r,children:t.name})},a))}),e.jsx(ae,{children:he&&e.jsx(w.button,{initial:{opacity:0,y:-10},animate:{opacity:1,transition:{delay:4*.1+.3,duration:.3},y:0},exit:{opacity:0,y:-10},onClick:()=>Ze("right"),disabled:W==="right"||W==="both",className:p("center-with-flex",W==="right"||W==="both"?"text-gray-500 focus-visible:outline-none":"text-cornblue-500 focus-visible:outline-cornblue-400 dark:text-cornblue-200 dark:focus-visible:text-cornblue-300 dark:focus-visible:outline-cornblue-500 rounded-full outline-none transition-[background-color,outline] duration-300 ease-in-out focus-visible:outline-2 focus-visible:outline-offset-0"),id:"rightBtn",children:e.jsx(_e,{size:20,className:p("rounded-full transition-colors duration-200 ease-in-out",W==="right"||W==="both"?"":"hover:bg-cornblue-100 dark:hover:bg-cornblue-300/50 bg-transparent")})})}),e.jsxs("div",{className:"center-with-flex",children:[e.jsx(w.button,{initial:{opacity:0,y:-10},animate:{opacity:1,transition:{delay:5*.1+.3,duration:.3},y:0},exit:{opacity:0},className:p("center-with-flex border-cornblue-500 text-cornblue-500 hover:border-cornblue-600 hover:bg-cornblue-100 focus-visible:ring-cornblue-400 active:border-cornblue-700 disabled:border-cornblue-200 dark:border-cornblue-400 dark:text-cornblue-200 dark:hover:bg-cornblue-300/50 dark:focus-visible:text-cornblue-300 dark:focus-visible:ring-cornblue-500 dark:active:bg-cornblue-300/30 dark:disabled:border-cornblue-800 gap-1 rounded-full border px-2 py-1 text-sm font-semibold ring-0 transition-[background-color,box-shadow] duration-300 focus-visible:outline-none focus-visible:ring"),onMouseEnter:()=>{H(!0)},onMouseLeave:()=>{H(!1)},onMouseDownCapture:()=>{T(!0),H(!1)},children:i("external_mount.create")}),e.jsx(ae,{children:G&&e.jsx(Xt,{text:i("external_mount.create_prompt"),className:p("absolute -top-[34px] z-[99999] text-xs font-medium",r==="facebook"&&"right-[0px]",(o===h.GMAIL.GMAIL_COMPOSE||o===h.GMAIL.GMAIL_REPLY)&&"right-[50px]",o===h.GMAIL.GMAIL_EXTERNAL_MOUNT&&"right- left-[48%] w-fit")})})]})]}):e.jsx("span",{className:p({"flex items-stretch justify-end gap-2 py-1":!0}),children:e.jsx(w.span,{initial:{opacity:0,y:-10},animate:{opacity:1,transition:{delay:.3,duration:.3},y:0},children:e.jsxs("span",{children:[i("external_mount.loading"),"..."]})})})}return e.jsx(yr,{children:e.jsxs(ae,{children:[e.jsxs(w.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:p("center-with-flex merlin-fab-strip flex gap-1 px-1",{"bg-white":r==="gmail","items-stretch":!le,"mt-3":o===h.LINKEDIN.INVITE,"plain-text-color":r!=="gmail","pt-[6px]":le,"px-2 pl-4":o===h.LINKEDIN.COMMENT,"px-5":o===h.LINKEDIN.POST}),children:[!y.isLoading&&y.isAuthenticated&&e.jsxs("div",{className:p({"flex flex-1 items-stretch justify-end gap-1 overflow-hidden":!0,"justify-start":o===h.GMAIL.GMAIL_EXTERNAL_MOUNT}),children:[Tt(),pe===ge.SAVE_PROMPT&&e.jsx("div",{className:"dark:bg-background fixed left-2/4 top-2/4 z-[2147483647] flex h-[40vh] min-h-[420px] w-[30vw] max-w-[360px] -translate-x-2/4 -translate-y-2/4 flex-col items-stretch rounded-lg border border-zinc-200 bg-zinc-50 dark:border-zinc-800",children:e.jsx(kr,{userPrompt:xe||v,changeActiveWindow:Pe,host:r,from:"FAB_STRIP",setUserPromptsUpdated:Ie,promptsFor:b})}),pe===ge.SAVED_PROMPTS&&e.jsx("div",{className:"dark:bg-background fixed left-2/4 top-2/4 z-[2147483647] flex h-[40vh] min-h-[420px] w-[30vw] max-w-[360px] -translate-x-2/4 -translate-y-2/4 flex-col items-stretch rounded-lg border border-zinc-200 bg-zinc-50 dark:border-zinc-800",children:e.jsx(wr,{changeActiveWindow:Pe,updateUserPrompt:Re,host:r,from:"FAB_STRIP",merlinPrompts:ce,setUserPromptsUpdated:Ie,promptsFor:b})})]}),!y.isLoading&&!y.isAuthenticated&&o!==h.GMAIL.GMAIL_EXTERNAL_MOUNT&&e.jsx(w.span,{className:p({"ml-auto py-1":!0}),initial:{opacity:0},animate:{opacity:1,transition:{duration:.3}},children:e.jsx("button",{type:"button",className:"center-with-flex border-cornblue-500 text-cornblue-500 hover:border-cornblue-600 hover:bg-cornblue-100 focus-visible:ring-cornblue-400 active:border-cornblue-700 disabled:border-cornblue-200 dark:border-cornblue-400 dark:text-cornblue-200 dark:hover:bg-cornblue-300/50 dark:focus-visible:text-cornblue-300 dark:focus-visible:ring-cornblue-500 dark:active:bg-cornblue-300/30 dark:disabled:border-cornblue-800 relative gap-1 overflow-hidden truncate whitespace-nowrap rounded-full border px-2 py-1 text-sm font-semibold ring-0 transition-[background-color,box-shadow] duration-300 focus-visible:outline-none focus-visible:ring",onClick:()=>{J({eventData:"Merlin Login",eventName:"OpenPage",eventType:"Button",feature:q[r],firedFromFile:"components/fabStrip"}),window.open(Dt,"_blank")},children:i("external_mount.login")})}),o!==h.GMAIL.GMAIL_EXTERNAL_MOUNT&&e.jsxs("div",{className:p({"flex items-stretch justify-between gap-1":!0}),children:[e.jsx(jr,{position:f.dotMenuPosition,promptsFor:b,isTwitterModal:!1,setActiveWindow:j,host:r,value:re}),e.jsx(vr,{position:f.dotMenuPosition,promptsFor:b,mountOn:o,isTwitterModal:I,setActiveWindow:j,host:r}),r==="gmail"&&e.jsx("button",{type:"button",onClick:()=>k(Le,n,!1),children:e.jsx(Ye,{className:p({"res-icon-big":!0})})})]})]}),A.status==="success"&&e.jsx("div",{className:"m-2",children:e.jsx(Ht,{queryTerms:_,promptResult:N,callingSite:window.location.href,email:!y.email||y.email===""?"EMAIL_NOT_FOUND":y.email,requestId:B})})]})})}export{yr as C,vr as D,Nr as E,dn as F,jr as G,kr as S,It as a,wr as b,Ir as c,We as u};
