"use strict";(()=>{var o=window,i=o.location,a=document,c=("undefined"!=typeof chrome&&chrome||{}).runtime.getURL("PATH/").replace("/PATH/",""),s=c.startsWith("safari-web-extension://"),u=!s&&c.startsWith("moz-extension://");function t(e,t,n){o.parent.postMessage({bm_method:e,bm_request:n,bm_value:t},c)}function n(e,t){t=new InputEvent(t,{bubbles:!0,cancelable:!0});e.dispatchEvent(t)}function r(e,t){t=new KeyboardEvent(t,{bubbles:!0,cancelable:!0,keyCode:13});e.dispatchEvent(t)}function m(e,t){t=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window});e.dispatchEvent(t)}function p(e){m(e,"mousedown"),m(e,"mouseup"),m(e,"click")}var e,l,d,b,f=!1,h=null,w='input[jsaction*="header.back"],img[src*="x/arrow_back_"]',v='input[jsaction*="input:header.searchbox.input"],img[src*="x/search_"] + input';function g(){var e=a.querySelector(w);e&&p(e)}function _(n){var e;n.mapswithcompanionQueryInputPrepared||(n.mapswithcompanionQueryInputPrepared=!0,"object"==typeof n.__jsaction&&delete n.__jsaction.blur,(e=n.getAttribute("jsaction"))&&-1!==e.indexOf(";blur:")&&n.setAttribute("jsaction",e.replace(";blur:",";bluuuur:")),setTimeout(function(){var e,t;e=n,t="focus",t=new FocusEvent(t,{bubbles:!0,cancelable:!0,view:window}),e.dispatchEvent(t)},1e3))}function y(e){var t;"string"==typeof e&&((t=a.querySelector(v))?(_(t),t.value=e,n(t,"input")):(g(),setTimeout(function(){y(e)},10)))}function E(){var e,t;a.documentElement.dataset.bmCsMapswithcompanionFocusState="0",e=a.querySelector(v),t=0,setTimeout(function(){p(e)},t+=50),setTimeout(function(){r(e,"keydown")},t+=50),setTimeout(function(){r(e,"keyup")},t+=50),setTimeout(function(){n(e,"input")},200)}function S(){var n;n=function(e,t){"mapswithcompanionUpdateSearchQuery"===e?(y(t.newValue),t.submit&&E()):"mapswithcompanionGoBack"===e?g():"mapswithcompanionToggleFocusState"===e&&(t?a.documentElement.dataset.bmCsMapswithcompanionFocusState="1":setTimeout(function(){a.documentElement.dataset.bmCsMapswithcompanionFocusState="0"},200))},o.addEventListener("message",function(e){var t;if(s){if(!e.origin.toLowerCase().startsWith("safari-web-extension://"))return}else if(!(e.origin===c))return;(e.isTrusted||u)&&e.source===o.parent&&(t=(e=e.data||{}).bm_method)&&n(t,e.bm_value,e.bm_request)})}function T(){var e=Boolean(a.querySelector('img[src*="x/arrow_back_"]')),e=(f!==e&&t("mapswithcompanionBackState",f=e),a.querySelector('h1[class*="__title-container"] > div[class*="__subtitle"]')),e=e&&e.textContent||null;h!==e&&t("mapswithcompanionPageTitle",h=e),setTimeout(T,100)}function x(){var e,t=a.querySelector("#map > div:first-child > div:first-child");t?((e=a.createElement("button")).type="button",e.className="bm-cs-mapswithcompanion-fab",e.addEventListener("click",function(){y("Navigate"),E()}),t.appendChild(e)):setTimeout(x,100)}e=function(e,t,n){return"mapswithcompanion"===t&&("https://www.google.com"===e||"https://maps.google.com"===e)&&-1!==i.pathname.indexOf("/maps/companion")&&-1!==n.indexOf("bm_wfn")},l=function(){S(),T(),x()},(e=>{var t,n;return!(o.top===o.self||a.documentElement instanceof SVGSVGElement)&&("object"!=typeof(t=i.ancestorOrigins)?1:(n=s?c.toLowerCase():c,1===t.length?t[0]===n:e&&2===t.length&&t[1]===n&&!t[0].endsWith(".google.com")))})(d=!0)&&(b=(b=(d=i.search).match(/[&?]bm_cid=([\da-z-]{2,25})(?:&|$)/))&&b[1],e(origin,b,d))&&(b&&(a.documentElement.dataset.bmCid=b),l())})();